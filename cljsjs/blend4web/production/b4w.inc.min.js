/**
 * Blend4Web CE 16.11
 * Copyright (C) 2014-2016 Triumph LLC
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
var b4w="object"===typeof b4w?b4w:function(a){var q={};a.module=q;var e={};a.cleanup=function(a,b){var g=q[a];g&&(g.Cl=null);e[b||"__b4w_default"]=null};a.register=function(a,b){q[a]||(q[a]=b)};a.require=function(a,b){if(!q[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";e[b]||(e[b]=function(a){return function(b){var d=q[b];if(!d)throw Error('Module "'+b+'" not found');d.Cl||(d.Cl={});d.Cl[a]||(d.Cl[a]={},d(d.Cl[a],e[a]));return d.Cl[a]}}(b));return e[b](a)};a.module_check=function(a){return q[a]?
!0:!1};a.get_namespace=function(a){for(var b in e)if(e[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});"object"==typeof module&&module.qv&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function q(){var a=e,d=a.getDate(),d=10>d?"0"+String(d):String(d),l=a.getMonth()+1,l=10>l?"0"+String(l):String(l),w=String(a.getFullYear()),f=a.getHours(),f=10>f?"0"+String(f):String(f),n=a.getMinutes(),n=10>n?"0"+String(n):String(n),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return d+"."+l+"."+w+" "+f+":"+n+":"+a}var e=new Date(2016,10,30,11,19,44),d=[16,11];a.version=function(){return d};a.version_str=function(){for(var a="",e=0;e<d.length;e++)a=1==e?a+(10>
d[e]?"0"+d[e]:d[e]):a+d[e],e!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return e};a.date_str=q;a.timestamp=function(){var a=q(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.qv&&b4w.module.__version(exports);b4w.module.__config=function(a,q){function e(){return b4w.module_check(a.be.Sq)}function d(){for(var d=a.be,e=null,f=document.getElementsByTagName("script"),n=0;n<f.length;n++){for(var g=f[n].src,v=0;v<d.NB.length;v++)if(0<=g.indexOf(d.NB[v])){e=g;break}if(null!==e)break}e||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),e=document.location.href);d=e.indexOf("?");0<=d&&(e=e.substring(0,d));return e.substring(0,e.lastIndexOf("/")+1)}var b=q("__print"),
g=q("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.P_AUTO=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.eA=g.P(a.context);a.A={alpha_sort:!0,alpha_sort_threshold:.1,Qk:[6,1],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,LA:1,dL:5,background_color:[0,0,0,0],canvas_resolution_factor:1,dn:3,allow_cors:!1,KA:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,nS:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,
motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,QE:!1,Yl:!0,Hs:!0,rc:!0,water_dynamic:!0,shore_smoothing:!0,Mm:!0,vE:!0,precision:"highp",quality:a.P_HIGH,Gq:!0,CN:!1,px:!1,hv:!1,JE:!1,is_mobile_device:!1,Tv:!1,Ju:!1,GT:!1,Hp:!1,allow_hidpi:!1,qD:!1,tw:!1,enable_selectable:!0,enable_outlining:!0,Ih:!0,em:!1,IA:!1,jw:[0,0],Ao:!1,HC:!0,et:!1,url_params:null,Sb:!0,tc:4,io:!1,UC:!1,VC:!1,ex:!1,Tz:!1,yB:!1,HA:!1,media_auto_activation:!0,eC:4,os:!1,gl_debug:!1,Nz:!1,Xy:!1,lu:!1,jo:"dds",
CT:"16x",srgb_type:"SRGB_SIMPLE"};a.tA=g.P(a.A);a.Rj={yr:-1,NA:!1,tk:1};a.controls={xN:1/120};a.pd={path:"",MN:"B4W_ASSETS_PATH=../../assets/",rN:15,prevent_caching:!0,sw:!1,dv:!1,Rs:!1};a.bz=g.P(a.pd);a.be={shaders_path:"",kP:"../shaders/",oD:"include/",BT:"postprocessing/",Sq:"built_in_data",NB:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js B4W_MAIN_MODULE".split(" "),smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};
a.pM={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{Jh:.064,ui:.035,oj:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],tl:.11,Pi:.062,wi:.004}};a.C={enabled:!0,max_fps:60,Xp:"",JQ:"B4W_URANIUM_PATH=uranium.js",Au:!1,ping:!1,hq:!0};a.yC=g.P(a.C);a.Ep={Jr:1024,fr:256,lA:32,pK:128,oK:256,AC:.25,UN:.5,TN:1};a.YC=g.P(a.Ep);a.S={oy:!0,vs:!1,fz:!1,Uz:!1,xA:!1};a.mD=g.P(a.S);a.nc={outlining_overview_mode:!1,Vh:[1,.4,.05],dj:.2,ej:3.8,fj:1};
a.ro={enabled:!1,MP:0,LP:0,nP:"COLOR"};a.rA=g.P(a.ro);a.zh={pN:8,qs:64,pw:8,rs:8,qw:15,fC:0,dp:128,Mh:1024,mw:4096,mc:4096,rw:[4096,4096]};a.dA=g.P(a.zh);a.apply_quality=function(){var b=a.A,d=a.C,f=a.Ep;switch(b.quality){case a.P_ULTRA:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Yl=!0;b.Hs=!0;b.rc=!0;f.Jr=2048;f.fr=512;b.dn=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Mm=!0;b.antialiasing=
!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.Ih=!0;b.tc=16;b.srgb_type="SRGB_PROPER";d.max_fps=120;break;case a.P_HIGH:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Yl=!0;b.Hs=!0;b.rc=!0;f.Jr=1024;f.fr=256;b.dn=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.Mm=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=
!0;b.Ih=!0;b.srgb_type="SRGB_SIMPLE";b.tc=4;d.max_fps=60;break;case a.P_LOW:b.shadows=!1;b.shore_smoothing=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.Yl=!1;b.Hs=!1;b.rc=!1;f.Jr=512;f.fr=256;b.dn=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.Mm=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=!1;b.enable_outlining=!1;b.Ih=!1;b.srgb_type="SRGB_SIMPLE";b.tc=1;d.max_fps=60;break;case a.P_AUTO:g.r("Direct AUTO quality profile setting is forbidden")}};
a.set=function(d,e){switch(d){case "allow_cors":a.A.allow_cors=e;break;case "allow_hidpi":a.A.allow_hidpi=e;break;case "alpha":a.context.alpha=e;break;case "alpha_sort":a.A.alpha_sort=e;break;case "alpha_sort_threshold":a.A.alpha_sort_threshold=e;break;case "anaglyph_use":b.NK();a.A.stereo=e?"ANAGLYPH":a.A.stereo;break;case "animation_framerate":a.Rj.yr=e;break;case "anisotropic_filtering":a.A.anisotropic_filtering=e;break;case "antialiasing":a.A.antialiasing=e;break;case "assets_dir":case "assets_path":a.pd.path=
e;break;case "assets_dds_available":a.pd.dv=e;break;case "assets_pvr_available":a.pd.Rs=e;break;case "assets_min50_available":a.pd.sw=e;break;case "audio":a.S.oy=e;break;case "background_color":a.A.background_color=e;break;case "bloom":a.A.bloom=e;break;case "built_in_module_name":a.be.Sq=e;break;case "canvas_resolution_factor":a.A.canvas_resolution_factor=e;break;case "console_verbose":a.A.console_verbose=e;break;case "compositing":a.A.compositing=e;break;case "dof":a.A.dof=e;break;case "do_not_load_resources":a.A.do_not_load_resources=
e;break;case "god_rays":a.A.god_rays=e;break;case "stereo":a.A.stereo=e;break;case "max_fps":a.A.max_fps=e;break;case "max_fps_physics":a.C.max_fps=e;break;case "media_auto_activation":a.A.media_auto_activation=e;break;case "motion_blur":a.A.motion_blur=e;break;case "physics_enabled":a.C.enabled=e;break;case "physics_uranium_path":a.C.Xp=e;break;case "physics_calc_fps":a.C.Au=e;break;case "physics_use_workers":a.C.hq=e;break;case "precision":a.A.precision=e;break;case "prevent_caching":a.pd.prevent_caching=
e;break;case "quality":a.A.quality=e;break;case "reflections":a.A.reflections=e;break;case "refractions":a.A.refractions=e;break;case "sfx_mix_mode":a.S.vs=e;break;case "shaders_dir":case "shaders_path":a.be.shaders_path=e;break;case "shadows":a.A.shadows=e;break;case "show_hud_debug_info":a.A.show_hud_debug_info=e;break;case "smaa":a.A.smaa=e;break;case "smaa_search_texture_path":a.be.smaa_search_texture_path=e;break;case "smaa_area_texture_path":a.be.smaa_area_texture_path=e;break;case "ssao":a.A.ssao=
e;break;case "debug_view":a.A.debug_view=e;break;case "enable_selectable":a.A.enable_selectable=e;break;case "enable_outlining":a.A.enable_outlining=e;break;case "outlining_overview_mode":a.nc.outlining_overview_mode=e;break;case "glow_materials":a.A.Ih=e;break;case "url_params":a.A.url_params=e;break;case "use_min50":a.A.use_min50=e;break;case "gl_debug":a.A.gl_debug=e;break;case "srgb_type":a.A.srgb_type=e;break;default:b.error("Unknown config property: "+d)}};a.get=function(d){switch(d){case "allow_cors":return a.A.allow_cors;
case "allow_hidpi":return a.A.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.A.alpha_sort;case "alpha_sort_threshold":return a.A.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.A.stereo;case "animation_framerate":return a.Rj.yr;case "anisotropic_filtering":return a.A.anisotropic_filtering;case "antialiasing":return a.A.antialiasing;case "assets_dir":case "assets_path":return a.pd.path;case "assets_dds_available":return a.pd.dv;case "assets_pvr_available":return a.pd.Rs;
case "assets_min50_available":return a.pd.sw;case "audio":return a.S.oy;case "background_color":return a.A.background_color;case "bloom":return a.A.bloom;case "built_in_module_name":return a.be.Sq;case "canvas_resolution_factor":return a.A.canvas_resolution_factor;case "console_verbose":return a.A.console_verbose;case "compositing":return a.A.compositing;case "dof":return a.A.dof;case "do_not_load_resources":return a.A.do_not_load_resources;case "is_mobile_device":return a.A.is_mobile_device;case "god_rays":return a.A.god_rays;
case "stereo":return a.A.stereo;case "max_fps":return a.A.max_fps;case "max_fps_physics":return a.C.max_fps;case "media_auto_activation":return a.A.media_auto_activation;case "motion_blur":return a.A.motion_blur;case "physics_enabled":return a.C.enabled;case "physics_uranium_path":return a.C.Xp;case "physics_calc_fps":return a.C.Au;case "physics_use_workers":return a.C.hq;case "precision":return a.A.precision;case "prevent_caching":return a.pd.prevent_caching;case "quality":return a.A.quality;case "reflections":return a.A.reflections;
case "refractions":return a.A.refractions;case "sfx_mix_mode":return a.S.vs;case "shaders_dir":case "shaders_path":return a.be.shaders_path;case "shadows":return a.A.shadows;case "show_hud_debug_info":return a.A.show_hud_debug_info;case "smaa":return a.A.smaa;case "smaa_search_texture_path":return a.be.smaa_search_texture_path;case "smaa_area_texture_path":return a.be.smaa_area_texture_path;case "ssao":return a.A.ssao;case "debug_view":return a.A.debug_view;case "enable_selectable":return a.A.enable_selectable;
case "enable_outlining":return a.A.enable_outlining;case "outlining_overview_mode":return a.nc.outlining_overview_mode;case "glow_materials":return a.A.Ih;case "url_params":return a.A.url_params;case "use_min50":return a.A.use_min50;case "gl_debug":return a.A.gl_debug;case "srgb_type":return a.A.srgb_type;default:b.error("Unknown config property: "+d)}};a.reset=function(){for(var b in a.eA)a.context[b]=a.eA[b];for(b in a.tA)a.A[b]=a.tA[b];for(b in a.bz)a.pd[b]=a.bz[b];for(b in a.yC)a.C[b]=a.yC[b];
for(b in a.YC)a.Ep[b]=a.YC[b];for(b in a.mD)a.S[b]=a.mD[b];for(b in a.rA)a.ro[b]=a.rA[b]};a.reset_limits=function(){for(var b in a.dA)a.zh[b]=a.dA[b]};a.DB=e;a.XO=function(){var b=a.be,g=a.C;e()||""!=b.shaders_path||(b.shaders_path=d()+b.kP);g.enabled&&""==g.Xp&&(g.Xp=d()+g.JQ.replace("B4W_URANIUM_PATH=",""))};a.get_std_assets_path=function(){var b=a.pd;return b.path?b.path:(b=b.MN.replace("B4W_ASSETS_PATH=",""))&&/^(((.*?)\/\/)|(\/))/.test(b)?b:d()+b}};b4w.module.__anchors=function(a,q){function e(){C=!0;y.get_container().addEventListener("mouseup",function(){function a(){return"visible"==c.style.visibility&&!D&&!n}if(!k&&!t){var b=h;if(b)if("visible"==b.lastElementChild.style.visibility)d(),h=null;else if(1==b.style.opacity){var c=b.lastElementChild,b=b.firstElementChild,m=c.firstElementChild,p=m.innerHTML;c.style.visibility="visible";var F=Math.min(parseInt(c.style.width)||200,w(p)-24),e=f(p,F),D=!0,n=!0;b.style.display="none";k=!0;B.animate(0,
F,200,function(b){b==F&&(D=!1,n||(k=!1),a&&(m.style.visibility="visible"));c.style.width=b+"px"});B.animate(0,e,200,function(b){b==e&&(n=!1,D||(k=!1),a&&(m.style.visibility="visible"));c.style.height=b+"px"})}}})}function d(){var a=h.lastElementChild;h.firstElementChild.style.display="";a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}function g(a){a.style.cssText+=
"background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}function l(a,c,m){var p=document.createElement("div"),F=document.createElement("span");m&&(p.style.width=
m+"px");g(p);b(F);F.innerHTML=a;p.style.visibility="hidden";F.style.visibility="hidden";p.appendChild(F);c.appendChild(p);c.addEventListener("mousedown",function(){k||c==h||1!=c.style.opacity||t||(h&&"visible"==h.lastElementChild.style.visibility&&d(),h=c)})}function w(a){var k=document.createElement("div"),h=document.createElement("span");h.innerHTML=a;b(h);g(k);k.appendChild(h);document.body.appendChild(k);a=k.offsetWidth+1;document.body.removeChild(k);return a}function f(a,k){var h=document.createElement("div"),
c=document.createElement("span");c.innerHTML=a;b(c);g(h);h.style.width=k+"px";h.style.display="inline-block";h.appendChild(c);document.body.appendChild(h);c=h.offsetHeight-16;document.body.removeChild(h);return c}function n(){for(var a=0,k=0;k<J.length;k++)J[k].Ql&&a++;F=new Float32Array(3*a)}function r(a,k){return k.depth-a.depth}function v(a,k,b){a=a.element;A.yB&&(k=Math.floor(k),b=Math.floor(b));"transform"in a.style?a.style.transform="translate3d("+k+"px, "+b+"px, 0px)":"webkitTransform"in a.style?
a.style.webkitTransform="translate3d("+k+"px, "+b+"px, 0px)":(a.style.left=k+"px",a.style.top=b+"px")}var c=q("__batch"),m=q("__camera"),p=q("__config"),y=q("__container"),E=q("__objects"),u=q("__print"),z=q("__renderer"),x=q("__scenes"),I=q("__subscene"),B=q("__time"),G=q("__tsr"),A=p.A,J=[],t=!1,h=null,C=!1,k=!1,F=new Float32Array(0),D=new Uint8Array(16),aa=new Float32Array(2),M=new Float32Array(3);a.append=function(a){var k;a:{for(k=0;k<J.length;k++)if(J[k].obj==a){k=!0;break a}k=!1}if(!k){k=a.anchor.Ql&&
Boolean(x.Ja(x.Ak(),I.vl));k={type:a.anchor.type,obj:a,x:0,y:0,depth:0,Sj:"out",Ql:k,element:null,wm:null,kH:a.anchor.sN,Ii:a.anchor.Ii};switch(k.type){case "ANNOTATION":var h=k.obj;a=y.get_container();var c=E.get_meta_tags(h),h=h.name,d=document.createElement("div"),m=d.cloneNode(),p=document.createElement("span"),F="";d.style.cssText+="position:           absolute;transform-style:    preserve-3d;";m.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;bottom:             0;left:               0;padding:            8px 12px;position:           absolute;";
d.style.visibility="hidden";c&&(F=c.description||F,h=c.title||h);p.innerHTML=h;p.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";b(p);p.style.whiteSpace="nowrap";m.appendChild(p);d.appendChild(m);F&&l(F,d,k.kH);a.appendChild(d);k.element=d;break;case "ELEMENT":if(k.element=document.getElementById(a.anchor.Ii),k.element)for(c=0;c<J.length;c++)"ELEMENT"==
J[c].type&&J[c].Ii==a.anchor.Ii&&(u.warn("Anchor with the id '"+a.anchor.Ii+"' already exists, making the new anchor generic."),k.type="GENERIC");else u.warn("Anchor HTML element with the id '"+a.anchor.Ii+"' was not found, making it generic."),k.type="GENERIC"}J.push(k);n();C||e()}};a.remove=function(a){for(var k=0;k<J.length;k++){var b=J[k];if(b.obj==a){"ANNOTATION"==b.type&&(a=b,y.get_container().removeChild(a.element));J.splice(k,1);n();break}}};a.update=function(a){for(var k=0,b=J.length;b--;){var d=
J[b];if(d.Ql){var p=G.get_trans_view(d.obj.k.n);F.set(p,3*k++)}var f;f=d;var p=M,t=x.bm(x.Ak());f=G.get_trans_view(f.obj.k.n);f=p=m.project_point(t,f,p);p=f[0];t=f[1];f=f[2];if(a||p!=d.x||t!=d.y||f!=d.depth){switch(d.type){case "ANNOTATION":var e=p,D=t;v(d,e,D);break;case "ELEMENT":D=d.element.getBoundingClientRect(),e=p-D.width/2,D=t-D.height/2,v(d,e,D)}d.x=p;d.y=t;d.depth=f;d.wm&&d.wm(p,t,d.Sj,d.obj,d.element)}}J.sort(r);for(b=0;b<J.length;b++)d=J[b],"GENERIC"!=d.type&&(d.element.style.zIndex=h==
d.element?J.length:b);0<k&&(a=x.Ja(x.Ak(),I.vl),k=a.La[0].oa[0],c.cQ(k.qa,F),I.Cc(a,k))};a.uE=function(){for(var a=y.get_container(),k=J.length;k--;){var b=J[k],c=b.obj,m=b.x,p=b.y,F=b.depth,F=0>m||0>p||0>F||1<F||x.is_hidden(c)||m>=a.clientWidth||p>=a.clientHeight?"out":"visible";if(b.Ql&&"out"!=F){var F=b,f=x.Ja(x.Ak(),I.vl).p,t=y.Uq(F.x,F.y,aa,f);z.$w(f.xe,t[0],f.height-t[1],2,2,D);F=1020==D[0]+D[4]+D[8]+D[12]?"visible":"out"==F.Sj||0==D[0]+D[4]+D[8]+D[12]?"covered":F.Sj}if(F!=b.Sj){switch(b.type){case "ANNOTATION":case "ELEMENT":var e=
b.element;if(!e)break;"out"==F?(e.style.visibility="hidden",e.children.length&&(e.children[0].style.visibility="hidden")):"visible"==F?(e.style.visibility="visible",e.children.length&&(e.children[0].style.visibility="visible"),e.style.opacity=1):(e.style.visibility="visible",e.style.opacity=.1,e.children.length&&(e.children[0].style.visibility="visible"),"ANNOTATION"==b.type&&1<e.children.length&&"visible"==e.lastElementChild.style.visibility&&(d(),e==h&&(h=null)))}b.Sj=F;b.wm&&b.wm(m,p,b.Sj,c,e)}}};
a.attach_move_cb=function(a,k){for(var b=0;b<J.length;b++)J[b].obj==a&&(J[b].wm=k)};a.detach_move_cb=function(a){for(var k=0;k<J.length;k++)J[k].obj==a&&(J[k].wm=null)};a.cleanup=function(){for(var a=0;a<J.length;a++){var k=J[a];"ANNOTATION"==k.type&&y.get_container().removeChild(k.element)}J.length=0};a.is_anchor=function(a){for(var k=0;k<J.length;k++)if(J[k].obj==a)return!0;return!1};a.get_element_id=function(a){for(var k=0;k<J.length;k++)if(J[k].obj==a)return J[k].Ii;return!1};a.pause=function(){t=
!0};a.resume=function(){t=!1};a.NN=function(a,k){for(var b=-1,h=0;h<J.length;h++){var d;if(d="visible"==J[h].Sj){var c=J[h];if(c.element){d=Math.round(c.element.offsetWidth)||0;var m=Math.round(c.element.offsetHeight)||0}else m=d=0;var p=c.x,c=c.y;d=a>=p&&a<=p+d&&k<c&&k>=c-m?!0:!1}if(d)if(0>b)var F=J[h].depth,b=h;else J[h].depth<F&&(b=h,F=J[h].depth)}return 0>b?null:J[b].obj}};b4w.module.__armature=function(a,q){function e(a){a=a.k;for(var b=a.Pm,d=a.ss,c=0;c<b.length;c++){for(var m=b[c],f=d[c],e=0;e<f.length;e+=2)for(var n=f[e],g=f[e+1],l=0;4>l;l++)m.Ld[n+l]=a.Ld[g+l],m.ee[n+l]=a.ee[g+l],m.Pd[n+l]=a.Pd[g+l],m.he[n+l]=a.he[g+l];m.we=a.we}}function d(a,b,c,m){var f=a.$x,e=a.zj,l=a.Up,v=a.Nw;v?(v=v.Up,b?g.multiply(v,f,l):(b=r,g.invert(v,b),g.multiply(b,l,f))):b?g.copy(f,l):g.copy(l,f);f=n;g.invert(e,f);g.multiply(l,f,f);e=a.xi;c[4*e]=f[0];c[4*e+1]=f[1];c[4*e+2]=f[2];c[4*
e+3]=f[3];m[4*e]=f[4];m[4*e+1]=f[5];m[4*e+2]=f[6];m[4*e+3]=f[7];a=a.vA;for(e=0;e<a.length;e++)l=a[e],l.Tb||d(l,!0,c,m)}var b=q("__util"),g=q("__tsr"),l=q("__quat"),w=q("__mat4"),f=q("__vec3"),n=g.create(),r=g.create(),v=new Float32Array(4),c=new Float32Array(4),m=new Float32Array(4);a.Cj=function(a,c){for(var d=a.data.bones,m=a.pose.bones,e={},l=0;l<m.length;l++){var v=m[l],r=v.bone,G=r.name,A=e[G]={xi:0,KE:-1,Nw:null,vA:[],Vq:[],Tb:null,Tp:g.create(),$x:g.create(),zj:g.create(),Up:g.create(),ut:g.create(),
ay:g.create(),vt:!1,WD:new Float32Array(3)},G=new Float32Array(r.matrix_local),J=new Float32Array(16);w.invert(G,J);var v=new Float32Array(v.matrix_basis),t=A.WD;f.subtract(b.f32(r.tail_local),b.f32(r.head_local),t);b.SQ(t,J,t);g.from_mat4(G,A.zj);g.from_mat4(v,A.ut);g.copy(A.zj,A.Up)}for(l=0;l<d.length;l++){G=d[l].name;v=b.keysearch("name",G,m);A=e[G];r=v.parent_recursive;A.Vq.push(A);for(J=0;J<r.length;J++)v=r[J],v=v.name,v=e[v],A.Vq.push(v);r.length?(v=r[0],v=v.name,v=e[v],A.Nw=v,g.invert(v.zj,
n),g.multiply(n,A.zj,A.Tp),v.vA.push(A)):g.copy(A.zj,A.Tp);A.xi=l;A.name=G;g.multiply(A.Tp,A.ut,A.$x)}c.k.qe=e};a.get_bone_tsr=function(a,b,d,f,e){var x=a.k,w=x.we;b=x.qe[b];var B=b.xi;a=b.zj;var G=x.Pd,A=x.he,J=x.Ld,x=x.ee,t=G[4*B+1],h=G[4*B+2],C=G[4*B+3],k=A[4*B+1],F=A[4*B+2],D=A[4*B+3];v[0]=(1-w)*G[4*B]+w*A[4*B];v[1]=(1-w)*t+w*k;v[2]=(1-w)*h+w*F;v[3]=(1-w)*C+w*D;c[0]=J[4*B];c[1]=J[4*B+1];c[2]=J[4*B+2];c[3]=J[4*B+3];m[0]=x[4*B];m[1]=x[4*B+1];m[2]=x[4*B+2];m[3]=x[4*B+3];l.slerp(c,m,w,c);w=n;g.set_transcale(v,
w);g.set_quat(c,w);d?(d=r,g.translate(a,b.WD,d),g.multiply(w,d,w)):g.multiply(w,a,w);if(f){if(f=b.Nw)d=r,g.invert(f.Up,d),g.multiply(d,w,w);f=r;g.invert(b.Tp,f);g.multiply(f,w,w)}g.copy(w,e)};a.set_bone_tsr=function(a,b,c,m){var f=a.k;b=f.qe[b];var n=f.Pd,l=f.Ld;m?g.multiply(b.Tp,c,b.$x):g.copy(c,b.Up);d(b,m,n,l);f.we=0;e(a)};a.CQ=e;a.jQ=d;a.Wn=function(a,b){return b in a.k.qe}};b4w.module.__boundings=function(a,q){function e(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function d(){return{D:new Float32Array(3),za:new Float32Array(3),Aa:new Float32Array(3),Ba:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function g(a,b){for(var h=a[0],c=a[1],d=a[2],m=a[0],p=a[1],f=a[2],e=3;e<a.length;e+=3)var t=a[e],n=a[e+1],l=a[e+2],h=Math.max(h,t),c=Math.max(c,n),d=Math.max(d,l),
m=Math.min(m,t),p=Math.min(p,n),f=Math.min(f,l);b.max_x=h;b.max_y=c;b.max_z=d;b.min_x=m;b.min_y=p;b.min_z=f;return b}function l(a,b){b||(b=new Float32Array(24));var h=a.max_x,c=a.max_y,d=a.max_z,m=a.min_x,p=a.min_y,f=a.min_z;b[0]=m;b[1]=p;b[2]=f;b[3]=h;b[4]=p;b[5]=f;b[6]=h;b[7]=c;b[8]=f;b[9]=m;b[10]=c;b[11]=f;b[12]=m;b[13]=p;b[14]=d;b[15]=h;b[16]=p;b[17]=d;b[18]=h;b[19]=c;b[20]=d;b[21]=m;b[22]=c;b[23]=d;return b}function w(){return{D:new Float32Array(3),Ra:0}}function f(a,b){b.D[0]=a.D[0];b.D[1]=
a.D[1];b.D[2]=a.D[2];b.Ra=a.Ra}function n(){return{za:new Float32Array(3),Aa:new Float32Array(3),Ba:new Float32Array(3),D:new Float32Array(3)}}function r(a,b){u.copy(a.za,b.za);u.copy(a.Aa,b.Aa);u.copy(a.Ba,b.Ba);u.copy(a.D,b.D);return b}function v(a){var b=n();r(a,b);return b}function c(a,b,h,c){return{za:new Float32Array(a),Aa:new Float32Array(b),Ba:new Float32Array(h),D:new Float32Array([c[0],c[1],c[2]])}}function m(a,b){var d=z.uI(a,J),d=b?z.pI(a,d,h):x.identity(h),d=z.YK(d,t);u.copy(a,B);u.transformMat3(B,
d,B);for(var m=B[0],p=m,f=B[1],e=f,n=B[2],l=n,O=0,v=0,g=0,r=0,y=0,G=0,H=3;H<a.length;H+=3)B[0]=a[H],B[1]=a[H+1],B[2]=a[H+2],u.transformMat3(B,d,B),O=B[0],v=B[1],g=B[2],O>m&&(m=O),O<p&&(p=O),v>f&&(f=v),v<e&&(e=v),g>n&&(n=g),g<l&&(l=g);f-=e;n-=l;m=Math.max(m-p,1E-9);f=Math.max(f,1E-9);n=Math.max(n,1E-9);p=x.identity(h);p[0]=0!=m?1/m:1E8;p[4]=0!=f?1/f:1E8;p[8]=0!=n?1/n:1E8;x.transpose(d,C);B[0]=a[0];B[1]=a[1];B[2]=a[2];u.transformMat3(B,d,B);u.transformMat3(B,p,B);u.transformMat3(B,C,B);O=B[0];v=B[0];
g=B[1];r=B[1];y=B[2];G=B[2];for(H=3;H<a.length;H+=3)B[0]=a[H],B[1]=a[H+1],B[2]=a[H+2],u.transformMat3(B,d,B),u.transformMat3(B,p,B),u.transformMat3(B,C,B),O=Math.max(O,B[0]),v=Math.min(v,B[0]),g=Math.max(g,B[1]),r=Math.min(r,B[1]),y=Math.max(y,B[2]),G=Math.min(G,B[2]);H=Math.sqrt((O-v)*(O-v)+(g-r)*(g-r)+(y-G)*(y-G))/2;H=Math.min(H,1);A[0]=(O+v)/2;A[1]=(g+r)/2;A[2]=(y+G)/2;O=A;p=x.identity(h);p[0]=m;p[4]=f;p[8]=n;u.transformMat3(O,d,O);u.transformMat3(O,p,O);u.transformMat3(O,C,O);p=[d[0],d[3],d[6]];
v=[d[1],d[4],d[7]];d=[d[2],d[5],d[8]];u.scale(p,m*H,p);u.scale(v,f*H,v);u.scale(d,n*H,d);return c(p,v,d,O)}function p(a,b,h){u.add(b,h,a.D);u.scale(a.D,.5,a.D);a.Ra=u.distance(a.D,b);return a}var y=q("__tsr"),E=q("__util"),u=q("__vec3"),z=q("__math"),x=q("__mat3"),I=new Float32Array(24),B=new Float32Array(3),G=new Float32Array(3),A=new Float32Array(3),J=new Float32Array(3),t=new Float32Array(9),h=new Float32Array(9),C=new Float32Array(9);new Float32Array(9);a.Wc=e;a.cr=d;a.Ei=b;a.TR=function(){return{max_x:1E12,
min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.gR=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.Il=function(a){var h=e();b(a,h);return h};a.qI=function(a){var b=a.max_x-a.min_x,h=a.max_y-a.min_y;h<b&&(b=h);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.rr=function(a,b){var h=a.max_y,d=a.max_z,c=a.min_x,m=a.min_y,p=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,h);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,c);a.min_y=Math.min(b.min_y,
m);a.min_z=Math.min(b.min_z,p)};a.YH=g;a.yi=function(a,b,h){h||(h=e());a=l(a,I);y.transform_vectors(a,b,a);return g(a,h)};a.FA=l;a.ET=function(a,b,h){h||(h=e());var d=b.min_x,c=b.max_x,m=b.min_y,p=b.max_y,f=b.min_z;b=b.max_z;if(d>=a.max_x||c<=a.min_x||m>=a.max_y||p<=a.min_y||f>=a.max_z||b<=a.min_z)return h.min_x=-.1,h.max_x=.1,h.min_y=-.1,h.max_y=.1,h.min_z=-.2,h.max_z=-.1,h;h.min_x=Math.max(a.min_x,d);h.max_x=Math.min(a.max_x,c);h.min_y=Math.max(a.min_y,m);h.max_y=Math.min(a.max_y,p);h.min_z=Math.max(a.min_z,
f);h.max_z=Math.min(a.max_z,b);return h};a.KT=function(a,b,h){h||(h=e());var d=a.max_x-a.min_x,c=a.max_y-a.min_y,m=a.max_z-a.min_z;h.min_x=a.min_x-.5*(b-1)*d;h.max_x=a.max_x+.5*(b-1)*d;h.min_y=a.min_y-.5*(b-1)*c;h.max_y=a.max_y+.5*(b-1)*c;h.min_z=a.min_z-.5*(b-1)*m;h.max_z=a.max_z+.5*(b-1)*m;return h};a.Hl=function(a,b,h){h||(h=w());y.transform_vec3(a.D,b,h.D);h.Ra=a.Ra*y.get_scale(b);return h};a.Gl=function(a,b,h){h||(h=n());y.transform_vec3(a.D,b,h.D);u.copy(a.za,h.za);u.copy(a.Aa,h.Aa);u.copy(a.Ba,
h.Ba);y.transform_dir_vec3(h.za,b,h.za);y.transform_dir_vec3(h.Aa,b,h.Aa);y.transform_dir_vec3(h.Ba,b,h.Ba);return h};a.yu=function(a,b,h){h||(h=d());y.transform_vec3(a.D,b,h.D);u.copy(a.za,h.za);u.copy(a.Aa,h.Aa);u.copy(a.Ba,h.Ba);y.transform_dir_vec3(h.za,b,h.za);y.transform_dir_vec3(h.Aa,b,h.Aa);y.transform_dir_vec3(h.Ba,b,h.Ba);return h};a.Rq=function(a,b){var h=w();u.copy(b,h.D);h.Ra=a;return h};a.uO=function(a,b,h,c,m){var p=d();u.copy(a,p.D);u.copy(b,p.za);u.copy(h,p.Aa);u.copy(c,p.Ba);u.scale(p.za,
m[0],p.za);u.scale(p.Aa,m[1],p.Aa);u.scale(p.Ba,m[2],p.Ba);return p};a.Hg=w;a.Zq=f;a.Se=n;a.fA=r;a.$n=v;a.ak=function(a){var b=w();f(a,b);return b};a.On=c;a.$H=function(){var a;a||(a=w());u.set(0,0,0,a.D);a.Ra=1E12;return a};a.CA=function(a,b){var h=u.subtract(b.D,a.D,u.create());0==u.length(h)&&u.set(1,0,0,h);var d=u.normalize(h,u.create()),h=u.scale(d,a.Ra,u.create());u.add(h,a.D,h);var c=u.scale(d,-a.Ra,u.create());u.add(c,a.D,c);var m=u.scale(d,b.Ra,u.create());u.add(m,b.D,m);var p=u.scale(d,
-b.Ra,u.create());u.add(p,b.D,p);h=[h,c,m,p];d=u.normalize(d,u.create());c=h[0];m=h[0];for(p=1;p<h.length;p++){var f=u.dot(h[p],d);f<u.dot(c,d)&&(c=h[p]);f>u.dot(m,d)&&(m=h[p])}d=[c,m];h=d[0];d=d[1];a.D=u.scale(u.add(h,d,u.create()),.5,u.create());a.Ra=u.length(u.subtract(d,h,u.create()))/2};a.sv=function(a,b){u.add(a.D,a.Aa,B);u.add(B,a.za,B);u.add(B,a.Ba,B);b.push(B[0],B[1],B[2]);u.add(a.D,a.Aa,B);u.add(B,a.za,B);u.subtract(B,a.Ba,B);b.push(B[0],B[1],B[2]);u.add(a.D,a.Aa,B);u.subtract(B,a.za,B);
u.add(B,a.Ba,B);b.push(B[0],B[1],B[2]);u.add(a.D,a.Aa,B);u.subtract(B,a.za,B);u.subtract(B,a.Ba,B);b.push(B[0],B[1],B[2]);u.subtract(a.D,a.Aa,B);u.add(B,a.za,B);u.add(B,a.Ba,B);b.push(B[0],B[1],B[2]);u.subtract(a.D,a.Aa,B);u.add(B,a.za,B);u.subtract(B,a.Ba,B);b.push(B[0],B[1],B[2]);u.subtract(a.D,a.Aa,B);u.subtract(B,a.za,B);u.add(B,a.Ba,B);b.push(B[0],B[1],B[2]);u.subtract(a.D,a.Aa,B);u.subtract(B,a.za,B);u.subtract(B,a.Ba,B);b.push(B[0],B[1],B[2])};a.br=m;a.iJ=function(a){var b=d();u.copy(a.za,
b.za);u.copy(a.Aa,b.Aa);u.copy(a.Ba,b.Ba);u.copy(a.D,b.D);return b};a.Jl=function(a){var b=w(),h=0,h=u.length(a.za),d=u.length(a.Aa),c=u.length(a.Ba),h=h>d?h:d;b.D=a.D;b.Ra=c>h?c:h;return b};a.zz=function(a,b){var h=v(a),d=y.Ub(b,J);u.subtract(h.D,d,h.D);return h};a.Zr=function(a,b){var h=u.length(a.za),d=u.length(a.Aa),c=u.length(a.Ba);return.75*b.Ra*b.Ra*b.Ra>h*d*c};a.jz=function(a,b){var h=b.max_z,d=b.min_z,c=Math.max(0,h-d-2*a);return{Ra:a,height:c,D:new Float32Array([0,0,(h+d)/2])}};a.lz=function(a,
b){var h=b.max_z,d=b.min_z,c=Math.max(0,h-d);return{Ra:a,height:c,D:new Float32Array([0,0,(h+d)/2])}};a.kz=function(a,b){var h=b.max_z,d=b.min_z,c=Math.max(0,h-d);return{Ra:a,height:c,D:new Float32Array([0,0,(h+d)/2])}};a.YR=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.cO=function(a){for(var b=0,h=0,d=0,c=0,p=0,f=0,e=0,t=0,O=0,n=0,l=0,v=0,g=0,r=0,H=0;H<a.submeshes.length;H++){var C=a.submeshes[H];if(C.position.length){b=
c=C.position[0];h=p=C.position[1];d=f=C.position[2];break}}for(H=0;H<a.submeshes.length;H++){for(var C=a.submeshes[H],y=C.position,e=n=C.position[0],t=l=C.position[1],O=v=C.position[2],ia=0;ia<y.length/3;ia++)var u=y[3*ia],J=y[3*ia+1],z=y[3*ia+2],b=Math.max(u,b),h=Math.max(J,h),d=Math.max(z,d),c=Math.min(u,c),p=Math.min(J,p),f=Math.min(z,f),e=Math.max(u,e),t=Math.max(J,t),O=Math.max(z,O),n=Math.min(u,n),l=Math.min(J,l),v=Math.min(z,v),g=Math.max(Math.sqrt(u*u+J*J+z*z),g),r=Math.max(Math.sqrt(u*u+
J*J),r);y=C.boundings.bb;y.max_x=e;y.min_x=n;y.max_y=t;y.min_y=l;y.max_z=O;y.min_z=v;y=I;y[0]=n;y[1]=l;y[2]=v;y[3]=e;y[4]=l;y[5]=v;y[6]=e;y[7]=t;y[8]=v;y[9]=n;y[10]=t;y[11]=v;y[12]=n;y[13]=l;y[14]=O;y[15]=e;y[16]=l;y[17]=O;y[18]=e;y[19]=t;y[20]=O;y[21]=n;y[22]=t;y[23]=O;e=m(y,!1);C.boundings.be_cen=e.D;C.boundings.be_ax=[e.za[0],e.Aa[1],e.Ba[2]]}H=a.b4w_boundings.bb;H.max_x=b;H.min_x=c;H.max_y=h;H.min_y=p;H.max_z=d;H.min_z=f;H=a.b4w_boundings.bb_src;H.max_x=b;H.min_x=c;H.max_y=h;H.min_y=p;H.max_z=
d;H.min_z=f;a.b4w_boundings.bs_rad=g;a.b4w_boundings.bc_rad=r;y=I;y[0]=c;y[1]=p;y[2]=f;y[3]=b;y[4]=p;y[5]=f;y[6]=b;y[7]=h;y[8]=f;y[9]=c;y[10]=h;y[11]=f;y[12]=c;y[13]=p;y[14]=d;y[15]=b;y[16]=p;y[17]=d;y[18]=b;y[19]=h;y[20]=d;y[21]=c;y[22]=h;y[23]=d;e=m(y,!1);a.b4w_boundings.be_cen=e.D;a.b4w_boundings.be_ax=[e.za[0],e.Aa[1],e.Ba[2]]};a.TL=function(a){var b=a.subarray(0,3),h=a.subarray(6,9),d=a.subarray(12,15),c=a.subarray(18,21);a=u.subtract(h,b,B);u.normalize(a,a);var m=E.cM(b,h,d,G),m=u.cross(m,a,
m);u.normalize(m,m);var f=u.create(),e=u.create();u.subtract(h,b,A);e[0]=u.dot(A,a);e[1]=u.dot(A,m);h=u.create();u.subtract(d,b,A);h[0]=u.dot(A,a);h[1]=u.dot(A,m);d=u.create();u.subtract(c,b,A);d[0]=u.dot(A,a);d[1]=u.dot(A,m);c=w();d=[f,e,h,d];f=p(c,d[0],d[1]);for(c=2;c<d.length;c++)if(u.distance(f.D,d[c])>f.Ra){for(var t=f,f=d,e=d[c],h=c-1,t=p(t,e,f[0]),O=1;O<=h;O++)if(u.distance(t.D,f[O])>t.Ra){for(var n=t,t=f,l=e,v=f[O],g=O-1,n=p(n,l,v),r=0;r<=g;r++)if(u.distance(n.D,t[r])>n.Ra){var H=l,y=v,C=
t[r],ia=u.subtract(y,C,A),ia=u.squaredLength(ia),J=u.subtract(H,C,A),z=u.squaredLength(J),J=u.subtract(H,y,A),x=u.squaredLength(J),J=ia*(z+x-ia),X=z*(x+ia-z),ia=x*(ia+z-x),z=J+X+ia;u.copy(H,n.D);u.scale(n.D,J/z,n.D);u.scaleAndAdd(n.D,y,X/z,n.D);u.scaleAndAdd(n.D,C,ia/z,n.D);n.Ra=u.distance(n.D,H)}t=n}f=t}c=f;a=u.scale(a,c.D[0],A);u.scaleAndAdd(a,m,c.D[1],a);u.add(a,b,c.D);return c}};b4w.module.__compat=function(a,q){function e(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function d(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var g=q("__config"),l=q("__debug"),w=q("__extensions"),
f=q("__print"),n=q("__renderer"),r="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.Jy=256;var v=g.Rj,c=g.A,m=g.ro,p=g.context,y=g.zh,E=g.S,u=g.C,z=g.pd;a.yK=function(a){a.getError()==a.INVALID_ENUM&&f.warn("Possible Tegra invalid enum issue detected, ignoring")};a.dD=function(x,I){function B(a){I&&f.warn(a)}y.pN=x.getParameter(x.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
y.qs=x.getParameter(x.MAX_FRAGMENT_UNIFORM_VECTORS);y.pw=x.getParameter(x.MAX_TEXTURE_IMAGE_UNITS);y.rs=x.getParameter(x.MAX_VARYING_VECTORS);y.qw=x.getParameter(x.MAX_VERTEX_ATTRIBS);y.fC=x.getParameter(x.MAX_VERTEX_TEXTURE_IMAGE_UNITS);y.dp=x.getParameter(x.MAX_VERTEX_UNIFORM_VECTORS);y.Mh=x.getParameter(x.MAX_CUBE_MAP_TEXTURE_SIZE);y.mw=x.getParameter(x.MAX_RENDERBUFFER_SIZE);y.mc=x.getParameter(x.MAX_TEXTURE_SIZE);y.rw=x.getParameter(x.MAX_VIEWPORT_DIMS);c.Sb&&!m.enabled&&(c.io=!0);c.Sb?(c.tc=
Math.min(c.tc,x.getParameter(x.MAX_SAMPLES)),e("Firefox")&&(B("Firefox and WebGL 2 detected, applying framebuffer hack, disabling anchor visibility"),c.Nz=!0,c.HA=!0)):c.tc=1;e("Firefox")&&"NONE"!==c.stereo&&(B("Firefox and Stereo rendering detected, disable texture reusage"),c.IA=!0);if(c.Sb&&l.NI()||e("Firefox"))B("Firefox detected, disabling multisample"),c.tc=1;n.LO();var G=Boolean(w.KL());e("Firefox/28.0")&&(e("Linux")||e("Macintosh"))&&(B("Firefox 28 detected, applying depth hack"),G=!1);e("Windows Phone")||
(e("iPad")||e("iPhone")?(B("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),p.alpha||(c.background_color[3]=1),c.VC=!0,c.JE=!0,c.smaa=!1,c.ssao=!1,c.precision="highp",c.Tv=!0,Boolean(w.iB())&&z.Rs&&(c.jo="pvr")):e("Mac OS X")&&e("Safari")&&!e("Chrome")&&(B("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),
c.UC=!0,E.fz=!0,E.Uz=!0));e("Windows")&&(e("Chrome/40")||e("Firefox/33")||e("Firefox/34")||e("Firefox/35")||e("Firefox/36"))&&(B("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),c.Ju=!0);e("Chrome")&&!d()&&g.DB()&&(B('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),c.Tz=!0);e("Mac OS X")&&(c.os=!0,B("OS X detected, applying shadows hack."));d()&&(B("Mobile detected, applying various hacks for video textures."),
c.is_mobile_device=!0,e("iPad")||e("iPhone")||e("Windows Phone")||(B("Mobile (not iOS) detected, disable playback rate for video textures."),E.xA=!0));(e("Firefox/35.0")||e("Firefox/36.0"))&&e("Windows")&&(B("Windows/Firefox 35/36 detected, applying shadows slink hack"),c.qD=!0);if(e("iPhone")||b()||e("Edge"))B("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),c.Hp=!0;10>y.rs&&(B("Not enough varyings, disable shadows on blend objects"),c.hv=!0);e("Windows Phone")&&
(B("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),c.debug_view=!1,c.precision="highp",c.Ih=!1,c.ssao=!1,c.smaa=!1,c.shadows=!1,c.reflections=!1,c.refractions=!1,c.HC=!1);if(e("UCBrowser")||e("Chrome")&&e("Nexus")&&c.is_mobile_device)B("Mobile Nexus Chrome or UCBrowser detected, disable workers."),u.hq=!1;var A=w.get_renderer_info();if(A){var J=x.getParameter(A.UNMASKED_VENDOR_WEBGL),A=x.getParameter(A.UNMASKED_RENDERER_WEBGL),t=/\b4\d{2}\b/;
-1<J.indexOf("ARM")&&t.test(A)&&(B("ARM Mali-400 series detected, applying depth and frames blending hacks"),G=!1,v.NA=!0);-1<J.indexOf("ARM")&&-1<A.indexOf("Mali-T604")&&(B('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),c.precision="highp",c.shadows=!1);-1<J.indexOf("ARM")&&-1<A.indexOf("Mali-T760")&&(B('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),c.precision="highp",c.ssao=!1,c.et=!0,c.Sb&&(c.tc=1,B("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));
-1<J.indexOf("Qualcomm")&&-1<A.indexOf("Adreno")&&(B("Qualcomm Adreno detected, applying shader constants hack."),c.px=!0,-1<A.indexOf("305")&&(B('Qualcomm Adreno305 detected, set "highp" precision.'),c.precision="highp"),-1<A.indexOf("330")&&(B('Qualcomm Adreno330 detected, set "highp" precision.'),c.precision="highp"),-1<A.indexOf("420")&&(B("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),y.mc=4096,y.Mh=4096));-1<J.indexOf("NVIDIA")&&-1<A.indexOf("Tegra 3")&&
(B("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),c.KA=!0);e("Windows")&&e("Chrome")&&!e("Edge")&&(A.match(/NVIDIA GeForce 8..0/)||A.match(/NVIDIA GeForce 9..0/)||A.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(B("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),y.Mh=a.Jy,c.ex=!0);-1<A.indexOf("PowerVR")&&(B("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),
c.ex=!0,c.et=!0,c.shadows=!1);J="";for(t=0;t<r.length;t++)if(-1<A.indexOf(r[t])){J=r[t];break}J&&(B("Architecture "+J+" detected. Blending between frames and shadows on blend objects will be disabled."),c.et=!0,c.hv=!0)}0==y.fC&&(B("Vertex textures are not allowed. Disabling vertex textures"),c.Gq=!1);G||(c.Yl=!1,c.rc=!1,c.water_dynamic=!1,c.shore_smoothing=!1,c.Mm=!1,c.smaa=!1);c.vE=Boolean(w.jB())||"pvr"==c.jo;c.kr=G;if(x.getShaderPrecisionFormat)var h=x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,
x.HIGH_FLOAT);x.getShaderPrecisionFormat&&0!==h.precision||(c.precision="mediump");if(b()&&e("Touch")||e("Edge"))B("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),c.em=!0;if(b()||e("Edge"))c.yB=!0;d()&&e("Firefox")&&(f.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),c.tw=!0,y.mc=4096,y.Mh=4096);e("Edge")&&(B("Microsoft Edge detected, set up new minimal texture size."),c.Ao=
!0)};a.Hu=e;a.detect_mobile=d;a.JH=function(){e("Firefox/35.0")&&e("Windows")&&(f.warn("Windows/Firefox 35 detected, forcing context's alpha"),g.context.alpha=!0)};a.is_ie11=b};b4w.module.__constraints=function(a,q){function e(a){var b={};b.type=a;return b}function d(a,h){a.Tb&&a.Tb.xa&&b(a.Tb.xa,a);if(h.xa){var d=h.xa;-1==d.se.indexOf(a)?d.se.push(a):y.r("Descendant object override is forbidden")}a.Tb=h}function b(a,b){var h=a.se.indexOf(b);-1!=h?a.se.splice(h,1):y.r("No descendant object")}function g(a,b,d){switch(b.type){case 1:var c=p.get_quat_view(a.k.n),e=b.xa.k.n;d=p.get_quat_view(b.xa.k.n);b.Md?(m.copy(b.Md,c),m.multiply(d,c,c)):m.copy(d,c);var l=p.transform_vec3(b.offset,
e,x);p.set_trans(l,a.k.n);l=p.get_scale(b.xa.k.n);p.set_scale(b.Dp*l,a.k.n);break;case 9:l=p.get_trans_view(a.k.n);c=p.get_quat_view(a.k.n);e=b.xa.k.n;d=p.get_quat_view(b.xa.k.n);m.multiply(m.invert(b.Wk,b.Wk),c,c);m.multiply(d,c,c);p.transform_vec3(b.offset,e,l);m.copy(d,b.Wk);break;case 10:l=p.get_trans_view(a.k.n);c=p.get_quat_view(a.k.n);e=b.xa.k.n;d=p.get_quat_view(b.xa.k.n);m.multiply(m.invert(b.Wk,b.Wk),c,c);m.multiply(d,c,c);p.transform_vec3(b.offset,e,l);m.copy(d,b.Wk);l=p.get_quat_view(a.k.n);
c=p.get_quat_view(b.xa.k.n);c=m.multiply(c,b.Md,A);c=r.Av(c,u);l=r.Av(l,z);r.rotate_eye_camera(a,y.$j(l[0],c[0]+b.TI,c[0]+b.SI),y.$j(l[1],c[1]+b.RI,c[1]+b.UI));break;case 13:var l=p.get_trans_view(a.k.n),c=p.get_quat_view(a.k.n),e=b.xa.k.n,g=p.get_trans_view(e),N=b.rP,G=x,O=A;p.transform_vec3(b.offset,e,G);y.smooth_v(G,l,d,N,l);e=x;E.sub(g,l,e);E.normalize(e,e);var qa=c,l=J,g=l.subarray(0,3),G=l.subarray(3,6),fa=l.subarray(6,9);E.copy(e,fa);E.negate(fa,fa);E.normalize(fa,fa);Boolean(.999999<Math.abs(E.dot(e,
y.AXIS_Z)))?(e=v.fromQuat(m.normalize(qa,O),t),E.copy(e.subarray(0,3),g)):E.cross(y.AXIS_Z,fa,g);E.normalize(g,g);E.cross(fa,g,G);E.normalize(G,G);m.fromMat3(l,O);m.normalize(O,O);y.zD(O,c,d,.16*N,c);break;case 2:c=p.get_quat_view(a.k.n);d=h;n.get_bone_tsr(b.xa,b.Zj,!0,!1,d);p.multiply(b.xa.k.n,d,d);c[0]=d[4];c[1]=d[5];c[2]=d[6];c[3]=d[7];b.Md&&(m.copy(b.Md,c),m.multiply(c,b.Md,c));p.set_scale(b.Dp*d[3],a.k.n);l=p.get_trans_view(a.k.n);p.transform_vec3(b.offset,d,l);break;case 3:l=p.get_trans_view(a.k.n);
c=p.get_quat_view(a.k.n);d=p.get_trans_view(b.xa.k.n);w(l,c,d);break;case 4:l=p.get_trans_view(a.k.n);c=p.get_quat_view(a.k.n);d=b.target;w(l,c,d);break;case 5:l=p.get_trans_view(a.k.n);c=p.get_quat_view(a.k.n);d=p.get_trans_view(b.xa.k.n);w(l,c,d);c=E.dist(l,d);if(c=c>b.dist_max?c-b.dist_max:c<b.vo?c-b.vo:0)E.sub(d,l,x),E.normalize(x,x),E.scale(x,c,x),E.add(l,x,l);break;case 6:l=p.get_trans_view(a.k.n);c=p.get_quat_view(a.k.n);d=b.target;w(l,c,d);c=E.dist(l,d);if(c=c>b.dist_max?c-b.dist_max:c<b.vo?
c-b.vo:0)E.sub(d,l,x),E.normalize(x,x),E.scale(x,c,x),E.add(l,x,l);break;case 7:e=b.xa.k.n;l=p.get_trans_view(a.k.n);p.transform_vec3(b.offset,e,l);break;case 8:g=p.get_trans_view(b.xa.k.n);l=p.get_trans_view(a.k.n);E.add(g,b.offset,l);break;case 14:c=p.get_quat_view(a.k.n);e=b.xa.k.n;d=p.get_quat_view(b.xa.k.n);b.Md?(m.copy(b.Md,c),m.multiply(d,c,c)):m.copy(d,c);l=p.get_trans_view(a.k.n);p.transform_vec3(b.offset,e,l);break;case 11:p.multiply(b.xa.k.n,b.wt,a.k.n);break;case 12:l=b.wt;d=h;n.get_bone_tsr(b.xa,
b.Zj,!0,!1,d);p.multiply(b.xa.k.n,d,d);p.multiply(d,l,a.k.n);break;case 15:c=b.xa,d=r.NL(c),l=p.get_trans_view(a.k.n),e=r.cm(d,"LEFT"),g=r.cm(d,"RIGHT"),N=r.cm(d,"TOP"),O=r.cm(d,"BOTTOM"),G="heights"==b.hor_units?N-O:g-e,b.VB?(e=r.cm(d,"LEFT"),l[0]=e+G*b.ew):(g=r.cm(d,"RIGHT"),l[0]=g-G*b.ew),e="heights"==b.vert_units?N-O:g-e,l[1]=b.eE?N-e*b.Qx:O+e*b.Qx,r.EM(d)?l[2]=-b.distance:(l[2]=-1,E.normalize(l,l),E.scale(l,b.distance/Math.abs(l[2]),l)),p.transform_dir_vec3(l,c.k.n,l),d=p.get_trans_view(c.k.n),
E.add(d,l,l),l=p.get_quat_view(a.k.n),c=p.get_quat_view(c.k.n),b.Md?(m.copy(b.Md,l),m.multiply(c,l,l)):m.copy(c,l)}"CAMERA"==a.k.type&&(l=a.k.Ie,10==b.type&&(d=p.get_quat_view(b.xa.k.n),l=E.transformQuat(l,d,C)),r.cy(a),f(a,l))}function l(a,b){switch(b.type){case 1:var d=b.target.k.n,c=h;p.invert(a.k.n,c);p.multiply(c,d,c);n.set_bone_tsr(a,b.Zj,c,!1)}a.Ew=!0}function w(a,b,h){var d=x;y.quat_to_dir(b,y.AXIS_MZ,d);E.normalize(d,d);var c=I;E.subtract(h,a,c);E.normalize(c,c);a=y.jx(d,c,G);m.multiply(a,
b,b);m.normalize(b,b)}function f(a,b,h){var d=a.k,c=p.get_quat_view(d.n),f=y.quat_to_dir(c,y.AXIS_Z,x);E.normalize(f,f);if(.999999<Math.abs(E.dot(b,f)))f=m.identity(A);else{var e=E.cross(b,f,I);E.normalize(e,e);d.hb==r.MS_TARGET_CONTROLS?d.xj&&E.negate(e,e):(d=y.quat_to_dir(c,y.AXIS_MY,B),0<E.dot(d,b)&&E.negate(e,e));d=y.quat_to_dir(c,y.AXIS_X,B);E.normalize(d,d);var t=y.clamp(E.dot(d,e),-1,1),f=-.999999>=t?m.setAxisAngle(f,Math.acos(t),A):m.rotationTo(d,e,A);m.normalize(f,f)}m.multiply(f,c,c);h&&
(h=y.quat_to_dir(c,y.AXIS_Y,x),0>E.dot(b,h)&&m.rotateZ(c,Math.PI,c));r.cy(a)}var n=q("__armature"),r=q("__camera"),v=q("__mat3"),c=q("__print"),m=q("__quat"),p=q("__tsr"),y=q("__util"),E=q("__vec3");a.sR=1;a.rR=2;a.wR=3;a.xR=4;a.mR=5;a.nR=6;a.tR=7;a.lR=8;a.qR=9;a.pR=10;a.jR=11;a.kR=12;a.oR=13;a.uR=14;a.vR=15;a.iR=1;var u=new Float32Array(2),z=new Float32Array(2),x=new Float32Array(3),I=new Float32Array(3),B=new Float32Array(3),G=new Float32Array(4),A=new Float32Array(4),J=new Float32Array(9),t=new Float32Array(9),
h=p.create(),C=new Float32Array(3);a.$y=function(a,b,h,c,m){var p=e(1);p.xa=b;p.offset=new Float32Array(h);p.Md=c?new Float32Array(c):null;p.Dp=m;d(a,p);g(a,p,0)};a.zH=function(a,b,h,c,m,p){var f=e(2);f.xa=b;f.Zj=h;f.offset=new Float32Array(c);f.Md=m?new Float32Array(m):null;f.Dp=p;d(a,f);g(a,f,0)};a.xH=function(a,b,h,c){var f=e(9),t=p.get_quat_view(a.k.n),n=p.get_quat_view(b.k.n);f.xa=b;f.offset=new Float32Array(h);f.Wk=new Float32Array(n);c&&(m.copy(c,t),m.multiply(n,t,t));d(a,f);g(a,f,0)};a.wH=
function(a,b,h,c,f,t,n,l){var v=e(10),O=p.get_quat_view(a.k.n),r=p.get_quat_view(b.k.n);v.xa=b;v.offset=new Float32Array(h);v.Wk=new Float32Array(r);v.SI=y.angle_wrap_0_2pi(f);v.TI=y.angle_wrap_0_2pi(t);v.UI=y.angle_wrap_periodic(n,-Math.PI,Math.PI);v.RI=y.angle_wrap_periodic(l,-Math.PI,Math.PI);c?(v.Md=new Float32Array(c),m.copy(c,O),m.multiply(r,O,O)):v.Md=m.create();d(a,v);g(a,v,0)};a.vH=function(a,b,h,c){var m=e(13);m.xa=b;m.offset=new Float32Array(h);m.rP=c;d(a,m);g(a,m,0)};a.CH=function(a,b,
h,c){var m=e(14);m.xa=b;m.offset=new Float32Array(h);m.Dp=1;m.Md=c?new Float32Array(c):null;d(a,m);g(a,m,0)};a.uT=b;a.FH=function(a,b){var h=e(3);h.xa=b;d(a,h);g(a,h,0)};a.GH=function(a,b){var h=e(4);h.target=new Float32Array(b);d(a,h);g(a,h,0)};a.rH=function(a,b,h,c){var m=e(5);m.xa=b;m.vo=h;m.dist_max=c;d(a,m);g(a,m,0)};a.sH=function(a,b,h,c){var m=e(6);m.target=new Float32Array(b);m.vo=h;m.dist_max=c;d(a,m);g(a,m,0)};a.BH=function(a,b,h){var c=e(7);c.xa=b;c.offset=new Float32Array(h);d(a,c);g(a,
c,0)};a.oH=function(a,b,h){var c=e(8);c.xa=b;c.offset=new Float32Array(h);d(a,c);g(a,c,0)};a.mH=function(a,b,h){var c=e(11);c.xa=b;c.wt=new Float32Array(h);d(a,c);g(a,c,0)};a.nH=function(a,b,h,c){var m=e(12);m.xa=b;m.Zj=h;m.wt=new Float32Array(c);d(a,m);g(a,m,0)};a.append_stiff_viewport=function(a,b,h){var m=e(15);m.xa=b;if(y.yf(h.left))m.VB=!0,m.ew=h.left;else if(y.yf(h.right))m.VB=!1,m.ew=h.right;else{c.error("append_stiff_viewport: Wrong positioning params");return}if(y.yf(h.top))m.eE=!0,m.Qx=
h.top;else if(y.yf(h.bottom))m.eE=!1,m.Qx=h.bottom;else{c.error("append_stiff_viewport: Wrong positioning params");return}y.yf(h.distance)?(m.distance=h.distance,m.Md=y.yf(h.rotation)?new Float32Array(h.rotation):null,m.hor_units=y.yf(h.hor_units)?h.hor_units:"widths",m.vert_units=y.yf(h.vert_units)?h.vert_units:"heights",d(a,m),g(a,m,0)):c.error("append_stiff_viewport: Wrong positioning params")};a.oQ=function(a,b){a.Tb&&g(a,a.Tb,b)};a.AH=function(a,b,h,c,d){var m=e(1);m.Zj=h;m.target=b;m.offset=
new Float32Array(c);m.Md=d?new Float32Array(d):null;m.Dp=1;b=m.target;h=m.Zj;c=a.k.qe[h];d=b.Pu;for(var p=0;p<d;p++){var f=d[p];if(f[0]==a&&f[1]==h){d.splice(p,1);break}}b.Pu.push([a,h]);c.Tb=m;l(a,m)};a.iQ=function(a,b){var h=a.k.qe[b];h.Tb&&l(a,h.Tb)};a.wO=w;a.correct_up=f;a.HI=function(a){return a.Tb?!0:!1};a.remove=function(a){a.Tb.xa&&b(a.Tb.xa,a);a.Tb=null};a.NS=function(a){return a.Tb?a.Tb.type:null};a.wf=function(a){a=a.Tb;return!a||11!=a.type&&12!=a.type?!1:!0};a.Cr=function(a){if((a=a.Tb)&&
11==a.type)return a.xa.k.n;if(a&&12==a.type){var b=h;n.get_bone_tsr(a.xa,a.Zj,!0,!1,b);p.multiply(a.xa.k.n,b,b);return b}return null};a.vf=function(a){a=a.Tb;return!a||11!=a.type&&12!=a.type?null:a.wt}};b4w.module.__container=function(a,q){var e,d,b,g,l;function w(a,b){e=a;d=b}function f(){var a=J.getBoundingClientRect();w(a.left,a.top)}function n(){return B.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function r(b,c,d){if(!b||!c){b=a.Wt;c=a.Vt;var f=h;f.style.width=a.Wt+"px";f.style.height=a.Vt+"px"}var f=J,e=t;!1!==d&&(f.style.width=b+"px",f.style.height=c+"px",e&&(e.style.width=b+"px",e.style.height=c+"px"));e&&(e.width=b,e.height=c,p.Wp());d=Math.floor(b*B.canvas_resolution_factor);c=Math.floor(c*
B.canvas_resolution_factor);n()&&(d*=window.devicePixelRatio,c*=window.devicePixelRatio);if(e=u.Ak())e=e.q,d=Math.floor(d*e.Jm),c=Math.floor(c*e.Jm);f.width=d;f.height=c;var e=Math.min(A.drawingBufferWidth,G.mw,G.rw[0]),l=Math.min(A.drawingBufferHeight,G.mw,G.rw[1]);if(d>e||c>l)E.warn("Canvas size exceeds platform limits, downscaling"),e=Math.min(e/d,l/c),d*=e,c*=e,f.width=d,f.height=c;u.iD(d,c,d/b);u.va()&&x.B(u.get_active().ri);m.sQ(f.width,f.height);m.is_primary_loaded()&&(v.update(),u.update(z.get_timeline(),
0),v.uE())}var v=q("__anchors"),c=q("__config"),m=q("__data"),p=q("__hud"),y=q("__input"),E=q("__print"),u=q("__scenes"),z=q("__time"),x=q("__transform"),I=q("__util"),B=c.A,G=c.zh,A=null,J=null,t=null,h=null,C=!1;g=b=0;l=1;e=d=0;a.Wt=320;a.Vt=240;a.jf=function(a){A=a};a.get_canvas=function(){return J};a.get_canvas_hud=function(){return t};a.get_container=function(){return h};a.init=function(a,b){a&&a.parentNode?(J=a,t=b,h=a.parentNode):I.r("canvas container is not available")};a.insert_to_container=
function(a,b){b=b||"LAST";switch(b){case "FIRST":h.insertBefore(a,h.firstElementChild);break;case "JUST_BEFORE_CANVAS":h.insertBefore(a,J);break;case "JUST_AFTER_CANVAS":J.nextElementSibling?h.insertBefore(a,J.nextElementSibling):h.appendChild(a,J);break;case "LAST":h.appendChild(a,J);break;default:E.error(b+" invalid stack order")}};a.pB=function(){return b};a.oB=function(){return g};a.set_canvas_offsets=w;a.update_canvas_offsets=f;a.iP=function(a,h,c){b=a;g=h;l=c;f()};a.force_offsets_updating=function(){C=
!0};a.client_to_canvas_coords=function(a,b,h){h||(h=new Float32Array(2));var c=h;C&&(f(),C=!1);c[0]=a-e;a=h;C&&(f(),C=!1);a[1]=b-d;return h};a.Uq=function(a,h,c,d){c||(c=new Float32Array(2));c[0]=a*l;c[1]=h*l;d&&(a=d.width/b,c[0]*=a,c[1]*=a);return c};a.XQ=function(a,h,c,d){c||(c=new Float32Array(2));c[0]=a/l;c[1]=h/l;d&&(a=d.width/b,c[0]/=a,c[1]/=a)};a.EB=function(b){return b&&b.parentNode?b.parentNode==h?!0:a.EB(b.parentNode):!1};a.AM=n;a.aL=function(a){var b=document.getElementsByTagName("script");
a=I.ip(a);for(var h=0;h<b.length;h++)if(b[h].src==a)return b[h];return null};a.resize=r;a.resize_to_container=function(a){var b=h,c=J,d=b.clientWidth,b=b.clientHeight;if(a||d!=c.clientWidth||b!=c.clientHeight)(a="HMD"===B.stereo&&y.qB())&&a.isPresenting||r(d,b,!0)};a.reset=function(){h=t=J=A=null}};b4w.module.__controls=function(a,q){function e(a,b){b||(b=m.get_container());return{type:a,value:0,R:null,element:b,Ea:!1,key:0,Kb:"",Fg:!1,Nu:null,Mu:function(){},Lu:null,Yz:function(){},dh:null,from:new Float32Array(3),to:new Float32Array(3),CB:!1,Vr:!1,yp:0,LC:function(){},axis:"",mf:0,en:new Float32Array(3),Ss:new Float32Array(4),threshold:0,IC:new Float32Array(4),Lq:0,Kq:0,TC:0,Mq:0,gf:0,repeat:!1,BA:!1,xk:0,callback:function(){}}}function d(a){function b(){return{Di:new Float32Array(2),Lk:!0,
obj:null,identifier:-1,ds:!0}}a||(a=m.get_container());for(var h=0;h<F.length;h++){var c=F[h];if(a==c.element)return c}c={element:a,nm:!0,Jk:!1,es:!0,vw:0,ww:0,um:0,vm:0,rp:0,sp:0,sg:new Float32Array(2),Od:new Float32Array(2),tg:new Float32Array(2),ge:new Float32Array(2),tt:0,Yx:0,fE:0,Gd:new Uint8Array(256),Ot:0,Lv:null,Vg:b(),il:Array(10),Zv:!1,tB:z.create(),Nr:0,Mr:0,Lr:0,Ov:0,Nv:0,Kr:Infinity,Jw:null,Iw:null,Aw:null,uw:null,yw:null,Wx:null,Vx:null,zw:null,xw:null,Sw:null,eT:null,Xx:null,Ux:null,
Tx:null,Xh:{}};for(h=0;10>h;++h)c.il[h]=b();c.Jw=function(a){c.Zv||(p.kM(a,c.tB),c.Zv=!0)};c.Iw=function(a){a=G.copy(a,M);c.Lr=a[0];c.Mr=a[1];c.Nr=a[2];Infinity==c.Kr&&(c.Kr=a[0],c.Nv=a[1],c.Ov=a[2])};c.Aw=function(a){c.Ot+=a*A.xN};c.uw=function(a){var b=p.get_device_by_type_element(p.DEVICE_MOUSE,c.element),b=p.get_vector_param(b,p.MOUSE_LOCATION,D);c.vw=b[0];c.ww=b[1];c.um=b[0];c.vm=b[1];c.Jk=!0;c.which=a};c.yw=function(){var a=p.get_device_by_type_element(p.DEVICE_MOUSE,c.element),a=p.get_vector_param(a,
p.MOUSE_LOCATION,D),a=m.client_to_canvas_coords(a[0],a[1],D);c.Vg.Lk=!1;c.Vg.Di[0]=a[0];c.Vg.Di[1]=a[1]};c.Wx=function(a){for(var b=0;b<a.length;++b){for(var h=a[b],d=null,k=null,f=0;f<c.il.length;f++){var p=c.il[f];if(p.identifier==h.identifier){p.ds&&(k=p);break}else!d&&p.ds&&(d=p,d.identifier=h.identifier)}if(h=k||d)d=m.client_to_canvas_coords(a[b].clientX,a[b].clientY,D),h.Lk=!1,h.ds=!1,h.Di[0]=d[0],h.Di[1]=d[1]}};c.Vx=function(a){for(var b=0;b<c.il.length;++b){for(var h=c.il[b],d=!1,m=0;m<a.length;++m)if(a[m].identifier==
h.identifier){d=!0;break}d||(h.Lk=!0,h.ds=!0,h.obj=null)}};c.zw=function(){c.Jk=!1};c.xw=function(a){if(!J.em||c.Jk)c.um=a[0],c.vm=a[1]};c.Sw=function(a){if(!J.em||c.Jk)c.rp+=a[0],c.sp+=a[1]};c.OB=function(a){2!=c.Gd[a]&&(c.Gd[a]=1,c.nm=!1)};c.QB=function(){for(var a=0;a<c.Gd.length;a++)0!=c.Gd[a]&&(c.Gd[a]=3,c.nm=!1)};c.RB=function(a){1==c.Gd[a]?c.Gd[a]=0:(c.nm&=0,c.Gd[a]=3)};c.Xx=function(a){c.es=!1;if(1==a.length)c.sg[0]=a[0].clientX,c.sg[1]=-1,c.tg[0]=a[0].clientY,c.tg[1]=-1;else if(1<a.length){c.tt=
c.Yx=r(a);c.sg[0]=a[0].clientX;c.sg[1]=a[1].clientX;c.tg[0]=a[0].clientY;c.tg[1]=a[1].clientY;var b=a[0];a=a[1];c.fE=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}c.Od.set(c.sg);c.ge.set(c.tg)};c.Ux=function(a){1===a.length?(c.Od[0]=a[0].clientX,c.Od[1]=-1,c.ge[0]=a[0].clientY,c.ge[1]=-1):1<a.length&&(c.Od[0]=a[0].clientX,c.Od[1]=a[1].clientX,c.ge[0]=a[0].clientY,c.ge[1]=a[1].clientY,c.tt=r(a))};c.Tx=function(a){0==a.length&&(c.es=!0)};F.push(c);return c}function b(a,b){if(b in a.Xh&&0<a.Xh[b])a.Xh[b]+=
1;else switch(a.Xh[b]=1,b){case "orientation_quat":var c=p.get_device_by_type_element(p.DEVICE_GYRO);c&&p.attach_param_cb(c,p.GYRO_ORIENTATION_ANGLES,a.Jw);break;case "orientation_angles":(c=p.get_device_by_type_element(p.DEVICE_GYRO))&&p.attach_param_cb(c,p.GYRO_ORIENTATION_ANGLES,a.Iw);break;case "mouse_wheel":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_WHEEL,a.Aw);break;case "mouse_down_which":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&
p.attach_param_cb(c,p.MOUSE_DOWN_WHICH,a.uw);break;case "mouse_select":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_DOWN_WHICH,a.yw);break;case "touch_select":if(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))p.attach_param_cb(c,p.TOUCH_START,a.Wx),p.attach_param_cb(c,p.TOUCH_END,a.Vx);break;case "mouse_up_which":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_UP_WHICH,a.zw);break;case "mouse_location":(c=
p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.MOUSE_LOCATION,a.xw);break;case "mouse_pointerlock":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.attach_param_cb(c,p.Cy,a.Sw);break;case "keyboard_downed_keys":if(c=p.get_device_by_type_element(p.DEVICE_KEYBOARD,a.element))p.attach_param_cb(c,p.KEYBOARD_DOWN,a.OB),p.attach_param_cb(c,p.By,a.QB),p.attach_param_cb(c,p.KEYBOARD_UP,a.RB);break;case "touch_start":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,
a.element))&&p.attach_param_cb(c,p.TOUCH_START,a.Xx);break;case "touch_move":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.attach_param_cb(c,p.TOUCH_MOVE,a.Ux);break;case "touch_end":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.attach_param_cb(c,p.TOUCH_END,a.Tx)}}function g(a,b){if(!(!b in a.Xh)&&0<a.Xh[b]&&(--a.Xh[b],!a.Xh[b]))switch(b){case "orientation_quat":var c=p.get_device_by_type_element(p.DEVICE_GYRO);c&&p.detach_param_cb(c,p.GYRO_ORIENTATION_QUAT,a.Jw);
break;case "orientation_angles":(c=p.get_device_by_type_element(p.DEVICE_GYRO))&&p.detach_param_cb(c,p.GYRO_ORIENTATION_ANGLES,a.Iw);break;case "mouse_wheel":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_WHEEL,a.Aw);break;case "mouse_down_which":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_DOWN_WHICH,a.uw);break;case "mouse_select":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_DOWN_WHICH,
a.yw);break;case "touch_select":if(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))p.detach_param_cb(c,p.TOUCH_START,a.Wx),p.detach_param_cb(c,p.TOUCH_END,a.Vx);break;case "mouse_up_which":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_UP_WHICH,a.zw);break;case "mouse_location":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,a.element))&&p.detach_param_cb(c,p.MOUSE_LOCATION,a.xw);break;case "mouse_pointerlock":(c=p.get_device_by_type_element(p.DEVICE_MOUSE,
a.element))&&p.detach_param_cb(c,p.Cy,a.Sw);break;case "keyboard_downed_keys":if(c=p.get_device_by_type_element(p.DEVICE_KEYBOARD,a.element))p.detach_param_cb(c,p.KEYBOARD_DOWN,a.OB),p.detach_param_cb(c,p.By,a.QB),p.detach_param_cb(c,p.KEYBOARD_UP,a.RB);break;case "touch_start":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.detach_param_cb(c,p.TOUCH_START,a.Xx);break;case "touch_move":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.detach_param_cb(c,p.TOUCH_MOVE,a.Ux);
break;case "touch_end":(c=p.get_device_by_type_element(p.DEVICE_TOUCH,a.element))&&p.detach_param_cb(c,p.TOUCH_END,a.Tx)}}function l(a,b){a.value=Number(b)}function w(a){for(var b=a.pj,c=a.DO,h=0;h<b.length;h++)c[h]=b[h].value;return a.iN(c)}function f(a,b){a=a||h;var c=a.qg;if(c){var d=a.bl;if(b){var m=c[b];if(m){for(var p=m.pj,e=0;e<p.length;e++){var l=p[e],v;v=C.indexOf(l);v=-1<v?k[v]:[];1==v.length?(n(l),l=C.indexOf(l),-1<l?(C.splice(l,1),k.splice(l,1)):B.r("Sensors cache is corrupted")):1<v.length&&
v.splice(v.indexOf(m),1)}delete c[b];e=d.indexOf(m);-1<e?d.splice(e,1):B.r("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=t.indexOf(a),-1<c?t.splice(c,1):E.error("Wrong object"))}}else{d=[];for(b in c)d.push(b);for(e=0;e<d.length;e++)f(a,d[e])}T=!0}}function n(a){switch(a.type){case 90:u.remove_collision_test(a.Nu,a.Kb,a.Mu);a.Ea=!0;break;case 100:u.clear_collision_impulse_test(a.Lu);a.Ea=!0;break;case 110:u.remove_ray_test(a.yp);a.Ea=!0;break;case 140:a.Ea=!0;break;case 20:var b=
d(a.element);g(b,"keyboard_downed_keys");a.Ea=!0;break;case 30:b=d(a.element);g(b,"mouse_wheel");a.Ea=!0;break;case 40:b=d(a.element);g(b,"mouse_down_which");g(b,"mouse_up_which");g(b,"mouse_location");a.Ea=!0;break;case 260:b=d(a.element);g(b,"mouse_pointerlock");a.Ea=!0;break;case 50:b=d(a.element);g(b,"mouse_down_which");g(b,"mouse_up_which");a.Ea=!0;break;case 60:b=d(a.element);g(b,"touch_start");g(b,"touch_move");g(b,"touch_end");a.Ea=!0;break;case 70:b=d(a.element);g(b,"touch_start");g(b,"touch_move");
a.Ea=!0;break;case 75:b=d(a.element);g(b,"touch_start");g(b,"touch_move");a.Ea=!0;break;case 80:b=d(a.element);g(b,"touch_start");g(b,"touch_end");a.Ea=!0;break;case 170:b=d(a.element);g(b,"mouse_select");g(b,"touch_select");g(b,"touch_start");g(b,"touch_end");g(b,"mouse_down_which");g(b,"mouse_up_which");a.Ea=!0;break;case 180:case 190:b=d(a.element);g(b,"orientation_angles");a.Ea=!0;break;case 200:b=d(a.element);g(b,"orientation_quat");a.Ea=!0;break;case 210:case 220:a.Ea=!0}}function r(a){var b=
a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function v(a){return 0==a?p.get_device_by_type_element(p.oq):1==a?p.get_device_by_type_element(p.Xt):2==a?p.get_device_by_type_element(p.Yt):p.get_device_by_type_element(p.Zt)}var c=q("__config"),m=q("__container"),p=q("__input"),y=q("__objects"),E=q("__print"),u=q("__physics"),z=q("__quat"),x=q("__time"),I=q("__tsr"),B=q("__util"),G=q("__vec3"),A=c.controls,J=c.A,t=[],h={},C=[],k=[],F=[],D=new Float32Array(2),aa=new Float32Array(2),
M=G.create(),L=z.create(),T=!1,N=0;a.CT_POSITIVE=10;a.CT_CONTINUOUS=20;a.CT_TRIGGER=30;a.CT_SHOT=40;a.CT_LEVEL=50;a.CT_CHANGE=60;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.PL_MULTITOUCH_MOVE_ROTATE=3;var U=1;a.update=function(b,c){for(var m=0;m<F.length;m++){var k=F[m];k.Vg.Lk||(k.Vg.obj=y.pick_object(k.Vg.Di[0],k.Vg.Di[1]),k.Vg.Lk=!0,k.Lv=k.Vg.obj);for(var f=0;10>f;++f){var e=k.il[f];e.Lk||(e.obj=y.pick_object(e.Di[0],e.Di[1]),e.Lk=!0,k.Lv=e.obj)}}for(m=0;m<
C.length;m++)if(k=C[m],e=b,f=c)switch(k.type){case 120:var H=k.dh,n=I.Ub(H.k.n,M),H=I.zd(H.k.n,L),g=G.dist(k.en,n),r=k.IC;z.invert(k.Ss,r);z.multiply(H,r,r);z.normalize(r,r);r=Math.abs(2*Math.acos(r[3]));g/=f;k.Lq=B.smooth(g,k.Lq,f,.3);k.R[0]=g;g=r/f;k.Kq=B.smooth(g,k.Kq,f,.3);k.R[1]=g;k.Lq>=k.threshold||k.Kq>=k.TC?l(k,1):l(k,0);G.copy(n,k.en);z.copy(H,k.Ss);k.mf=e;break;case 130:H=k.dh;n=I.Ub(H.k.n,M);H=Math.abs(n[1]-k.en[1])/f;k.Mq=B.smooth(H,k.Mq,f,.3);k.R=H;k.Mq>=k.threshold?l(k,1):l(k,0);G.copy(n,
k.en);k.mf=e;break;case 140:!k.Ea&&0<=k.gf&&e-k.mf>=k.gf&&(l(k,1),k.repeat?k.mf=e:k.gf=-k.gf);break;case 150:k.mf||(k.mf=e);l(k,e-k.mf);k.mf=e;break;case 160:l(k,e);break;case 180:e=d(k.element);k.R[0]=e.Nr-e.Ov;k.R[1]=e.Mr-e.Nv;k.R[2]=e.Lr-e.Kr;break;case 190:e=d(k.element);k.R[0]=e.Nr;k.R[1]=e.Mr;k.R[2]=e.Lr;break;case 200:e=d(k.element);z.copy(e.tB,k.R);break;case 210:f=p.get_device_by_type_element(p.DEVICE_HMD);p.get_vector_param(f,p.HMD_ORIENTATION_QUAT,k.R);break;case 220:f=p.get_device_by_type_element(p.DEVICE_HMD);
p.get_vector_param(f,p.HMD_POSITION,k.R);break;case 240:f=v(k.xk);k.value=p.VL(f,k.key);break;case 250:f=v(k.xk);k.value=p.UL(f,k.key);break;case 230:l(k,k.callback());break;case 30:e=d(k.element);l(k,e.Ot);break;case 40:e=d(k.element);if(!J.em||e.Jk)switch(n=e.um-e.vw,H=e.vm-e.ww,k.R.coords[0]=e.um,k.R.coords[1]=e.vm,k.axis){case "X":l(k,n);break;case "Y":l(k,H);break;case "XY":f=Math.sqrt(n*n+H*H),l(k,f)}break;case 260:e=d(k.element);J.em||(n=e.rp,H=e.sp,g=B.smooth(n,0,f,.1*U),f=B.smooth(H,0,f,
.1*U),.01<Math.abs(n)||.01<Math.abs(H)?(e.rp-=g,e.sp-=f,k.R.coords[0]=g,k.R.coords[1]=f):(k.R.coords[0]=0,k.R.coords[1]=0),l(k,Math.sqrt(n*n+H*H)));break;case 50:e=d(k.element);l(k,e.Jk);k.R.which=e.which;k.R.coords[0]=e.um;k.R.coords[1]=e.vm;break;case 170:e=d(k.element);l(k,0);if(k.BA)e.Lv==k.dh&&l(k,1);else if(e.Jk&&e.Vg.obj==k.dh)l(k,1);else if(!e.es)for(f=0;10>f;++f)if(e.il[f].obj==k.dh){l(k,1);break}break;case 20:e=d(k.element);k.R=e.Gd[k.key];1==k.R||e.Gd[0]&&16==k.key?l(k,1):k.R&&3!=k.R||
l(k,0);break;case 60:e=d(k.element);if(-1==e.Od[1]&&-1==e.ge[1]){n=e.Od[0]-e.sg[0];H=e.ge[0]-e.tg[0];f=Math.sqrt(n*n+H*H);if(-1!=e.sg[1]&&-1!=e.tg[1]){var g=e.Od[0]-e.sg[1],r=e.ge[0]-e.tg[1],u=Math.sqrt(g*g+r*r);u<f&&(n=g,H=r,f=u)}k.R.gesture=a.PL_SINGLE_TOUCH_MOVE}else f=D,f[0]=(e.Od[0]+e.Od[1])/2,f[1]=(e.ge[0]+e.ge[1])/2,H=aa,H[0]=(e.sg[0]+e.sg[1])/2,H[1]=(e.tg[0]+e.tg[1])/2,n=f[0]-H[0],H=f[1]-H[1],f=Math.sqrt(n*n+H*H),k.R.gesture=a.PL_MULTITOUCH_MOVE_PAN;k.R.coords[0]=e.Od[0];k.R.coords[1]=e.ge[0];
switch(k.axis){case "X":l(k,n);break;case "Y":l(k,H);break;case "XY":l(k,f)}break;case 70:e=d(k.element);f=e.tt-e.Yx;k.R=a.PL_MULTITOUCH_MOVE_ZOOM;l(k,f);break;case 75:e=d(k.element);-1!=e.Od[1]&&(f=Math.atan2(e.ge[0]-e.ge[1],e.Od[0]-e.Od[1]),k.R=a.PL_MULTITOUCH_MOVE_ROTATE,l(k,f-e.fE));break;case 80:e=d(k.element),k.R.coords[0]=e.Od[0],k.R.coords[1]=e.ge[0],e.es?l(k,0):l(k,1)}for(m=0;m<t.length;m++)for(e=t[m],k=e.bl,f=0;f<k.length;f++)if(n=k[f],n.Bj!=N){n.Bj=N;r=n;H=0;switch(r.type){case a.CT_POSITIVE:H=
(g=w(r))?1:0;break;case a.CT_CONTINUOUS:H=r.Lh;(g=w(r))?(H=1,r.Lh=1):1==H?(H=-1,r.Lh=-1):H=0;break;case a.CT_TRIGGER:H=r.Lh;(g=w(r))&&-1==H?(H=1,r.Lh=1):g||1!=H?H=0:(H=-1,r.Lh=-1);break;case a.CT_SHOT:H=r.Lh;(g=w(r))&&-1==H?(H=1,r.Lh=1):g||1!=H?H=0:(H=0,r.Lh=-1);break;case a.CT_LEVEL:g=w(r);r.UB!=g?(H=1,r.UB=g):H=0;break;case a.CT_CHANGE:g=r.pj;r=r.MM;for(u=0;u<g.length;u++){var A=g[u].value;H||A==r[u]||(H=1);r[u]=A}break;default:B.r("Wrong sensor manifold type: "+r.type)}if(H&&(g=e==h?null:e,T=!1,
n.callback(g,n.id,H,n.vI),T)){m=-1;break}}for(m=0;m<t.length;m++)for(e=t[m],k=e.bl,f=0;f<k.length;f++)for(n=k[f],e=n.pj,n=0;n<e.length;n++)switch(H=e[n],H.type){case 30:l(H,0);break;case 40:l(H,0);break;case 60:l(H,0);break;case 70:l(H,0);break;case 75:l(H,0);break;case 80:l(H,0);break;case 140:l(H,0)}for(m=0;m<F.length;m++){k=F[m];if(!k.nm){for(f=0;f<k.Gd.length;f++)1==k.Gd[f]?k.Gd[f]=2:3==k.Gd[f]&&(k.Gd[f]=0);k.nm=!0}k.Ot=0;k.vw=k.um;k.ww=k.vm;k.Gd[0]=!1;k.sg.set(k.Od);k.tg.set(k.ge);k.Yx=k.tt;
k.Ov=k.Nr;k.Nv=k.Mr;k.Kr=k.Lr;k.Zv=!1}N++};a.create_custom_sensor=function(a){var b=e(10);l(b,a);return b};a.create_keyboard_sensor=function(a){var b=e(20,document);b.key=a;b.Ea=!0;return b};a.create_gamepad_btn_sensor=function(a,b){var c=e(240,document);b=b||p.eB();c.xk=b;c.key=a;c.Ea=!0;return c};a.create_gamepad_axis_sensor=function(a,b){var c=e(250,document);b=void 0==b?p.eB():b;c.xk=b;c.key=a;c.Ea=!0;return c};a.create_collision_sensor=function(a,b,c){if(!a||!u.ka(a))return E.error("Wrong collision object"),
null;var h=e(90);h.Nu=a;h.Kb=b;h.Fg=c;h.R={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};h.Mu=function(a,b,c,d,k){l(h,a);a=h.R;a.coll_obj=b;h.Fg&&(a.coll_pos.set(c),a.coll_norm.set(d),a.coll_dist=k)};h.Ea=!0;return h};a.create_collision_impulse_sensor=function(a){if(!a||!a.C)return E.error("Wrong collision impulse object"),null;var b=e(100);b.Lu=a;b.Yz=function(a){l(b,a)};b.Ea=!0;return b};a.create_ray_sensor=function(a,b,c,h,d,k,m){var f=e(110);
f.dh=a;f.from=b;f.to=c;f.Kb=h;f.CB=d;f.Fg=k;f.Vr=m;f.R={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),yp:0};f.LC=function(a,b,c,h,d,k){f.CB?l(f,-1==b?0:1):l(f,b);f.R.hit_fract=b;f.R.obj_hit=c;f.R.hit_time=h;f.Fg&&(f.R.hit_pos.set(d),f.R.hit_norm.set(k))};f.Ea=!0;return f};a.create_mouse_click_sensor=function(a){a=e(50,a);a.Ea=!0;a.R={coords:new Float32Array(2),which:null};return a};a.create_mouse_wheel_sensor=function(a){a=e(30,a);a.Ea=!0;return a};a.create_mouse_move_sensor=
function(a,b){var c=e(40,b);c.axis=a||"XY";c.R={coords:new Float32Array(2)};c.Ea=!0;return c};a.create_touch_move_sensor=function(a,b){var c=e(60,b);c.axis=a||"XY";c.R={coords:new Float32Array(2),gesture:0};c.Ea=!0;return c};a.create_touch_zoom_sensor=function(a){a=e(70,a);a.R=0;a.Ea=!0;return a};a.create_touch_rotate_sensor=function(a){a=e(75,a);a.R=0;a.Ea=!0;return a};a.create_touch_click_sensor=function(a){a=e(80,a);a.R={coords:new Float32Array(2)};a.Ea=!0;return a};a.create_motion_sensor=function(a,
b,c){if(!a)return E.error("Wrong collision object"),null;var h=e(120);h.dh=a;var d=I.get_trans_view(a.k.n);a=I.get_quat_view(a.k.n);h.IC=new Float32Array(4);h.en=new Float32Array(d);h.Ss=new Float32Array(a);h.Lq=0;h.Kq=0;h.threshold=b||.1;h.TC=c||.1;h.mf=0;h.R=new Float32Array([0,0]);return h};a.create_vertical_velocity_sensor=function(a,b){if(!a)return E.error("Wrong collision object"),null;var c=e(130);c.dh=a;var h=I.get_trans_view(a.k.n),d=I.get_quat_view(a.k.n);c.en=new Float32Array(h);c.Ss=new Float32Array(d);
c.Mq=0;c.threshold=b||1;c.mf=0;c.R=0;return c};a.create_timer_sensor=function(a,b){var c=e(140);c.gf=a;c.repeat=b;c.Ea=!0;return c};a.reset_timer_sensor=function(a,b,c,d){a=a||h;a=a.qg;if(!a||!a[b])return E.error("reset_timer_sensor(): wrong object"),null;b=a[b].pj[c];if(!b)return E.error("reset_timer_sensor(): sensor not found"),null;b.mf=x.get_timeline();b.gf=d};a.create_elapsed_sensor=function(){var a=e(150);a.mf=0;return a};a.create_gyro_delta_sensor=function(){var a=e(180,window);a.R=new Float32Array(3);
p.get_device_by_type_element(p.DEVICE_GYRO)?l(a,1):l(a,0);a.Ea=!0;return a};a.create_gyro_angles_sensor=function(){var a=e(190,window);a.R=new Float32Array(3);p.get_device_by_type_element(p.DEVICE_GYRO)?l(a,1):l(a,0);a.Ea=!0;return a};a.create_gyro_quat_sensor=function(){var a=e(200,window);a.R=z.create();p.get_device_by_type_element(p.DEVICE_GYRO)?l(a,1):l(a,0);a.Ea=!0;return a};a.create_hmd_quat_sensor=function(){var a=e(210,window);a.R=z.create();p.get_device_by_type_element(p.DEVICE_HMD)?l(a,
1):l(a,0);a.Ea=!0;return a};a.create_hmd_position_sensor=function(){var a=e(220,window);a.R=G.create();p.get_device_by_type_element(p.DEVICE_HMD)?l(a,1):l(a,0);a.Ea=!0;return a};a.create_timeline_sensor=function(){return e(160)};a.create_selection_sensor=function(a,b){var c=e(170);c.dh=a;c.BA=b;c.Ea=!0;return c};a.create_callback_sensor=function(a,b){var c=e(230);c.callback=a;l(c,b);return c};a.create_plock_mouse_sensor=function(a){a=e(260,a);a.R={coords:new Float32Array(2)};a.Ea=!0;return a};a.create_plock_sensor=
function(a){a=e(270,a);a.Ea=!0;return a};a.CO=l;a.get_sensor_value=function(a,b,c){a=a||h;a=a.qg;if(!a||!a[b])return E.error("get_sensor_value(): wrong object"),null;b=a[b].pj[c];return b?b.value:(E.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,c){a=a||h;a=a.qg;if(!a||!a[b])return E.error("get_sensor_payload(): wrong object"),null;b=a[b].pj[c];return b?b.R:(E.error("get_sensor_payload(): sensor not found"),null)};a.cleanup=function(){t=[];h={};for(var a=0;a<
C.length;a++)n(C[a]);C.length=0;k.length=0};a.check_sensor_manifold=function(a,b){a=a||h;if(!a.qg)return!1;if(b&&a.qg[b])return!0;if(!b)for(var c in a.qg)return!0;return!1};a.create_sensor_manifold=function(a,c,m,e,n,l,H){a=a||h;a.bl=a.bl||[];a.qg=a.qg||{};var g=a.qg,v=a.bl;g[c]&&f(a,c);m={id:c,type:m,pj:e.slice(0),iN:n,DO:Array(e.length),callback:l,vI:H,Lh:-1,UB:0,MM:Array(e.length),Bj:-1};g[c]=m;v.push(m);-1==t.indexOf(a)&&t.push(a);e=m.pj;for(a=0;a<e.length;a++){g=c=e[a];if(g.Ea){switch(g.type){case 90:u.append_collision_test(g.Nu,
g.Kb,g.Mu,g.Fg);break;case 100:u.apply_collision_impulse_test(g.Lu,g.Yz);break;case 110:g.yp=u.append_ray_test(g.dh,g.from,g.to,g.Kb,g.LC,!1,!1,g.Fg,g.Vr);g.R.yp=g.yp;break;case 140:g.mf=x.get_timeline();0>g.gf&&(g.gf=-g.gf);break;case 20:v=d(g.element);b(v,"keyboard_downed_keys");break;case 30:v=d(g.element);b(v,"mouse_wheel");break;case 40:v=d(g.element);b(v,"mouse_down_which");b(v,"mouse_up_which");b(v,"mouse_location");break;case 260:v=d(g.element);b(v,"mouse_pointerlock");break;case 270:p.gH(g);
break;case 50:v=d(g.element);b(v,"mouse_down_which");b(v,"mouse_up_which");break;case 60:v=d(g.element);b(v,"touch_start");b(v,"touch_move");b(v,"touch_end");break;case 70:v=d(g.element);b(v,"touch_start");b(v,"touch_move");break;case 75:v=d(g.element);b(v,"touch_start");b(v,"touch_move");break;case 80:v=d(g.element);b(v,"touch_start");b(v,"touch_end");break;case 170:v=d(g.element);b(v,"mouse_select");b(v,"touch_select");b(v,"touch_start");b(v,"touch_end");b(v,"mouse_down_which");b(v,"mouse_up_which");
break;case 180:case 190:v=d(g.element);b(v,"orientation_angles");break;case 200:v=d(g.element);b(v,"orientation_quat");break;case 240:0==g.xk?p.get_device_by_type_element(p.oq):1==g.xk?p.get_device_by_type_element(p.Xt):2==g.xk?p.get_device_by_type_element(p.Yt):p.get_device_by_type_element(p.Zt)}g.Ea=!1}g=C.indexOf(c);-1==g?(C.push(c),k.push([m])):k[g].push(m)}T=!0};a.default_AND_logic_fun=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.default_OR_logic_fun=function(a){for(var b=
0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.remove_sensor_manifold=f;a.reset=function(){for(var a=0;a<t.length;a++){var b=t[a],c=b.qg,b=b.bl,h;for(h in c)delete c[h];b.length=0}for(a=0;a<C.length;a++)n(C[a]);t.length=0;C.length=0;k.length=0};a.debug=function(){E.log(String(t.length)+" objects with manifolds",t);E.log(String(C.length)+" sensors",C);for(var a=[],b=[],c=0;c<C.length;c++){var h=C[c];90==h.type&&a.push(h);110==h.type&&b.push(h)}E.log(String(a.length)+" collision sensors",
a);E.log(String(b.length)+" ray sensors",b)};a.set_plock_smooth_factor=function(a){U=a}};b4w.module.__curve=function(a,q){function e(a,b,d,c,m){var f=c.length;m||(m=new Float32Array(f));for(var e=f+a,l=new Float32Array(e),g=1;g<=e-1;g++)l[g-1]=b>=d[g-1]&&b<d[g+1-1]?1:0;for(var z=2;z<=a;z++)for(g=1;g<=e-z;g++)l[g-1]=(0!=l[g-1]?(b-d[g-1])*l[g-1]/(d[g+z-1-1]-d[g-1]):0)+(0!=l[g+1-1]?(d[g+z-1]-b)*l[g+1-1]/(d[g+z-1]-d[g+1-1]):0);b==d[e-1]&&(l[f-1]=1);a=0;for(g=1;g<=f;g++)a+=l[g-1]*c[g-1];for(g=1;g<=f;g++)m[g-1]=0!=a?l[g-1]*c[g-1]/a:0;return m}function d(a){a=a.hs;return a[a.length-1]}function b(a){a=
a.mA;return a[a.length-1]}function g(a,b,d,c,m,f,e,w){var u=a+(b-a)/2,z=l(u,c,m,f,e)-d;w=w?w:.01;return Math.abs(z)<w?u:0<z?g(a,u,d,c,m,f,e,w):g(u,b,d,c,m,f,e,w)}function l(a,b,d,c,m){var f=1-a;return b*f*f*f+3*d*f*f*a+3*c*f*a*a+m*a*a*a}q("__print");var w=q("__util"),f=q("__vec3");a.IJ=function(a){var b={},d=a.data;a=d.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var c=a.order_u;b.cj=c;a=a.points;var m=a.length/5,f=[],g=m+c,m=m+2;f[0]=0;for(var l=2;l<=g;l++)f[l-1]=l>c&&l<m?f[l-
2]+1:f[l-2];b.hs=f;"2D"==d.dimensions?b.Ui=!1:"3D"==d.dimensions?b.Ui=!0:w.r("Wrong curve dimensions");c=[];f=[];for(d=0;d<a.length;d+=5)c.push(a[d]),c.push(a[d+1]),c.push(a[d+2]),b.Ui&&c.push(a[d+3]),f.push(a[d+4]);b.Ru=c;b.py=f;a=[];for(var d=b.Ru,c=b.Ui?4:3,f=b.py,g=b.hs,m=b.cj,l=d.length/c,u=l+m,z=0,x=g[u-1]/999,I=0;1E3>I;I++){5E-6>g[u-1]-z&&(z=g[u-1]);for(var B=e(m,z,g,f),G=0;G<c;G++)for(var A=a[c*I+G]=0;A<l;A++)a[c*I+G]+=B[A]*d[c*A+G];z+=x}c=b.Ui?4:3;f=new Float32Array(1E3);f[0]=0;for(d=1;1E3>
d;d+=1)g=a[(d-1)*c],m=a[(d-1)*c+1],l=a[(d-1)*c+2],u=a[d*c],z=a[d*c+1],x=a[d*c+2],f[d]=f[d-1]+Math.sqrt((u-g)*(u-g)+(z-m)*(z-m)+(x-l)*(x-l));b.mA=f;return b};a.EP=function(a,b,f){f||(f=[]);var c=b,m=Math.max(c,0);b=m=Math.min(c,d(a));var c=a.Ru,m=a.Ui?4:3,p=a.py,g=a.hs,l=a.cj;a=c.length/m;var u=a+l;5E-6>g[u-1]-b&&(b=g[u-1]);u=new Float32Array(a);e(l,b,g,p,u);for(b=0;b<m;b++)for(p=f[b]=0;p<a;p++)f[b]+=u[p]*c[m*p+b]};a.BP=function(a,b,d){d||(d=[]);var c=a.Ru,f=a.Ui?4:3,e=a.py,g=a.hs,l=a.cj;a=c.length/
f;var u=a+l;5E-6>g[u-1]-b&&(b=g[u-1]);var u=new Float32Array(a),z=b;b=u;var x=e.length;b||(b=new Float32Array(x));var w=new Float32Array(x),B=new Float32Array(x),G=w,A=B;G||(G=new Float32Array(x));A||(A=new Float32Array(x));for(var J=x+l,t=new Float32Array(J),h=new Float32Array(J),C=1;C<=J-1;C++)t[C-1]=z>=g[C-1]&&z<g[C+1-1]?1:0;z==g[J-1]&&(t[x-1]=1);for(var k=2;k<=l;k++)for(C=1;C<=J-k;C++){var F=0!=t[C-1]?t[C-1]/(g[C+k-1-1]-g[C-1]):0,D=0!=t[C+1-1]?-t[C+1-1]/(g[C+k-1]-g[C+1-1]):0,q=0!=h[C-1]?(z-g[C-
1])*h[C-1]/(g[C+k-1-1]-g[C-1]):0,M=0!=h[C+1-1]?(g[C+k-1]-z)*h[C+1-1]/(g[C+k-1]-g[C+1-1]):0;t[C-1]=(0!=t[C-1]?(z-g[C-1])*t[C-1]/(g[C+k-1-1]-g[C-1]):0)+(0!=t[C+1-1]?(g[C+k-1]-z)*t[C+1-1]/(g[C+k-1]-g[C+1-1]):0);h[C-1]=F+D+q+M}for(C=1;C<=x;C++)G[C-1]=t[C-1],A[C-1]=h[C-1];g=0;for(l=1;l<=x;l++)g+=w[l-1]*e[l-1];z=0;for(l=1;l<=x;l++)z+=B[l-1]*e[l-1];for(l=1;l<=x;l++)b[l-1]=0!=g?B[l-1]*e[l-1]/g+w[l-1]*e[l-1]*z/(g*g):0;for(e=0;e<f;e++)for(g=d[e]=0;g<a;g++)d[e]+=u[g]*c[f*g+e]};a.HT=d;a.DP=b;a.CP=function(a,
f){if(0>=f)return 0;var e=d(a);if(f>=b(a))return e;var c=a.mA,m=w.Nq(c,f,0,c.length-1);return e*(m+(f-c[m])/(c[m+1]-c[m]))/1E3};a.ks=function(a,b,d,c,f){return d+(f-c)*(a-d)/(b-c)};a.XB=function(a,b,d){var c=b[0];b=b[1];d=(d[1]-b)/(d[0]-c);return d*a+(b-d*c)};a.mz=function(a,b,d,c,f,e){return l(g(0,1,a,b[0],d[0],c[0],f[0],e),b[1],d[1],c[1],f[1])};a.Cu=function(a,b,d,c,m){var e=new Float32Array(3),g=new Float32Array(3),l=new Float32Array(3),u=new Float32Array(3),z=new Float32Array(3),x=new Float32Array(3);
f.copy(a[1],g);null==b?(f.copy(d[1],l),e[0]=2*g[0]-l[0],e[1]=2*g[1]-l[1]):f.copy(b[1],e);null==d?(f.copy(b[1],e),l[0]=2*g[0]-e[0],l[1]=2*g[1]-e[1]):f.copy(d[1],l);f.subtract(g,e,u);f.subtract(l,g,z);b=f.length(u);d=f.length(z);0==b&&(b=1);0==d&&(d=1);if("AUTO"==c||"AUTO"==m)x[0]=z[0]/d+u[0]/b,x[1]=z[1]/d+u[1]/b,e=2.5614*f.length(x),0!=e&&("AUTO"==c&&f.scaleAndAdd(g,x,-(b/e),a[0]),"AUTO"==m&&f.scaleAndAdd(g,x,d/e,a[2]));"VECTOR"==c&&f.scaleAndAdd(g,u,-1/3,a[0]);"VECTOR"==m&&f.scaleAndAdd(g,z,1/3,a[2])};
a.dJ=function(a,b,d,c){var f=[],e=[],g,l,u;f[0]=a[0]-b[0];f[1]=a[1]-b[1];e[0]=c[0]-d[0];e[1]=c[1]-d[1];u=c[0]-a[0];g=Math.abs(f[0]);l=Math.abs(e[0]);0!=g+l&&g+l>u&&(g=u/(g+l),b[0]=a[0]-g*f[0],b[1]=a[1]-g*f[1],d[0]=c[0]-g*e[0],d[1]=c[1]-g*e[1])}};b4w.module.__debug=function(a,q){function e(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function d(){var a=v.Cv();if(a){var b=a.createQueryEXT();a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)}else b=performance.now();return b}function b(){var b=t;return b&&b.debug_view_mode==a.DV_RENDER_TIME}function g(a,b,c){var h=v.Cv(),d=0;if(h)for(c&&h.endQueryEXT(h.TIME_ELAPSED_EXT),c=0;c<a.length;c++){var k=a[c],f=h.getQueryObjectEXT(k,h.QUERY_RESULT_AVAILABLE_EXT),e=I.getParameter(h.GPU_DISJOINT_EXT);
f&&!e&&(d=h.getQueryObjectEXT(k,h.QUERY_RESULT_EXT)/1E6,b&&(d=u.smooth(d,b,1,10)),a.splice(c,1),c--)}else d=performance.now()-a.pop(),b&&(d=u.smooth(d,b,1,10));return d}function l(a,b){w(a)||u.r("Structure assertion failed: invalid first object value");w(b)||u.r("Structure assertion failed: invalid second object value");f(a,b)||u.r("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||u.Yv(a)||a instanceof Array)){for(var c in a)w(a[c])||u.r("Structure assertion failed: invalid value for key in the first object: "+
c),c in b||u.r("Structure assertion failed: missing key in the first object: "+c);for(c in b)w(b[c])||u.r("Structure assertion failed: invalid value for key in the second object: "+c),c in a||u.r("Structure assertion failed: missing key in the second object: "+c),f(a[c],b[c])||u.r("Structure assertion failed: incompatible types for key "+c)}}function w(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function f(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==
typeof a){var c=a instanceof Array,h=b instanceof Array;if(c&&!h||!c&&h)return!1;c=u.Yv(a);h=u.Yv(b);if(c&&!h||!c&&h)return!1}return!0}var n=q("__compat"),r=q("__config"),v=q("__extensions"),c=q("__graph"),m=q("__print"),p=q("__subscene"),y=q("__textures"),E=q("__time"),u=q("__util"),z=r.A,x={},I=null,B={},G=[],A=-1,J=-1,t=null,h=null,C=!1,k={};a.DV_NONE=0;a.DV_OPAQUE_WIREFRAME=1;a.DV_TRANSPARENT_WIREFRAME=2;a.DV_FRONT_BACK_VIEW=3;a.DV_BOUNDINGS=4;a.DV_CLUSTERS_VIEW=5;a.DV_BATCHES_VIEW=6;a.DV_RENDER_TIME=
7;a.jf=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var h=b[c];h in a&&(x[a[h]]=h)}I=a};a.IO=function(a){t=a};a.GS=function(){return t};a.XK=function(a,b,c,h,d){k[a]||(k[a]={jP:b,pe:{}});c in k[a].pe||(k[a].pe[c]=h);d&&(k[a].pe[c]=0)};a.calc_vbo_garbage_byte_size=function(){var a=0,b;for(b in k)for(var c in k[b].pe)a+=k[b].pe[c];return a};a.show_vbo_garbage_info=function(){var a={},b;for(b in k)for(var c in k[b].pe){var h=
k[b].pe[c];if(h){var d=k[b].jP;d in a||(a[d]={Sx:0,pe:{}});c in a[d].pe||(a[d].pe[c]=0);a[d].pe[c]+=h;a[d].Sx+=h}}for(d in a){m.groupCollapsed(d,a[d].Sx);for(c in a[d].pe)m.Zd(c,a[d].pe[c]);m.groupEnd()}};a.Gu=function(a){if(z.gl_debug){var b=I.getError();b!=I.NO_ERROR&&(b in x?u.r("GL Error: "+b+", gl."+x[b]+" ("+a+")"):u.r("Unknown GL error: "+b+" ("+a+")"))}};a.EI=function(){if(z.gl_debug||z.Nz)switch(I.checkFramebufferStatus(I.FRAMEBUFFER)){case I.FRAMEBUFFER_COMPLETE:break;case I.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:m.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case I.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:m.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case I.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:m.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case I.FRAMEBUFFER_UNSUPPORTED:m.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case I.zR:m.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:m.error("FRAMEBUFFER CHECK FAILED")}};a.II=function(){if(-1!=
A)return A;I.bindFramebuffer(I.FRAMEBUFFER,I.createFramebuffer());var a=y.Ll("DEBUG",y.Bl);y.resize(a,1,1);I.framebufferTexture2D(I.FRAMEBUFFER,I.DEPTH_ATTACHMENT,a.eb,a.ib,0);I.checkFramebufferStatus(I.FRAMEBUFFER)!=I.FRAMEBUFFER_COMPLETE?(A=!0,m.warn("depth-only issue was found")):A=!1;I.bindFramebuffer(I.FRAMEBUFFER,null);return A};a.NI=function(){if(1==z.tc)return!1;if(-1!=J)return J;I.bindRenderbuffer(I.RENDERBUFFER,I.createRenderbuffer());I.renderbufferStorageMultisample(I.RENDERBUFFER,z.tc,
I.RGBA8,1,1);var a=I.getRenderbufferParameter(I.RENDERBUFFER,I.RENDERBUFFER_SAMPLES);a!=z.tc?(J=!0,m.warn("multisample issue was found: requested "+z.tc+", got "+a),I.getError()==I.INVALID_OPERATION&&m.warn("the error from multisample issue detected, ignoring")):J=!1;I.bindRenderbuffer(I.RENDERBUFFER,null);return J};a.KI=function(){return n.Hu("Firefox")&&I.getError()==I.OUT_OF_MEMORY?(m.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.PC=function(a,b,c){z.gl_debug&&(c=e(c),m.error("shader compilation failed:\n"+
c+"\n"+I.getShaderInfoLog(a)+" ("+b+")"))};a.pO=function(a,b,c,h){z.gl_debug&&(c=e(c),h=e(h),m.error("shader linking failed:\n"+c+"\n\n\n"+h+"\n"+I.getProgramInfoLog(a)+" ("+b+")"))};a.bx=function(a){if(z.show_hud_debug_info||a.type==p.xn)a.jv||a.kk.push(d())};a.kO=function(a){"MAIN"==a.type&&b()&&a.kk.push(d())};a.cx=function(a){if((z.show_hud_debug_info||a.type==p.xn)&&!a.jv){var b=g(a.kk,a.Ue,!0);b&&(a.Ue=b)}};a.lO=function(a){if("MAIN"==a.type&&b()){var c=g(a.kk,a.Ue,!0);c&&(a.Ue=c)}};a.HB=b;
a.aO=function(a){var b=g(a.kk,a.Ue,!1);b&&(a.Ue=b)};a.qS=function(a){B[a]=a in B?B[a]+1:1};a.update=function(){for(var a in B)m.log(a,B[a]),B[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(u.is_vector(c))for(var h=0;h<c.length;h++)a.push(c[h]);else a.push(arguments[b])}G.push(a)};a.msg=function(){for(var a=1,b=0;b<G.length;b++){var c=G[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],u.is_vector(a))for(var h=
0;h<a.length;h++)c.push(a[h]);else c.push(arguments[b]);G.push(c)};var F=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},h=Math.max(0,performance.now()-1E3*a),d=0;d<G.length;d++){var k=G[d];a=k[0];if(!(a<h)){var f=String(k[1]);c[f]||(c[f]=F[b++%F.length]);a=["%c"+(a/1E3).toFixed(6),c[f],f];for(f=2;f<k.length;f++)a.push(k[f]);m.log.apply(this,a)}}G.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b=
{},c=Math.max(0,performance.now()-1E3*a),h=0;h<G.length;h++){var d=G[h];a=d[0];if(!(a<c))for(var k=2;k<d.length;k++){var f=String(d[1]);3<d.length&&(f+="_"+String(k-2));b[f]||(b[f]=f+"\n");b[f]+=String(a)+" "+d[k]+"\n"}}a="";for(f in b)a+=b[f]+"\n\n";m.log(a);G.splice(0)};a.ZR=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&
b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(u.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.OR=function(a,b){a.constructor!=b&&u.r("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.PR=l;a.QR=
function(a){C?l(a,h):C=!0;h=u.ao(a)};a.fake_load=function(a,b,c,h,d){(a=a||null)||u.r("Stage load callback is undefined");b=b||5E3;c=c||0;h=h||100;100<h&&u.r("Max percentage must be less than 100");0>c&&u.r("Min percentage must be greater than 0");c>h&&u.r("Max percentage must be greater than min percentage");var k=E.animate(c,h,b,function(b){b=b.toFixed();a(b);100==b&&(E.clear_animation(k),d&&d())})};a.oT=function(a){return c.sK(a,function(a,b){var c=b.type+"("+b.name+")",h=b.J,c=c+"\n\nINPUTS:";
if(h.length)for(var d=0;d<h.length;d++)c+="\n"+h[d].identifier+": ",c=h[d].Za?c+"linked":c+h[d].wa;else c+="\n---";h=b.Ua;c+="\n\nOUTPUTS:";if(h.length)for(d=0;d<h.length;d++)c+="\n"+h[d].identifier+": ",c=h[d].Za?c+("linked(default "+h[d].wa+")"):c+"not used";else c+="\n---";d="";switch(b.type){case "GEOMETRY_UV":d="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":d="\ntexture: "+b.data.value.name+"\n("+b.data.value.Qi+")"}""==d&&(d="\n---");return c=c+"\n\nDATA:"+d},function(b,
h,d){b=c.Pa(a,b);h=c.Pa(a,h);return b.Ua[d[0]].identifier+"\n==>\n"+h.J[d[1]].identifier})};a.Dr=function(){return I};a.cleanup=function(){t=null;k={}};a.reset=function(){I=null}};b4w.module.__extensions=function(a,q){function e(a){if(a in f)return f[a];var b=w.getExtension(a)||null;f[a]=b;g.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function d(a){if(a in f)return f[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=w}f[a]=b;g.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=q("__config"),g=q("__print"),
l=b.A,w=null,f={};a.jf=function(a){w=a};a.jB=function(){return e("WEBGL_compressed_texture_s3tc")||e("WEBKIT_WEBGL_compressed_texture_s3tc")||e("MOZ_WEBGL_compressed_texture_s3tc")};a.iB=function(){return e("WEBKIT_WEBGL_compressed_texture_pvrtc")||e("WEBGL_compressed_texture_pvrtc")};a.KL=function(){return l.Sb?d("WEBGL_depth_texture"):e("WEBGL_depth_texture")||e("WEBKIT_WEBGL_depth_texture")||e("MOZ_WEBGL_depth_texture")};a.CL=function(){return e("EXT_texture_filter_anisotropic")||e("WEBKIT_EXT_texture_filter_anisotropic")||
e("MOZ_EXT_texture_filter_anisotropic")};a.JL=function(){return e("WEBGL_debug_shaders")};a.get_renderer_info=function(){return e("WEBGL_debug_renderer_info")};a.dB=function(){return l.Sb?d("OES_element_index_uint"):e("OES_element_index_uint")};a.Jv=function(){return l.Sb?d("OES_standard_derivatives"):e("OES_standard_derivatives")};a.Cv=function(){return e("EXT_disjoint_timer_query")};a.ZL=function(){if(l.Sb)return d("ANGLE_instanced_arrays");var a=e("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,
d,c,f,e){a.drawElementsInstancedANGLE(b,d,c,f,e)},vertexAttribDivisor:function(b,d){a.vertexAttribDivisorANGLE(b,d)},drawArraysInstanced:function(b,d,c,f){a.drawArraysInstancedANGLE(b,d,c,f)}}};a.Kv=function(){if(l.Sb)return d("OES_vertex_array_object");var a=e("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};
a.cleanup=function(){f={}};a.reset=function(){w=null}};b4w.module.__graph=function(a,q){function e(a,b,c){c||(c=null);d(a,b)?F.r("Graph already has node with given ID"):a.L.push(b,c)}function d(a,b){for(var c=a.L,h=0;h<c.length;h+=2)if(c[h]==b)return!0;return!1}function b(a,b,c,h){h||(h=null);d(a,b)&&d(a,c)?a.Ia.push(b,c,h):F.r("Wrong node IDs")}function g(a,b){d(a,b)||F.r("Node not found");for(var c=a.L,h=0;h<c.length;h+=2)c[h]==b&&(c.splice(h,2),h-=2)}function l(a,b,c,h){t(a,b,c)||F.r("Edge not found");a=a.Ia;for(var d=0,k=0;k<a.length;k+=3)if(a[k]==
b&&a[k+1]==c){if(-1==h)a.splice(k,3);else{if(h==d){a.splice(k,3);break}d++}k-=3}}function w(a){a=a.L;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function f(a,b){for(var c=a.L,h=0;h<c.length;h+=2)if(c[h+1]==b)return c[h];return-1}function n(a){var b=[],c={};r(a,c);for(var h=a.L,d=0;d<h.length;d+=2)0==G(a,h[d])&&v(a,h[d],c,b);return{L:b,Ia:a.Ia.slice(0)}}function r(a,b){for(var c=a.L,h=0;h<c.length;h+=2)b[c[h]]=!1}function v(a,b,c,h){if(!c[b]){c[b]=!0;for(var d=0;d<B(a,b);d++)v(a,
A(a,b,d),c,h);h.unshift(b,I(a,b))}}function c(a,b,h,d){if(!h[b]){h[b]=!0;if(10==d||30==d)for(var k=0;k<B(a,b);k++){var f=A(a,b,k);c(a,f,h,d)}if(20==d||30==d)for(k=0;k<G(a,b);k++)f=J(a,b,k),c(a,f,h,d)}}function m(a){for(var b=a.Ia,c=0;c<b.length;c+=3){var h=b[c+1];d(a,b[c])&&d(a,h)||(b.splice(c,3),c-=3)}}function p(a){for(var b=[],c=a.L,h=0;h<c.length;h+=2){var d=c[h];B(a,d)||b.push(d)}return b}function y(a){var b=a.L;a=a.Ia;for(var c=[],h=[],d=[],k=0;k<b.length;k++)d[b[2*k]]=k,c.push(k,b[2*k+1]);
for(k=0;k<a.length;k+=3)h.push(d[a[k]],d[a[k+1]],a[k+2]);return{L:c,Ia:h}}function E(a,b,c){if(c.Gg==c.aj){for(var h=0,d=0;h<c.aj;h++)-1!=c.Ah[h]&&(a[d]=h,b[d]=c.Ah[h],d++);return!0}if(c.aj>c.xm||c.vj>c.wj||c.an>c.cn||c.$m>c.bn)return!1;for(var d=h=-1,k=!1;!k&&u(c,D,h,d);)if(h=D[0],d=D[1],z(c,h,d)){var f;f=c;k={};k.Ko=f.Ko;k.Lo=f.Lo;k.Gw=f.Gw;k.or=f.or;k.aj=f.aj;k.xm=f.xm;k.cj=f.cj;k.Gg=k.Es=f.Gg;k.$m=f.$m;k.an=f.an;k.vj=f.vj;k.bn=f.bn;k.cn=f.cn;k.wj=f.wj;k.Cn=-1;k.Ah=f.Ah;k.gk=f.gk;k.Ek=f.Ek;k.Fk=
f.Fk;k.Tk=f.Tk;k.Uk=f.Uk;k.bt=f.bt;f.bt[0]+=1;var k=f=k,e=h,m=d,p=k.Ko,t=k.Lo,g=k.aj,H=k.xm,l=k.Ah,n=k.gk,v=k.Ek,F=k.Fk,r=k.Tk,C=k.Uk;x(e<g);x(m<H);x(k.Gg<g);x(k.Gg<H);g=++k.Gg;k.Cn=e;v[e]||(v[e]=g,k.$m++,r[e]&&k.vj++);r[e]||(r[e]=g,k.an++,v[e]&&k.vj++);F[m]||(F[m]=g,k.bn++,C[m]&&k.wj++);C[m]||(C[m]=g,k.cn++,F[m]&&k.wj++);l[e]=m;n[m]=e;for(l=0;l<G(p,e);l++)n=J(p,e,l),v[n]||(v[n]=g,k.$m++,r[n]&&k.vj++);for(l=0;l<B(p,e);l++)n=A(p,e,l),r[n]||(r[n]=g,k.an++,v[n]&&k.vj++);for(l=0;l<G(t,m);l++)n=J(t,m,
l),F[n]||(F[n]=g,k.bn++,C[n]&&k.wj++);for(l=0;l<B(t,m);l++)n=A(t,m,l),C[n]||(C[n]=g,k.cn++,F[n]&&k.wj++);k=E(a,b,f);x(1>=f.Gg-f.Es);x(-1!=f.Cn);n=f.Ko;e=f.Lo;m=f.Gg;p=f.Cn;t=f.Ah;v=f.gk;g=f.Ek;F=f.Fk;H=f.Tk;r=f.Uk;if(f.Es<m){g[p]==m&&(g[p]=0);for(C=0;C<G(n,p);C++)l=J(n,p,C),g[l]==m&&(g[l]=0);H[p]==m&&(H[p]=0);for(C=0;C<B(n,p);C++)l=A(n,p,C),H[l]==m&&(H[l]=0);n=t[p];F[n]==m&&(F[n]=0);for(C=0;C<G(e,n);C++)l=J(e,n,C),F[l]==m&&(F[l]=0);r[n]==m&&(r[n]=0);for(C=0;C<B(e,n);C++)l=A(e,n,C),r[l]==m&&(r[l]=
0);t[p]=-1;v[n]=-1;f.Gg=f.Es;f.Cn=-1}}return k}function u(a,b,c,h){-1==c&&(c=0);-1==h?h=0:h++;var d=a.vj,k=a.wj,f=a.an,e=a.cn,m=a.$m,p=a.bn,t=a.Gg,g=a.aj,l=a.xm,n=a.Ah,v=a.gk,F=a.Ek,r=a.Fk,C=a.Tk,y=a.Uk;if(d>t&&k>t)for(;c<g&&(-1!=n[c]||0==C[c]||0==F[c]);)c++,h=0;else if(f>t&&e>t)for(;c<g&&(-1!=n[c]||0==C[c]);)c++,h=0;else if(m>t&&p>t)for(;c<g&&(-1!=n[c]||0==F[c]);)c++,h=0;else if(0==c&&0!=a.cj){for(F=0;F<g&&-1!=n[c=a.cj[F]];)F++;F==g&&(c=g)}else for(;c<g&&-1!=n[c];)c++,h=0;if(d>t&&k>t)for(;h<l&&(-1!=
v[h]||0==y[h]||0==r[h]);)h++;else if(f>t&&e>t)for(;h<l&&(-1!=v[h]||0==y[h]);)h++;else if(m>t&&p>t)for(;h<l&&(-1!=v[h]||0==r[h]);)h++;else for(;h<l&&-1!=v[h];)h++;return c<g&&h<l?(b[0]=c,b[1]=h,!0):!1}function z(a,b,c){var d=a.Ko,k=a.Lo,f=a.xm,e=a.Ah,m=a.gk,p=a.Ek,g=a.Fk,l=a.Tk,n=a.Uk;x(b<a.aj);x(c<f);x(-1==e[b]);x(-1==m[c]);if(!(0,a.Gw)(I(d,b),I(k,c)))return!1;for(var H=f=0,v=0,F=0,r=0,C=0,y=0;y<B(d,b);y++){var u=A(d,b,y);if(-1!=e[u]){var X=e[u];if(!t(k,c,X)||!h(a.or,d,b,u,k,c,X))return!1}else p[u]&&
v++,l[u]&&f++,p[u]||l[u]||r++}for(y=0;y<G(d,b);y++)if(u=J(d,b,y),-1!=e[u]){if(X=e[u],!t(k,X,c)||!h(a.or,d,u,b,k,X,c))return!1}else p[u]&&v++,l[u]&&f++,p[u]||l[u]||r++;for(y=0;y<B(k,c);y++)if(X=A(k,c,y),-1!=m[X]){if(u=m[X],!t(d,b,u))return!1}else g[X]&&F++,n[X]&&H++,g[X]||n[X]||C++;for(y=0;y<G(k,c);y++)if(X=J(k,c,y),-1!=m[X]){if(u=m[X],!t(d,u,b))return!1}else g[X]&&F++,n[X]&&H++,g[X]||n[X]||C++;return v<=F&&f<=H&&r<=C}function x(a){a||F.r("Assertion failed")}function I(a,b){for(var c=a.L,h=0;h<c.length;h+=
2)if(c[h]==b)return c[h+1];return null}function B(a,b){for(var c=a.Ia,h=0,d=0;d<c.length;d+=3)c[d]==b&&h++;return h}function G(a,b){for(var c=a.Ia,h=0,d=0;d<c.length;d+=3)c[d+1]==b&&h++;return h}function A(a,b,c){a=a.Ia;for(var h=0,d=0;d<a.length;d+=3)if(a[d]==b){if(h==c)return a[d+1];h++}return-1}function J(a,b,c){a=a.Ia;for(var h=0,d=0;d<a.length;d+=3)if(a[d+1]==b){if(h==c)return a[d];h++}return-1}function t(a,b,c){a=a.Ia;for(var h=0;h<a.length;h+=3)if(a[h]==b&&a[h+1]==c)return!0;return!1}function h(a,
b,c,h,d,f,e){for(var m=C(b,c,h),p=C(d,f,e),t=0;t<m;t++){for(var g=!1,l=0;l<p;l++)if(a(k(b,c,h,t),k(d,f,e,l))){g=!0;break}if(!g)return!1}return!0}function C(a,b,c){var h=0;a=a.Ia;for(var d=0;d<a.length;d+=3)a[d]==b&&a[d+1]==c&&h++;return h}function k(a,b,c,h){a=a.Ia;for(var d=0,k=0;k<a.length;k+=3)if(a[k]==b&&a[k+1]==c){if(d==h)return a[k+2];d++}return null}q("__print");var F=q("__util"),D=[-1,-1];a.cu=-1;a.yR=10;a.nq=20;a.ER=30;a.create=function(){for(var a=arguments,b=[],c=[],h=0;h<a.length;h++){var d=
a[h];switch(d.length){case 2:b.push(d[0],d[1]);break;case 3:c.push(d[0],d[1],d[2]);break;default:F.r("Wrong graph constructor params")}}return{L:b,Ia:c}};a.clone=function(a,b,c){if(b)for(var h=Array(a.L.length),d=0;d<a.L.length;d+=2)h[d]=a.L[d],h[d+1]=b(a.L[d+1]);else h=F.P(a.L);if(c)for(b=Array(a.Ia.length),d=0;d<a.Ia.length;d+=3)b[d]=a.Ia[d],b[d+1]=a.Ia[d+1],b[d+2]=c(a.Ia[d+2]);else b=F.P(a.Ia);return a={L:h,Ia:b}};a.hS=function(a,b){for(var c=[],h=[],d=0;d<a.length;d++)c.push(a[d][0],a[d][1]);
for(d=0;d<b.length;d++)h.push(b[d][0],b[d][1],b[d][2]);return{L:c,Ia:h}};a.ti=e;a.SS=d;a.Lc=b;a.Gf=g;a.nj=l;a.Im=function(a,b,c,h){t(a,b,c)||F.r("Edge not found");a=a.Ia;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c&&a[d+2][0]==h[0]&&a[d+2][1]==h[1]){a.splice(d,3);break}};a.H=function(a,b){if(-1==f(a,b)){var c=w(a);e(a,c,b);return c}F.r("Non-unique attribute")};a.nO=function(a,b,c,h,d){a=a.Ia;for(var k=0;k<a.length;k+=3)a[k]==b&&a[k+1]==c&&a[k+2]==h&&(a[k+2]=d)};a.DH=function(a,c,h){var d;h=h||
[];d=d||[];for(var k={},f=0;f<a.L.length;f+=2){var m=a.L[f],p=a.L[f+1],t=w(c);e(c,t,p);k[m]=t}for(f=0;f<a.Ia.length;f+=3)p=k[a.Ia[f]],t=k[a.Ia[f+1]],m=a.Ia[f+2],b(c,p,t,m);for(f=0;f<h.length;f+=3)p=k[h[f]],a=h[f+1],m=h[f+2],b(c,p,a,m);for(f=0;f<d.length;f+=3)h=d[f],t=k[d[f+1]],m=d[f+2],b(c,h,t,m)};a.yk=w;a.hg=f;a.s=function(a,c,h,d){c=f(a,c);h=f(a,h);-1!=c&&-1!=h?b(a,c,h,d):F.r("Attributes not found")};a.la=function(a,b){for(var c=a.L,h=0;h<c.length&&!b(c[h],c[h+1]);h+=2);};a.Lf=function(a,b){for(var c=
a.Ia,h=0;h<c.length&&!b(c[h],c[h+1],c[h+2]);h+=3);};a.ih=function(a,b,c){for(var h=a.Ia,d=0;d<h.length;d+=3)if(h[d+1]==b){var k=h[d];if(c(k,I(a,k),h[d+2]))break}};a.yj=function(a,b,c){for(var h=a.Ia,d=0;d<h.length;d+=3)if(h[d]==b){var k=h[d+1];if(c(k,I(a,k),h[d+2]))break}};a.Rx=n;a.RP=function(a){a=n(a).L;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.ZS=function(){};a.nt=function(a,b,h){d(a,b)||F.r("No such node");var k={};r(a,k);c(a,b,k,h);b=[];for(var f in k)k[f]&&(f=Number(f),b.push(f,
I(a,f)));a={L:b,Ia:a.Ia.slice(0)};m(a);return a};a.Iu=m;a.dM=function(a){for(var b=[],c=a.L,h=0;h<c.length;h+=2){var d=c[h];G(a,d)||b.push(d)}return b};a.Oo=p;a.match=function(a,b,c,h){var d={};d.Ko=y(a);d.Lo=y(b);d.Gw=c||function(a,b){return a==b};d.or=h||function(a,b){return a==b};h=a.L.length/2;var k=b.L.length/2;d.aj=h;d.xm=k;d.cj=0;d.Gg=d.Es=0;d.vj=d.$m=d.an=0;d.wj=d.bn=d.cn=0;d.Cn=-1;d.Ah=Array(h);d.gk=Array(k);d.Ek=Array(h);d.Fk=Array(k);d.Tk=Array(h);d.Uk=Array(k);d.bt=[1];for(c=0;c<h;c++)d.Ah[c]=
-1,d.Ek[c]=0,d.Tk[c]=0;for(c=0;c<k;c++)d.gk[c]=-1,d.Fk[c]=0,d.Uk[c]=0;k=Array(h);h=Array(h);if(E(k,h,d)){for(c=0;c<k.length;c++)k[c]=a.L[2*k[c]],h[c]=b.L[2*h[c]];return[k,h]}return null};a.aM=function(a,b){for(var c=a.L,h=1;h<c.length;h+=2)if(c[h]==b)return c[h-1];return null};a.Pa=I;a.kg=B;a.hm=G;a.cg=A;a.Hh=J;a.HS=C;a.yd=k;a.replace=function(a,b,c){for(var h=a.Ia,d=w(a),k=0;k<b.length;k++){var f=b[k];g(a,f);for(var m=0;m<h.length;m+=3)h[m]==f&&(h[m]=d),h[m+1]==f&&(h[m+1]=d),h[m]==h[m+1]&&(h.splice(m,
3),m-=3)}e(a,d,c)};a.dO=function(a,b,c,h,d){t(a,b,c)||F.r("Edge not found");a=a.Ia;for(var k=0;k<a.length;k+=3)a[k]==b&&a[k+1]==c&&(a[k]=h,a[k+1]=d)};a.MK=function(a,b){function c(a,b){if(-1!=m.indexOf(a)){var h=m.slice(m.indexOf(a));if(-1!=d[h[h.length-1]].indexOf(h[0])){e.push([a,h[h.length-1]]);return}}m.push(a);for(h=0;h<b.length;h++)b[h]in d&&c(b[h],d[b[h]])}b||(b=p(a)[0]);var h=a.Ia;if(h.length&&-1!=h.indexOf(b)){for(var d={},k=0,f=0;f<h.length;f+=3)h[f+1]in d?d[h[f+1]].push(h[f]):d[h[f+1]]=
[h[f]],k++;var m=[],e=[];c(b,d[b]);for(f=0;f<e.length;f++)for(var t=k=0;t<h.length;t+=3)e[f][1]==h[t+1]&&e[f][0]==h[t]&&l(a,h[t],h[t+1],k),k++}};a.sK=function(a,b,c){var h=a.L;a=a.Ia;var d;d="digraph debug {\n    node [shape=box];\n";for(var k=0;k<h.length;k+=2){var f=h[k],m=h[k+1],m=b?b(f,m):String(f);d+="    ";d+=String(f)+' [label="'+m.replace(/\"/g,'\\"')+'"];\n'}for(k=0;k<a.length;k+=3)b=a[k],h=a[k+1],m=a[k+2],d+="    ",d+=String(b)+" -> "+String(h),c&&(d+=' [label="'+c(b,h,m)+'"]'),d+=";\n";
return d+="}"}};b4w.module.__ipc=function(a,q){function e(a,b,d){for(var f=0;f<m.length;f+=2)m[f+1]==a&&(c[f+Number(!b)]=d)}function d(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,h;for(h in c){var f=c[h];switch(f.constructor){case Float32Array:d+=f.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.sF=0;var g=a.kF=1,l=a.mF=2;a.lF=3;a.oF=4;a.pF=5;a.qF=6;a.tF=7;var w=a.vF=8,f=a.Ay=9,n=a.wF=10;a.xF=11;var r=a.yF=12;a.zF=13;a.uF=14;a.rF=15;a.nF=16;a.uG=100;a.WF=101;a.XF=102;a.YF=103;a.ZF=104;a.aG=105;a.$F=106;
a.bG=107;a.cG=108;a.dG=109;a.eG=110;a.fG=111;a.gG=112;a.iG=113;a.jG=114;a.xG=115;a.kG=116;a.lG=117;a.mG=118;a.oG=119;a.pG=120;a.qG=121;a.sG=122;a.tG=123;a.vG=124;a.hG=125;a.zG=126;a.nG=127;a.Ly=128;a.yG=129;a.AG=130;a.BG=131;a.CG=132;a.DG=133;a.EG=134;a.FG=135;a.GG=136;a.HG=137;a.IG=138;a.JG=139;a.My=140;var v=a.tq=141;a.KG=142;a.Ky=143;a.LG=144;a.MG=145;a.wG=146;a.rG=147;a.NG=148;var c=b4w.worker_listeners,m=b4w.worker_namespaces,p={df:r,Y:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Rg:new Float32Array(3),Cg:new Float32Array(3),len:0},y={df:w,Fu:0,Vw:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},E={df:f,id:0,Fl:0,hit_fract:0,hit_time:0,len:0},u={df:n,id:0,Fl:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},z={df:g,Xj:0,Yj:0,result:0,len:0},x={df:l,Xj:0,Yj:0,result:0,dk:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},I={df:v,Y:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},B=[p,y,E,u,z,x,I];
a.lK=function(a,d){var f={cs:a?!0:!1,Lj:null,Eg:[],rf:""};if(d)if(f.Lj={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");e(f.rf,f.cs,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");e(f.rf,f.cs,null)},postMessage:function(a){var b;a:{for(b=0;b<m.length;b+=2)if(m[b+1]==f.rf){b=c[b+Number(!!f.cs)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<m.length;a+=2)if(m[a+1]==f.rf){c.splice(a,2);m.splice(a,2);break}}},f.cs){var p=
q("__util"),h=q("__container"),g=b4w.get_namespace(q),p=p.Vp(g+"_worker");m.push(g);m.push(p);c.push(null);c.push(null);f.rf=p;(h=h.aL(a))?b?h.addEventListener("load",function(){b4w.require("__bindings",f.rf)},!1):(b4w.cleanup("__bindings",f.rf),b4w.cleanup("__ipc",f.rf),b4w.require("__bindings",f.rf)):(h=document.createElement("script"),h.src=a,h.defer="defer",h.async="async",h.addEventListener("load",function(){b=!1;b4w.require("__bindings",f.rf)},!1),document.head.appendChild(h))}else f.rf=b4w.get_namespace(q);
else f.Lj=a?new Worker(a):self;return f};a.TH=function(a,b){function c(d){if(d.constructor==ArrayBuffer)d=new Float32Array(d);else if(d[0].constructor==ArrayBuffer){for(var h=0;h<d.length;h++)c(d[h]);return}h=d[0]|0;switch(h){case r:var m=p;m.Y=d[1]|0;m.time=d[2];m.trans[0]=d[3];m.trans[1]=d[4];m.trans[2]=d[5];m.quat[0]=d[6];m.quat[1]=d[7];m.quat[2]=d[8];m.quat[3]=d[9];m.Rg[0]=d[10];m.Rg[1]=d[11];m.Rg[2]=d[12];m.Cg[0]=d[13];m.Cg[1]=d[14];m.Cg[2]=d[15];break;case w:m=y;m.Fu=d[1]|0;m.Vw=d[2]|0;m.trans[0]=
d[3];m.trans[1]=d[4];m.trans[2]=d[5];m.quat[0]=d[6];m.quat[1]=d[7];m.quat[2]=d[8];m.quat[3]=d[9];break;case f:m=E;m.id=d[1]|0;m.Fl=d[2]|0;m.hit_fract=d[3];m.hit_time=d[4];break;case n:m=u;m.id=d[1]|0;m.Fl=d[2]|0;m.hit_fract=d[3];m.hit_time=d[4];m.hit_pos[0]=d[5];m.hit_pos[1]=d[6];m.hit_pos[2]=d[7];m.hit_norm[0]=d[8];m.hit_norm[1]=d[9];m.hit_norm[2]=d[10];break;case g:m=z;m.Xj=d[1]|0;m.Yj=d[2]|0;m.result=!!d[3];break;case l:m=x;m.Xj=d[1]|0;m.Yj=d[2]|0;m.result=!!d[3];m.dk[0]=d[4];m.dk[1]=d[5];m.dk[2]=
d[6];m.coll_norm[0]=d[7];m.coll_norm[1]=d[8];m.coll_norm[2]=d[9];m.coll_dist=d[10];break;case v:m=I;m.Y=d[1]|0;m.trans[0]=d[2];m.trans[1]=d[3];m.trans[2]=d[4];m.quat[0]=d[5];m.quat[1]=d[6];m.quat[2]=d[7];m.quat[3]=d[8];break;default:m=d}b(a,h,m)}d(B);a.Lj.addEventListener("message",function(a){c(a.data)},!1)};a.cleanup=function(){};a.Z=function(a,b){if(a)switch(b){case r:var c=p,d=new Float32Array(c.len);d[0]=c.df;d[1]=c.Y;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];
d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.Rg[0];d[11]=c.Rg[1];d[12]=c.Rg[2];d[13]=c.Cg[0];d[14]=c.Cg[1];d[15]=c.Cg[2];a.Eg.push(d.buffer);break;case w:c=y;d=new Float32Array(c.len);d[0]=c.df;d[1]=c.Fu;d[2]=c.Vw;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.Eg.push(d.buffer);break;case f:c=E;d=new Float32Array(c.len);d[0]=c.df;d[1]=c.id;d[2]=c.Fl;d[3]=c.hit_fract;d[4]=c.hit_time;a.Eg.push(d.buffer);break;case n:c=u;d=new Float32Array(c.len);
d[0]=c.df;d[1]=c.id;d[2]=c.Fl;d[3]=c.hit_fract;d[4]=c.hit_time;d[5]=c.hit_pos[0];d[6]=c.hit_pos[1];d[7]=c.hit_pos[2];d[8]=c.hit_norm[0];d[9]=c.hit_norm[1];d[10]=c.hit_norm[2];a.Eg.push(d.buffer);break;case g:c=z;d=new Float32Array(c.len);d[0]=c.df;d[1]=c.Xj;d[2]=c.Yj;d[3]=c.result;a.Eg.push(d.buffer);break;case l:c=x;d=new Float32Array(c.len);d[0]=c.df;d[1]=c.Xj;d[2]=c.Yj;d[3]=c.result;d[4]=c.dk[0];d[5]=c.dk[1];d[6]=c.dk[2];d[7]=c.coll_norm[0];d[8]=c.coll_norm[1];d[9]=c.coll_norm[2];d[10]=c.coll_dist;
a.Eg.push(d.buffer);break;case v:c=I;d=new Float32Array(c.len);d[0]=c.df;d[1]=c.Y;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];d[8]=c.quat[3];a.Eg.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.Lj.postMessage(d)}};a.XN=function(a){a&&a.Eg.length&&(a.Lj.postMessage(a.Eg),a.Eg.length=0)};a.gB=function(a){switch(a){case r:return p;case w:return y;case f:return E;case n:return u;case g:return z;case l:return x;case v:return I;
default:return null}};a.terminate=function(a){a.Lj.terminate();a.Lj=null};a.Yr=function(a){return!!a.Lj};a.IB=function(a){return!!a.rf}};b4w.module.__hud=function(a,q){function e(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function d(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.q){var c=0,d=0,e=0;f.la(a.q.Ma,function(a,f){if(f.type!=n.Al){for(var m=Math.round(f.p.width)+"x"+Math.round(f.p.height),g=0,l=0;l<f.La.length;l++)g+=f.La[l].oa.length;l=f.qo;if(f.type==n.Sc||f.type==n.me)g*=6;var v=f.Lb,r=v?f.Ue:0;f.enqueue||(f.Ue=
0);var J=v?" (\u2713)":" (\u2715)",t=n.Fx(f);b(J,t,f.Cs,m,l,"of",g,"  ",r.toFixed(3));f.qo=0;v&&(c+=g,d+=l,e+=r)}});return[c,d,e]}b("No INFO")}function b(){for(var a=80+20*c[0],b=arguments[0],d=1;d<arguments.length;d++){for(var f="",e=0;e<r[d]-String(arguments[d]).length;e++)f+=" ";b+=f+arguments[d]}c[0]++;v.fillText(b,30,a)}function g(a,b,c){b*=a.Yb;c.x=a.x+b;c.y=a.y;c.Yb=a.Yb-2*b;c.xb=a.xb}function l(a){return a.x+a.Yb/2}function w(a){var b=v,c={x:0,y:0,Yb:0,xb:0},d=b.canvas.width,b=b.canvas.height;
c.x=0;c.y=0;c.Yb=d;c.xb=b;g(c,.01,c);d=.02*c.xb;c.x=c.x;c.y+=d;c.Yb=c.Yb;c.xb-=2*d;d=c.Yb/8;c.x+=d*a;c.y=c.y;c.Yb=d;c.xb=c.xb;g(c,.02,c);return c}var f=q("__graph");q("__print");var n=q("__subscene"),r=[5,30,4,10,5,3,5],v=null,c=[0,0];a.init=function(a){a=a.getContext("2d");e(a);return v=a};a.Wp=function(){v&&e(v)};a.reset=function(){var a=v;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),c[0]=0,c[1]=0)};a.mP=function(a,
f){var e=v;if(e){e.textAlign="left";e.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/f).toFixed(2));c[0]++;for(var g=e=0,l=0,n=0;n<a.length;n++){var r=d(a[n]),e=e+r[0],g=g+r[1],l=l+r[2];c[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",g,"of",e,"  ",l.toFixed(3))}};a.print=function(){var a=v;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.plot_array=function(a,b,c,d,f,e,g){var n=v;if(n){b=w(b);var r=b.xb/5;b.x=
b.x;b.y+=4*r;b.Yb=b.Yb;b.xb=r;n.textAlign="center";n.fillStyle="#00FF00";v.fillText(a,l(b),b.y-10);n.strokeStyle="#00FF00";n.lineWidth=.5;n.beginPath();n.moveTo(b.x,b.y);n.lineTo(b.x+b.Yb,b.y);n.lineTo(b.x+b.Yb,b.y+b.xb);n.lineTo(b.x,b.y+b.xb);n.closePath();n.stroke();if(!e&&!g)for(e=1E6,g=-1E6,a=0;a<c.length;a++)e=Math.min(e,c[a]),g=Math.max(g,c[a]);n.textAlign="right";v.fillText(String(e),b.x-10,b.y+b.xb);v.fillText(String(g),b.x-10,b.y);n.textAlign="center";v.fillText(String(d),b.x,b.y+b.xb+15);
v.fillText(String(f),b.x+b.Yb,b.y+b.xb+15);n.strokeStyle="#FF0000";n.lineWidth=1.5;n.beginPath();d=b.Yb/(c.length-1);g=b.xb/(g-e);for(a=0;a<c.length;a++)f=b.x+d*a,r=b.y+b.xb-(c[a]-e)*g,0==a?n.moveTo(f,r):n.lineTo(f,r);n.stroke()}};a.draw_mixer_strip=function(a,b,c,d,f,e,g){var n=v;if(n)for(n.textAlign="center",n.fillStyle="#00FF00",n.font="bold 12px Courier",c=w(c),v.fillText(b?"["+a+"]":a,l(c),c.y),0<=e&&v.fillText(e?"[M]":"[ ]",l(c)-15,c.y+30),0<=g&&v.fillText(g?"[S]":"[ ]",l(c)+15,c.y+30),a={x:0,
y:0,Yb:0,xb:0},b=0;b<d.length;b++){e=d[b];var r="VOLUME"==e[0];if(r){g=c.y+350;var G=c.Yb,A=a;A.x=c.x;A.y=g;A.Yb=G;A.xb=250}else{g=c.y+50+50*b;var G=c.Yb,A=c.xb,J=a;J.x=c.x;J.y=g;J.Yb=G;J.xb=A}g=n;var G=a,J=b==f,t=e[0],A=e[1],h=e[2],C=e[3],k=(C-h)/e[4],k=1>k?Math.floor(1/k-1E-5).toFixed(0).length:0;e=e[5]?Math.log(A/h)/Math.log(C/h):(A-h)/(C-h);g.textAlign="center";J?g.fillText("["+t+"]",l(G),G.y):g.fillText(t,l(G),G.y);g.strokeStyle="#00FF00";g.lineWidth=r?3:1;r?(g.textAlign="right",g.fillText(C.toFixed(k),
l(G)-10,G.y+15),g.textAlign="right",g.fillText(h.toFixed(k),l(G)-10,G.y+G.xb-15)):(g.textAlign="right",g.fillText(h.toFixed(k),G.x+28,G.y+15),g.textAlign="left",g.fillText(C.toFixed(k),G.x+G.Yb-28,G.y+15));g.beginPath();if(r){var F=G.y+15+(G.xb-30)*(1-e);g.moveTo(l(G),G.y+15);g.lineTo(l(G),G.y+G.xb-15);g.moveTo(l(G)-5,G.y+15);g.lineTo(l(G)+5,G.y+15);g.moveTo(l(G)-5,G.y+G.xb-15);g.lineTo(l(G)+5,G.y+G.xb-15);g.moveTo(l(G)-5,F);g.lineTo(l(G)+5,F)}else{var D=G.x+30+(G.Yb-60)*e;g.moveTo(G.x+30,G.y+15);
g.lineTo(G.x+G.Yb-30,G.y+15);g.moveTo(G.x+30,G.y+15-5);g.lineTo(G.x+30,G.y+15+5);g.moveTo(G.x+G.Yb-30,G.y+15-5);g.lineTo(G.x+G.Yb-30,G.y+15+5);g.moveTo(D,G.y+15-5);g.lineTo(D,G.y+15+5)}g.stroke();"EQ_Q"==t?(e=Math.log(1+1/(2*A*A)+Math.sqrt((2+1/(A*A))*(2+1/(A*A))/4-1))/Math.log(2),r?(g.textAlign="left",g.fillText(A.toFixed(k),l(G)+10,F),g.textAlign="left",g.fillText("("+e.toFixed(k+1)+")",l(G)+10,F+10)):(g.textAlign="right",g.fillText(A.toFixed(k),D,G.y+30),g.textAlign="left",g.fillText("("+e.toFixed(k+
1)+")",D,G.y+30))):r?(g.textAlign="left",g.fillText(A.toFixed(k),l(G)+10,F)):(g.textAlign="center",g.fillText(A.toFixed(k),D,G.y+30))}}};b4w.module.__renderer=function(a,q){function e(a){for(var d=a.p,h=a.La,k=null,f=E.Ub(d.n,aa),e=0;e<h.length;e++){var m=h[e];if(m.Lb){var g=m.nb,m=m.oa;if(g.Zg!=k){t.useProgram(g.Zg);for(var k=a,H=d,n=g,v=n.jE,F=v.length;F--;){var C=v[F];C.$l(t,C.ze,k,H)}if(n.gp&&!n.zs)for(n.Pw.length||l(n),n=n.Pw,F=n.length;F--;)C=n[F],C.$l(t,C.ze,k,H);k=g.Zg}for(H=0;H<m.length;H++)if(v=m[H],v.Lb){n=v.Th;F=v.qa;r.kO(F);r.HB()&&"DEBUG_VIEW"==F.type&&(F.po=u.smooth(w.VH(F.Ol),F.po,1,15));if(T.alpha_sort&&F.Ke){var C=
n,v=v.Wr,y=f,A=F.ha,X=x.dist(y,v.WE),z=T.alpha_sort_threshold*Math.min(v.ZH,1);if(X>z||C.Ho)c.kQ(A,v,C.n,y),x.copy(y,v.WE),C.Ho=!1}C=a;v=F;y=g;z=y.kE;for(A=z.length;A--;)X=z[A],X.$l(t,X.ze,n,v);if(y.gp&&!y.zs){y.op.length||l(y);z=y.op;for(A=z.length;A--;)X=z[A],X.$l(t,X.ze,n,v);y.gp=!1}t.depthMask(v.Na);v.Jb?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE);A=v.X;X=t;for(z=0;z<A.length;z++){var G=A[z];X.activeTexture(X.TEXTURE0+z);X.bindTexture(G.eb,G.ib)}if(C.type==p.Of){n=C;y=y.jl;A=n.p.bc.ib;X=n.jk;
for(z=0;6>z;z++)if(G=b(z),T.Ju?(t.bindTexture(t.TEXTURE_CUBE_MAP,A),t.texImage2D(G,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,J)):(t.uniformMatrix4fv(y.u_cube_view_matrix,!1,X[z]),t.uniform4fv(y.u_sky_tex_fac,n.jt),t.uniform3fv(y.u_sky_tex_color,n.ht),t.uniform1f(y.u_sky_tex_dvar,n.it),t.uniform3fv(y.u_horizon_color,n.Jd),t.uniform3fv(y.u_zenith_color,n.Rd),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,G,A,0),D(v,0)),n.xs&&3!=z){var G=n,q=z,da=L;T.Ju?da.set(J):(t.readPixels(191,191,1,1,t.RGBA,
t.UNSIGNED_BYTE,da),255!=da[0]&&255!=da[1]&&255!=da[2]||t.readPixels(191,220,1,1,t.RGBA,t.UNSIGNED_BYTE,da));var K=da[0],Ba=da[1],da=da[2],K=K/255,Ba=Ba/255,da=da/255;2===q?(G.Xd[3]=K,G.Xd[7]=Ba,G.Xd[11]=da):2>q?(G.Xd[4*q]=K,G.Xd[4*q+1]=Ba,G.Xd[4*q+2]=da):(G.Xd[4*(q-2)]=K,G.Xd[4*(q-2)+1]=Ba,G.Xd[4*(q-2)+2]=da)}C.qo+=6}else D(v,n.Ct),C.qo++;r.lO(F);r.HB()&&"MAIN"==F.type&&w.WH(F.id,F.Ue)}}}}function d(a){if(a){var b=(a.jb?t.COLOR_BUFFER_BIT:0)|(a.qb?t.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case p.Ed:a=
A;break;case p.Jc:a=I;break;case p.Oe:a=B;break;case p.Le:case p.ph:case p.vl:a=G;break;case p.Nf:case p.zn:case p.uq:a=A;break;default:a=T.background_color}}else b=t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT,a=T.background_color;t.colorMask(!0,!0,!0,!0);t.depthMask(!0);t.clearColor(a[0],a[1],a[2],a[3]);t.clear(b)}function b(a){switch(a){case 0:return t.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return t.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return t.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return t.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return t.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return t.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function g(a){var b=v.Kv(),c=a.Kn,d=a.ha,h=d.Cb;a.ke.length=0;var k=1,f;for(f in h)k=Math.max(k,h[f].frames);for(h=0;h<k;h++){f=b.createVertexArray();F(f);d.xf&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,d.xf);for(var e=0;e<d.md.length;e++){t.bindBuffer(t.ARRAY_BUFFER,d.md[e].Dj);for(var m=0;m<c.length;m++){var g=c[m];g.FE==d.md[e].type&&(t.enableVertexAttribArray(g.ze),t.vertexAttribPointer(g.ze,g.Vb,g.Gr,g.Gr==t.FLOAT?
!1:!0,g.hl,g.hz+g.MA*h),C(g.ze,g.xo))}}F(null);a.ke.push(f)}}function l(a){var b=a.jl,c=a.kE,d=a.op,h=a.jE,k=a.Pw;c.length=0;d.length=0;h.length=0;k.length=0;for(var f in b){var e=!1,m=null,g=null;switch(f){case "u_proj_matrix":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.lb)};e=!0;break;case "u_view_refl_matrix":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Gt)};e=!0;break;case "u_view_tsr":case "u_view_tsr_frag":m=function(a,b,c,d){d.Xb?a.uniformMatrix3fv(b,!1,d.zp):a.uniformMatrix3fv(b,!1,d.Je)};
e=!0;break;case "u_view_tsr_inverse":m=function(a,b,c,d){d.Xb?a.uniformMatrix3fv(b,!1,d.Us):a.uniformMatrix3fv(b,!1,d.Ht)};e=!0;break;case "u_shadow_cast_billboard_view_tsr":m=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.Jp)};e=!0;break;case "u_view_proj_prev":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Uw)};e=!0;break;case "u_view_proj_matrix":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Rc)};e=!0;break;case "u_view_proj_inverse":m=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Ft)};e=!0;break;case "u_sky_vp_inverse":m=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Hf)};e=!0;break;case "u_camera_eye":case "u_camera_eye_frag":m=function(a,b,c,d){a.uniform3fv(b,E.Ub(d.n,aa))};e=!0;break;case "u_camera_quat":m=function(a,b,c,d){a.uniform4fv(b,E.zd(d.n,M))};e=!0;break;case "u_view_max_depth":m=function(a,b,c,d){a.uniform1f(b,d.far)};e=!0;break;case "u_camera_range":m=function(a,b,c,d){a.uniform2f(b,d.near,d.far)};break;case "u_csm_center_dists":m=function(a,b,c,d){a.uniform4fv(b,d.er)};break;case "u_height":m=function(a,
b,c,d){a.uniform1f(b,d.height)};e=!0;break;case "u_pcf_blur_radii":m=function(a,b,c,d){a.uniform4fv(b,d.Fm)};break;case "u_dof_dist":m=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};e=!0;break;case "u_dof_front_start":m=function(a,b,c,d){a.uniform1f(b,d.dof_front_start)};e=!0;break;case "u_dof_front_end":m=function(a,b,c,d){a.uniform1f(b,d.dof_front_end)};e=!0;break;case "u_dof_rear_start":m=function(a,b,c,d){a.uniform1f(b,d.dof_rear_start)};e=!0;break;case "u_dof_rear_end":m=
function(a,b,c,d){a.uniform1f(b,d.dof_rear_end)};e=!0;break;case "u_dof_bokeh_intensity":m=function(a,b,c,d){a.uniform1f(b,d.gb)};e=!0;break;case "u_camera_direction":m=function(a,b,c,d){a.uniform3fv(b,d.direction)};e=!0;break;case "u_cam_water_depth":m=function(a,b,c){a.uniform1f(b,c.Eu)};e=!0;break;case "u_waves_height":m=function(a,b,c){a.uniform1f(b,c.my)};break;case "u_waves_length":m=function(a,b,c){a.uniform1f(b,c.ny)};break;case "u_fog_color_density":m=function(a,b,c){a.uniform4fv(b,c.Yd)};
break;case "u_fog_params":m=function(a,b,c){a.uniform4fv(b,c.tf)};break;case "u_underwater_fog_color_density":m=function(a,b,c){a.uniform4fv(b,c.nh)};break;case "u_bloom_key":m=function(a,b,c){a.uniform1f(b,c.Pq)};break;case "u_bloom_edge_lum":m=function(a,b,c){a.uniform1f(b,c.Oq)};break;case "u_time":m=function(a,b,c){a.uniform1f(b,c.time)};e=!0;break;case "u_wind":m=function(a,b,c){a.uniform3fv(b,c.mi)};e=!0;break;case "u_sky_tex_dvar":m=function(a,b,c){a.uniform1f(b,c.it)};break;case "u_sky_tex_fac":m=
function(a,b,c){a.uniform4fv(b,c.jt)};break;case "u_sky_tex_color":m=function(a,b,c){a.uniform3fv(b,c.ht)};break;case "u_horizon_color":m=function(a,b,c){a.uniform3fv(b,c.Jd)};break;case "u_zenith_color":m=function(a,b,c){a.uniform3fv(b,c.Rd)};break;case "u_environment_energy":m=function(a,b,c){a.uniform1f(b,c.$f)};break;case "u_sky_color":m=function(a,b,c){a.uniform3fv(b,c.Qm)};break;case "u_rayleigh_brightness":m=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":m=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":m=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":m=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":m=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":m=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":m=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":m=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":m=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":m=function(a,b,c){a.uniform4fv(b,c.cp)};break;case "u_light_directions":m=function(a,b,c){a.uniform3fv(b,c.gw)};break;case "u_light_color_intensities":m=function(a,b,c){a.uniform4fv(b,c.bp)};break;case "u_sun_quaternion":m=function(a,b,c){a.uniform4fv(b,c.SD)};break;case "u_sun_intensity":m=function(a,b,c){a.uniform3fv(b,c.RD)};
break;case "u_sun_direction":m=function(a,b,c){a.uniform3fv(b,c.Gx)};break;case "u_debug_view_mode":m=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":m=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":m=function(a,b,c){a.uniform1f(b,c.qA)};break;case "u_subpixel_jitter":m=function(a,b,c){a.uniform2fv(b,c.GM)};e=!0;break;case "u_subsample_indices":m=function(a,b,c){a.uniform4fv(b,c.HM)};e=!0;break;case "u_radial_blur_step":m=
function(a,b,c){a.uniform1f(b,c.Ts)};break;case "u_god_rays_intensity":m=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":m=function(a,b,c){a.uniform1f(b,c.Vm)};break;case "u_ssao_blur_discard_value":m=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};e=!0;break;case "u_ssao_influence":m=function(a,b,c){a.uniform1f(b,c.Um)};break;case "u_ssao_dist_factor":m=function(a,b,c){a.uniform1f(b,c.Tm)};break;case "u_texel_size":m=function(a,b,c){a.uniform2fv(b,
c.Ox)};e=!0;break;case "u_normal_offset":m=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":m=function(a,b,c){a.uniform4fv(b,c.Bt)};e=!0;break;case "u_v_light_r":m=function(a,b,c){a.uniform4fv(b,c.At)};e=!0;break;case "u_v_light_tsr":m=function(a,b,c){a.uniformMatrix3fv(b,!1,c.iy)};e=!0;break;case "u_p_light_matrix0":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Vk[0])};e=!0;break;case "u_p_light_matrix1":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Vk[1])};e=!0;
break;case "u_p_light_matrix2":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Vk[2])};e=!0;break;case "u_p_light_matrix3":m=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Vk[3])};e=!0;break;case "u_outline_color":m=function(a,b,c){a.uniform3fv(b,c.Vh)};break;case "u_draw_outline":m=function(a,b,c){a.uniform1f(b,c.lv)};e=!0;break;case "u_glow_mask_small_coeff":m=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};e=!0;break;case "u_glow_mask_large_coeff":m=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};
e=!0;break;case "u_brightness":m=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":m=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":m=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":m=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":m=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":m=function(a,b,c){a.uniform4fv(b,c.lk)};break;case "u_chromatic_aberration_coefs":m=function(a,
b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":m=function(a,b,c){a.uniform1f(b,c.gC)};e=!0;break;case "u_motion_blur_decay_threshold":m=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};e=!0;break;case "u_model_tsr":g=function(a,b,c){a.uniformMatrix3fv(b,!1,c.n)};e=!0;break;case "u_model_tsr_inverse":g=function(a,b,c){a.uniformMatrix3fv(b,!1,c.Pt)};e=!0;break;case "u_transb":g=function(a,b,c){a.uniform4fv(b,c.Pd)};e=!0;break;case "u_transa":g=function(a,b,c){a.uniform4fv(b,
c.he)};e=!0;break;case "u_arm_rel_trans":g=function(a,b,c){a.uniform4fv(b,c.In)};e=!0;break;case "u_arm_rel_quat":g=function(a,b,c){a.uniform4fv(b,c.Hn)};e=!0;break;case "u_quat":g=function(a,b,c){a.uniform4fv(b,E.zd(c.n,M))};e=!0;break;case "u_quatsb":g=function(a,b,c){a.uniform4fv(b,c.Ld)};e=!0;break;case "u_quatsa":g=function(a,b,c){a.uniform4fv(b,c.ee)};e=!0;break;case "u_frame_factor":g=function(a,b,c){a.uniform1f(b,c.we)};e=!0;break;case "au_center_pos":g=function(){};e=!0;break;case "au_wind_bending_amp":g=
function(a,b,c){a.uniform1f(b,c.Mf)};e=!0;break;case "au_wind_bending_freq":g=function(a,b,c){a.uniform1f(b,c.wg)};e=!0;break;case "au_detail_bending_freq":g=function(a,b,c){a.uniform1f(b,c.Wf)};e=!0;break;case "au_detail_bending_amp":g=function(a,b,c){a.uniform1f(b,c.Vf)};e=!0;break;case "au_branch_bending_amp":g=function(a,b,c){a.uniform1f(b,c.Rf)};e=!0;break;case "u_node_values":g=function(a,b,c,d){a.uniform1fv(b,d.Rh)};e=!0;break;case "u_node_rgbs":g=function(a,b,c,d){a.uniform3fv(b,d.ae)};e=
!0;break;case "u_diffuse_color":g=function(a,b,c,d){a.uniform4fv(b,d.ud)};e=!0;break;case "u_diffuse_intensity":g=function(a,b,c,d){a.uniform1f(b,d.Kg)};e=!0;break;case "u_diffuse_params":g=function(a,b,c,d){a.uniform2fv(b,d.wd)};e=!0;break;case "u_emit":g=function(a,b,c,d){a.uniform1f(b,d.Yf)};e=!0;break;case "u_ambient":g=function(a,b,c,d){a.uniform1f(b,d.Qf)};e=!0;break;case "u_specular_color":g=function(a,b,c,d){a.uniform3fv(b,d.Jf)};e=!0;break;case "u_specular_alpha":g=function(a,b,c,d){a.uniform1f(b,
d.Np)};e=!0;break;case "u_specular_params":g=function(a,b,c,d){a.uniform3fv(b,d.Nd)};e=!0;break;case "u_reflect_factor":g=function(a,b,c,d){a.uniform1f(b,d.reflect_factor)};e=!0;break;case "u_mirror_factor":g=function(a,b,c,d){a.uniform1f(b,d.ep)};e=!0;break;case "u_grass_map_dim":g=function(a,b,c,d){a.uniform3fv(b,d.Hd)};e=!0;break;case "u_grass_size":g=function(a,b,c,d){a.uniform1f(b,d.Po)};e=!0;break;case "u_scale_threshold":g=function(a,b,c,d){a.uniform1f(b,d.Ir)};e=!0;break;case "u_cube_fog":g=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Xd)};break;case "u_jitter_amp":g=function(a,b,c,d){a.uniform1f(b,d.fs)};e=!0;break;case "u_jitter_freq":g=function(a,b,c,d){a.uniform1f(b,d.gs)};e=!0;break;case "u_wireframe_edge_color":g=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":g=function(a,b,c,d){a.uniform1f(b,d.bk)};e=!0;break;case "u_batch_debug_id_color":g=function(a,b,c,d){a.uniform1f(b,d.hr)};e=!0;break;case "u_batch_debug_main_render_time":g=function(a,
b,c,d){a.uniform1f(b,d.po)};e=!0;break;case "u_refr_bump":g=function(a,b,c,d){a.uniform1f(b,d.Vs)};e=!0;break;case "u_line_width":g=function(a,b,c,d){a.uniform1f(b,d.qm)};e=!0;break;case "u_lamp_light_positions":g=function(a,b,c,d){a.uniform3fv(b,d.om)};break;case "u_lamp_light_directions":g=function(a,b,c,d){a.uniform3fv(b,d.$o)};break;case "u_lamp_light_color_intensities":g=function(a,b,c,d){a.uniform3fv(b,d.Zo)};break;case "u_halo_size":g=function(a,b,c,d){a.uniform1f(b,d.Sr)};e=!0;break;case "u_halo_hardness":g=
function(a,b,c,d){a.uniform1f(b,d.Pr)};e=!0;break;case "u_halo_rings_color":g=function(a,b,c,d){a.uniform3fv(b,d.Rr)};e=!0;break;case "u_halo_lines_color":g=function(a,b,c,d){a.uniform3fv(b,d.Qr)};e=!0;break;case "u_halo_stars_blend":g=function(a,b,c,d){a.uniform1f(b,d.Tr)};e=!0;break;case "u_halo_stars_height":g=function(a,b,c,d){a.uniform1f(b,d.Ur)};e=!0;break;case "u_fresnel_params":g=function(a,b,c,d){a.uniform4fv(b,d.Ze)};e=!0;break;case "u_texture_scale":g=function(a,b,c,d){a.uniform3fv(b,d.fh)};
e=!0;break;case "u_parallax_scale":g=function(a,b,c,d){a.uniform1f(b,d.parallax_scale)};e=!0;break;case "u_color_id":g=function(a,b,c){a.uniform3fv(b,c.ek)};e=!0;break;case "u_line_points":g=function(a,b,c,d){a.uniform3fv(b,d.hT)};e=!0;break;case "u_diffuse_color_factor":g=function(a,b,c,d){a.uniform1f(b,d.Jg)};e=!0;break;case "u_alpha_factor":g=function(a,b,c,d){a.uniform1f(b,d.Bg)};e=!0;break;case "u_specular_color_factor":g=function(a,b,c,d){a.uniform1f(b,d.bi)};e=!0;break;case "u_normal_factor":g=
function(a,b,c,d){a.uniform1f(b,d.Bs)};e=!0;break;case "u_normalmap0_scale":g=function(a,b,c,d){a.uniform2fv(b,d.Sh[0])};e=!0;break;case "u_normalmap1_scale":g=function(a,b,c,d){a.uniform2fv(b,d.Sh[1])};e=!0;break;case "u_normalmap2_scale":g=function(a,b,c,d){a.uniform2fv(b,d.Sh[2])};e=!0;break;case "u_normalmap3_scale":g=function(a,b,c,d){a.uniform2fv(b,d.Sh[3])};e=!0;break;case "u_foam_factor":g=function(a,b,c,d){a.uniform1f(b,d.foam_factor)};e=!0;break;case "u_foam_uv_freq":g=function(a,b,c,d){a.uniform2fv(b,
d.xr)};e=!0;break;case "u_foam_mag":g=function(a,b,c,d){a.uniform2fv(b,d.wr)};e=!0;break;case "u_foam_scale":g=function(a,b,c,d){a.uniform2fv(b,d.Eo)};e=!0;break;case "u_water_norm_uv_velocity":g=function(a,b,c,d){a.uniform1f(b,d.Kj)};e=!0;break;case "u_shallow_water_col":g=function(a,b,c,d){a.uniform3fv(b,d.shallow_water_col)};e=!0;break;case "u_shore_water_col":g=function(a,b,c,d){a.uniform3fv(b,d.shore_water_col)};e=!0;break;case "u_water_shallow_col_fac":g=function(a,b,c,d){a.uniform1f(b,d.shallow_water_col_fac)};
e=!0;break;case "u_water_shore_col_fac":g=function(a,b,c,d){a.uniform1f(b,d.shore_water_col_fac)};e=!0;break;case "u_p_length":g=function(a,b,c,d){a.uniform1f(b,d.Va.cE)};e=!0;break;case "u_p_cyclic":g=function(a,b,c,d){a.uniform1i(b,d.Va.cyclic)};e=!0;break;case "u_p_max_lifetime":g=function(a,b,c,d){a.uniform1f(b,d.Va.WB)};e=!0;break;case "u_p_fade_in":g=function(a,b,c,d){a.uniform1f(b,d.Va.qk)};e=!0;break;case "u_p_fade_out":g=function(a,b,c,d){a.uniform1f(b,d.Va.We)};e=!0;break;case "u_p_size":g=
function(a,b,c,d){a.uniform1f(b,d.Va.size)};e=!0;break;case "u_p_alpha_start":g=function(a,b,c,d){a.uniform1f(b,d.Va.Zy)};e=!0;break;case "u_p_alpha_end":g=function(a,b,c,d){a.uniform1f(b,d.Va.Yy)};e=!0;break;case "u_p_nfactor":g=function(a,b,c,d){a.uniform1f(b,d.Va.Fw)};e=!0;break;case "u_p_gravity":g=function(a,b,c,d){a.uniform1f(b,d.Va.sB)};e=!0;break;case "u_p_mass":g=function(a,b,c,d){a.uniform1f(b,d.Va.Ug)};e=!0;break;case "u_p_color_ramp":g=function(a,b,c,d){a.uniform4fv(b,d.Va.Zz)};e=!0;break;
case "u_p_wind_fac":g=function(a,b,c,d){a.uniform1f(b,d.Va.RE)};e=!0;break;case "u_p_time":g=function(a,b,c,d){a.uniform1f(b,d.Va.time)};e=!0;break;case "u_p_tilt":g=function(a,b,c,d){a.uniform1f(b,d.Va.aE)};e=!0;break;case "u_p_tilt_rand":g=function(a,b,c,d){a.uniform1f(b,d.Va.bE)};e=!0;break;case "u_position":g=function(a,b,c,d){a.uniform3fv(b,d.Pj)};e=!0;break;case "u_va_frame_factor":g=function(a,b,c){a.uniform1f(b,c.Dt)};e=!0;break;case "u_refl_plane":g=function(a,b,c){a.uniform4fv(b,c.Xb)};
e=!0;break;case "u_outline_intensity":g=function(a,b,c){a.uniform1f(b,c.lg)};e=!0;break;case "u_obj_info":g=function(a,b,c,d){a.uniform3fv(b,d.Am)},e=!0}g&&(g={name:f,$l:g,ze:b[f]},e?c.push(g):d.push(g));m&&(g={name:f,$l:m,ze:b[f]},e?h.push(g):k.push(g))}if(d.length||k.length){a=a.Qw;for(var p in a)delete a[p];for(p=0;p<d.length;p++)g=d[p],a[g.name]=g;for(p=0;p<k.length;p++)g=k[p],a[g.name]=g}else a.zs=!0}var w=q("__batch"),f=q("__camera"),n=q("__config"),r=q("__debug"),v=q("__extensions"),c=q("__geometry"),
m=q("__quat"),p=q("__subscene"),y=q("__textures"),E=q("__tsr"),u=q("__util"),z=q("__version"),c=q("__geometry"),x=q("__vec3"),I=[1,1,1,1],B=[1,1,1,1],G=[0,0,0,1],A=[0,0,0,0],J=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var t=null,h=null,C=null,k=null,F=null,D=null,aa=new Float32Array(3),M=m.create(),L=new Uint8Array(4),T=n.A;a.jf=function(a){var b=T.background_color;a.clearColor(b[0],b[1],
b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);t=a};a.Tl=function(a){if(a.Lb)if(a.type==p.zl){r.bx(a);var c=a.p;t.bindFramebuffer(t.READ_FRAMEBUFFER,c.Io);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,c.xe);var h=0;c.bc&&(h|=t.COLOR_BUFFER_BIT);c.ue&&(h|=t.DEPTH_BUFFER_BIT);t.blitFramebuffer(0,0,c.width,c.height,0,0,c.width,c.height,h,t.NEAREST);r.cx(a);r.Gu("draw resolve")}else if(a.type==
p.Ut)r.bx(a),c=a.p,t.bindFramebuffer(t.FRAMEBUFFER,c.Io),t.bindTexture(t.TEXTURE_2D,c.bc.ib),t.copyTexSubImage2D(t.TEXTURE_2D,0,0,0,0,0,c.width,c.height,0),r.cx(a),r.Gu("draw copy");else{r.bx(a);c=a.p;t.bindFramebuffer(t.FRAMEBUFFER,c.xe);a.pu&&(h=c.bc,t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,h.eb,h.ib,0));t.viewport(0,0,c.width,c.height);a.type!=p.Sc&&a.type!=p.me&&d(a);a.yb?t.enable(t.BLEND):t.disable(t.BLEND);a.sd?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST);switch(a.type){case p.Jc:t.enable(t.POLYGON_OFFSET_FILL);
t.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);t.cullFace(t.BACK);break;case p.nd:case p.Ne:t.disable(t.POLYGON_OFFSET_FILL);t.cullFace(t.FRONT);break;case p.Me:t.enable(t.POLYGON_OFFSET_FILL);t.polygonOffset(-4,-4);t.cullFace(t.BACK);break;case p.Ed:if(1<T.tc||T.VC){t.enable(t.POLYGON_OFFSET_FILL);t.polygonOffset(-2,-2);break}default:t.disable(t.POLYGON_OFFSET_FILL),t.cullFace(t.BACK)}if(a.type==p.Sc||a.type==p.me)for(var c=a.p,h=c.bc.ib,k=0;6>k;k++){var m=b(k);c.Ab=a.jk[k];
E.from_mat4(c.Ab,c.Je);f.Bu(c);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,m,h,0);d(a);for(var m=a.La,g=0;g<m.length;g++)for(var l=0;l<m[g].oa.length;l++){var n=m[g].oa[l];n.Lb=n.kv[k]}e(a)}else e(a);r.cx(a);r.Gu("draw subscene: "+p.Fx(a))}};a.clear=function(a){t.bindFramebuffer(t.FRAMEBUFFER,a.p.xe);d(a)};a.ou=function(a){var b=a.Kn;b.length=0;var d=a.ha,h=d.Cb,k=a.nb.attributes,f;for(f in k){var e=h[f],m=c.Mi(f),p=c.WL(f),l=c.nB(f);b.push({FE:m,Gr:p,ze:k[f],hz:e.offset*l,MA:1<e.frames?
e.length*l:0,Vb:e.Vb,hl:e.hl*l,xo:e.xo})}if("DEBUG"==z.type())for(f in h)m=c.Mi(f),b=c.BO(d.md,m),b=d.md[b],e=a.tb.ug+" | "+a.tb.Ye,m=h[f].length*h[f].frames*c.nB(f),r.XK(b.tK,e,f,m,f in k);T.lu&&g(a)};a.SH=g;a.YI=function(a){for(var b=v.Kv(),c=0;c<a.ke.length;c++)b.deleteVertexArray(a.ke[c]);a.ke.length=0};a.ZI=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.RH=l;a.dz=function(a){var b=a.nb,c=a.X;a=a.dd;t.useProgram(b.Zg);for(var d=0;d<c.length;d++)t.uniform1i(b.jl[a[d]],d)};
a.$w=function(a,b,c,d,h,k){d||(d=1);h||(h=1);k||(k=new Uint8Array(4*d*h));k.length!=4*d*h&&u.r("read_pixels(): Wrong storage");t.bindFramebuffer(t.FRAMEBUFFER,a);t.readPixels(b,c,d,h,t.RGBA,t.UNSIGNED_BYTE,k);t.bindFramebuffer(t.FRAMEBUFFER,null);return k};a.hQ=function(a){var b=a.nb;b.zs||(t.useProgram(b.Zg),b.op.length||l(b),b=b.Qw.u_cube_fog,b.$l(t,b.ze,null,a))};a.jO=function(a,b){var c=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,c);if(y.lm(a)){var d=a.le;t.framebufferRenderbuffer(t.FRAMEBUFFER,
t.COLOR_ATTACHMENT0,t.RENDERBUFFER,d)}else if(y.mm(a)){var h=a,d=h.ib,h=h.eb==t.TEXTURE_CUBE_MAP?t.TEXTURE_CUBE_MAP_NEGATIVE_Z:h.eb;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,h,d,0)}y.lm(b)?(d=b.le,t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,d)):y.mm(b)&&(h=b,d=h.ib,h=h.eb,t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,h,d,0));r.EI();t.bindFramebuffer(t.FRAMEBUFFER,null);return c};a.iO=function(a,b,c,d,h){null==a?(t.bindFramebuffer(t.FRAMEBUFFER,
a),t.viewport(0,0,d,h),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)):(y.lm(b)?t.deleteRenderbuffer(b.le):y.mm(b)&&t.deleteTexture(b.ib),y.lm(c)?t.deleteRenderbuffer(c.le):y.mm(c)&&t.deleteTexture(c.ib),t.deleteFramebuffer(a))};a.WS=function(){};a.DK=function(a,b,c,d,h,k){a=a.ib;t.viewport(0,0,c,c);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,b,a,0);b=w.Uu("FLIP_CUBEMAP_COORDS");a=b.nb;t.activeTexture(t.TEXTURE0);t.bindTexture(t.TEXTURE_2D,h);var f=h=0;c!=d&&(h=1/(6*d),f=1/(4*d));t.uniform1i(a.jl.u_tex_number,
k);t.uniform2fv(a.jl.u_delta,[h,f]);t.useProgram(a.Zg);D(b,0);t.bindTexture(t.TEXTURE_2D,null)};a.EK=function(a,b,c,d,h){t.bindFramebuffer(t.FRAMEBUFFER,d);d=a.ib;a=a.eb;t.bindTexture(a,d);t.viewport(0,0,b,c);t.texImage2D(a,0,t.RGBA,b,c,0,t.RGBA,t.UNSIGNED_BYTE,null);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,a,d,0);b=w.Uu("NONE");c=b.nb;t.activeTexture(t.TEXTURE0);t.bindTexture(a,h);t.useProgram(c.Zg);D(b,0);t.bindFramebuffer(t.FRAMEBUFFER,null);t.bindTexture(a,null)};a.cleanup=function(){};
a.LO=function(){var a=v.ZL(),b=v.Kv();T.Xy=a?!0:!1;T.lu=b?!0:!1;a?(h=function(b,c,d,h,k){a.drawElementsInstanced(b,c,d,h,k)},C=function(b,c){a.vertexAttribDivisor(b,c)},k=function(b,c,d,h){a.drawArraysInstanced(b,c,d,h)}):(h=function(a,b,c,d){t.drawElements(a,b,c,d)},C=function(){},k=function(a,b,c){t.drawArrays(a,b,c)});b?(F=function(a){b.bindVertexArray(a)},D=function(a,b){var c=a.ha;F(a.ke[b]);c.xf?h(c.mode,c.count,c.Bk,0,c.Gk):k(c.mode,0,c.count,c.Gk);F(null)}):D=function(a,b){for(var c=a.ha,
d=a.Kn,f=0;f<c.md.length;f++){t.bindBuffer(t.ARRAY_BUFFER,c.md[f].Dj);for(var e=0;e<d.length;e++){var m=d[e];m.FE==c.md[f].type&&(t.enableVertexAttribArray(m.ze),t.vertexAttribPointer(m.ze,m.Vb,m.Gr,m.Gr==t.FLOAT?!1:!0,m.hl,m.hz+m.MA*b),C(m.ze,m.xo))}}c.xf?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,c.xf),h(c.mode,c.count,c.Bk,0,c.Gk)):k(c.mode,0,c.count,c.Gk);for(f=0;f<d.length;f++)m=d[f],t.disableVertexAttribArray(m.ze)}};a.reset=function(){F=k=C=h=t=null}};b4w.module.__shaders=function(a,q){function e(a,b,c){var h=a.Gi;"string"==typeof c?(a=d(a,c))&&(c=a[1]):c=String(c);for(a=0;a<h.length;a++)if(h[a][0]==b){h[a][1]=c;break}}function d(a,b){for(var c=a.Gi,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var c=a+b;if(!(c in T)){var d=p(D.shaders_path,a),h=p(D.shaders_path,b),d=E(d),h=E(h),k;for(k in h)d[k]=h[k];h=[];for(k in d)h.push([k,d[k]]);T[c]=h}return T[c]}function g(a,b){return a+b}function l(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(g,0)}function w(a,b){var c=m(a.type),d=m(b.type),h=a.Tj,k=b.Tj;return c>d?-1:c<d?1:h>k?-1:h<k?1:0}function f(a){if(k.Sb){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=qa}else b=fa;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],Tj:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});return r(a,R,F.rs)}function n(a,b,c){a=a.split(";").map(function(a){return(a=a.match(O))&&{type:a[2],Tj:a[4]?parseInt(a[4]):
1}}).filter(function(a){return a});return r(a,b,c)}function r(a,b,d){function h(){for(var d=0;l<a.length;){var k=a[l];if(3!=m(k.type))break;d+=c(k.type)*k.Tj;l++}g=p+d;if(g>V)return!1;v(b,p,d,0,3);return!0}function k(){for(var d=V-g,h=d,f=d;l<a.length;){var e=a[l];if(2!=m(e.type))break;e=c(e.type)*e.Tj;if(e<=h)h-=e;else if(e<=f)f-=e;else return!1;l++}f=d-f;v(b,g,d-h,0,2);v(b,V-f,f,2,2);return!0}function f(){for(;l<a.length;){for(var h=a[l],h=c(h.type)*h.Tj,k=-1,e=d+1,m=-1,g=0;4>g;g++){var p=W;p[0]=
0;p[1]=1;var t;t=b;for(var n=g,H=h,K=p;ma<t.length&&15===t[ma];)ma++;for(;0<V&&15===t[V];)V--;if(V-ma<H)t=!1;else{for(var n=1<<n,F=0,r=-1,C=t.length+1,u=!1,da=ma;da<=V;da++)da<V&&!(t[da]&n)?u||(F=da,u=!0):(u&&(u=da-F,u>=H&&u<C&&(C=u,r=F)),u=!1);0>r?t=!1:(K[0]=r,K[1]=C,t=!0)}t&&p[1]<e&&(m=p[0],e=p[1],k=g)}if(0>k)return!1;v(b,m,h,k,1);l++}return!0}if(!a.length)return!0;for(var e=0;e<d;e++)b[e]=0;V=d;a.sort(w);var g=0,p=0,l=0;return function(){for(;l<a.length;){var d=a[l];if(4!=m(d.type))break;p+=c(d.type)*
d.Tj;l++}if(p>V)return!1;ma=p;v(b,0,p,0,4);return!0}()&&h()&&k()&&f()}function v(a,b,c,d,h){for(var k=0,f=0;f<h;f++)k|=1<<d+f;for(f=0;f<c;f++)a[b+f]|=k}function c(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function m(a){var b=0;switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":b=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":b=3;break;case "vec2":case "ivec2":case "bvec2":b=2;break;default:b=1}return b}
function p(a,b){var c=a+b;if(M[c])return M[c];if(L){var d=L[b];if(!d)return null;d=q("__gpp_parser").sT.parse(d)}else if(d=q("shader_texts")[b],!d)return null;return M[c]=d}function y(a,b){for(var c={},d=b.Gi||[],f=0;f<d.length;f++)c[d[f][0]]=[d[f][1]];for(f=0;f<b.ig.length;f++)c["USE_NODE_"+b.ig[f].id]=["1"];k.Sb?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],
c.GLSL_TEXTURE_PROJ=["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=k.io?["sampler2DShadow"]:["sampler2D"];for(var e in c)c[e][0].constructor!=String&&h.warn("Warning! The value of a directive '"+e+"' is not of type string.");return c}
function E(a){function b(a){"var"==a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=p(D.shaders_path,D.oD+a.o),c(a,b))}function c(a,b,d){if(a instanceof Array)for(var h=0;h<a.length;h++)c(a[h],b,d);else if(a instanceof Object&&a){b&&b(a);for(h in a)c(a[h],b,d);d&&d(a)}}var d={};c(a,b);return d}function u(a,b,c){function d(b){b=b.d;for(var c=0;c<b.length;c++){var k=b[c];switch(k.a){case "cond":a:for(var k=k.d,Z=0;Z<k.length;Z++){var t=k[Z];switch(t.a){case "if":case "elif":if(f(t.g)){d(t.h);break a}break;
case "else":d(t.h);break a;case "ifdef":t.c in v&&d(t.h);break;case "ifndef":t.c in v||d(t.h)}}break;case "include":k=k.o;Z=p(D.shaders_path,D.oD+k);r.push("include/"+k);d(Z);r.pop();break;case "var":break;case "define":v[k.c]=k.b;break;case "error":C.r("Shader error: #error "+k.b.join(" "));break;case "line":break;case "pragma":H.push("#pragma "+k.c+" "+k.b.join(" "));break;case "undef":delete v[k.c];break;case "warning":h.warn("Shader warning: #warning "+k.b.join(" "));break;case "extension":k=
l(k.b,v,F,!1);H.push("#extension "+k.join(" "));break;case "version":k=l(k.b,v,F,!1),H.push("#version "+k.join(" "));case "#":break;case "node":z[k.c]=k;break;case "nodes_global":k=n;for(Z=0;Z<k.length;Z++){var t=k[Z],X=z[t.id];if(X)for(var u=0,y=0;y<X.l.length;y++){var S=X.l[y];if("node_param"==S.a){var x;if("PARTICLE_INFO"==t.id&&S.e)if(1==v.PARTICLE_BATCH)switch(x=!1,u){case 0:x=G(t.Eb,"PART_INFO_IND")||G(t.Eb,"PART_INFO_AGE")||G(t.Eb,"PART_INFO_LT")||G(t.Eb,"PART_INFO_SIZE");break;case 1:x=G(t.Eb,
"PART_INFO_LOC");break;case 2:x=G(t.Eb,"PART_INFO_VEL");break;case 3:x=G(t.Eb,"PART_INFO_A_VEL");break;case 4:x=G(t.Eb,"PART_INFO_IND")}else x=!1;else x=!0;x&&(S=S.f.join(" ")+" ","vert"==a?S+=t.lh[u]:"frag"==a&&(S+=t.U[u],null!==t.Is[u]&&(S+="="+t.Is[u])),S+=";",g(m(S)));u++}}}break;case "nodes_main":k=n;for(Z=0;Z<k.length;Z++)if(t=k[Z],X=z[t.id]){u={};q=O=w=0;y=X;S=t;x=y;for(var J={},ka=0;ka<x.m.length;ka++){var B=x.m[ka];J[B.c]=[B.b.join("")]}x=J;for(J=0;J<S.Eb.length;J++)ka=S.Eb[J][0],ka in x&&
(x[ka]=[S.Eb[J][1]]);for(J=ka=0;J<y.l.length;J++)B=y.l[J],"node_out"==B.a&&(x["USE_OUT_"+B.c]=[-1<A.indexOf(S.Ua[ka])|0],ka++);y=x;S=t;x=X.l;J=u;ka=y;for(B=0;B<x.length;B++){var E=x[B];switch(E.a){case "node_in":var I=S.J[w];if(null!==S.Uv[w]){if(("MATERIAL_BEGIN"==S.id&&3===w||!ka.MATERIAL_EXT&&("MATERIAL_BEGIN"==S.id&&4===w||"MATERIAL_END"==S.id&&3===w||"MATERIAL_END"==S.id&&4===w||"MATERIAL_END"==S.id&&5===w)||"TEXTURE_COLOR"==S.id||"TEXTURE_NORMAL"==S.id)&&E.e){J[E.c]=S.Uv[w];w++;continue}var ma=
E.f.join(" ")+" ",ma=ma+(I+"="+S.Uv[w]+";");g(m(ma))}J[E.c]=I;w++;break;case "node_out":I=S.Ua[O];if(!E.e||-1<A.indexOf(I))ma=E.f.join(" ")+" ",ma+=I+";",g(m(ma)),J[E.c]=I;O++;break;case "node_param":"vert"==a?I=S.lh[q]:"frag"==a&&(I=S.U[q]),J[E.c]=I,q++}}H.push("{");e(t,X.j,u,y);H.push("}")}break;case "txt":g(k.b);break;default:C.r("Unknown element type: "+k.a)}}}function f(a,b){var c;c=l(a,v,F,!0,b);for(var d=[],k=0;k<c.length;k++)if(c[k]instanceof Object)switch(c[k].a){case "conditional_expr":var e=
d.pop(),m=d.pop();d.pop()?d.push(m):d.push(e);break;case "logical_or_expr":for(var m=d.pop(),g=0;g<c[k].i-1;g++)e=d.pop(),m=m||e;d.push(m);break;case "logical_and_expr":m=d.pop();for(g=0;g<c[k].i-1;g++)e=d.pop(),m=m&&e;d.push(m);break;case "logical_bitor_expr":m=d.pop();for(g=0;g<c[k].i-1;g++)m|=d.pop();d.push(m);break;case "logical_bitxor_expr":m=d.pop();for(g=0;g<c[k].i-1;g++)m^=d.pop();d.push(m);break;case "logical_bitand_expr":m=d.pop();for(g=0;g<c[k].i-1;g++)m&=d.pop();d.push(m);break;case "equal_expr":e=
d.pop();m=d.pop();d.push(m==e);break;case "non_equal_expr":e=d.pop();m=d.pop();d.push(m!=e);break;case "le_expr":e=d.pop();m=d.pop();d.push(m<=e);break;case "ge_expr":e=d.pop();m=d.pop();d.push(m>=e);break;case "l_expr":e=d.pop();m=d.pop();d.push(m<e);break;case "g_expr":e=d.pop();m=d.pop();d.push(m>e);break;case "left_shift_expr":m=d.pop();e=d.pop();d.push(m<<e);break;case "right_shift_expr":m=d.pop();e=d.pop();d.push(m>>e);break;case "add_expr":m=d.pop();e=d.pop();d.push(m+e);break;case "sub_expr":m=
d.pop();e=d.pop();d.push(m-e);break;case "mul_expr":m=d.pop();e=d.pop();d.push(m*e);break;case "div_expr":m=d.pop();e=d.pop();d.push(m/e);break;case "mod_expr":m=d.pop();e=d.pop();d.push(m%e);break;case "pre_inc_expr":case "post_inc_expr":e=d.pop();d.push(++e);break;case "pre_dec_expr":case "post_dec_expr":e=d.pop();d.push(--e);break;case "positive_expr":e=d.pop();d.push(+e);break;case "negative_expr":e=d.pop();d.push(-e);break;case "one_compl_expr":e=d.pop();d.push(~e);break;case "logic_negative_expr":e=
d.pop();d.push(!e);break;default:C.r("Unknown operation type: "+c[k].a)}else e=c[k],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(e)?(d.push(0),0!=e.indexOf("USE_NODE_")&&(m=r[r.length-1],m in u||(u[m]=[]),-1==u[m].indexOf(e)&&(u[m].push(e),h.error("Undefined directive '"+e+"' in shader '"+m+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[k]));1==d.length?c=d[0]:(C.r("Incorrect expression: "+c.join(" ")),c=void 0);return c}function e(a,b,c,d){for(var h=0;h<b.length;h++){var k=
b[h];switch(k.a){case "node_cond":a:for(var m=a,k=k.d,p=c,l=d,t=0;t<k.length;t++){var n=k[t];switch(n.a){case "node_if":case "node_elif":if(f(n.g,l)){e(m,n.j,p,l);break a}break;case "node_else":e(m,n.j,p,l);break a;case "node_ifdef":(n.c in v||n.c in l)&&e(m,n.j,p,l);break;case "node_ifndef":n.c in v||n.c in l||e(m,n.j,p,l)}}break;case "txt":m=[];for(p=0;p<k.b.length;p++)l=k.b[p],l in c?m.push(c[l]):m.push(l);g(m,d)}}}function m(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function g(b,c){var d=
b;k.Sb||"frag"!=a||(d=d.join(" "),S&&(d.match(/[^;]*;/)?(d=d.replace(/[^;]*;/,""),S=!1):d=""),d=d.replace(/GLSL_OUT [^;]*;/g,""),d.match(/GLSL_OUT(?:$| [^;]*)/)&&(d=d.replace(/GLSL_OUT(?:$| [^;]*)/,""),S=!0),d=d.replace(/ {2,}/g," "),d=(d=d.trim())?d.split(" "):[]);b=d;b.length&&(d=l(b,v,F,!1,c),H.push(d.join(" ")))}function l(a,b,c,d,h){var k=[];t(a,b,c,d,k,h);return k}function t(a,b,c,d,h,k){for(var e=0;e<a.length;e++){var f=a[e];if(k&&f in k)f=k[f];else if(f in b)f=b[f];else{h.push(f);continue}0==
f.length&&d?h.push(0):t(f,b,c,d,h,k)}}var n=c.ig,H=[],v=y(a,c),F={},r=[c[a]],u={},z={},A=[],x;for(x in n)for(var J in n[x].J)A.push(n[x].J[J]);var S=!1;d(b);var w=0,O=0,q=0;return H.join("\n")}function z(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function x(a){pa.deleteProgram(a.Zg);pa.deleteShader(a.Jt);pa.deleteShader(a.zr);delete aa[a.qx]}function I(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return B(a);case 2:return"vec2("+B(a[0])+","+B(a[1])+")";case 3:return"vec3("+
B(a[0])+","+B(a[1])+","+B(a[2])+")";case 4:return"vec4("+B(a[0])+","+B(a[1])+","+B(a[2])+","+B(a[3])+")";case 9:return"mat3("+B(a[0])+","+B(a[1])+","+B(a[2])+","+B(a[3])+","+B(a[4])+","+B(a[5])+","+B(a[6])+","+B(a[7])+","+B(a[8])+")";case 16:return"mat4("+B(a[0])+","+B(a[1])+","+B(a[2])+","+B(a[3])+","+B(a[4])+","+B(a[5])+","+B(a[6])+","+B(a[7])+","+B(a[8])+","+B(a[9])+","+B(a[10])+","+B(a[11])+","+B(a[12])+","+B(a[13])+","+B(a[14])+","+B(a[15])+")";default:C.r("Wrong glsl value dimension")}}function B(a){return a%
1?String(a):String(a)+".0"}function G(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var A=q("__assets"),J=q("__config"),t=q("__debug"),h=q("__print"),C=q("__util"),k=J.A,F=J.zh,D=J.be,aa={},M={},L=null,T={},N="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.gu=0;a.fF=1;a.eF=2;a.iF=4;a.hF=8;a.gF=16;a.ZE=32;var U=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,O=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,qa=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,fa=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
W=new Int16Array(2),R=null,ha=null,H=null,ma=0,V=0,ia=[],pa=null,ua=!1;a.jf=function(a){pa=a};a.aa=e;a.LL=d;a.JO=function(a){a.Gi=C.yh(b(a.ug,a.Ye));e(a,"PRECISION",J.A.precision);"highp"==J.A.precision?e(a,"EPSILON",I(1E-6)):e(a,"EPSILON",I(1E-4));e(a,"CONSTANTS_HACK",k.px|0);e(a,"SRGB",k.srgb_type);e(a,"COMPARED_MODE",k.io|0)};a.PS=function(a){return a.ug};a.JS=function(a){return a.Ye};a.GL=function(a){var b=JSON.stringify(a.ug)+JSON.stringify(a.Ye)+JSON.stringify(a.Gi)+JSON.stringify(a.ig),c=aa[b];
if(c)return c;var d=a.Ye,h=p(D.shaders_path,a.ug),d=p(D.shaders_path,d);if(!h||!d)return null;var h=u("vert",h,a),d=u("frag",d,a),c=0,e=l(d,U);a.ZD=e;e>F.pw&&(c|=1);R||(R=new Uint32Array(F.rs));ha||(ha=new Uint32Array(F.qs));H||(H=new Uint32Array(F.dp));n(d,ha,F.qs)||(c|=2);n(h,H,F.dp)||(c|=4);e=k.Sb?(h.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(h.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.ez=e;e>F.qw&&(c|=8);f(d)||(c|=16);a.status=c;if(0===
a.status){var c=pa,m=z(c,h,c.VERTEX_SHADER),g=z(c,d,c.FRAGMENT_SHADER),e=c.createProgram();c.attachShader(e,m);c.attachShader(e,g);c.linkProgram(e);for(var m={Jt:m,zr:g,Zg:e,attributes:{},jl:{},op:C.Fi(),Pw:C.Fi(),Qw:{},gp:!0,zs:!1,kE:C.Fi(),jE:C.Fi(),tb:C.yh(a),qx:b,rd:!0},v=c.getProgramParameter(e,c.ACTIVE_ATTRIBUTES),g=0;g<v;g++){var r=c.getActiveAttrib(e,g).name;m.attributes[r]=c.getAttribLocation(e,r)}v=c.getProgramParameter(e,c.ACTIVE_UNIFORMS);for(g=0;g<v;g++)r=c.getActiveUniform(e,g).name.split("[0]").join(""),
m.jl[r]=c.getUniformLocation(e,r);aa[b]=c=m;e=!pa.getShaderParameter(c.zr,pa.COMPILE_STATUS);m=!pa.getShaderParameter(c.Jt,pa.COMPILE_STATUS);g=!pa.getProgramParameter(c.Zg,pa.LINK_STATUS);e?t.PC(c.zr,b,d):m?t.PC(c.Jt,b,h):g&&t.pO(c.Zg,b,h,d);if(e||m||g)a.status|=32,c=null}else c=null;return c};a.aN=function(){ua=!1;if(b4w.module_check("shader_texts"))ua=!0;else{for(var a=[],b=A.AT_TEXT,c=0;c<N.length;c++){var d=C.ip(D.shaders_path+N[c]);a.push({id:N[c],type:b,url:d})}b=function(a,b){L||(L={});L[b]=
a};a.length?A.enqueue(a,b,function(){ua=!0}):h.error("Shaders have not been found.")}};a.Rz=function(){return ua};a.lS=function(){return ia};a.aB=function(){return aa};a.cleanup=function(){for(var a in aa)x(aa[a]);for(var b in M)delete M[b];for(var c in ia)delete ia[c];H=ha=R=null;T={}};a.XI=x;a.mS=function(a){var b=a.Gi;h.log("Shader: "+a.ug+" "+a.Ye+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)h.log("  "+b[a][0],b[a][1])};a.F=I;a.Sz=function(a,b){return b in a.jl?!0:!1};a.reset=
function(){pa=null}};b4w.module.__geometry=function(a,q){function e(){return{length:0,frames:1,Vb:0,hl:0,offset:0,xo:0}}function d(a,b){for(var c=b.a_tbn_quat,d=b.a_position,h=c.length,k=d.length,e=1;e<a.Wa.length;e++)for(var f=a.Wa[e].$e,m=a.Wa[e].To,f=f.a_position,g=0;g<k;g++)d[g]+=m*f[g];d=ia;for(e=0;e<h;e+=4){k=c.subarray(e,e+4);d.set(R.yl);for(g=1;g<a.Wa.length;g++)f=a.Wa[g].$e,m=a.Wa[g].To,m=fa.slerp(R.yl,f.a_tbn_quat,m,pa),fa.normalize(m,m),fa.multiply(m,d,d);fa.multiply(d,k,k)}}function b(a){return 65536<a.Ca?
O.dB()?!1:!0:!1}function g(a){return 0<a.ja.length?!0:!1}function l(a,b,c){if(!g(a))return a;c||qa.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ca*(b||1)+", will use drawArrays","color: #aa0");b=a.ja;c=a.Ca;var d=a.ma,h=a.V,k;for(k in d){var e=d[k],f=I(e,c);d[k]=w(b,e,f)}for(d=0;d<h.length;d++){var m=h[d];for(k in m)e=m[k],f=I(e,c),m[k]=w(b,e,f)}for(d=0;d<a.Wa.length;d++){k=a.Wa[d].$e;for(var p in k)e=k[p],f=I(e,c),k[p]=w(b,e,f)}a.Ca=b.length;a.ja=new Uint16Array(0);return a}
function w(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),h=0;h<a.length;h++)for(var k=a[h],e=0;e<c;e++)d[c*h+e]=b[c*k+e];return d}function f(){return{Ad:null,Db:k(),Bk:0,count:0,Cb:{},mode:0,kl:0,Nl:0,Pl:0,md:[],xf:null,Wa:null,Gk:1,rd:!0}}function n(a,b){var c=a.Cb[b];if(c){var d=T(b);return M(a.Db,d).subarray(c.offset,c.offset+c.length)}R.r("extract_array() failed; invalid name: "+b)}function r(b,c){var d,h;switch(c){case a.wl:case a.qq:d=ca.TRIANGLES;h=
ca.STATIC_DRAW;break;case a.yy:d=ca.POINTS;h=ca.STATIC_DRAW;break;case a.pq:d=ca.TRIANGLES;h=ca.DYNAMIC_DRAW;break;case a.$E:d=ca.POINTS;h=ca.DYNAMIC_DRAW;break;case a.aF:d=ca.LINES;h=ca.STATIC_DRAW;break;default:R.r("Wrong draw_mode")}b.mode=d;b.kl=h}function v(a,b,c){function d(a,b){h[a]||(h[a]=0);h[a]+=b}var h={},k;for(k in a[0]){var e=a[0][k],f=T(k);d(f,e.length*a.length)}for(k in b)e=b[k],f=T(k),d(f,e.length);if(c){a=c.fn.length;f=T("a_part_ts");d(f,4*a);f=T("a_part_r");d(f,4*a);b=c.Xk;for(k in b)f=
T(k),d(f,b[k].Vb*a);c=c.Sp;for(k in c)f=T(k),d(f,a)}return h}function c(a){a.Ad?(a.xf||(a.xf=ca.createBuffer()),ca.bindBuffer(ca.ELEMENT_ARRAY_BUFFER,a.xf),ca.bufferData(ca.ELEMENT_ARRAY_BUFFER,a.Ad,a.kl),a.Nl=a.Ad.byteLength):a.Nl=0;for(var b=a.Pl=0;b<a.Db.length;b++){var c=a.Db[b].type,d=D(a.md,c);-1==d&&(a.md.push({Dj:null,type:c,tK:R.aQ()}),d=a.md.length-1);c=a.md[d];c.Dj||(c.Dj=ca.createBuffer());ca.bindBuffer(ca.ARRAY_BUFFER,c.Dj);ca.bufferData(ca.ARRAY_BUFFER,a.Db[b].kh,a.kl);a.Pl+=a.Db[b].kh.byteLength}}
function m(a,b){a.K=U.yi(a.K,b);a.O=U.Gl(a.O,b);a.da=U.Hl(a.da,b);a.qd=U.yu(a.qd,b)}function p(a){for(var b=a[0],c=a[0],d=C("JOIN_"+a.length+"_SUBMESHES"),h=0,k=0;k<a.length;k++)h+=a[k].ja.length;d.ja=new Uint32Array(h);var e=h=0;if(0<a[0].Wa.length)for(var f=0;f<a[0].Wa.length;f++){for(k=0;k<a.length;k++)h+=a[k].Wa[f].$e.a_position.length,e+=a[k].Wa[f].$e.a_tbn_quat.length;k={a_position:new Float32Array(h),a_tbn_quat:new Float32Array(e)};d.Wa.push({To:a[0].Wa[f].To,$e:k})}for(k=h=0;k<a.length;k++)h+=
a[k].Ca;d.Ca=h;for(var m in c.ma){for(k=h=0;k<a.length;k++)h+=a[k].ma[m].length;d.ma[m]=new Float32Array(h)}for(m in c.V[0]){for(k=h=0;k<a.length;k++)h+=a[k].V[0][m].length;for(k=0;k<c.V.length;k++)d.V[k]=d.V[k]||{},d.V[k][m]=new Float32Array(h)}k=d.kf;k.K=U.Il(b.kf.K);e=h=0;f=[];for(c=0;c<a.length;c++){var g=a[c],p=g.ja,l=g.Ca,t=g.ma;m=g.kf.da;U.rr(k.K,g.kf.K);U.CA(k.da,m);U.sv(g.kf.qd,f);for(m=0;m<p.length;m++)d.ja[h+m]=p[m]+e;var h=h+p.length,n;for(n in t){var p=t[n],H=e*I(p,l);d.ma[n].set(p,H)}for(m=
0;m<g.V.length;m++){var t=g.V[m],v=d.V[m];for(n in t)p=t[n],H=e*I(p,l),v[n].set(p,H)}e+=l}k.O=U.br(R.f32(f),!0);if(0<d.Wa.length)for(c=0;c<d.Wa.length;c++)for(n=d.Wa[c].$e,m=h=k=0;m<a.length;m++)e=a[m].Wa[c].$e,n.a_position.set(e.a_position,k),n.a_tbn_quat.set(e.a_tbn_quat,h),k+=e.a_position.length,h+=e.a_tbn_quat.length;a[0].cf&&(d.cf={fn:b.cf.fn,mt:b.cf.mt,HD:!0,Sp:b.cf.Sp,Xk:b.cf.Xk,nr:b.cf.nr});return d}function y(a,b,c){b=b.kf;for(var d=U.Wc(),h=U.cr(),k=[],e=0;e<c.length;e++)U.yi(a.kf.K,c[e],
d),U.rr(b.K,d),U.yu(a.kf.qd,c[e],h),U.sv(h,k);b.O=U.br(R.f32(k),!0);b.qd=U.iJ(b.O);b.da=U.Jl(b.O)}function E(a,b,c,d,h,k){var e=a.submeshes[b],f=e.base_length,m=C("SUBMESH_"+a.name+"_"+a.materials[b].name);m.Ca=f;var g=!1;if(z(c,"a_texcoord")){var p=null,t=a.materials[b];b=a.submeshes[b];if(t.texture_slots.length)switch(t=t.texture_slots[0],t.texture_coords){case "UV":t=a.uv_textures.indexOf(t.uv_layer);0==t?p=new Float32Array(b.texcoord):1==t&&(p=new Float32Array(b.texcoord2));break;case "ORCO":for(var n=
a.b4w_boundings.bb_src,p=new Float32Array(2*b.base_length),t=(n.max_x+n.min_x)/2,H=(n.max_y+n.min_y)/2,v=n.max_x-n.min_x,n=n.max_y-n.min_y,F=0,r=0;r<b.position.length;r+=3)p[F++]=(b.position[r]-t)/v+.5,p[F++]=(b.position[r+1]-H)/n+.5}null===p&&(p=new Float32Array(2*b.base_length));b=p}else b=new Float32Array(0);if(z(c,"a_orco_tex_coord")){p=a.b4w_boundings.bb_src;t=new Float32Array(3*e.base_length);H=p.max_x-p.min_x;v=p.max_y-p.min_y;n=p.max_z-p.min_z;for(r=F=0;r<e.position.length;r+=3)0==H?t[F++]=
.5:t[F++]=R.clamp(parseFloat(((e.position[r]-p.min_x)/H).toFixed(5)),0,1),0==v?t[F++]=.5:t[F++]=R.clamp(parseFloat(((e.position[r+1]-p.min_y)/v).toFixed(5)),0,1),0==n?t[F++]=.5:t[F++]=R.clamp(parseFloat(((e.position[r+2]-p.min_z)/n).toFixed(5)),0,1);p=t}else p=new Float32Array(0);t=e.group;if(z(c,"a_influence")&&d){H=new Float32Array(4*f);v=t.length/f;n=new Float32Array(v);for(F=0;F<v;F++){n[F]=-1;for(var y in d)if(r=d[y],r.KE===F){n[F]=r.ev;break}}var A=3<v?v:4;d=new Float32Array(A);y=new Uint32Array(A);
for(var F=new Float32Array(4),r=new Float32Array(A),A=new Uint32Array(A),S=new Float32Array(4),G=0;G<f;G++)d.set(r),y.set(A),F.set(S),H.set(x(t,v,G,f,n,d,y,F),4*G)}else H=new Float32Array(0);d=H;h=h?R.P(h):{};h.a_color={zk:!0};h.a_color.src=z(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,zf:7}]:[];m.ma.a_texcoord=b;m.ma.a_influence=d;m.ma.a_orco_tex_coord=p;d=m.ma;y=e.vertex_colors;b=e.color;p=a.name;t=[];for(H=0;H<y.length;H++)t.push(y[H].name);for(var w in h)if(H=h[w].src,H.length){for(n=
v=0;n<H.length;n++)v+=R.$k(H[n].zf);d[w]=new Float32Array(v*f);for(n=F=0;n<H.length;n++){var D=H[n].name,r=H[n].zf,A=R.RC(r),O=t.indexOf(D);-1==O&&R.r('vertex color "'+D+'" for mesh "'+p+'" not found.');S=y[O].mask;G=R.$k(S);(r&S)!==r&&qa.error("Wrong color extraction from "+D+" to "+w+".");for(var ba=D=0;ba<O;ba++)D+=R.$k(y[ba].mask);O=D*f;for(D=0;D<f;D++)for(ba=0;3>ba;ba++)A[ba]&&(d[w][D*v+(F+R.Km(r,ba))]=b[O+D*G+R.Km(S,ba)]);F+=G}}else d[w]=new Float32Array(0);w=a.uv_textures;h=e.texcoord;d=e.texcoord2;
y=m.ma;if(k)for(var la in k){b=w.indexOf(la);if(0==b)var Z=new Float32Array(h);else 1==b&&(Z=new Float32Array(d));y[k[la]]=Z}m.ja=new Uint32Array(e.indices);la=e.position.length/f/3;Z=z(c,"a_tbn_quat")&&e.tbn_quat.length?!0:!1;w=z(c,"a_shade_tangs")&&e.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(g=!0);for(h=0;h<la;h++){k=u(e,f,Z,w,h);if(g)if(d={},d.name=a.b4w_shape_keys[h].name,m.Wa.push(d),0!=h){d.$e=k;d.To=a.b4w_shape_keys[h].value;continue}else d.$e=u(e,f,Z,w,h),d.To=1;m.V.push(k)}if(1<
la&&!g){a=m.V[0];k={};for(var rb in a)k[rb]=new Float32Array(a[rb]);m.V.push(k)}z(c,"a_polyindex")&&(l(m,1,!0),m.ma.a_polyindex=J(m));e=e.boundings;c=m.kf;c.K=U.Wc();c.K.max_x=e.bb.max_x;c.K.max_y=e.bb.max_y;c.K.max_z=e.bb.max_z;c.K.min_x=e.bb.min_x;c.K.min_y=e.bb.min_y;c.K.min_z=e.bb.min_z;rb=e.rbb;a=e.caxis_x;f=e.caxis_y;g=e.caxis_z;k=e.be_ax;c.O=U.On(a,f,g,e.be_cen);ha.scale(c.O.za,k[0],c.O.za);ha.scale(c.O.Aa,k[1],c.O.Aa);ha.scale(c.O.Ba,k[2],c.O.Ba);c.da=U.Jl(c.O);ha.copy(rb.rbb_c,c.qd.D);ha.copy(a,
c.qd.za);ha.copy(f,c.qd.Aa);ha.copy(g,c.qd.Ba);e=rb.rbb_s;ha.scale(c.qd.za,e[0],c.qd.za);ha.scale(c.qd.Aa,e[1],c.qd.Aa);ha.scale(c.qd.Ba,e[2],c.qd.Ba);return m}function u(a,b,c,d,h){var k={},e=new Float32Array(3*b),f=new Float32Array(c?4*b:0),m=h*b*3;e.set(a.position.subarray(m,m+3*b),0);c&&(m=h*b*4,f.set(a.tbn_quat.subarray(m,m+4*b),0));d&&(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),0),k.a_shade_tangs=c);k.a_position=e;k.a_tbn_quat=f;return k}function z(a,b){return-1<a.indexOf(b)?
!0:!1}function x(b,c,d,h,k,e,f,m){for(var g=!0,p=0;p<c;p++){var l=b[p*h+d];if(-1!==l){var t=k[p];-1!==t&&(e[p]=l,f[p]=t,g=!1)}}if(g)return m;B(e,f,a.eu,!1);for(p=b=0;4>p;p++)b+=e[p];if(.01>b)return m;for(p=0;4>p;p++)e[p]/=b;if(.01>Math.abs(e[0]-1))m[0]=f[0]+1;else for(p=0;4>p;p++)m[p]=f[p]+e[p];return m}function I(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&R.r("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return d}function B(b,c,d,h){for(var k=
b.length,e=k,f=!1,m=h?-1:1;1<e||f;){1<e&&(e=Math.floor(e/1.247330950103979));for(var f=!1,g=0;e+g<k;g++)if(d==a.eu?0>m*(b[g]-b[g+e]):b[g]<b[g+e]&&h)f=b[g],b[g]=b[g+e],b[g+e]=f,f=c[g],c[g]=c[g+e],c[g+e]=f,f=!0}}function G(a,b,c){var d=[],h=[];ha.subtract(b,a,d);ha.subtract(c,a,h);ha.normalize(d,d);ha.normalize(h,h);a=R.clamp(ha.dot(d,h),-1,1);return Math.acos(a)}function A(a,b,c){if(g(b)){b=b.ja;for(var d=b.length/3,h=0;h<d;h++){var k=new Float32Array(9),e=b[3*h];k[0]=a[3*e];k[1]=a[3*e+1];k[2]=a[3*
e+2];e=b[3*h+1];k[3]=a[3*e];k[4]=a[3*e+1];k[5]=a[3*e+2];e=b[3*h+2];k[6]=a[3*e];k[7]=a[3*e+1];k[8]=a[3*e+2];c[h]=k}}else for(h=0;h<a.length;h++)k=new Float32Array(9),k[0]=a[9*h],k[1]=a[9*h+1],k[2]=a[9*h+2],k[3]=a[9*h+3],k[4]=a[9*h+4],k[5]=a[9*h+5],k[6]=a[9*h+6],k[7]=a[9*h+7],k[8]=a[9*h+8],c[h]=k;return c}function J(a){for(var b=new Float32Array(a.Ca),c=0;c<a.Ca;c++)b[c]=c%3/2;return b}function t(a,b,c){var d=ha.dist(a,b);a=ha.dist(a,c);b=ha.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function h(a){for(var b=
new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),d=0;d<a;d++)c.set(b,8*d);return c}function C(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};return{name:a,Ca:0,ja:null,V:[],ma:b,Wa:[],kf:{K:U.Wc(),O:U.Se(),da:U.Hg(),qd:U.cr()},cf:null}}function k(a){var b=[],c;for(c in a)b.push(F(c,a[c]));return b}function F(a,b){return{kh:new (L(a))(b),type:a}}function D(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function aa(a,
b){var c=D(a,b);return-1==c?null:a[c].Dj}function M(a,b){var c=D(a,b);return-1==c?null:a[c].kh}function L(a){switch(a){case "float":return Float32Array;case "short":return Int16Array;case "unsigned_byte":return Uint8Array;default:return Float32Array}}function T(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";
default:return"float"}}function N(a,b,c,d){var h=T(b);b=D(a,h);switch(h){case "float":a[b].kh.set(c,d);break;case "short":for(h=0;h<c.length;h++)a[b].kh[d+h]=R.Do(c[h]);break;case "unsigned_byte":for(h=0;h<c.length;h++)a[b].kh[d+h]=R.YP(c[h])}}var U=q("__boundings"),O=q("__extensions"),qa=q("__print"),fa=q("__quat"),W=q("__tsr"),R=q("__util"),ha=q("__vec3");new Float32Array(2);var H=new Float32Array(3),ma=new Float32Array(3),V=new Float32Array(3),ia=new Float32Array(4),pa=new Float32Array(4),ua=new Float32Array(8);
a.qq=10;a.yy=20;a.pq=30;a.$E=40;a.aF=50;a.eu=0;a.OG=1;a.wl=a.qq;var ca=null;a.TG="float";a.FR="short";a.GR="unsigned_byte";a.jf=function(a){ca=a};a.PD=function(a,h,m){b(a)&&l(a);var g=a.ja,p=a.Ca,t=a.V,n={},H;for(H in a.ma)H in m&&!m[H].zk||(n[H]=a.ma[H]);m=f();0<a.Wa.length&&d(a,t[0]);H=a.cf;if(g.length){var F=g.length;if(65536>=p)var g=new Uint16Array(g),u=ca.UNSIGNED_SHORT;else g=new Uint32Array(g),u=ca.UNSIGNED_INT}else F=p,g=null;for(var C=v(t,n,H),C=k(C),y={},A=0;A<C.length;A++)y[C[A].type]=
0;var z={},x;for(x in n){var G=n[x],J=G.length;if(J){var w=T(x),A=z[x]=e();A.length=J;A.Vb=I(G,p);A.offset=y[w];N(C,x,G,y[w]);y[w]+=J}}n=t.length;for(x in t[0])if(G=t[0][x],w=T(x),J=G.length,G=I(G,p),J)for(A=z[x]=e(),A.length=J,A.frames=n,A.Vb=G,A.offset=y[w],1<n&&(A=z[x+"_next"]=e(),A.length=J,A.frames=n,A.Vb=G,A.offset=y[w]+J),A=0;A<n;A++)G=t[A][x],w=T(x),N(C,x,G,y[w]),y[w]+=J;if(H){t=H.fn;x=H.mt;n=H.Xk;J=H.Sp;t=H.fn;x=H.mt;var n=H.Xk,J=H.Sp,w=H.HD,p={a_part_ts:{data:[],Vb:4},a_part_r:{data:[],
Vb:4}},D;for(D in n)p[D]={data:[],Vb:n[D].Vb};for(D in J)p[D]={data:[],Vb:1};for(G=0;G<t.length;G++){A=t[G];w&&x&&!H.nr&&(A=W.multiply(x,t[G],ua));!w&&H.nr&&ha.subtract(t[G],x,t[G]);p.a_part_ts.data.push(A[0],A[1],A[2],A[3]);p.a_part_r.data.push(A[4],A[5],A[6],A[7]);for(D in n)for(var A=n[D].Vb,S=0;S<A;S++)p[D].data.push(n[D].data[G*A+S]);for(D in J)p[D].data.push(J[D][0])}for(D in p)t=T(D),N(C,D,p[D].data,y[t]),x=e(),x.Vb=p[D].Vb,x.offset=y[t],x.xo=1,x.length=p[D].data.length,z[D]=x,y[t]+=x.length;
m.Gk=H.fn.length}m.count=F;m.Ad=g;m.Db=C;m.Bk=u;m.Cb=z;r(m,h);c(m);m.Wa=a.Wa;return m};a.KP=d;a.CM=b;a.BM=g;a.pt=l;a.mE=function(a,b,c){r(a,b);a.count=c.length;a.Ad=c;a.Bk=c instanceof Uint16Array?ca.UNSIGNED_SHORT:ca.UNSIGNED_INT};a.lE=function(a,b,d,h){var k=a.Cb,f=k[b],m=T(b);if(f)d&&f.Vb!=d&&R.r('invalid num_comp for "'+b+'"'),N(a.Db,b,h,f.offset);else{f=D(a.Db,m);-1==f&&(a.Db.push(F(m,0)),f=a.Db.length-1);var m=a.Db[f].kh,g=new m.constructor(m.length+h.length);g.set(m);a.Db[f].kh=g;N(a.Db,b,
h,m.length);b=k[b]=e();b.Vb=d;b.offset=m.length;b.length=h.length}c(a)};a.RK=n;a.lT=function(a){a.kl=ca.STATIC_DRAW};a.lN=function(a){a.kl=ca.DYNAMIC_DRAW};a.dy=c;a.VI=function(a){a.xf&&ca.deleteBuffer(a.xf);for(var b=0;b<a.md.length;b++)a.md[b].Dj&&ca.deleteBuffer(a.md[b].Dj);a.md.length=0};a.vB=function(a,b){return a.submeshes[b].base_length?!1:!0};a.ot=function(a,b){for(var c=0;c<a.V.length;c++){var d=a.V[c].a_position;W.transform_vectors(d,b,d,0);d=a.V[c].a_tbn_quat;0<d.length&&W.iE(d,b,d,0);
(d=a.V[c].a_shade_tangs)&&0<d.length&&W.transform_dir_vectors(d,b,d,0)}(c=a.ma.au_center_pos)&&c.length&&W.transform_vectors(c,b,c,0);m(a.kf,b);return a};a.JP=function(a,b){var c=a.ma.au_center_pos;if(c&&c.length){var d=new Float32Array(c);W.transform_vectors(d,b,d,0);for(var h=0;h<a.V.length;h++)for(var k=0;k<d.length;k++)a.V[h].a_position[k]+=d[k]-c[k];c.set(d)}else R.r('Attribute "au_center_pos" is missing in particle submesh');m(a.kf,b)};a.gI=m;a.IP=function(a,b){var c=a.Ca,d;for(d in b){var h=
b[d].length;a.ma[d]=new Float32Array(h*c);for(var k=0;k<c;k++)for(var e=0;e<h;e++)a.ma[d][k*h+e]=b[d][e]}};a.OD=p;a.kN=function(a,b,c){if(!a.Ca)return C("EMPTY");var d=c.length;65536<a.Ca*d&&!O.dB()&&l(a,d);var h=a.ja,k=a.Ca,e=a.ma,f=a.V,m;for(m in b){var g=b[m].length,p=g*k;e[m]=new Float32Array(p);for(var t=0;t<k;t++)for(p=0;p<g;p++)e[m][t*g+p]=b[m][p]}b=C("CLONE_"+d+"_SUBMESHES");b.Ca=k*d;b.ja=new Uint32Array(h.length*d);for(t=0;t<d;t++)for(g=h.length*t,m=k*t,p=0;p<h.length;p++)b.ja[g+p]=h[p]+
m;for(var n in e)for(h=e[n],p=h.length*d,g=I(h,k),b.ma[n]=new Float32Array(p),t=0;t<d;t++)m=k*g*t,b.ma[n].set(h,m);for(n in f[0])for(t=0;t<f.length;t++)for(h=f[t][n],p=h.length*d,g=I(h,k),b.V[t]=b.V[t]||{},b.V[t][n]=new Float32Array(p),p=0;p<d;p++)switch(e=c[p],m=k*g*p,n){case "a_position":W.transform_vectors(h,e,b.V[t][n],m);break;case "a_tbn_quat":W.iE(h,e,b.V[t][n],m);break;case "a_shade_tangs":W.transform_tangents(h,e,b.V[t][n],m);break;default:R.r("Wrong attribute name: "+n)}y(a,b,c);return b};
a.Cz=y;a.tv=E;a.TK=function(a){var b=a.Ca,c=a.V[0].a_position,d=new Float32Array(12*b);a=new Uint32Array(4*a.ja.length);for(var k=new Float32Array(4*b),e=0;e<b;e++){d[12*e]=c[3*e];d[12*e+1]=c[3*e+1];d[12*e+2]=c[3*e+2];d[12*e+3]=c[3*e];d[12*e+4]=c[3*e+1];d[12*e+5]=c[3*e+2];d[12*e+6]=c[3*e];d[12*e+7]=c[3*e+1];d[12*e+8]=c[3*e+2];d[12*e+9]=c[3*e];d[12*e+10]=c[3*e+1];d[12*e+11]=c[3*e+2];a[6*e]=4*e+2;a[6*e+1]=4*e+1;a[6*e+2]=4*e;a[6*e+3]=4*e+2;a[6*e+4]=4*e;a[6*e+5]=4*e+3;var f=Math.random();k[4*e]=f;k[4*
e+1]=f;k[4*e+2]=f;k[4*e+3]=f}c=C("HALO");c.V[0]={};c.Ca=4*b;c.V[0].a_position=d;c.ma.a_halo_bb_vertex=h(b);c.ma.a_random_vals=k;c.ja=a;return c};a.lM=z;a.GA=function(a,b,c){for(var d=[],h=0;h<a.submeshes.length;h++){var k=E(a,h,b,null,c,null);k.Ca&&d.push(k)}return 0==d.length?C("EMPTY"):1==d.length?d[0]:p(d)};a.kQ=function(a,b,c,d){var h=a.Ad,k=n(a,"a_position"),e=b.uN,f=b.vN;b=b.AK;for(var m=h,g=m.length/3,p=0;p<g;p++){var l=m[3*p],t=m[3*p+1],H=m[3*p+2],v=k[3*l+1],F=k[3*l+2],r=k[3*t+1],u=k[3*t+
2],C=k[3*H+1],y=k[3*H+2];e[3*p]=(k[3*l]+k[3*t]+k[3*H])/3;e[3*p+1]=(v+r+C)/3;e[3*p+2]=(F+u+y)/3}W.transform_vectors(e,c,f);c=f.length/3;for(k=0;k<c;k++)e=f[3*k]-d[0],m=f[3*k+1]-d[1],g=f[3*k+2]-d[2],b[k]=e*e+m*m+g*g;d=h;h=b.length;if(!(2>h))for(f=h,k=!1;1<f||k;)for(1<f&&(f=Math.floor(f/1.247330950103979)),k=!1,c=0;f+c<h;c++)0>b[c]-b[c+f]&&(k=b[c],b[c]=b[c+f],b[c+f]=k,k=d,e=c,m=c+f,g=k[3*e],p=k[3*e+1],l=k[3*e+2],k[3*e]=k[3*m],k[3*e+1]=k[3*m+1],k[3*e+2]=k[3*m+2],k[3*m]=g,k[3*m+1]=p,k[3*m+2]=l,k=!0);h=
d;ca.bindBuffer(ca.ELEMENT_ARRAY_BUFFER,a.xf);ca.bufferData(ca.ELEMENT_ARRAY_BUFFER,h,ca.DYNAMIC_DRAW)};a.AD=B;a.Az=function(a,b,c){for(var d=b.length/3,h=a.length/3,k=[],e=Array(3),f=Array(3),m=Array(3),g=0;g<h;g++){for(var p=a[3*g],l=a[3*g+1],t=a[3*g+2],n=0;3>n;n++)e[n]=b[3*p+n],f[n]=b[3*l+n],m[n]=b[3*t+n];if(c)var n=G(e,f,m),H=G(f,m,e),v=Math.PI-n-H;else v=H=n=1;var F=k,r;r=e;var u=m,C=[],y=[],A=[];ha.subtract(f,r,C);ha.subtract(u,r,y);ha.cross(C,y,A);ha.normalize(A,A);r=A;for(u=0;3>u;u++)C=3*
l+u,y=3*t+u,F[3*p+u]=n*r[u],F[C]=H*r[u],F[y]=v*r[u]}if(c)for(var z in c)for(g=c[z],a=0;3>a;a++){b=3*g[0]+a;for(h=1;h<g.length;h++)e=3*g[h]+a,k[b]+=k[e];for(h=1;h<g.length;h++)e=3*g[h]+a,k[e]=k[b]}for(g=0;g<d;g++){c=g;z=k;a=new Float32Array(3);for(b=0;3>b;b++)h=3*c+b,a[b]=z[h];ha.normalize(a,a);for(b=0;3>b;b++)h=3*c+b,z[h]=a[b]}return k};a.Bz=function(a,b,c){for(var d={},h=b.length/3,k=0;k<h;k++){var e=String(b[3*k])+String(b[3*k+1])+String(b[3*k+2]);d[e]=[]}h=a.length;for(k=0;k<h;k++)b=a[k],e=String(c[3*
b])+String(c[3*b+1])+String(c[3*b+2]),e in d&&d[e].push(b);return d};a.yv=function(a,b,c,d){var h;h=null;h=[];h=A(a.V[0].a_position,a,h);if(c){var k;k=null;k=[];for(var e=a.V[0].a_tbn_quat,f=e.length/4,m=new Float32Array(3*f),g=0;g<f;g++){var p=ia;p[0]=e[4*g];p[1]=e[4*g+1];p[2]=e[4*g+2];p[3]=e[4*g+3];p=ha.transformQuat(R.AXIS_Y,p,H);m[3*g]=p[0];m[3*g+1]=p[1];m[3*g+2]=p[2]}k=A(m,a,k)}f=h.length;m=new Float32Array(f);for(a=0;a<f;a++)g=h[a],H.set(g.subarray(0,3)),ma.set(g.subarray(3,6)),V.set(g.subarray(6)),
m[a]=Math.sqrt(t(H,ma,V));e=new Float32Array(f);e[0]=m[0];for(a=1;a<f;a++)e[a]=e[a-1]+m[a];f=e[m.length-1];m=[];for(a=0;a<b;a++){var g=f*R.Ff(d),g=R.Nq(e,g,0,e.length-1),l=g=c?k[g]:h[g],n=d;(g=H)||(g=new Float32Array(3));var p=l[0],v=l[1],F=l[2],r=l[3],u=l[4],C=l[5],y=l[6],S=l[7],z=l[8],l=R.Ff(n),n=R.Ff(n);1<l+n&&(l=1-l,n=1-n);var x=1-l-n,v=x*v+l*u+n*S,F=x*F+l*C+n*z;g[0]=x*p+l*r+n*y;g[1]=v;g[2]=F;c?(m[a]=new Float32Array(4),ha.normalize(g,g),g=fa.rotationTo(R.AXIS_Y,g,ia),m[a][0]=g[0],m[a][1]=g[1],
m[a][2]=g[2],m[a][3]=g[3]):(m[a]=new Float32Array(3),m[a][0]=g[0],m[a][1]=g[1],m[a][2]=g[2])}return m};a.sr=J;a.QT=t;a.QA=h;a.WC=function(a,b,c){a=a.V[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.az=function(a,b,c){var d=a.G[0].T;a=a.k.bh;for(var h=1;h<a.length;h++)a[h].name==b&&(a[h].value=c);for(h=0;h<d.length;h++)if(!d[h].uf&&d[h].je&&!d[h].Dh){b=d[h].ha;var k=T("a_position");c=aa(b.md,k);k=M(b.Db,k);ca.bindBuffer(ca.ARRAY_BUFFER,
c);var e=b.Cb.a_position;c=d[h];var f=a;if(e){for(var m=e.offset,e=e.length+m,g=c.ha.Wa[0].$e.a_position,p=m;p<e;p++)k[p]=g[p-m];for(p=1;p<c.ha.Wa.length;p++){var g=c.ha.Wa[p].$e.a_position,l=f[p].value;if(l)for(var t=m;t<e;t++)k[t]+=l*g[t-m]}ca.bufferSubData(ca.ARRAY_BUFFER,R.ni*m,k.subarray(m))}k=T("a_tbn_quat");c=aa(b.md,k);k=M(b.Db,k);ca.bindBuffer(ca.ARRAY_BUFFER,c);m=b.Cb.a_tbn_quat;b=d[h];c=k;k=a;if(m){f=m.offset;m=m.length+f;e=b.ha.Wa[0].$e.a_tbn_quat;p=ia;for(g=f;g<m;g+=4){p[0]=0;p[1]=0;
p[2]=0;for(l=p[3]=1;l<b.ha.Wa.length;l++){var t=b.ha.Wa[l].$e.a_tbn_quat,n=k[l].value;if(n){var H=pa;H[0]=t[g-f];H[1]=t[g+1-f];H[2]=t[g+2-f];H[3]=t[g+3-f];t=fa.slerp(R.yl,H,n,pa);fa.multiply(t,p,p)}}l=pa;l[0]=e[g-f];l[1]=e[g-f+1];l[2]=e[g-f+2];l[3]=e[g-f+3];t=0<l[3];fa.multiply(p,l,l);(0<l[3]&&!t||0>l[3]&&t)&&fa.scale(l,-1,l);c[g]=R.Do(l[0]);c[g+1]=R.Do(l[1]);c[g+2]=R.Do(l[2]);c[g+3]=R.Do(l[3])}ca.bufferSubData(ca.ARRAY_BUFFER,R.ni*f,c.subarray(f))}}};a.check_shape_keys=function(a){return a.k.je};
a.get_shape_keys_names=function(a){var b=[];if(a.k)for(var c=1;c<a.k.bh.length;c++)b.push(a.k.bh[c].name);return b};a.get_shape_key_value=function(a,b){if(a.k)for(var c=1;c<a.k.bh.length;c++)if(b==a.k.bh[c].name)return a.k.bh[c].value;return 0};a.Qv=function(a,b){var c=a.k.bh;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.dm=function(a){return a&&a.k&&a.k.ve?!0:!1};a.draw_line=function(b,d,h){var e=b.ha;if(e){for(var f=h?d.length/3/2:d.length/3-1,m=new Float32Array(12*f),g=new Float32Array(12*
f),p=new Uint16Array(6*f),l=0;l<f;l++){if(h)var t=6*l,n=6*l+3;else t=3*l,n=3*(l+1);var H=d[t],v=d[t+1],t=d[t+2],F=d[n],r=d[n+1],n=d[n+2],u=F-H,C=r-v,y=n-t;m[12*l]=H;m[12*l+1]=v;m[12*l+2]=t;g[12*l]=u;g[12*l+1]=C;g[12*l+2]=y;m[12*l+3]=F;m[12*l+4]=r;m[12*l+5]=n;g[12*l+3]=-u;g[12*l+4]=-C;g[12*l+5]=-y;m[12*l+6]=H;m[12*l+7]=v;m[12*l+8]=t;g[12*l+6]=-u;g[12*l+7]=-C;g[12*l+8]=-y;m[12*l+9]=F;m[12*l+10]=r;m[12*l+11]=n;g[12*l+9]=u;g[12*l+10]=C;g[12*l+11]=y;p[6*l]=4*l;p[6*l+1]=4*l+1;p[6*l+2]=4*l+2;p[6*l+3]=4*
l;p[6*l+4]=4*l+3;p[6*l+5]=4*l+1}h=0;for(var A in e.Cb)d=e.Cb[A],h+=m.length/3*d.Vb;d={};d["float"]=h;h=e.Db=k(d);a.mE(e,b.Xf,p);b=0;for(A in e.Cb)switch(d=e.Cb[A],A){case "a_position":N(h,A,m,b);d.offset=b;d.length=m.length;b+=d.length;break;case "a_direction":N(h,A,g,b);d.offset=b;d.length=g.length;b+=d.length;break;default:d.offset=b,d.length=m.length/3*d.Vb,p=new Float32Array(d.length),N(h,A,p,b),b+=d.length}c(e)}};a.$I=function(a){var b=f();if(a.Ad)switch(a.Bk){case ca.UNSIGNED_SHORT:b.Ad=new Uint16Array(a.Ad);
break;case ca.UNSIGNED_INT:b.Ad=new Uint32Array(a.Ad)}else b.Ad=null;for(var c=a.Db,d=[],h=0;h<c.length;h++){var k=c[h].kh,e=c[h].type;d.push({kh:new k.constructor(k),type:e})}b.Db=d;b.Bk=a.Bk;b.count=a.count;b.Cb=R.P(a.Cb);b.mode=a.mode;b.kl=a.kl;b.Nl=a.Nl;b.Pl=a.Pl;b.xf=null;b.Wr=R.P(a.Wr);b.Wa=R.P(a.Wa);b.Gk=a.Gk;b.rd=a.rd;return b};a.bf=C;a.reset=function(){ca=null};a.tM=k;a.BO=D;a.OS=aa;a.Fr=M;a.bB=L;a.Mi=T;a.nB=function(a){switch(T(a)){case "float":return R.ni;case "short":return R.yn;case "unsigned_byte":return R.Rt;
default:return R.ni}};a.WL=function(a){switch(T(a)){case "float":return ca.FLOAT;case "short":return ca.SHORT;case "unsigned_byte":return ca.UNSIGNED_BYTE;default:return ca.FLOAT}};a.iq=N};b4w.module.__objects=function(a,q){function e(a){var b=a.G;a=a.k;for(var c=0;c<b.length;c++){var d=b[c].mb;d.q.outline&&a.lg&&D.qO(d)}}function d(a){a.k.lg=0;a=pa.indexOf(a);-1!=a&&pa.splice(a,1)}function b(a){if(a.cH)return!0;a=a.nodes;for(var c=0;c<a.length;c++)if("GROUP"==a[c].type&&b(a[c].node_group.node_tree))return!0;return!1}function g(a){if(a.Wl)for(var b=a.G,c=0;c<b.length;c++)D.oE(b[c].mb,a)}function l(a,b){for(var c=a.G,d=b.G,h=0;h<c.length;h++){for(var k=!1,e=0;e<d.length;e++)if(c[h].mb==
d[e].mb){k=!0;break}k||w(b,c[h].mb)&&J.Gn(b,c[h].mb)}}function w(a,b){return!b.Qy&&"SPEAKER"==a.type||!b.dH&&("LAMP"==a.type||"CAMERA"==a.type)?!1:!0}function f(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.iu||a.parent&&a.parent.iu)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,d=a.b4w_collision,h=a.b4w_vehicle,k=a.b4w_floating,e=a.b4w_character,m=t.nM(a),f=G.wz(a),g=0<a.data.b4w_shape_keys.length,l=a.b4w_dynamic_geometry;if(!(c=p.xz(a,b)||c||d||h||g||k||m||e||f||l))a:{c=a.data;
for(d=0;d<c.materials.length;d++)if(h=c.materials[d],h.b4w_water||h.b4w_lens_flares||n(h.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=G.wz(a),d=a.b4w_do_not_batch,h=Boolean(a.b4w_anchor),p.xz(a,b)||c||d||h;default:return!0}}function n(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,h=c.convert_to,k=c.outputs[0];if(!(!k.is_linked||"WORLD"==d&&"CAMERA"==h||"CAMERA"==d&&"WORLD"==h||"OBJECT"==d&&"OBJECT"==h))return!0}if("NORMAL_MAP"==
c.type&&(d=c.space,k=c.outputs[0],k.is_linked&&("OBJECT"==d||"BLENDER_OBJECT"==d))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==c.type&&(k=c.outputs[1],d=c.outputs[3],c.outputs[0].is_linked||k.is_linked||d.is_linked))return!0}return!1}function r(a,b){var c=a.animation_data,d=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.q.type==p.OBJ_ANIM_TYPE_OBJECT||c.q.type==p.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==b.type||c.q.type==p.VF&&"LAMP"==b.type||c.q.type==p.UF&&"WORLD"==b.type)&&
b.Uf.push(p.zB(null,c)));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.Uf.push(p.zB(null,d.action));"MESH"==b.type&&b.Uf.push.apply(b.Uf,p.EL(a))}function v(a,b,c){b=ha[b]||[];for(var d=[],h=0;h<b.length;h++){var k=b[h];if(k.k.Fd==c||-1==c)for(var e=k.G,m=0;m<e.length;m++)e[m].mb==a&&d.push(k)}return d}function c(a,b,c,d,h){for(var k=null,e=0;e<b.length;e++){var m=b[e];if(!((c?m.Sk:m.name)!=a||m.k.Fd!=d&&-1!=d||h&&!m.zi||(k=m,J.get_dg_parent(k))))break}return k}function m(a){ha.ALL.push(a);
ha[a.type]||(ha[a.type]=[]);ha[a.type].push(a);var b=a.k.ce;if(null!=b)for(var c=0;c<ia.length;c++){var d=ia[c];d.k.ce==b&&d.Bp.push(a)}}var p=q("__animation"),y=q("__batch"),E=q("__boundings"),u=q("__camera"),z=q("__config"),x=q("__constraints"),I=q("__geometry"),B=q("__lights"),G=q("__nla"),A=q("__nodemat"),J=q("__obj_util"),t=q("__particles"),h=q("__physics"),C=q("__print"),k=q("__primitives"),F=q("__quat"),D=q("__scenes"),aa=q("__sfx"),M=q("__transform"),L=q("__textures"),T=q("__tsr"),N=q("__util"),
U=q("__vec3"),O=q("__armature"),qa=q("__anchors"),fa=q("__renderer"),W=z.A,R=z.nc,ha={ALL:[]},H=new Float32Array(24),ma=0,V=0,ia=[],pa=[],ua=new Float32Array(3),ca=new Float32Array(4);a.au=0;a.$t=1;a.yc=2;a.DATA_ID_ALL=-1;a.update=function(a){for(var b=0;b<pa.length;b++){var c=pa[b],h=c,k=a,m=0,f=h.tC;0==f.rt&&(f.rt=k);k-=f.rt;if(f.ax&&k/f.gf>=f.ax)d(h);else{k%=f.gf;if(k<f.Kw)switch(f=k/(f.Kw/5),k=Math.floor(f),k){case 0:m=(f-k)/2;break;case 1:m=(f-k)/2+.5;break;case 2:m=1;break;case 3:m=1-(f-k)/
2;break;case 4:m=.5-(f-k)/2}h.k.lg=m}c.k.lg&&e(c)}if(a=ha.ARMATURE)for(b=0;b<a.length;b++)c=a[b],c.Ew&&(M.B(c),c.Ew=!1)};a.set_outline_intensity=function(a,b){a.k.lg=b;e(a)};a.apply_outline_anim=function(a,b,c,d){var h=a.tC;h.rt=0;h.Kw=b;h.gf=c;h.ax=d;-1==pa.indexOf(a)&&pa.push(a)};a.clear_outline_anim=d;a.Cj=function(a,c){c.ji=a.uuid;c.zi=!0;r(a,c);a.iu=c.is_dynamic=f(a,c);a.eH=!0;c.ye=a.b4w_vehicle;c.is_character=a.b4w_character;c.Ik=a.b4w_floating;c.ml=a.b4w_collision;c.Kb=a.b4w_collision_id;c.ar=
a.b4w_correct_bounding_offset;var d=a.game;c.mg={pp:d.physics_type,cq:d.use_ghost,CE:d.use_sleep,Ug:d.mass,HE:d.velocity_min,GE:d.velocity_max,pA:d.damping,SC:d.rotation_damping,cN:d.lock_location_x,dN:d.lock_location_y,eN:d.lock_location_z,fN:d.lock_rotation_x,gN:d.lock_rotation_y,hN:d.lock_rotation_z,eo:d.collision_margin,bo:d.collision_group,fo:d.collision_mask,gy:d.use_collision_bounds,Wq:d.collision_bounds_type,Zp:d.use_collision_compound};if(d=a.b4w_vehicle_settings)c.He={name:d.name,Ae:d.part,
NP:d.suspension_rest_length,Hx:d.suspension_compression,Jx:d.suspension_stiffness,Ix:d.suspension_damping,qy:d.wheel_friction,gx:d.roll_influence,ow:d.max_suspension_travel_cm,Go:d.force_max,Rn:d.brake_max,Xm:d.steering_max,sm:d.max_speed_angle,so:d.delta_tach_angle,Pp:d.speed_ratio,Rp:d.steering_ratio,Vo:d.inverse_control,rk:d.floating_factor,rl:d.water_lin_damp,sl:d.water_rot_damp,TD:d.synchronize_position};if(d=a.b4w_floating_settings)c.Xl={name:d.name,Ae:d.part,rk:d.floating_factor,rl:d.water_lin_damp,
sl:d.water_rot_damp,TD:d.synchronize_position};if(d=a.b4w_character_settings)c.Mz={bR:d.walk_speed,yO:d.run_speed,HP:d.step_height,JM:d.jump_strength,dR:d.waterline};for(d=0;d<a.constraints.length;d++){var h=a.constraints[d];"RIGID_BODY_JOINT"==h.type&&c.Rw.push({target:h.target.Ka,PN:h.pivot_type,QN:h.pivot_x,RN:h.pivot_y,SN:h.pivot_z,za:h.axis_x,Aa:h.axis_y,Ba:h.axis_z,OQ:h.use_limit_x,PQ:h.use_limit_y,QQ:h.use_limit_z,KQ:h.use_angular_limit_x,LQ:h.use_angular_limit_y,MQ:h.use_angular_limit_z,TM:h.limit_max_x,
UM:h.limit_max_y,VM:h.limit_max_z,WM:h.limit_min_x,XM:h.limit_min_y,YM:h.limit_min_z,NM:h.limit_angle_max_x,OM:h.limit_angle_max_y,PM:h.limit_angle_max_z,QM:h.limit_angle_min_x,RM:h.limit_angle_min_y,SM:h.limit_angle_min_z})}d=c.k=J.Kl("MESH"===c.type?c.is_dynamic?"DYNAMIC":"STATIC":c.type);a.parent?(c.parent=a.parent.Ka,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(c.mp=a.parent_bone),a.pinverse_tsr&&(c.Ms=T.create(),T.copy(a.pinverse_tsr,c.Ms))):a.dg_parent&&(c.parent=a.dg_parent.Ka,c.ij=!0);
var h=a.location,k=a.scale[0];N.Ww(a.rotation_quaternion,ca);M.set_translation(c,h);M.set_rotation(c,ca);M.set_scale(c,k);c.aq=a.b4w_use_default_animation;c.Qj=p.nu(a.b4w_anim_behavior);a.b4w_object_tags&&(c.us={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});a.b4w_viewport_alignment&&(c.It={hH:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":O.Cj(a,c);h=d.qe;k=p.rI(h);a.b4w_animation_mixing?
(d.Ld=new Float32Array(k.sb),d.ee=new Float32Array(k.sb),d.Pd=new Float32Array(k.trans),d.he=new Float32Array(k.trans)):(d.Ld=k.sb,d.ee=k.sb,d.Pd=k.trans,d.he=k.trans);for(var e in h){var g=h[e];1==g.Vq.length&&O.jQ(g,!0,k.trans,k.sb)}d.tp=k;d.we=0;d.sh=a.b4w_animation_mixing;break;case "MESH":d.Hi=a.b4w_do_not_render;d.vi=y.XH(a.data.b4w_boundings.bb);d.ah=R.outlining_overview_mode||a.b4w_selectable;d.Dm=a.b4w_selectable;d.nc=R.outlining_overview_mode||a.b4w_outlining;d.Cm=a.b4w_outlining;d.Fs=R.outlining_overview_mode||
a.b4w_outline_on_select;d.Re=a.b4w_billboard;d.Pn=a.b4w_pres_glob_orientation;d.Wj="BASIC";d.Vj="SPHERICAL"==a.b4w_billboard_geometry;e=d.Wg;e.dj=a.b4w_outline_settings.outline_duration;e.ej=a.b4w_outline_settings.outline_period;e.fj=a.b4w_outline_settings.outline_relapses;d.ah&&(d.ek=N.RA(ma),ma++);for(e=0;e<a.data.b4w_vertex_anim.length;e++)h=a.data.b4w_vertex_anim[e],c.Hc.push({name:h.name,pa:h.frame_start,Sa:h.frame_end,RR:h.averaging,SR:h.averaging_interval,iH:h.allow_nla});c.k.Hc=c.Hc.length?
!0:!1;"MESH"!=a.type&&N.r("Wrong object type: "+a.name);e=c.k;if(a.data.b4w_shape_keys.length)for(e.je=!0,h=0;h<a.data.b4w_shape_keys.length;h++)k={},k.value=a.data.b4w_shape_keys[h].value,k.name=a.data.b4w_shape_keys[h].name,e.bh.push(k);else e.je=!1;d.Dd=a.b4w_shadow_cast;d.cd=a.b4w_shadow_receive;d.kd=a.b4w_shadow_cast_only&&d.Dd;d.$c=a.b4w_reflexible;d.Qc=a.b4w_reflexible_only&&d.$c;d.Pc=a.b4w_reflective;d.hf=a.b4w_reflection_type;if(!d.Pc)for(e=a.data.materials,h=0;h<e.length;h++)k=e[h],k.use_nodes&&
b(k.node_tree)&&(d.Pc=!0,d.hf="CUBE");d.Sf=a.b4w_caustics;if(d.Qd=a.b4w_wind_bending)d.ul=a.b4w_wind_bending_angle,e=y.eR(a.b4w_wind_bending_angle,d.vi,a.scale[0]),d.Mf=e,d.wg=a.b4w_wind_bending_freq,d.Wf=a.b4w_detail_bending_freq,d.Vf=a.b4w_detail_bending_amp,d.Rf=a.b4w_branch_bending_amp,d.fg=a.b4w_main_bend_stiffness_col,e=a.b4w_detail_bend_colors,d.td.dw=e.leaves_stiffness_col,d.td.cw=e.leaves_phase_col,d.td.Lw=e.overall_stiffness_col;d.hide=a.b4w_hidden_on_load;d.Eh=a.b4w_do_not_cull;d.Rl=a.b4w_disable_fogging;
d.ve=a.b4w_dynamic_geometry;"MESH"!==a.type&&N.r("Wrong object");e=a.data.materials[0];d.vk=e.physics.friction;d.nk=e.physics.elasticity;d.Pk=0;d.Tg=J.bu;d.Xi=a.b4w_lod_transition;d.Ls=a.pass_index;break;case "LINE":d.Eh=!0;d.K=E.Wc();d.O=E.Se();d.ga=E.Wc();d.sa=E.Se();break;case "CAMERA":u.xI(a,c);u.OH(c);break;case "LAMP":B.KM(a,c);break;case "SPEAKER":c.S=aa.FJ();d=!1;for(e=0;e<c.G.length;e++)if(c.G[e].mb.Bc){d=!0;break}d&&aa.Cj(a,c);break;case "EMPTY":e=E.Wc(),d.K=e,e=E.Hg(),d.da=e,a.field&&(c.Wl=
{type:a.field.type,LD:a.field.strength}),a.b4w_anchor&&(c.anchor={type:a.b4w_anchor.type,Ql:a.b4w_anchor.detect_visibility,Ii:a.b4w_anchor.element_id,sN:a.b4w_anchor.max_width})}m(c)};a.GQ=function(a,b){b.ji=a.uuid;b.zi=!0;r(a,b);a.iu=b.is_dynamic=f(a,b);a.eH=!0;b.k=J.Kl(b.type);b.aq=a.b4w_use_default_animation;b.Qj=p.nu(a.b4w_anim_behavior);m(b)};a.uQ=function(a,b){var c=b.k;if(b.parent){!b.ij&&b.mg.Zp&&b.parent.mg.Zp&&(b.ml=!1);for(var d=!1,k=0;k<b.G.length;k++)if(b.G[k].mb.gc){d=!0;break}if(k=
d)k=b.mg,k=b.ye||b.Ik||h.is_character(b)||b.ml&&!k.cq&&0<k.Ug&&("DYNAMIC"==k.pp||"RIGID_BODY"==k.pp);if(k)k=b.ij?T.copy(c.n,T.create()):c.n,T.multiply(b.parent.k.n,k,c.n),M.set_translation(b,T.get_trans_view(c.n)),M.set_scale(b,T.get_scale(c.n)),M.set_rotation(b,T.get_quat_view(c.n));else if(b.ij||!b.mp)if(k=T.copy(c.n,T.create()),b.It&&"CAMERA"==b.parent.type){k={distance:b.It.distance,rotation:T.get_quat_view(k)};switch(b.It.hH){case "TOP_LEFT":k.top=0;k.left=0;break;case "TOP":k.top=0;k.left=.5;
break;case "TOP_RIGHT":k.top=0;k.right=0;break;case "LEFT":k.top=.5;k.left=0;break;case "CENTER":k.top=.5;k.left=.5;break;case "RIGHT":k.top=.5;k.right=0;break;case "BOTTOM_LEFT":k.bottom=0;k.left=0;break;case "BOTTOM":k.bottom=0;k.left=.5;break;case "BOTTOM_RIGHT":k.bottom=0,k.right=0}x.append_stiff_viewport(b,b.parent,k)}else x.mH(b,b.parent,k);else k=T.copy(c.n,T.create()),x.nH(b,b.parent,b.mp,k)}if("ARMATURE"==b.type)for(d=a.pose.bones,k=0;k<d.length;k++){var e=d[k],f=e.constraints;if(f)for(var g=
0;g<f.length;g++){var t=f[g];"COPY_TRANSFORMS"!=t.type||t.subtarget||t.mute||x.AH(b,t.target.Ka,e.name,N.Oy,N.yl)}}if("MESH"==b.type)var n=p.$A(a);if(n){f=n.Ka;k=f.k.tp;d=b.k;e=a.data;b.Jq=f;e=e.vertex_groups;if(e.length){var f=f.k.qe,g=0,t={},H;for(H in f){var v=N.keysearch("name",H,e);v&&(t[H]={KE:v.index,xi:f[H].xi,ev:g++})}d.vh=t;H=g;e=p.fB();d.gg=H;H>2*e?(d.Vi=!1,C.error('too many bones for "'+a.name+'" / '+d.gg+" bones (max "+e+" with blending, "+2*e+" without blending). Skinning will be disabled.")):
d.Vi=!0}H=p.UK(k.trans,k.sb,c.vh);n.b4w_animation_mixing?(c.Ld=new Float32Array(H.sb),c.ee=new Float32Array(H.sb),c.Pd=new Float32Array(H.trans),c.he=new Float32Array(H.trans)):(c.Ld=H.sb,c.ee=H.sb,c.Pd=H.trans,c.he=H.trans);c.In=new Float32Array(4);c.Hn=F.create();c.tp=H;c.we=0}if(c.Pc)if(c=b.k,"CUBE"==c.hf)c.te=V++;else if("PLANE"==c.hf){a:{n=a.constraints;for(H=0;H<n.length;H++)if(k=n[H],"LOCKED_TRACK"==k.type&&"REFLECTION PLANE"==k.name){if(k.target.Ka){n=k.target.Ka;break a}C.warn('Reflection plane target "'+
k.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}n=null}n||(n=N.Vp("%reflection%"),n=J.mo(n,"EMPTY"),H=J.Kl("EMPTY"),n.k=H,l(b,n),x.$y(n,b,[0,0,0],null,1),m(n));H=null;for(k=0;k<ia.length;k++)if(ia[k]==n){H=k;break}null==H&&(H=ia.length,ia.push(n));n.k.ce=H;c.ce=H;n.Bp.push(b)}};a.pQ=g;a.gS=l;a.GI=w;a.vQ=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=c.k.type&&"CAMERA"!=c.k.type||M.B(c);c.aq&&p.sC(c)&&(p.apply_def(c),c.ba.length&&
p.play(c,null,p.SLOT_ALL))}};a.get_meta_tags=function(a){return N.P(a.us)};a.cleanup=function(){V=ma=0;ia.length=0;pa.length=0;ha={ALL:[]}};a.copy=function(a,b,d){var h=b,k=J.get_dg_parent(a);b=k?J.SA(k.name,b):b;if(c(b,ha.ALL,!1,-1)){for(var k=1,e;;){e="."+(3>String(k).length?("000"+String(k)).slice(-3):String(k));if(!c(b+e,ha.ALL,!1,-1))break;k++}C.error('Object "'+b+'" already exists. Name was replaced by "'+b+e+'".');h+=e;b+=e}h=J.mo(b,a.type,h);h.zi=a.zi;h.is_dynamic=a.is_dynamic;h.Xo=a.Xo;h.aq=
a.aq;h.Uf=a.Uf;h.k=J.Ku(a.k);h.us=J.$q(a.us);l(a,h);h.Eq=J.Qu(a.Eq);h.parent=J.Qu(a.parent);h.ij=a.ij;h.mp=a.mp;h.Hc=J.Qu(a.Hc);h.Qj=a.Qj;!a.C||a.ye||a.is_character||a.Ik||(h.ml=a.ml,h.C=null);h.Kb=a.Kb;h.ar=a.ar;h.mg=J.$q(a.mg);b=[];for(k=0;k<a.G.length;k++){var f=h.G[k];e=a.G[k].T;if(d){for(var f=f.T,g=0;g<e.length;g++)if(!e[g].uf){var p=J.$q(e[g]);p.ha=I.$I(e[g].ha);f.push(p);b.push(e[g].ha)}for(g=0;g<e.length;g++)if(e[g].uf){p=J.$q(e[g]);f.push(p);for(var t=0;t<b.length;t++)b[t]==e[g].ha&&(p.ha=
f[t].ha)}for(g=0;g<f.length;g++)f[g].ha&&I.dy(f[g].ha),W.lu&&fa.SH(f[g]),f[g].Uh=h.ji,y.eQ(f[g],y.tI(h.k));L.lP(f)}else f.T=e}d||(h.k.Yp=!1);J.kx(h,!1);m(h);h.k.$r=!0;h.k.as=d;h.k.ek=N.RA(ma);ma++;return h};a.update_boundings=function(a){for(var b=a.k,c=a.G[0].T,d,h,e,f,m,g,p,l,t,n,v,F,r=[],u=0;u<c.length;u++){var C=c[u];if("MAIN"==C.type){var A=I.Mi("a_position"),A=I.Fr(C.ha.Db,A),S=C.ha.Cb.a_position.offset;d=f=A[S];h=m=A[S+1];e=g=A[S+2]}}for(u=0;u<c.length;u++)if(C=c[u],C.ha&&C.sa&&C.ga){var A=
I.Mi("a_position"),A=I.Fr(C.ha.Db,A),S=C.ha.Cb.a_position.offset,z=C.ha.Cb.a_position.length+S;p=n=A[S];l=v=A[S+1];t=F=A[S+2];for(var x=S;x<z;x+=3){var S=A[x],G=A[x+1],J=A[x+2];p=Math.max(S,p);l=Math.max(G,l);t=Math.max(J,t);n=Math.min(S,n);v=Math.min(G,v);F=Math.min(J,F)}C.K.max_x=p.toFixed(3);C.K.max_y=l.toFixed(3);C.K.max_z=t.toFixed(3);C.K.min_x=n.toFixed(3);C.K.min_y=v.toFixed(3);C.K.min_z=F.toFixed(3);E.yi(C.K,b.n,C.ga);E.FA(C.ga,H);for(A=r.length=0;A<H.length;A++)r.push(H[A]);C.sa=E.br(r,!0);
C.O=E.zz(C.sa,b.n);C.da=E.Jl(C.O);C.Da=E.Jl(C.sa);C.Fe=E.Zr(C.O,C.da);"MAIN"==C.type&&(d=Math.max(p,d),h=Math.max(l,h),e=Math.max(t,e),f=Math.min(n,f),m=Math.min(v,m),g=Math.min(F,g))}r={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(h.toFixed(3)),max_z:parseFloat(e.toFixed(3)),min_x:parseFloat(f.toFixed(3)),min_y:parseFloat(m.toFixed(3)),min_z:parseFloat(g.toFixed(3))};n=d-f;l=h-m;p=e-g;f=.5*(d+f);t=.5*(h+m);v=.5*(e+g);var ba=f,la=v;m=Math.max(n,Math.max(l,p))/2;g=Math.max(n,p)/2;var Z=[f/(n?n:
1),t/(l?l:1),v/(p?p:1)];F=.5;if(b.Re)S=Math.max(Math.abs(r.max_x),Math.abs(r.min_x)),G=Math.max(Math.abs(r.max_y),Math.abs(r.min_y)),J=Math.max(Math.abs(r.max_z),Math.abs(r.min_z)),e=Math.sqrt(S*S+G*G+J*J),u=Math.sqrt(S*S+G*G),r.max_x=r.max_y=r.max_z=e,r.min_x=r.min_y=r.min_z=-e,g=u,m=e,S=new Float32Array([0,0,0]),d=new Float32Array([m,m,m]),e=new Float32Array([0,0,0]);else{for(u=0;u<c.length;u++)if(C=c[u],"MAIN"==C.type)for(A=I.Mi("a_position"),A=I.Fr(C.ha.Db,A),z=c[u].ha.Cb,S=z.a_position.offset,
z=z.a_position.length+S,x=S;x<z;x+=3){var S=A[x],G=A[x+1],J=A[x+2],w=Math.sqrt((f-S)*(f-S)+(t-G)*(t-G)+(v-J)*(v-J));if(w>m){var C=f-m*(S-f)/w,xa=t-m*(G-t)/w,w=v-m*(J-v)/w;f=(C+S)/2;t=(xa+G)/2;v=(w+J)/2;m=Math.sqrt((f-S)*(f-S)+(t-G)*(t-G)+(v-J)*(v-J))}xa=Math.sqrt((ba-S)*(ba-S)+(la-J)*(la-J));xa>g&&(C=ba-g*(S-ba)/xa,w=la-g*(J-la)/xa,ba=(C+S)/2,la=(w+J)/2,g=Math.sqrt((ba-S)*(ba-S)+(la-J)*(la-J)));S/=n?n:1;G/=l?l:1;J/=p?p:1;w=Math.sqrt((Z[0]-S)*(Z[0]-S)+(Z[1]-G)*(Z[1]-G)+(Z[2]-J)*(Z[2]-J));w>F&&(C=Z[0]-
F*(S-Z[0])/w,xa=Z[1]-F*(G-Z[1])/w,w=Z[2]-F*(J-Z[2])/w,Z[0]=(C+S)/2,Z[1]=(xa+G)/2,Z[2]=(w+J)/2,F=Math.sqrt((Z[0]-S)*(Z[0]-S)+(Z[1]-G)*(Z[1]-G)+(Z[2]-J)*(Z[2]-J)))}u=n?n*Z[0]:d;h=l?l*Z[1]:h;e=p?p*Z[2]:e;d=F*n;A=F*l;z=F*p;S=new Float32Array([f,t,v]);d=new Float32Array([d,A,z]);e=new Float32Array([u,h,e]);g=parseFloat(g.toFixed(3))}b.K=r;y.UO(b,g,g,r);r=E.Rq(m,S);b.da=r;r=E.On([d[0],0,0],[0,d[1],0],[0,0,d[2]],e);b.O=r;M.B(a);if(W.debug_view)for(u=0;u<c.length;u++)if("DEBUG_VIEW"===c[u].type&&c[u].Dh){a=
k.Br(1,r.D);I.WC(a,[r.za[0],r.Aa[1],r.Ba[2]],r.D);I.pt(a,1,!0);a.ma.a_polyindex=I.sr(a);y.dQ(c[u],a);break}};a.Gb=v;a.kB=function(a,b,c){b=ha[b]||[];for(var d=[],h=0;h<b.length;h++){var k=b[h];if((k.k.Fd==c||-1==c)&&k.zi)for(var e=k.G,f=0;f<e.length;f++)e[f].mb==a&&d.push(k)}return d};a.get_all_objects=function(a){var b=ha.ALL;if(-1==a)return b;for(var c=[],d=0;d<b.length;d++){var h=b[d];h.k.Fd==a&&c.push(h)}return c};a.get_first_character=function(a){var b=ha.MESH;if(b)for(var c=0;c<b.length;c++){var d=
b[c];if(h.is_character(d))for(var k=d.G,e=0;e<k.length;e++)if(k[e].mb==a)return d}return null};a.uP=function(a){var b=v(a,"LAMP",-1);if(b.length==a.q.pT){for(var c=[],d=0;d<b.length;d++){var h=b[d],h=J.ea(h,a);c[h.Nk]=d}for(d=0;d<c.length-1;d++)for(h=d+1;h<c.length;h++){var k=b[c[d]].$a,e=b[c[h]].$a;if(e.ll&&e.nl&&(!k.ll||!k.nl)||!k.ll&&(e.ll||!k.nl&&e.nl))k=c[d],c[d]=c[h],c[h]=k}for(d=0;d<c.length;d++)h=b[c[d]],J.ea(h,a).Nk=d,D.jn(b[c[d]],a)}};a.Ds=function(a,b,c,d,h){for(var k=0;k<a.G.length;k++)for(var e=
a.G[k].T,f=0;f<e.length;f++){for(var m=e[f],g=0;g<m.X.length;g++)m.X[g].rd=b;m.ha.rd=c;m.rd=c;m.nb.rd=d;""!==m.bj&&(m=A.hB(m.bj))&&(m.Vz=h)}};a.get_selectable_objects=function(){var a=[],b=ha.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.k.ah&&d.zi&&a.push(d)}return a};a.get_outlining_objects=function(){var a=[],b=ha.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.k.nc&&d.zi&&a.push(d)}return a};a.cc=function(b,d,h,k){var e=null,f=ha.ALL;switch(b){case a.au:e=c(d,f,!0,h,k);break;case a.$t:a:{for(b=
0;b<f.length;b++)if(e=f[b],e.Sk==h&&(e.k.Fd==k||-1==k)){var m=J.get_dg_parent(e);if(m&&m.Sk==d)break a}e=null}break;case a.yc:a:{for(k=0;k<f.length;k++){b=f[k];for(var e=d.length-1,m=b,g=!0;0<=e&&g;)g=m&&m.Sk==d[e]&&(m.k.Fd==h||-1==h),m&&(m=J.get_dg_parent(m)),e--;if(g&&!m){e=b;break a}}e=null}}return e};a.get_world_by_name=function(a,b){return c("%meta_world%"+a,ha.WORLD,!0,b)};a.pick_object=function(b,c){var d=D.Ak();if(!d)return C.error("No active scene"),null;var h=qa.NN(b,c);if(h)return h;h=
D.ON(d,b,c);if(!h)return null;for(var d=v(d,"MESH",-1),k=0;k<d.length;k++){var e=d[k].k,f=e.ek;if(f&&3>Math.abs(255*f[0]-h[0])&&3>Math.abs(255*f[1]-h[1])&&3>Math.abs(255*f[2]-h[2]))return e.nc&&e.Fs&&(R.outlining_overview_mode?a.apply_outline_anim(d[k],R.dj,R.ej,R.fj):(h=e.Wg,a.apply_outline_anim(d[k],h.dj,h.ej,h.fj))),d[k]}return null};a.set_wind_params=function(a,b){for(var c=v(a,"EMPTY",-1),d=0;d<c.length;d++){var h=c[d];if(h.Wl&&"WIND"===h.Wl.type){var k=h;break}}if(!k)return C.error("There is no wind on the scene"),
0;"number"==typeof b.wind_dir&&(c=N.deg_to_rad(b.wind_dir),U.set(Math.sin(c),-Math.cos(c),0,ua),N.dir_to_quat(ua,N.AXIS_Z,ca),M.set_rotation(k,ca));"number"==typeof b.wind_strength&&(k.Wl.LD=b.wind_strength);g(k)};a.remove_object=function(a){x.HI(a)&&x.remove(a);var b=ha.ALL,c=ha[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.FN=m;a.GN=function(a){return ha[a.type]&&-1<ha[a.type].indexOf(a)}};b4w.module.__obj_util=function(a,q){function e(a){a={type:a,id:0,Fd:0,n:f.hk(),Pt:f.hk(),pivot:new Float32Array(3),Hb:new Float32Array(3),Si:0,Ti:0,$r:!1,as:!1,ek:null,lg:0,xj:!1,Ie:r.create(),use_panning:!1,hb:0,Fj:1,Ej:1,Gj:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,gb:0,Xc:!1,fd:!1,Dc:null,Ya:null,fa:null,fb:null,kc:null,jc:null,Cd:null,Lg:!0,Wg:{dj:1,ej:1,fj:0},te:-1,ce:-1,Xb:new Float32Array(4),vk:0,nk:0,Tg:-1,Pk:0,Xi:0,Hi:!1,Dd:!1,cd:!1,kd:!1,
$c:!1,Qc:!1,Pc:!1,hf:"",Sf:!1,Qd:!1,Rl:!1,ve:!1,rc:!1,Eh:!1,hide:!1,ah:!1,Dm:!1,nc:!1,Cm:!1,Fs:!1,jm:!1,is_visible:!1,Ho:!1,ul:0,Mf:0,wg:0,Wf:0,Vf:0,Rf:0,fg:"",td:{dw:"",cw:"",Lw:""},Uj:!1,Re:!1,Pn:!1,Wj:"",Vj:!1,we:0,Ct:0,Dt:0,gg:0,uk:!1,Hc:!1,je:!1,bh:[],Vi:!1,sh:!1,Dg:1,En:0,Dn:1,gn:new Int8Array([-1,-1]),Pm:[],ss:[],dt:[],Ld:null,ee:null,Pd:null,he:null,qe:null,vh:null,tp:null,In:null,Hn:null,vi:null,K:l.Wc(),ga:l.Wc(),da:l.Hg(),Da:l.Hg(),O:l.Se(),sa:l.Se(),qd:l.cr(),iz:l.cr(),Nn:null,Ln:null,
Mn:null,Yp:!0,Fe:!1,Ls:0};r.copy(n.AXIS_Z,a.Ie);return a}function d(a){if(!(a instanceof Object))return a;var b=null,c=null,e=null,f=null,g=null;a.X&&(b=a.X,a.X=null);a.dd&&(c=a.dd,a.dd=null);a.Wa&&(e=a.Wa,a.Wa=null);a.nb&&(f=a.nb,a.nb=null);a.ke&&(g=a.ke,a.ke=null);var l;l=a.constructor;switch(l){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:l=new l(a);break;case Array:l=new l(a.length);for(var v=0;v<a.length;v++)l[v]=
d(a[v]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:l=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:l=null;break;case Function:l=a;break;default:for(v in l=new l,a)l[v]=d(a[v])}b&&(l.X=b,a.X=b);c&&(l.dd=c,a.dd=c);e&&(l.Wa=e,a.Wa=e);f&&(l.nb=f,a.nb=f);g&&(l.ke=n.Fi(),a.ke=g);return l}function b(a,b){for(var c=a.G,d=0;d<c.length;d++){var e=c[d];if(e.mb==b)return e}return null}function g(a){return a.ij?a.parent:a.parent?g(a.parent):null}var l=q("__boundings"),
w=q("__config"),f=q("__tsr"),n=q("__util"),r=q("__vec3"),v=q("__vec4"),c=w.A;new Float32Array(4);new Float32Array(4);new Float32Array(4);f.create();f.create();a.bu=-1;a.Kl=e;a.Ku=function(a){var b=e(a.type);b.id=a.id;b.Fd=a.Fd;f.copy(a.n,b.n);f.copy(a.Pt,b.Pt);r.copy(a.pivot,b.pivot);r.copy(a.Hb,b.Hb);b.Si=a.Si;b.Ti=a.Ti;b.$r=a.$r;b.as=a.as;a.ek&&(b.ek=r.clone(a.ek));b.lg=a.lg;b.xj=a.xj;r.copy(a.Ie,b.Ie);b.use_panning=a.use_panning;b.hb=a.hb;b.Fj=a.Fj;b.Ej=a.Ej;b.Gj=a.Gj;b.dof_distance=a.dof_distance;
b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.gb=a.gb;b.Xc=a.Xc;b.fd=a.fd;b.Dc=a.Dc;b.Ya=n.P(a.Ya);b.fa=n.P(a.fa);b.fb=n.P(a.fb);b.kc=n.P(a.kc);b.jc=n.P(a.jc);b.Cd=a.Cd;b.Lg=a.Lg;b.Wg.dj=a.Wg.dj;b.Wg.ej=a.Wg.ej;b.Wg.fj=a.Wg.fj;b.te=a.te;b.ce=a.ce;b.Xb=a.Xb;b.vk=a.vk;b.nk=a.nk;b.Tg=a.Tg;b.Pk=a.Pk;b.Xi=a.Xi;b.Hi=a.Hi;b.Dd=a.Dd;b.cd=a.cd;b.kd=a.kd;b.$c=a.$c;b.Qc=a.Qc;b.Pc=a.Pc;b.hf=a.hf;b.Sf=
a.Sf;b.Qd=a.Qd;b.Rl=a.Rl;b.ve=a.ve;b.rc=a.rc;b.Eh=a.Eh;b.hide=a.hide;b.ah=a.ah;b.Dm=a.Dm;b.nc=a.nc;b.Cm=a.Cm;b.Fs=a.Fs;b.jm=a.jm;b.is_visible=a.is_visible;b.Ho=a.Ho;b.ul=a.ul;b.Mf=a.Mf;b.wg=a.wg;b.Wf=a.Wf;b.Vf=a.Vf;b.Rf=a.Rf;b.fg=a.fg;b.td=a.td;b.Uj=a.Uj;b.Re=a.Re;b.Pn=a.Pn;b.Wj=a.Wj;b.Vj=a.Vj;b.we=a.we;b.Ct=a.Ct;b.Dt=a.Dt;b.gg=a.gg;b.uk=a.uk;b.Hc=a.Hc;b.je=a.je;b.bh=n.P(a.bh);b.Vi=a.Vi;b.sh=a.sh;b.Dg=a.Dg;b.En=a.En;b.Dn=a.Dn;b.gn.set(a.gn);b.Pm=n.P(a.Pm);b.ss=n.P(a.ss);b.dt=n.P(a.dt);b.Ld=n.P(a.Ld);
b.ee=n.P(a.ee);b.Pd=n.P(a.Pd);b.he=n.P(a.he);b.qe=n.P(a.qe);b.vh=n.P(a.vh);b.tp=n.P(a.tp);b.In=n.P(a.In);b.Hn=n.P(a.Hn);b.vi=n.P(a.vi);l.Ei(a.K,b.K);l.Ei(a.ga,b.ga);l.Zq(a.da,b.da);l.Zq(a.Da,b.Da);l.fA(a.O,b.O);l.fA(a.sa,b.sa);b.Nn=n.P(a.Nn);b.Ln=n.P(a.Ln);b.Mn=n.P(a.Mn);b.Yp=a.Yp;b.Fe=a.Fe;b.Ls=a.Ls;return b};a.mo=function(a,b,c){c||(c=a);return{name:a,ji:n.xv(),Sk:c,type:b,zi:!1,is_dynamic:!1,Xo:!1,aq:!1,k:null,Tb:null,S:null,$a:null,Jq:null,anchor:null,Wl:null,us:null,G:[],Hc:[],se:n.Fi(),Pu:n.Fi(),
ba:[],Bp:[],Cf:[],Eq:[],qg:null,bl:[],parent:null,ij:!1,mp:"",It:null,Ms:null,ml:!1,Kb:"",ar:"AUTO",ye:!1,is_character:!1,Ik:!1,vz:!1,C:null,v:null,sf:null,He:null,Xl:null,Mz:null,Rw:[],mg:{pp:"NO_COLLISION",cq:!1,CE:!1,Ug:0,HE:0,GE:0,pA:0,SC:0,cN:!1,dN:!1,eN:!1,fN:!1,gN:!1,hN:!1,eo:0,bo:0,fo:0,gy:!1,Wq:"BOX",Zp:!1},tC:{rt:0,Kw:0,gf:0,ax:0},Qj:0,Uf:[],Ew:!1,jC:!1,ts:[]}};a.Qu=function(a){return a instanceof Array?a.slice():a};a.fS=function(a){for(var b=[],c=0;c<a.length;c++){var e=a[c],f={},g;for(g in e)e[g]==
e.ga?f.ga=d(e.ga):e[g]==e.sa?f.sa=d(e.sa):f[g]=e[g];b.push(f)}return b};a.$q=d;a.is_dynamic=function(a){return a.is_dynamic};a.dg=function(a){return"MESH"==a.type&&a.is_dynamic};a.Gn=function(a,b){a.G.push({mb:b,Yr:!1,T:[],Xg:[],Bh:null,rx:[],Nk:0,rC:!1,W:[],pD:[]})};a.Hq=function(a,c,d){b(a,c).T.push(d)};a.vT=function(a,b){for(var c=a.G,d=0;d<c.length;d++)if(c[d].mb==b){c.splice(d,1);break}};a.ea=b;a.qE=function(a,b){for(var c=0;c<a.length;c++)v.copy(b,a[c].k.Xb)};a.kx=function(a,b,c){for(var d=
0;d<a.G.length;d++){var e=a.G[d];c&&e.mb!=c||(e.Yr=b)}};a.Er=function(a,b){for(var d=[],e=b?c.eC-1:c.eC,f=0;f<a.length;f++){var g=a[f];g.$a.WA&&d.length<e&&d.push(g)}return d.length?d:a[0]?[a[0]]:[]};a.Pz=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=b.material-1,d=a.data.materials;if(0<=c&&c<d.length&&("ADD"==d[c].game_settings.alpha_blend||"ALPHA"==d[c].game_settings.alpha_blend||"ALPHA_SORT"==d[c].game_settings.alpha_blend))return!0}return!1};a.MI=function(a){a=
a.G;for(var b=0;b<a.length;b++)for(var c=a[b].T,d=0;d<c.length;d++)for(var e=c[d].tb.Gi,f=0;f<e.length;f++){var g=e[f];if("USE_MODEL_TSR_INVERSE"==g[0]&&"1"==g[1])return!0}return!1};a.SA=function(a,b){return a+"*"+b};a.get_parent=function(a){return a.ij?null:a.parent};a.get_dg_parent=g;a.Bv=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];g(e)==a&&c.push(e)}return c};a.get_object_data_id=function(a){return a.k.Fd};a.is_mesh=function(a){return"MESH"===a.type};a.is_armature=function(a){return"ARMATURE"===
a.type};a.is_speaker=function(a){return"SPEAKER"===a.type};a.is_camera=function(a){return"CAMERA"===a.type};a.is_lamp=function(a){return"LAMP"===a.type};a.is_empty=function(a){return"EMPTY"===a.type};a.is_line=function(a){return"LINE"===a.type};a.is_world=function(a){return"WORLD"===a.type}};b4w.module.__particles=function(a,q){function e(){v.r("_rand() undefined")}function d(a,b,c,d,e,f){var m=a.jr,g=a.Zf,h=a.time;a=a.EC;for(var l=0;l<m.length;l+=4){var k=m[l];if(h>a&&h>=k&&k>a||h<a&&(k>a||h>=k))for(k=0;8>k;k++)g[8*l+k]=d[k],y[k]=d[k];else for(k=0;8>k;k++)y[k]=g[8*l+k];k=E;k[0]=b[3*l];k[1]=b[3*l+1];k[2]=b[3*l+2];r.transform_vec3(k,y,k);e[3*l]=k[0];e[3*l+1]=k[1];e[3*l+2]=k[2];var n=p;n[0]=c[4*l];n[1]=c[4*l+1];n[2]=c[4*l+2];n[3]=c[4*l+3];r.WP(n,y,n);f[4*l]=n[0];f[4*l+1]=n[1];f[4*l+2]=
n[2];f[4*l+3]=n[3];for(k=1;4>k;k++)e[3*(l+k)]=e[3*l],e[3*(l+k)+1]=e[3*l+1],e[3*(l+k)+2]=e[3*l+2],f[4*(l+k)]=n[0],f[4*(l+k)+1]=n[1],f[4*(l+k)+2]=n[2],f[4*(l+k)+3]=n[3]}}function b(a){a?(v.FP(a),e=function(){return v.bO()}):e=function(){return Math.random()}}var g=q("__config"),l=q("__batch"),w=q("__geometry"),f=q("__textures"),n=q("__time"),r=q("__tsr"),v=q("__util"),c=q("__vec3"),m=g.A,p=new Float32Array(4),y=new Float32Array(8),E=new Float32Array(3),u=[];a.update=function(){for(var a=0;a<u.length;a++)for(var b=
u[a],c=b.G,e=0;e<c.length;e++)for(var f=b,m=c[e].T,g=0;g<m.length;g++){var l=m[g],h=l.Va;h&&h.zt&&!l.uf&&(d(h,h.positions,h.YD,f.k.n,h.Tw,h.Mx),h.iC=!0)}};a.zm=function(a){a=a.G;for(var b=0;b<a.length;b++)for(var c=a[b].T,d=0;d<c.length;d++)if(c[d].Va)return!0;return!1};a.qC=function(a){a=a.G;for(var b=0;b<a.length;b++)for(var c=a[b].T,d=0;d<c.length;d++){var e=c[d].Va;if(e&&"EMITTER"==e.Gs)return!0}return!1};a.iI=function(a){return 0<a.particle_systems.length};a.hI=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==
a.particle_systems[b].settings.type)return!0;return!1};a.nM=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.rM=function(a,b,c){var d=a.Va={name:b.name,Gs:b.settings.type,time:0,EC:-1,zt:!1,pa:0,Sa:0,cE:0,fw:0,WB:0,cyclic:0,Ug:0,Fw:0,sB:0,qk:0,We:0,RE:0,size:0,Zy:0,Yy:0,$z:0,Zz:new Float32Array(16),iC:!1,positions:null,Tw:null,YD:null,Mx:null,jr:null,fv:null,Zf:null,uC:null,aE:0,bE:0};d.pa=b.settings.frame_start;
d.Sa=b.settings.frame_end;d.cE=(d.Sa-d.pa)/n.Zc();d.fw=b.settings.lifetime;d.WB=d.fw/n.Zc();d.cyclic=b.settings.b4w_cyclic?1:0;d.Ug=b.settings.mass;d.Fw=b.settings.normal_factor;d.sB=9.81*b.settings.effector_weights.gravity;d.qk=b.settings.b4w_fade_in/n.Zc();d.We=b.settings.b4w_fade_out/n.Zc();d.RE=b.settings.effector_weights.wind;d.zt="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var e,g,p;a.Qo?(e=c.halo.size,g=c.halo.hardness,30>g?(g=.5,p=.9):40>g?(g=.1,p=1):50>g?(g=0,p=.8):(g=0,p=.5)):(e=b.settings.particle_size,
p=g=1);d.size=e;d.Zy=g;d.Yy=p;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(l.ab(a,"NODES",1),l.ab(a,"PARTICLE_BATCH",1),a.Oi=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&m.Gq&&(e=[],f.oI(b[0].texture.color_ramp,f.Ny,e),e=new Uint8Array(e.map(function(a){return v.clamp(255*a,0,255)})),l.EH(a,e,f.Ny),l.ab(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&
c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(e=0;e<b;e+=4)g=c[e/4],a[e]=g.position,a[e+1]=g.color[0],a[e+2]=g.color[1],a[e+3]=g.color[2];d.$z=c.length}d.Zz.set(a)};a.rL=function(a,f,m,g){var l=a.Va,p=g.n;g=m.settings.count;var r=m.settings.frame_start/n.Zc(),t=m.settings.frame_end/n.Zc(),h=m.settings.lifetime/n.Zc(),C=m.settings.lifetime_random,k=m.settings.emit_from,F=m.settings.factor_random;if(m.settings.use_rotations)var u=
m.settings.angular_velocity_mode,y=m.settings.angular_velocity_factor;else u="NONE",y=0;var q=m.settings.b4w_randomize_emission,E=m.settings.b4w_cyclic;l.aE=m.settings.billboard_tilt;l.bE=m.settings.billboard_tilt_random;b(m.seed);var T;f=w.GA(f,["a_position","a_tbn_quat"],null);switch(k){case "VERT":var N=f.V[0].a_position;T=f.V[0].a_tbn_quat;m=N.length/3;f=[];for(k=0;k<g;k++){var U=Math.round((m-1)*e());f.push(U);f.push(U);f.push(U);f.push(U)}m=[];for(k=0;k<f.length;k++)m.push(N[3*f[k]]),m.push(N[3*
f[k]+1]),m.push(N[3*f[k]+2]);N=new Float32Array(m);m=[];for(k=0;k<f.length;k++)m.push(T[4*f[k]]),m.push(T[4*f[k]+1]),m.push(T[4*f[k]+2]),m.push(T[4*f[k]+3]);T=new Float32Array(m);break;case "FACE":N=[];T=[];k=[];v.Xr(0,k);m=w.yv(f,g,!1,k);v.Xr(0,k);f=w.yv(f,g,!0,k);for(k=0;k<m.length;k++)N.push(m[k][0],m[k][1],m[k][2]),N.push(m[k][0],m[k][1],m[k][2]),N.push(m[k][0],m[k][1],m[k][2]),N.push(m[k][0],m[k][1],m[k][2]),T.push(f[k][0],f[k][1],f[k][2],f[k][3]),T.push(f[k][0],f[k][1],f[k][2],f[k][3]),T.push(f[k][0],
f[k][1],f[k][2],f[k][3]),T.push(f[k][0],f[k][1],f[k][2],f[k][3]);N=new Float32Array(N);T=new Float32Array(T);break;case "VOLUME":v.r("Particle emission from volume is not supported");break;default:v.r("Wrong emit from option")}T=[N,T];N=T[0];T=T[1];l.positions=new Float32Array(N);l.YD=new Float32Array(T);l.Tw=new Float32Array(N.length);l.Mx=new Float32Array(T.length);f=[];t=(t-r)/g;for(m=0;m<g;m++)k=q?t*m+10*t*(.5-e()):t*m,E||(k+=r),f.push(k),f.push(k),f.push(k),f.push(k);r=new Float32Array(f);l.jr=
new Float32Array(r);l.fv=new Float32Array(r);if(l.zt){l.Zf=new Float32Array(8*r.length);for(q=0;q<8*r.length;q++)for(E=0;8>E;E++)l.Zf[8*q+E]=p[E];d(l,N,T,p,N,T)}p=w.bf("EMITTER_PARTICLES");q=v.Tf();q.a_position=N;q.a_tbn_quat=T;p.V[0]=q;a.Xf=w.pq;a=[];for(q=0;q<g;q++)a.push(4*q,4*q+2,4*q+1,4*q,4*q+3,4*q+2);a=new Uint16Array(a);p.ja=a;p.ma.a_p_bb_vertex=w.QA(g);p.Ca=N.length/3;a=[];C*=h;for(q=0;q<g;q++)E=C*e(),a.push(h-E),a.push(h-E),a.push(h-E),a.push(h-E);h=p.ma;C=[];for(q=0;q<g;q++)E=Math.random(),
C.push(a[4*q],r[4*q],E),C.push(a[4*q+1],r[4*q+1],E),C.push(a[4*q+2],r[4*q+2],E),C.push(a[4*q+3],r[4*q+3],E);C=new Float32Array(C);h.a_p_data=C;h=p.ma;C=[];for(a=0;a<g;a++){r=[e()-.5,e()-.5,e()-.5];c.normalize(r,r);C.push(F*r[0]);C.push(F*r[1]);C.push(F*r[2]);switch(u){case "NONE":C.push(0);break;case "SPIN":case "VELOCITY":C.push(y);break;case "RAND":C.push(2*y*(e()-.5));break;default:v.r("Undefined velocity factor")}r=C.slice(-4);for(q=0;12>q;q++)C.push(r[q%4])}g=new Float32Array(C);h.a_p_vels=g;
l.uC=new Float32Array(p.ma.a_p_data);return p};a.cP=function(a,b,c){a=a.G;for(var d=0;d<a.length;d++)for(var e=a[d].T,f=0;f<e.length;f++){var m=e[f].Va;m&&m.name==b&&!e[f].uf&&(m.EC=m.time,m.time=c)}};a.YN=function(a){for(var b=a.Ca,c=a.V[0].a_position,d=[],e=[],f=0;f<b;f++)e.push(c[3*f]),d.push(c[3*f+1]),e.push(c[3*f+2]);d=new Float32Array(d);e=new Float32Array(e);a.ma.a_lf_dist=d;a.ma.a_lf_bb_vertex=e;return a};a.set_size=function(a,b,c){a=a.G;for(var d=0;d<a.length;d++)for(var e=a[d].T,f=0;f<e.length;f++){var m=
e[f].Va;m&&m.name==b&&(m.size=c)}};a.set_normal_factor=function(a,b,c){a=a.G;for(var d=0;d<a.length;d++)for(var e=a[d].T,f=0;f<e.length;f++){var m=e[f].Va;m&&m.name==b&&(m.Fw=c)}};a.set_factor=function(a,b,c){a=a.G;for(var d=0;d<a.length;d++)for(var e=a[d].T,f=0;f<e.length;f++){var m=e[f],g=m.Va;if(g&&g.name==b){var h=g.jr;if(1==c)var l=h;else if(0==c)for(var l=g.fv,k=0;k<l.length;k+=4)l[k]=1E4,l[k+1]=l[k],l[k+2]=l[k],l[k+3]=l[k];else for(var p=4/c,l=g.fv,n=0,k=0;k<l.length;k+=4)k>=n?(l[k]=h[k],n+=
p):l[k]=1E4,l[k+1]=l[k],l[k+2]=l[k],l[k+3]=l[k];m=m.ha;if(m.Cb.a_p_data){g=g.uC;for(k=0;k<g.length;k+=3)g[k+1]=l[Math.round(k/3)];w.lE(m,"a_p_data",3,g)}}}};a.FQ=function(a,b,c){a=a.G;for(var d=0;d<a.length;d++)for(var e=a[d].T,f=0;f<e.length;f++){var m=e[f].Va;if(m&&m.zt)for(var g=0;g<8*m.jr.length;g++)m.Zf[8*g]=b[0],m.Zf[8*g+1]=b[1],m.Zf[8*g+2]=b[2],m.Zf[8*g+3]=b[3],m.Zf[8*g+4]=c[0],m.Zf[8*g+5]=c[1],m.Zf[8*g+6]=c[2],m.Zf[8*g+7]=c[3]}};a.yQ=function(a,b,c){for(var d=[],e=0;e<c;e++)d.push(0,0,0,1,
0,0,0,1,0,0,0,1,0,0,0,1);a.ma.a_tbn_quat=new Float32Array(d);if(b.np){d=[];for(e=0;e<c;e++)d.push(e,e,e,e);a.ma[b.np.name]=new Float32Array(d)}};a.xQ=function(a){-1==u.indexOf(a)&&u.push(a)};a.gO=function(a){a=u.indexOf(a);-1!=a&&u.splice(a,1)};a.cleanup=function(){u.length=0}};b4w.module.__primitives=function(a,q){function e(a,b,c,d){for(var e=[],g=[],l=[],n=[],z=2*c/(a-1),x=2*d/(b-1),q=0;q<a;q++)for(var B=-c+q*z,G=0;G<b;G++)if(g.push(B,-d+G*x,0),n.push(0,0,0,1),l.push(q/(a-1),G/(b-1)),q&&G){var A=q*b+G,J=A-1,t=(q-1)*b+G,h=t-1;e.push(A,J,t);e.push(J,h,t)}a=f.Tf();a.a_position=new Float32Array(g);a.a_tbn_quat=new Float32Array(n);n=w.bf("GRID_PLANE");n.V[0]=a;n.ma.a_texcoord=new Float32Array(l);n.ja=new Uint32Array(e);n.Ca=g.length/3;return n}function d(a){var b=a.length;
b%4&&f.r("Wrong array");for(var c=[],d=[],e=0;e<b;e+=4){var l=a[e+1],n=a[e+2],u=a[e+3];g(a[e],d);g(l,d);g(n,d);g(u,d);c.push(e,e+1,e+2);c.push(e,e+2,e+3)}a=f.Tf();a.a_position=new Float32Array(d);b=w.bf("FROM_QUADS");b.V[0]=a;b.ja=new Uint32Array(c);b.Ca=d.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function g(a,b){b.push(a[0],a[1],a[2])}var l=q("__config"),w=q("__geometry");q("__print");var f=q("__util"),n=l.A;a.vL=function(){var a=w.bf("LINE"),b=f.Tf();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.V[0]=b;a.ja=new Uint32Array(1);a.Ca=1;return a};a.DS=function(a,b){var c=e(2,2,a,b);c.name="PLANE";return c};a.CS=e;a.oL=function(a,b,c){function d(a,b){return 1==a%2&&(0==b||b==u-1)||1==b%2&&(0==a||a==l-1)?!0:!1}var e=c/=Math.pow(2,a-1),g=c,l=b+1,u=b+1;b=[];c=[];for(var z=[],x=0,q=0,B=-1,G=[],A=0;A<a;A++){for(var J=2*e/(l-1),t=2*g/(u-1),h=[],C=[],k=0,F=0;F<l;F++){for(var D=-e+F*J,aa=[],M=0;M<u;M++){var L=-g+M*t;if(D>-x&&D<x&&L>-q&&L<q)aa.push(-1),k++;else{for(var T=
null,N=0;N<G.length;N+=3)if(D==G[N]&&L==G[N+1]){T=G[N+2];break}N=null!==T?T:B+1;d(F,M)?(aa.push(-2),k++):(null==T&&(0==M||M==u-1||0==F||F==l-1?(T=A==a-1?J:2*J,h.push(D,L,N)):T=J,c.push(D,L,T),z.push(.707,0,0,.707),B++),aa.push(N));if(F&&M)if(1==F)if(d(F-1,M)){if(1<M){var L=N-1,T=C[F-1][M+1],U=T-1;b.push(U,L,N)}else T=C[F-1][M+1],U=T-1;b.push(T,U,N)}else d(F,M)||(L=N-1,T=C[F-1][M],b.push(T,L,N));else if(F==l-1){if(!d(F,M))if(M==u-1)L=N-1,T=C[F-1][M-1],U=C[F-2][M],b.push(T,L,N),b.push(U,T,N);else{var L=
N-1,T=C[F-1][M],U=T-1,O=T+1;b.push(U,L,N);b.push(T,U,N);b.push(O,T,N);2==M&&(O=C[F-2][M-2],b.push(U,O,L))}}else 1==M?d(F,M-1)?(L=C[F-1][M],T=C[F-1][M-1],b.push(L,T,N)):(L=aa[M-1],T=C[F-1][M],U=C[F-2][M-1],b.push(T,L,N),b.push(T,U,L)):M==u-1?d(F,M)||(L=aa[M-1],T=C[F-1][M-1],U=C[F-2][M],b.push(T,L,N),b.push(U,T,N)):-1!=C[F-1][M]&&-1!=C[F-1][M-1]&&-1!=aa[M-1]?(L=aa[M-1],T=C[F-1][M],U=C[F-1][M-1],b.push(T,L,N),b.push(T,U,L),M==u-2&&d(F,M+1)&&(O=C[F-1][M+1],b.push(O,T,N))):M==u-2&&d(F,M+1)&&(T=C[F-1][M],
O=C[F-1][M+1],b.push(O,T,N))}}C.push(aa)}G=h;x=e;q=g;e*=2;g*=2}if(2E4>x)for(a=-(2*x)/(l-1),c.push(-2E4,-2E4,a),c.push(-2E4,2E4,a),c.push(-x,-q,a),c.push(-x,q,a),c.push(2E4,-2E4,a),c.push(2E4,2E4,a),c.push(x,-q,a),c.push(x,q,a),N=B+1,b.push(N+1,N+2,N+3,N+1,N+0,N+2,N+2,N+4,N+6,N+2,N+0,N+4,N+1,N+7,N+5,N+1,N+3,N+7,N+7,N+4,N+5,N+6,N+4,N+7),F=0;8>F;F++)z.push(.707,0,0,.707);a=f.Tf();a.a_position=new Float32Array(c);a.a_tbn_quat=new Float32Array(z);e=w.bf("MULTIGRID_PLANE");e.V[0]=a;e.ja=new Uint32Array(b);
e.Ca=c.length/3;n.QE&&(w.pt(e,1,!0),a.a_polyindex=w.sr(e));return e};a.BS=function(a){var b=a.length;b%3&&f.r("Wrong array");for(var c=[],d=[],e=0;e<b;e+=3){var l=a[e+1],n=a[e+2];g(a[e],d);g(l,d);g(n,d);c.push(e,e+1,e+2)}a=f.Tf();a.a_position=new Float32Array(d);b=w.bf("FROM_TRIANGLES");b.V[0]=a;b.ja=new Uint32Array(c);b.Ca=d.length/3;return b};a.AS=d;a.sL=function(a){a=f.TQ(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);
b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=d(b);a.name="FRUSTUM";return a};a.Fc=function(){var a=w.bf("FULLSCREEN_TRI"),b=f.Tf();b.a_position=new Float32Array([0,0,1,0,0,1]);a.V[0]=b;a.ja=new Uint32Array([0,1,2]);a.Ca=3;return a};a.tL=function(){var a=w.bf("FULLSCREEN_QUAD"),b=f.Tf();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.V[0]=b;a.ja=new Uint32Array([0,2,1,1,2,3]);a.Ca=4;return a};a.nL=function(){var a=w.bf("BILLBOARD"),b=f.Tf();b.a_bb_vertex=w.QA(1);a.V[0]=b;a.ja=new Uint32Array([0,
2,1,0,3,2]);a.Ca=4;return a};a.pL=function(){var a=w.bf("CUBEMAP_BOARD"),b=f.Tf();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.V[0]=b;a.ja=new Uint32Array([0,2,1,0,3,2]);a.Ca=4;return a};a.Br=function(a,d){var c=w.bf("UV_SPHERE"),e,l,n=[],q=[],u=[];for(l=0;8>=l;l++)for(e=0;16>=e;e++){var z=e/16,x=l/8;q.push(-a*Math.cos(2*z*Math.PI)*Math.sin(x*Math.PI)+d[0],a*Math.cos(x*Math.PI)+d[1],a*Math.sin(2*z*Math.PI)*Math.sin(x*Math.PI)+d[2])}for(l=z=0;8>l;l++)for(e=0;16>e;e++){var x=b(q,17*l+e+1),
I=b(q,17*l+e),B=b(q,17*(l+1)+e),G=b(q,17*(l+1)+e+1);Math.abs(x[1])==a+d[1]?(g(x,n),g(B,n),g(G,n),u.push(z,z+1,z+2),z+=3):Math.abs(B[1])==a+d[1]?(g(x,n),g(I,n),g(B,n),u.push(z,z+1,z+2),z+=3):(g(x,n),g(I,n),g(B,n),g(G,n),u.push(z,z+1,z+2),u.push(z,z+2,z+3),z+=4)}e={};e.a_position=n;q=w.Bz(u,q,n);q=w.Az(u,n,q);e.a_tbn_quat=f.gen_tbn_quats(q);c.V[0]=e;c.ja=u;c.Ca=n.length/3;return c};a.VA=function(a){var b=w.bf("INDEX"),c=f.Tf();c.a_index=new Float32Array(a);for(var d=0;d<a;d++)c.a_index[d]=d;b.V[0]=
c;b.ja=new Uint16Array(0);b.Ca=a;return b}};b4w.module.__prerender=function(a,q){function e(a,c){var d=a.Th;d.is_visible=!1;if(d.hide)return!1;var e=c.p,g=c.type==f.Jc?e.ms:n.Ub(e.n,m),w=d.Pk,q=d.Tg,g=v.dist(d.Da.D,g);if(!(g<w?0:q==l.bu||g<q+d.Xi*d.Da.Ra))return!1;d.is_visible=!0;g=a.qa;if(c.type==f.Me)return c.debug_view_mode==b.DV_BOUNDINGS?g.Dh:!g.Dh;if(c.type==f.Nf&&0==d.lg)return!1;d.Yp?(w=g.Da,q=g.sa,g=g.Fe):(w=d.Da,q=d.sa,g=d.Fe);if(d=!d.Eh)e=e.Og,d=q,q=g,g=w.D,r.AP(g,e,w.Ra)?d=!0:q?(g=d.D,d=r.JK(g,e,d.za,d.Aa,d.Ba)):d=!1;return d?!1:
!0}function d(a){var b=a.Va;if(b&&b.iC){a=a.ha;g.lN(a);var c=a.Cb,d=c.a_position.offset;g.iq(a.Db,"a_position",b.Tw,d);d=c.a_tbn_quat.offset;g.iq(a.Db,"a_tbn_quat",b.Mx,d);g.dy(a)}}q("__config");var b=q("__debug"),g=q("__geometry"),l=q("__obj_util"),w=q("__renderer"),f=q("__subscene"),n=q("__tsr"),r=q("__util"),v=q("__vec3"),c=[f.Bb,f.zc,f.nd,f.Sc,f.Ne,f.me,f.Ed,f.of,f.Jc,f.Oe,f.Nf,f.Me,f.Le,f.ph],m=new Float32Array(3);a.Ps=function(a){if(-1<c.indexOf(a.type)){for(var b=!1,m=a.type==f.Sc||a.type==
f.me,g=a.La,l=0;l<g.length;l++){for(var n=g[l],v=n.oa,r=!1,G=0;G<v.length;G++){var A=v[G],J=A.qa;if(m)for(var t=0;6>t;t++)a.p.Og=a.oo[t],A.kv[t]=e(A,a),A.kv[t]&&(r=b=!0,d(J));else A.Lb=e(A,a),A.Lb&&(r=b=!0,d(J));a.ra&&(J.nb.gp=!0)}n.Lb=r}a.ra=!1;switch(a.type){case f.Me:break;default:a.type==f.Bb||a.type==f.Oe||a.type==f.Ed||a.type==f.nd||a.type==f.Sc||b?a.Lb=!0:(a.Lb&&w.clear(a),a.Lb=!1)}}else if(a.ra){g=a.La;for(l=0;l<g.length;l++)for(v=g[l].oa,G=0;G<v.length;G++)A=v[G],J=A.qa,J.nb.gp=!0;a.ra=!1}a.Bw&&
f.tP(a)}};b4w.module.__print=function(a){function q(a,b){var d=[];-1<a[0].indexOf("%c")?d.push(a[0].replace("%c","%c"+b+": ")):d.push(b+": "+a[0]);for(var c=1;c<a.length;c++)d.push(a[c]);return d}function e(){l++;var a=q(arguments,"B4W ERROR");console.error.apply(console,a)}function d(a){a in f||(f[a]=a,e([a]))}function b(a,b){d(a+"() is deprecated, use "+b+"() instead.")}var g=!1,l=0,w=0,f={};a.dP=function(a){g=a};a.Zd=function(){console.log.apply(console,arguments)};a.log=function(){if(g){var a=q(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=e;a.Ec=d;a.kb=b;a.Mg=function(a,e){switch(1<e.length){case !0:d(a+"() is deprecated, use "+e.slice(0,-1).join("(), ")+"() or "+e[e.length-1]+"() instead.");break;case !1:b(a,e[0])}};a.NK=function(){d('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){w++;var a=q(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=q(arguments,"B4W INFO");console.info.apply(console,a)};a.PK=function(){l++;
var a=q(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.QK=function(){w++;var a=q(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){g&&console.time.apply(console,arguments)};a.timeEnd=function(){g&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.hM=function(){return w};a.ML=function(){return l};a.clear_errors_warnings=function(){l=w=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,q){function e(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function d(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.strips.length;e++){var h=d.strips[e];"action"in h||(h.action=null,b("strip",h,"action"));"action_frame_start"in h||(h.action_frame_start=0,b("strip",h,"action_frame_start"));"action_frame_end"in h||(h.action_frame_end=h.frame_end-h.frame_start,b("strip",h,"action_frame_end"));"repeat"in h||(h.repeat=1,b("strip",h,"repeat"));
"use_reverse"in h||(h.use_reverse=!1,b("strip",h,"use_reverse"));"scale"in h||(h.scale=1,b("strip",h,"scale"))}}function b(a,b,c){c=c+">>"+a;c in x||(x[c]={Cx:[],QC:"undefined",type:a});x[c].Cx.push(b.name)}function g(a,b,c){c=c+">>"+a;c in x||(x[c]={Cx:[],QC:"deprecated",type:a});x[c].Cx.push(b.name)}function l(a){v.warn(a)}function w(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var h=m.yh(a);a.materials=c;a.submeshes=d;h.name=b;h.materials=a.materials.slice(0);
h.submeshes=[];for(c=0;c<d.length;c++){var e=m.ao(d[c]);h.submeshes.push(e)}return h}var f=q("__boundings"),n=q("__curve"),r=q("__mat4"),v=q("__print"),c=q("__quat"),m=q("__util"),p=q("__vec3"),y=q("__mat3"),E=q("__logic_nodes"),u=q("__animation"),z=[5,4],x={},I=y.create(),B=c.create();a.Qz=function(a){return-1!=m.IE(a,z)};a.FI=function(a){x={};var c=a.worlds;if(0==c.length){v.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var f={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};c.push(f)}for(var c=a.worlds,n=0;n<c.length;n++){f=c[n];"use_sky_blend"in f||(b("world",f,"use_sky_blend"),f.use_sky_blend=!1);"use_sky_paper"in f||(b("world",f,"use_sky_paper"),
f.use_sky_paper=!1);"use_sky_real"in f||(b("world",f,"use_sky_real"),f.use_sky_real=!1);"b4w_sky_settings"in f&&"rayleigh_brightness"in f.b4w_sky_settings||(b("world",f,"rayleigh_brightness"),f.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
f||(b("world",f,"fog_settings"),f.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in f&&(f.fog_settings.use_custom_color=!0,f.fog_settings.color=f.b4w_fog_color),"b4w_fog_density"in f&&0<f.b4w_fog_density&&(f.fog_settings.depth=1/f.b4w_fog_density));"render_sky"in f.b4w_sky_settings||(b("world",f,"render_sky"),f.b4w_sky_settings.render_sky=!1);for(var h=f.texture_slots,p=0;p<h.length;p++){var k=h[p];"blend_type"in
k||(k.blend_type="MIX",b("world_texture_slot",k,"blend_type"));"use_map_blend"in k||(k.use_map_blend=!1,b("world_texture_slot",k,"use_map_blend"));"use_map_horizon"in k||(k.use_map_horizon=!0,b("world_texture_slot",k,"use_map_horizon"));"use_map_zenith_up"in k||(k.use_map_zenith_up=!1,b("world_texture_slot",k,"use_map_zenith_up"));"use_rgb_to_intensity"in k||(k.use_rgb_to_intensity=!1,b("world_texture_slot",k,"use_rgb_to_intensity"));"invert"in k||(k.invert=!1,b("world_texture_slot",k,"invert"));
"color"in k||(k.color=[1,0,1],b("world_texture_slot",k,"color"));"blend_factor"in k||(k.blend_factor=0,b("world_texture_slot",k,"blend_factor"));"horizon_factor"in k||(k.horizon_factor=1,b("world_texture_slot",k,"horizon_factor"));"zenith_up_factor"in k||(k.zenith_up_factor=0,b("world_texture_slot",k,"zenith_up_factor"));"zenith_down_factor"in k||(k.zenith_down_factor=0,b("world_texture_slot",k,"zenith_down_factor"));"default_value"in k||(k.default_value=1,b("world_texture_slot",k,"default_value"))}"b4w_use_default_animation"in
f||(b("world",f,"b4w_use_default_animation"),f.b4w_use_default_animation=!1);"b4w_anim_behavior"in f||(b("world",f,"b4w_anim_behavior"),f.b4w_anim_behavior="CYCLIC")}p=a.scenes;for(n=0;n<p.length;n++)h=p[n],k=h.world,"timeline_markers"in h||(h.timeline_markers=null,b("scene",h,"timeline_markers")),"b4w_reflection_quality"in h||(h.b4w_reflection_quality="MEDIUM",b("scene",h,"b4w_reflection_quality")),"b4w_use_nla"in h||(h.b4w_use_nla=!1,b("scene",h,"b4w_use_nla")),"fps"in h||(h.fps=24,b("scene",h,
"fps")),"b4w_nla_cyclic"in h||(h.b4w_nla_cyclic=!1,b("scene",h,"b4w_nla_cyclic")),"b4w_logic_nodes"in h||(h.b4w_logic_nodes=[],b("scene",h,"b4w_logic_nodes")),"b4w_detect_collisions"in h&&(g("scene",h,"b4w_detect_collisions"),delete h.b4w_detect_collisions),"audio_doppler_speed"in h||(h.audio_doppler_speed=343.3),"audio_doppler_factor"in h||(h.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in h||(h.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",h,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in h||(h.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in h||(h.b4w_enable_bloom=!1,b("scene",h,"b4w_enable_bloom")),"b4w_enable_motion_blur"in h||(h.b4w_enable_motion_blur=!1,b("scene",h,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in h||(h.b4w_enable_color_correction=!1,b("scene",h,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in h||(h.b4w_antialiasing_quality="MEDIUM",b("scene",h,"b4w_antialiasing_quality")),
"b4w_tags"in h||(h.b4w_tags={title:"",description:""},b("scene",h,"b4w_tags")),"b4w_enable_object_selection"in h||(h.b4w_enable_object_selection="AUTO",b("scene",h,"b4w_enable_object_selection")),"b4w_enable_outlining"in h||(h.b4w_enable_outlining="AUTO",b("scene",h,"b4w_enable_outlining")),"b4w_enable_glow_materials"in h||(h.b4w_enable_glow_materials="AUTO",b("scene",h,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in h||(h.b4w_enable_anchors_visibility="AUTO",b("scene",h,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in h||(h.b4w_outline_color=[1,1,1],b("scene",h,"b4w_outline_color")),"b4w_outline_factor"in h||(h.b4w_outline_factor="b4w_glow_factor"in h?h.b4w_glow_factor:1,b("scene",h,"b4w_outline_factor")),"b4w_shadow_settings"in h||(b("scene",h,"b4w_shadow_settings"),c=k.b4w_shadow_settings,h.b4w_shadow_settings=c?c:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),c=h.b4w_shadow_settings,"csm_resolution"in c||(b("scene",h,"b4w_shadow_settings.csm_resolution"),c.csm_resolution=2048),"blur_samples"in c||(b("scene",h,"b4w_shadow_settings.blur_samples"),c.blur_samples="16x"),"soft_shadows"in c||(b("scene",h,"b4w_shadow_settings.soft_shadows"),c.soft_shadows=!0),"self_shadow_polygon_offset"in c||(b("scene",h,"b4w_shadow_settings.self_shadow_polygon_offset"),c.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in c||(b("scene",h,"b4w_shadow_settings.self_shadow_normal_offset"),c.self_shadow_normal_offset=.01),"b4w_enable_csm"in c||(b("scene",h,"b4w_shadow_settings.b4w_enable_csm"),c.b4w_enable_csm=!1),"csm_num"in c||(b("scene",h,"b4w_shadow_settings.csm_num"),c.csm_num=1),"csm_first_cascade_border"in c||(b("scene",h,"b4w_shadow_settings.csm_first_cascade_border"),c.csm_first_cascade_border=10),"first_cascade_blur_radius"in c||(b("scene",h,"b4w_shadow_settings.first_cascade_blur_radius"),
c.first_cascade_blur_radius=3),"csm_last_cascade_border"in c||(b("scene",h,"b4w_shadow_settings.csm_last_cascade_border"),c.csm_last_cascade_border=100),"last_cascade_blur_radius"in c||(b("scene",h,"b4w_shadow_settings.last_cascade_blur_radius"),c.last_cascade_blur_radius=1.5),"fade_last_cascade"in c||(b("scene",h,"b4w_shadow_settings.fade_last_cascade"),c.fade_last_cascade=!0),"blend_between_cascades"in c||(b("scene",h,"b4w_shadow_settings.blend_between_cascades"),c.blend_between_cascades=!0),"b4w_ssao_settings"in
h||(b("scene",h,"b4w_ssao_settings"),c=k.b4w_ssao_settings,h.b4w_ssao_settings=c?c:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),c=h.b4w_ssao_settings,"dist_factor"in c||(b("scene",h,"b4w_ssao_settings.dist_factor"),c.dist_factor=0),"samples"in c||(b("scene",h,"b4w_ssao_settings.samples"),c.samples=16),"hemisphere"in c||(b("scene",h,"b4w_ssao_settings.hemisphere"),c.hemisphere=!1),"blur_depth"in c||(b("scene",h,"b4w_ssao_settings.blur_depth"),c.blur_depth=!1),"blur_discard_value"in
c||(b("scene",h,"b4w_ssao_settings.blur_discard_value"),c.blur_discard_value=1),"b4w_bloom_settings"in h||(b("scene",h,"b4w_bloom_settings"),c=k.b4w_bloom_settings,h.b4w_bloom_settings=c?c:{key:.2,blur:4,edge_lum:1}),"key"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.key"),h.b4w_bloom_settings.key=.2),"blur"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.blur"),h.b4w_bloom_settings.blur=4),"edge_lum"in h.b4w_bloom_settings||(b("scene",h,"b4w_bloom_settings.edge_lum"),h.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in h||(b("scene",h,"b4w_motion_blur_settings"),c=k.b4w_motion_blur_settings,h.b4w_motion_blur_settings=c?c:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in h.b4w_motion_blur_settings||(b("scene",h,"b4w_motion_blur_settings.motion_blur_factor"),h.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in h.b4w_motion_blur_settings||(b("scene",h,"b4w_motion_blur_settings.motion_blur_decay_threshold"),h.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in h||(b("scene",h,"b4w_color_correction_settings"),c=k.b4w_color_correction_settings,h.b4w_color_correction_settings=c?c:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in h||(b("scene",h,"b4w_god_rays_settings"),c=k.b4w_god_rays_settings,h.b4w_god_rays_settings=c?c:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in h.b4w_god_rays_settings||(b("scene",h,"b4w_god_rays_settings.steps_per_pass"),h.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in h||(b("scene",h,"b4w_glow_settings"),h.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},c=h.b4w_glow_settings,"b4w_render_glow_over_blend"in k&&(c.render_glow_over_blend=k.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in k&&(c.small_glow_mask_coeff=k.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in k&&(c.large_glow_mask_coeff=k.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
k&&(c.small_glow_mask_width=k.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in k&&(c.large_glow_mask_width=k.b4w_large_glow_mask_width)),k=h.b4w_render_shadows,"AUTO"!=k&&"OFF"!=k&&"ON"!=k&&(h.b4w_render_shadows=k?"ON":"OFF"),k=h.b4w_render_reflections,"OFF"!=k&&"ON"!=k&&(h.b4w_render_reflections=k?"ON":"OFF"),k=h.b4w_render_refractions,"AUTO"!=k&&"OFF"!=k&&"ON"!=k&&(h.b4w_render_refractions=k?"ON":"OFF"),"b4w_render_dynamic_grass"in h||(b("scene",h,"b4w_render_dynamic_grass"),h.b4w_render_dynamic_grass=
"AUTO"),h.b4w_nla_script&&g("scene",h,"b4w_nla_script"),"audio_distance_model"in h||(b("scene",h,"audio_distance_model"),h.audio_distance_model="INVERSE_CLAMPED");h=a.meshes;for(n=0;n<h.length;n++){k=h[n];k.b4w_boundings||(b("mesh",k,"b4w_boundings"),k.b4w_boundings={},c=k.b4w_boundings,c.bb=k.b4w_bounding_box?k.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},c.bb_src=k.b4w_bounding_box_source?k.b4w_bounding_box_source:k.b4w_bounding_box,c.bs_cen=k.b4w_bounding_sphere_center?k.b4w_bounding_sphere_center:
[0,0,0],c.bc_cen=k.b4w_bounding_cylinder_center?k.b4w_bounding_cylinder_center:[0,0,0],c.be_cen=k.b4w_bounding_ellipsoid_center?k.b4w_bounding_ellipsoid_center:[0,0,0],k.b4w_bounding_ellipsoid_axes?c.be_ax=k.b4w_bounding_ellipsoid_axes:(p=c.bb,c.be_ax=[(p.max_x-p.min_x)/2,(p.max_y-p.min_y)/2,(p.max_z-p.min_z)/2]),k.b4w_rotated_bounding_box?c.rbb=k.b4w_rotated_bounding_box:(p=c.bb,c.rbb={rbb_c:[(p.max_x+p.min_x)/2,(p.max_y+p.min_y)/2,(p.max_z+p.min_z)/2],rbb_s:[1,1,1]}),c.caxis_x=k.b4w_cov_axis_x?
k.b4w_cov_axis_x:[1,0,0],c.caxis_y=k.b4w_cov_axis_y?k.b4w_cov_axis_y:[0,1,0],c.caxis_z=k.b4w_cov_axis_z?k.b4w_cov_axis_z:[0,0,1]);k.uv_textures||(b("mesh",k,"uv_textures"),k.uv_textures=[]);"b4w_shape_keys"in k||(k.b4w_shape_keys=[],b("mesh",k,"b4w_shape_keys"));c=!0;for(f=0;f<k.submeshes.length;f++){var F=k.submeshes[f];"boundings"in F||(c=!1,F.boundings={be_ax:k.b4w_bounding_ellipsoid_axes,be_cen:k.b4w_bounding_ellipsoid_center,bb:{max_x:k.b4w_bounding_box.max_x,max_y:k.b4w_bounding_box.max_y,max_z:k.b4w_bounding_box.max_z,
min_x:k.b4w_bounding_box.min_x,min_y:k.b4w_bounding_box.min_y,min_z:k.b4w_bounding_box.min_z}});"be_ax"in F.boundings||(F.boundings.be_ax=k.b4w_bounding_ellipsoid_axes);"be_cen"in F.boundings||(F.boundings.be_cen=k.b4w_bounding_ellipsoid_center);"bb"in F.boundings||(F.boundings.bb=k.b4w_bounding_box);"rbb"in F.boundings||(p=k.b4w_bounding_box,F.boundings.rbb={rbb_c:[(p.max_x+p.min_x)/2,(p.max_y+p.min_y)/2,(p.max_z+p.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in F.boundings||(F.boundings.caxis_x=[1,0,0]);
"caxis_y"in F.boundings||(F.boundings.caxis_y=[0,1,0]);"caxis_z"in F.boundings||(F.boundings.caxis_z=[0,0,1])}c||b("mesh",k,"submesh_bd");p=k;c=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];f=null;for(F=0;F<c.length;F++)p[c[F]]&&(f?(p[c[F]]=!1,v.warn('WARNING property "'+c[F]+'" of object "'+p.name+'" has been set to "false". Foreground property "'+f+'" already exists.')):f=c[F]);for(p=0;p<k.b4w_vertex_anim.length;p++)c=k.b4w_vertex_anim[p],
"allow_nla"in c||(b('mesh["b4w_vertex_anim"]',k,"allow_nla"),c.allow_nla=!0)}p=a.cameras;for(n=0;n<p.length;n++)h=p[n],h.type||(h.type="PERSP",b("camera",h,"type")),"b4w_eye_target_dist"in h&&(delete h.b4w_eye_target_dist,g("camera",h,"b4w_eye_target_dist")),"b4w_hover_zero_level"in h||(h.b4w_hover_zero_level=0,b("camera",h,"b4w_hover_zero_level")),"b4w_trans_velocity"in h||(h.b4w_trans_velocity=1,b("camera",h,"b4w_trans_velocity")),"b4w_rot_velocity"in h||(h.b4w_rot_velocity=1,b("camera",h,"b4w_rot_velocity")),
"b4w_zoom_velocity"in h||(h.b4w_zoom_velocity=.1,b("camera",h,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in h||(h.b4w_use_target_distance_limits=h.b4w_use_distance_limits||!1,b("camera",h,"b4w_use_target_distance_limits")),"b4w_use_zooming"in h||(h.b4w_use_zooming=h.b4w_use_distance_limits||!1,b("camera",h,"b4w_use_zooming")),"b4w_distance_min"in h||(h.b4w_distance_min=1,b("camera",h,"b4w_distance_min")),"b4w_distance_max"in h||(h.b4w_distance_max=100,b("camera",h,"b4w_distance_max")),
"b4w_horizontal_translation_min"in h||(h.b4w_horizontal_translation_min=-100,b("camera",h,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in h||(h.b4w_horizontal_translation_max=100,b("camera",h,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in h||(h.b4w_vertical_translation_min=-100,b("camera",h,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in h||(h.b4w_vertical_translation_max=100,b("camera",h,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in
h||(h.b4w_use_horizontal_clamping=!1,b("camera",h,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in h||(h.b4w_rotation_left_limit=-Math.PI,b("camera",h,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in h||(h.b4w_rotation_right_limit=Math.PI,b("camera",h,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in h||(h.b4w_horizontal_clamping_type="LOCAL",b("camera",h,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in h||(h.b4w_use_vertical_clamping=!1,b("camera",h,"b4w_use_vertical_clamping")),
"b4w_rotation_down_limit"in h||(h.b4w_rotation_down_limit=-Math.PI/2,b("camera",h,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in h||(h.b4w_rotation_up_limit=Math.PI/2,b("camera",h,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in h||(h.b4w_vertical_clamping_type="LOCAL",b("camera",h,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in h||(h.b4w_hover_angle_min=Math.PI/6,b("camera",h,"b4w_hover_angle_min")),"b4w_hover_angle_max"in h||(h.b4w_hover_angle_max=Math.PI/6,b("camera",h,"b4w_hover_angle_max")),
"b4w_enable_hover_hor_rotation"in h||(h.b4w_enable_hover_hor_rotation=!0,b("camera",h,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in h||(h.b4w_use_panning=!0,b("camera",h,"b4w_use_panning")),"b4w_use_pivot_limits"in h||(h.b4w_use_pivot_limits=!1,h.b4w_pivot_z_min=0,h.b4w_pivot_z_max=10,b("camera",h,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in h||(h.b4w_dof_bokeh=!1,b("camera",h,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in h||(h.b4w_dof_bokeh_intensity=.3,b("camera",h,"b4w_dof_bokeh_intensity")),
"b4w_dof_foreground_blur"in h||(h.b4w_dof_foreground_blur=!1,b("camera",h,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in h||(h.b4w_dof_front_start=0,b("camera",h,"b4w_dof_front_start")),"b4w_dof_front_end"in h||(h.b4w_dof_front_end=h.b4w_dof_front,b("camera",h,"b4w_dof_front_end")),"b4w_dof_rear_start"in h||(h.b4w_dof_rear_start=0,b("camera",h,"b4w_dof_rear_start")),"b4w_dof_rear_end"in h||(h.b4w_dof_rear_end=h.b4w_dof_rear,b("camera",h,"b4w_dof_rear_end"));p=a.lamps;for(n=0;n<p.length;n++)h=
p[n],"b4w_generate_shadows"in h||(h.b4w_generate_shadows=!1,b("lamp",h,"b4w_generate_shadows")),"b4w_dynamic_intensity"in h||(h.b4w_dynamic_intensity=!1,b("lamp",h,"b4w_dynamic_intensity")),"use_diffuse"in h||(h.use_diffuse=!0,b("lamp",h,"use_diffuse")),"use_specular"in h||(h.use_specular=!0,b("lamp",h,"use_specular")),"clip_start"in h||(h.clip_start=.1,b("lamp",h,"clip_start")),"clip_end"in h||(h.clip_end=30,b("lamp",h,"clip_end")),"POINT"!=h.type&&"SPOT"!=h.type||"use_sphere"in h||(h.use_sphere=
!1,b("lamp",h,"use_sphere"));p=a.speakers;for(n=0;n<p.length;n++)h=p[n],"b4w_behavior"in h||(h.b4w_behavior=h.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in h||(h.b4w_auto_play=!1,b("speaker",h,"b4w_auto_play")),"b4w_enable_doppler"in h||(h.b4w_enable_doppler=!1,b("speaker",h,"b4w_enable_doppler")),"b4w_delay"in h||(h.b4w_delay=0),"b4w_delay_random"in h||(h.b4w_delay_random=0),"b4w_volume_random"in h||(h.b4w_volume_random=0),"b4w_pitch_random"in h||(h.b4w_pitch_random=0),
"b4w_fade_in"in h||(h.b4w_fade_in=0),"b4w_fade_out"in h||(h.b4w_fade_out=0),"b4w_loop"in h||(h.b4w_loop=!1),"b4w_loop_start"in h||(h.b4w_loop_start=0,b("speaker",h,"b4w_loop_start")),"b4w_loop_end"in h||(h.b4w_loop_end=0,b("speaker",h,"b4w_loop_end")),h.animation_data&&d(h.animation_data);p=a.textures;for(n=0;n<p.length;n++)h=p[n],"b4w_anisotropic_filtering"in h||(h.b4w_anisotropic_filtering="OFF",b("texture",h,"b4w_anisotropic_filtering")),"b4w_water_foam"in h||(h.b4w_water_foam=!1,b("texture",h,
"b4w_water_foam")),"b4w_foam_uv_freq"in h||(h.b4w_foam_uv_freq=[1,1],b("texture",h,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in h||(h.b4w_foam_uv_magnitude=[1,1],b("texture",h,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in h||(h.b4w_parallax_steps=5,b("material",h,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in h||(h.b4w_parallax_lod_dist=10,b("material",h,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in h||(h.b4w_shore_dist_map=!1,b("texture",h,"b4w_shore_dist_map")),"b4w_shore_boundings"in
h||(h.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",h,"b4w_shore_boundings")),"b4w_max_shore_dist"in h||(h.b4w_max_shore_dist=100,b("texture",h,"b4w_max_shore_dist")),"b4w_disable_compression"in h||(h.b4w_disable_compression=!1,b("texture",h,"b4w_disable_compression")),"b4w_source_type"in h||(h.b4w_source_type="",b("texture",h,"b4w_source_type")),"b4w_source_id"in h||(h.b4w_source_id="",b("texture",h,"b4w_source_id")),"b4w_source_size"in h||(h.b4w_source_size=1024,b("texture",h,"b4w_source_size")),
"b4w_enable_canvas_mipmapping"in h||(h.b4w_enable_canvas_mipmapping=!0,b("texture",h,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in h||(h.b4w_nla_video=!1,b("texture",h,"b4w_nla_video"));p=a.images;for(n=0;n<p.length;n++)h=p[n],"colorspace_settings_name"in h||(h.colorspace_settings_name="sRGB",b("image",h,"colorspace_settings_name"));c=a.materials;for(n=0;n<c.length;n++){f=c[n];"ALPHA_ANTIALIASING"==f.game_settings.alpha_blend&&(f.game_settings.alpha_blend="CLIP");"use_tangent_shading"in f||(f.use_tangent_shading=
!1,b("material",f,"use_tangent_shading"));"b4w_node_mat_type"in f&&g("material",f,"b4w_node_mat_type");"b4w_skydome"in f&&g("material",f,"b4w_skydome");"b4w_procedural_skydome"in f&&g("material",f,"b4w_procedural_skydome");"b4w_lens_flares"in f||(f.b4w_lens_flares=!1,b("material",f,"b4w_lens_flares"));"LENS_FLARES"===f.name&&(f.b4w_lens_flares||v.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),f.b4w_lens_flares=!0);f.b4w_water&&("b4w_water_shore_smoothing"in
f||(f.b4w_water_shore_smoothing=!1,b("material",f,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in f||(f.b4w_water_dynamic=!1,b("material",f,"b4w_water_dynamic")),"b4w_waves_height"in f||(f.b4w_waves_height=1,b("material",f,"b4w_waves_height")),"b4w_waves_length"in f||(f.b4w_waves_length=1,b("material",f,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in f||(f.b4w_water_dst_noise_scale0=.05,b("material",f,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in f||(f.b4w_water_dst_noise_scale1=
.03,b("material",f,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in f||(f.b4w_water_dst_noise_freq0=1.3,b("material",f,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in f||(f.b4w_water_dst_noise_freq1=1,b("material",f,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in f||(f.b4w_water_dir_min_shore_fac=.4,b("material",f,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in f||(f.b4w_water_dir_freq=.5,b("material",f,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in
f||(f.b4w_water_dir_noise_scale=.05,b("material",f,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in f||(f.b4w_water_dir_noise_freq=.07,b("material",f,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in f||(f.b4w_water_dir_min_noise_fac=.5,b("material",f,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in f||(f.b4w_water_dst_min_fac=.2,b("material",f,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in f||(f.b4w_water_waves_hor_fac=5,b("material",f,"b4w_water_waves_hor_fac")),
"b4w_water_absorb_factor"in f||(f.b4w_water_absorb_factor=6,b("material",f,"b4w_water_absorb_factor")),"b4w_water_fog_color"in f||(f.b4w_water_fog_color=[.5,.7,.7],b("material",f,"b4w_water_fog_color")),"b4w_foam_factor"in f||(f.b4w_foam_factor=5,b("material",f,"b4w_foam_factor")),"b4w_generated_mesh"in f||(f.b4w_generated_mesh=!1,b("material",f,"b4w_generated_mesh")),"b4w_water_num_cascads"in f||(f.b4w_water_num_cascads=5,b("material",f,"b4w_water_num_cascads")),"b4w_water_subdivs"in f||(f.b4w_water_subdivs=
64,b("material",f,"b4w_water_subdivs")),"b4w_water_detailed_dist"in f||(f.b4w_water_detailed_dist=1E3,b("material",f,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in f||(f.b4w_water_enable_caust=!1,b("material",f,"b4w_water_enable_caust")),"b4w_water_caust_scale"in f||(f.b4w_water_caust_scale=.25,b("material",f,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in f||(f.b4w_water_caust_brightness=.5,b("material",f,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in f||(f.b4w_dynamic_grass_size=
"");"b4w_dynamic_grass_color"in f||(f.b4w_dynamic_grass_color="");"diffuse_intensity"in f||(f.diffuse_intensity=1,b("material",f,"diffuse_intensity"));"b4w_use_ghost"in f||(f.b4w_use_ghost=!1);"b4w_collision_margin"in f||(f.b4w_collision_margin=.04,b("material",f,"b4w_collision_margin"));"b4w_collision_group"in f||(f.b4w_collision_group=128,b("material",f,"b4w_collision_group"));"b4w_collision_mask"in f||(f.b4w_collision_mask=127,b("material",f,"b4w_collision_mask"));"b4w_do_not_render"in f||(f.b4w_do_not_render=
!1,b("material",f,"b4w_do_not_render"));"HALO"!=f.type||"b4w_halo_sky_stars"in f||(f.b4w_halo_sky_stars=!1,b("material",f,"b4w_halo_sky_stars"));"HALO"!=f.type||"b4w_halo_stars_blend_height"in f||(f.b4w_halo_stars_blend_height=10,b("material",f,"b4w_halo_stars_blend_height"));"HALO"!=f.type||"b4w_halo_stars_min_height"in f||(f.b4w_halo_stars_min_height=0,b("material",f,"b4w_halo_stars_min_height"));"specular_shader"in f||(f.specular_shader="COOKTORR",b("material",f,"specular_shader"));"diffuse_shader"in
f||(f.diffuse_shader="LAMBERT",b("material",f,"diffuse_shader"));"roughness"in f||(f.roughness=.5,b("material",f,"roughness"));"diffuse_fresnel"in f||(f.diffuse_fresnel=.1,b("material",f,"diffuse_fresnel"));"diffuse_fresnel_factor"in f||(f.diffuse_fresnel_factor=.5,b("material",f,"diffuse_fresnel_factor"));"specular_slope"in f||(f.specular_slope=.2,b("material",f,"specular_slope"));"specular_toon_size"in f||(f.specular_toon_size=.5,b("material",f,"specular_toon_size"));"specular_toon_smooth"in f||
(f.specular_toon_smooth=.1,b("material",f,"specular_toon_smooth"));"specular_alpha"in f||(f.specular_alpha=1,b("material",f,"specular_alpha"));"b4w_wettable"in f||(f.b4w_wettable=!1,b("material",f,"b4w_wettable"));"b4w_refractive"in f||(f.b4w_refractive=!1,b("material",f,"b4w_refractive"));"b4w_refr_bump"in f||(f.b4w_refr_bump=0,b("material",f,"b4w_refr_bump"));"b4w_shallow_water_col"in f||(f.b4w_shallow_water_col=[0,.8,.3],b("material",f,"b4w_shallow_water_col"));"b4w_shore_water_col"in f||(f.b4w_shore_water_col=
[0,.9,.2],b("material",f,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in f||(f.b4w_shallow_water_col_fac=1,b("material",f,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in f||(f.b4w_shore_water_col_fac=.5,b("material",f,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in f||(f.b4w_water_sss_strength=5.9,b("material",f,"b4w_water_sss_strength"));"b4w_water_sss_width"in f||(f.b4w_water_sss_width=.45,b("material",f,"b4w_water_sss_width"));"b4w_render_above_all"in f||(f.b4w_render_above_all=
!1,b("material",f,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in f||(f.b4w_water_norm_uv_velocity=.05,b("material",f,"b4w_water_norm_uv_velocity"));"specular_ior"in f||(f.specular_ior=1,b("material",f,"specular_ior"));"darkness"in f||(f.darkness=0,b("material",f,"darkness"));"diffuse_toon_size"in f||(f.diffuse_toon_size=0,b("material",f,"diffuse_toon_size"));"diffuse_toon_smooth"in f||(f.diffuse_toon_smooth=0,b("material",f,"diffuse_toon_smooth"));"pass_index"in f||(f.pass_index=0,b("material",
f,"pass_index"));h=f.texture_slots;for(p=0;p<h.length;p++)k=h[p],"blend_type"in k||(k.blend_type="MIX",b("texture_slot",k,"blend_type"));if(f.node_tree){h=f.node_tree.nodes;for(p=0;p<h.length;p++)e(h[p]);f.node_tree.animation_data&&d(f.node_tree.animation_data)}}k=a.node_groups;for(n=0;n<k.length;n++)for(h=k[n].node_tree.nodes,p=0;p<h.length;p++)e(h[p]);h=a.objects;for(n=0;n<h.length;n++){k=h[n];switch(k.type){case "MESH":"b4w_dynamic_geometry"in k||(k.b4w_dynamic_geometry=!1);"b4w_reflexible"in k||
(k.b4w_reflexible=!1);"b4w_reflexible_only"in k||(k.b4w_reflexible_only=!1);"b4w_reflective"in k||(k.b4w_reflective=!1);"b4w_reflection_type"in k||(k.b4w_reflection_type="PLANE",b("object",k,"b4w_reflection_type"));"b4w_wind_bending"in k||(k.b4w_wind_bending=!1,b("object",k,"b4w_wind_bending"));"b4w_wind_bending_angle"in k||(k.b4w_wind_bending_angle=10,k.b4w_wind_bending_freq=.25,b("object",k,"wind bending params"));"b4w_detail_bending_amp"in k||(k.b4w_detail_bending_amp=.1,k.b4w_branch_bending_amp=
.3,b("object",k,"detail bending params"));"b4w_detail_bending_freq"in k||(k.b4w_detail_bending_freq=1,b("object",k,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in k||(k.b4w_main_bend_stiffness_col="",b("object",k,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in k||(k.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",k,"b4w_detail_bend_colors"));"b4w_caustics"in k||(k.b4w_caustics=!1);"vertex_groups"in k&&k.vertex_groups.length&&
k.data&&0==k.data.vertex_groups.length&&(k.data.vertex_groups=k.vertex_groups,delete k.vertex_groups,b("object",k,"vertex_groups"));"b4w_vertex_anim"in k&&k.b4w_vertex_anim.length&&k.data&&0==k.data.b4w_vertex_anim.length&&(k.data.b4w_vertex_anim=k.b4w_vertex_anim,delete k.b4w_vertex_anim,b("object",k,"b4w_vertex_anim"));"b4w_do_not_render"in k||(k.b4w_do_not_render=!1);"b4w_hidden_on_load"in k||(k.b4w_hidden_on_load=!1);"use_ghost"in k.game||(k.game.use_ghost=!1);"use_sleep"in k.game||(k.game.use_sleep=
!1);"velocity_min"in k.game||(k.game.velocity_min=0);"velocity_max"in k.game||(k.game.velocity_max=0);"collision_group"in k.game||(k.game.collision_group=1);"collision_mask"in k.game||(k.game.collision_mask=255);p=k;c=p.game;f=c.collision_bounds_type;c.use_collision_bounds&&"BOX"!=f&&"CYLINDER"!=f&&"CONE"!=f&&"SPHERE"!=f&&"CAPSULE"!=f&&"EMPTY"!=f&&(v.error("Wrong collision bounds type "+f+". Disable physics for object "+p.name),p.b4w_collision=!1,p.b4w_floating=!1,p.b4w_vehicle=!1,p.b4w_character=
!1);"b4w_vehicle_settings"in k?k.b4w_vehicle_settings&&("steering_ratio"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.steering_ratio=10),"steering_max"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.steering_max=1),"inverse_control"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.inverse_control=!1),"force_max"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.force_max=1500),"brake_max"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.brake_max=100),"speed_ratio"in k.b4w_vehicle_settings||
(k.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.suspension_damping=
2.3),"wheel_friction"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.floating_factor=3),"floating_factor"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in k.b4w_vehicle_settings||
(k.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in k.b4w_vehicle_settings||(k.b4w_vehicle_settings.water_rot_damp=.9)):(k.b4w_vehicle_settings=null,b("object",k,"b4w_vehicle_settings"));"b4w_floating_settings"in k?k.b4w_floating_settings&&("floating_factor"in k.b4w_floating_settings||(k.b4w_floating_settings.floating_factor=3),"water_lin_damp"in k.b4w_floating_settings||(k.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in k.b4w_floating_settings||(k.b4w_floating_settings.water_rot_damp=
.8)):(k.b4w_floating_settings=null,b("object",k,"b4w_floating_settings"));"b4w_character_settings"in k?k.b4w_character_settings&&("walk_speed"in k.b4w_character_settings||(k.b4w_character_settings.walk_speed=4),"run_speed"in k.b4w_character_settings||(k.b4w_character_settings.run_speed=8),"step_height"in k.b4w_character_settings||(k.b4w_character_settings.step_height=.25),"jump_strength"in k.b4w_character_settings||(k.b4w_character_settings.jump_strength=5),"waterline"in k.b4w_character_settings||
(k.b4w_character_settings.waterline=0)):(k.b4w_character_settings=null,b("object",k,"b4w_character_settings"));"b4w_selectable"in k||(k.b4w_selectable=!1,b("object",k,"b4w_selectable"));"b4w_outlining"in k||(k.b4w_outlining=!1,b("object",k,"b4w_outlining"));"b4w_outline_on_select"in k||(k.b4w_outline_on_select=!1,b("object",k,"b4w_outline_on_select"));"b4w_billboard"in k||(k.b4w_billboard=!1,b("object",k,"b4w_billboard"));"b4w_billboard_geometry"in k||(k.b4w_billboard_geometry="SPHERICAL",b("object",
k,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in k||(k.b4w_pres_glob_orientation=!1,b("object",k,"b4w_pres_glob_orientation"));"b4w_outline_settings"in k||("b4w_glow_settings"in k?k.b4w_outline_settings=k.b4w_glow_settings:(k.b4w_outline_settings={},k.b4w_outline_settings.outline_duration=1,k.b4w_outline_settings.outline_period=1,k.b4w_outline_settings.outline_relapses=0),b("object",k,"b4w_outline_settings"));"b4w_lod_transition"in k||(k.b4w_lod_transition=.01,b("object",k,"b4w_lod_transition"));
"lod_levels"in k||(k.lod_levels=[],b("object",k,"lod_levels"));"b4w_animation_mixing"in k||(k.b4w_animation_mixing=!1,b("object",k,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in k||(k.b4w_anchor=null,b("object",k,"b4w_anchor")),!k.b4w_anchor||"max_width"in k.b4w_anchor||(k.b4w_anchor.max_width=250)}"collision_margin"in k.game||(k.game.collision_margin=.04,b("object",k,"collision_margin"));"b4w_anim_behavior"in k||(k.b4w_anim_behavior=k.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",
k,"b4w_anim_behavior"));if(!("rotation_quaternion"in k)){p=[0,0,0,1];m.euler_to_quat(k.rotation_euler,p);var c=p,f=p[0],F=p[1],r=p[2];c[0]=p[3];c[1]=f;c[2]=F;c[3]=r;k.rotation_quaternion=p;b("object",k,"rotation_quaternion")}"webgl_do_not_batch"in k&&(k.b4w_do_not_batch=k.webgl_do_not_batch)&&g("object",k,"webgl_do_not_batch");"b4w_shadow_cast_only"in k||(k.b4w_shadow_cast_only=!1,b("object",k,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in k||(k.b4w_correct_bounding_offset="AUTO",b("object",
k,"b4w_correct_bounding_offset"));c=k.particle_systems;for(p=0;p<c.length;p++)f=c[p],F=f.settings,"use_rotation_dupli"in F||(F.use_rotation_dupli=!1,b("particle_settings",F,"use_rotation_dupli")),"use_whole_group"in F||(F.use_whole_group=!1,b("particle_settings",F,"use_whole_group")),f.transforms||(f.transforms=new Float32Array,b("particle_system",f,"transforms")),"b4w_billboard_align"in F||(F.b4w_billboard_align="VIEW",b("particle_settings",F,"b4w_billboard_align")),"b4w_dynamic_grass"in F||(F.b4w_dynamic_grass=
!1,b("object",F,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in F||(F.b4w_dynamic_grass_scale_threshold=.01,b("object",F,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in F||(F.b4w_initial_rand_rotation=!1,b("particle_settings",F,"b4w_initial_rand_rotation")),"b4w_rotation_type"in F||(F.b4w_rotation_type="Z",b("particle_settings",F,"b4w_rotation_type")),"b4w_rand_rotation_strength"in F||(F.b4w_rand_rotation_strength=1,b("particle_settings",F,"b4w_rand_rotation_strength")),
"b4w_hair_billboard"in F||(F.b4w_hair_billboard=!1,b("particle_settings",F,"b4w_hair_billboard")),"b4w_hair_billboard_type"in F||(F.b4w_hair_billboard_type="BASIC",b("particle_settings",F,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in F||(F.b4w_hair_billboard_jitter_amp=0,b("particle_settings",F,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in F||(F.b4w_hair_billboard_jitter_freq=0,b("particle_settings",F,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in
F||(F.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",F,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in F||(F.b4w_wind_bend_inheritance="PARENT",b("particle_settings",F,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in F||(F.b4w_shadow_inheritance="PARENT",b("particle_settings",F,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in F||(F.b4w_reflection_inheritance="PARENT",b("particle_settings",F,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in F||(F.b4w_vcol_from_name=
"",b("particle_settings",F,"b4w_vcol_from_name")),"b4w_vcol_to_name"in F||(F.b4w_vcol_to_name="",b("particle_settings",F,"b4w_vcol_to_name")),"b4w_coordinate_system"in F||(F.b4w_coordinate_system="LOCAL",b("particle_settings",F,"b4w_coordinate_system")),"b4w_allow_nla"in F||(F.b4w_allow_nla=!0,b("particle_settings",F,"b4w_allow_nla")),"b4w_enable_soft_particles"in F||(F.b4w_enable_soft_particles=!1,b("particle_settings",F,"b4w_enable_soft_particles")),"b4w_particles_softness"in F||(F.b4w_particles_softness=
1,b("particle_settings",F,"b4w_particles_softness")),"billboard_tilt"in F||(F.billboard_tilt=0,b("particle_settings",F,"billboard_tilt")),"billboard_tilt_random"in F||(F.billboard_tilt_random=0,b("particle_settings",F,"billboard_tilt_random")),"use_rotations"in F||(F.use_rotations=!1,b("particle_settings",F,"use_rotations"));"constraints"in k||(k.constraints=[],b("object",k,"constraints"));c=k.modifiers;for(p=0;p<c.length;p++){a:{f=c[p];switch(f.type){case "ARRAY":if(!("fit_type"in f)){v.error("WARNING Incomplete modifier "+
String(f.type)+' for "'+k.name+'", reexport "'+a.b4w_filepath_blend+'" scene');f=!1;break a}}f=!0}f||(c.splice(p,1),p--)}"animation_data"in k||(k.animation_data={action:null,nla_tracks:[]},b("object",k,"animation_data"));k.animation_data&&("action"in k.animation_data||(k.animation_data.action=null,l("no action in animation data "+k.name)),"nla_tracks"in k.animation_data||(k.animation_data.nla_tracks=[],l("no NLA in animation data "+k.name)),d(k.animation_data));"b4w_collision_id"in k||(k.b4w_collision_id=
"",b("object",k,"b4w_collision_id"));"b4w_viewport_alignment"in k||(k.b4w_viewport_alignment=null,b("object",k,"b4w_viewport_alignment"));"pinverse_tsr"in k||(k.pinverse_tsr=null,b("object",k,"pinverse_tsr"));"b4w_cluster_data"in k||(k.b4w_cluster_data={cluster_id:-1},b("object",k,"b4w_cluster_data"));"pass_index"in k||(k.pass_index=0,b("object",k,"pass_index"));(0>k.scale[0]||0>k.scale[1]||0>k.scale[2])&&l('negative scale for object "'+k.name+'", can lead to some errors');p=k.scale;0==p[0]&&0==p[1]&&
0==p[2]?p=!0:(c=Math.abs((p[1]-p[2])/p[1]),p=.005>Math.abs((p[0]-p[1])/p[0])&&.005>c);p||l("non-uniform scale for object "+k.name)}for(var u in x)n=x[u],p=u.match(/.*?(?=>>|$)/i)[0],v.warn('Property "'+String(p)+'" is '+n.QC+' for "'+n.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.CI=function(a,b){"num_channels"in a||(a.num_channels=1,l('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.KH=function(a){var b;a:{b=a.modifiers;for(var d=0;d<
b.length;d++){var e=b[d].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=!1}if(!b)return null;b=w(a.data,a.data.name+"_MOD");a=a.modifiers;for(d=0;d<a.length;d++){var h=a[d];switch(h.type){case "ARRAY":for(var e=b,g=h,k=0,l=0,v=0,u=new Float32Array(16),h=[],z=1;z<g.count;z++){g.use_constant_offset&&(k+=g.constant_offset_displace[0],l+=g.constant_offset_displace[1],v+=g.constant_offset_displace[2]);if(g.use_relative_offset)var q=e.b4w_bounding_box,k=k+(q.max_x-q.min_x)*g.relative_offset_displace[0],
l=l+(q.max_y-q.min_y)*g.relative_offset_displace[1],v=v+(q.max_z-q.min_z)*g.relative_offset_displace[2];m.SP(k,l,v,u);for(var x=q=w(e),E=u,U=y.fromMat4(E,I),U=c.fromMat3(U,B),O=0;O<x.submeshes.length;O++){var qa=x.submeshes[O];m.Hm(qa.position,E,qa.position,0);m.JC(qa.tbn_quat,U,qa.tbn_quat,0)}h.push(q)}for(z=0;z<h.length;z++)for(g=e,k=h[z],l=0;l<g.submeshes.length;l++){v=g.submeshes[l];u=k.submeshes[l];q=v.base_length;x=v.indices.length;v.base_length+=u.base_length;for(var fa in v)if("base_length"!=
fa&&"boundings"!=fa)if("indices"==fa)for(v[fa]=m.ZP(v[fa],u[fa]),E=x;E<v.indices.length;E++)v.indices[E]+=q;else"vertex_colors"!=fa&&(v[fa]=m.bL(v[fa],u[fa]))}break;case "CURVE":for(e=b,z=n.IJ(h.object),g=new Float32Array(16),l=z.Ui?4:3,k=new Float32Array(l),l=new Float32Array(l),v=new Float32Array(3),u=new Float32Array(4),q=new Float32Array(4),x=new Float32Array(3),E=new Float32Array(3),U=new Float32Array(3),new Float32Array(4),new Float32Array(4),O=0;O<e.submeshes.length;O++){var W=e.submeshes[O],
qa=W.position,W=W.tbn_quat,R;a:{R=h.deform_axis;switch(R){case "POS_X":case "NEG_X":R=0;break a;case "POS_Y":case "NEG_Y":R=1;break a;case "POS_Z":case "NEG_Z":R=2;break a;default:m.r("Wrong deform axis value "+R)}R=void 0}x[0]=0;x[1]=0;x[2]=0;x[R]=1;for(var ha=n.DP(z),H=0;H<qa.length/3;H++){U[0]=qa[3*H];U[1]=qa[3*H+1];U[2]=qa[3*H+2];var ma=U[R],V=n.CP(z,ma);n.EP(z,V,k);v[0]=k[0];v[1]=k[1];v[2]=k[2];n.BP(z,V,l);E[0]=l[0];E[1]=0;E[2]=l[2];p.normalize(E,E);c.rotationTo(x,E,u);0>ma?(k[0]=E[0],k[1]=E[1],
k[2]=E[2],p.scale(k,ma,k),p.add(v,k,v)):ma>ha&&(k[0]=E[0],k[1]=E[1],k[2]=E[2],p.scale(k,ma-ha,k),p.add(v,k,v));r.fromRotationTranslation(u,v,g);z.Ui&&(c.setAxisAngle(x,k[3],q),p.transformQuat(U,q,U));U[R]=0;p.transformMat4(U,g,U);qa[3*H]=U[0];qa[3*H+1]=U[1];qa[3*H+2]=U[2];W.length&&(B[0]=W[4*H],B[1]=W[4*H+1],B[2]=W[4*H+2],B[3]=W[4*H+3],c.multiply(B,u,B),W[4*H]=B[0],W[4*H+1]=B[1],W[4*H+2]=B[2],W[4*H+3]=B[3])}}}f.cO(b)}return b};a.xJ=function(){return{name:"DEFAULT",uuid:m.xv(),use_nodes:!1,diffuse_shader:"LAMBERT",
diffuse_color:[.8,.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,
.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,
1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.PH=function(a,b){function c(b,d){for(var h in b){var f=b[h],e=f[0];if(1<f.length)for(var k=1;k<f.length;k++)e+="*"+f[k];for(k=0;k<a.length;k++)if(f=a[k],f.name==e)for(var g in d)f[g]=d[g]}}for(var d=b.b4w_logic_nodes,h=0;h<d.length;h++)for(var f=d[h],e=0;e<f.length;e++){var g=f[e],m={register1:"variable1",register2:"variable2",registerd:"variabled"},p;for(p in m)p in
g&&(g[m[p]]=g[p]);for(var n in g.variables)"boolean"!=typeof g.variables[n][0]&&(g.variables[n]=[!1,g.variables[n]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(g.type)&&("variable1"in g&&(g.variables.v1=[!1,g.variable1]),"variable2"in g&&(g.variables.v2=[!1,g.variable2]),"variabled"in g&&(g.variables.vd=[!1,g.variabled]));switch(g.type){case "SELECT":for(var v=0;v<a.length;v++)m=a[v],m.name==g.object&&(m.b4w_selectable=!0);g.bools||(g.bools={});g.bools.not_wait||(g.bools.not_wait=!1);l('Logic nodes type "SELECT" is deprecated');
break;case "SWITCH_SELECT":c(g.objects_paths,{b4w_selectable:!0});if(g.links instanceof Array){l('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var m={},r=0;for(v in g.objects_paths)m[v]=g.links[r],r++;g.links=m}break;case "SELECT_PLAY":l('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');g.mute=!0;break;case "SELECT_PLAY_ANIM":l('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');
break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(g.objects_paths,{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(g.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(g.objects_paths,{b4w_do_not_batch:!0});switch(g.common_usage_names.space_type){case "WORLD":g.common_usage_names.space_type=E.RF;break;case "PARENT":g.common_usage_names.space_type=E.QF;break;case "LOCAL":g.common_usage_names.space_type=E.PF}break;case "OUTLINE":c(g.objects_paths,
{b4w_outlining:!0});break;case "CONDJUMP":g.condition&&(g.common_usage_names.condition=g.condition);if("cnd"in g.floats)g.common_usage_names.condition=g.floats.cnd;else switch(g.common_usage_names.condition){case "GEQUAL":g.common_usage_names.condition=E.Ey;break;case "LEQUAL":g.common_usage_names.condition=E.Gy;break;case "GREATER":g.common_usage_names.condition=E.Fy;break;case "LESS":g.common_usage_names.condition=E.Hy;break;case "NOTEQUAL":g.common_usage_names.condition=E.Iy;break;case "EQUAL":g.common_usage_names.condition=
E.Dy}void 0!=g.number1&&(g.input1=g.number1);void 0!=g.number2&&(g.input2=g.number2);g.bools||(g.bools={});void 0===g.bools.str&&(g.bools.str=!1,g.floats.inp1=g.input1,g.floats.inp2=g.input2);break;case "SEND_REQ":g.bools||(g.bools={});g.strings||(g.strings={});void 0===g.bools.ct&&(g.bools.ct=!1);void 0!=g.url&&(g.bools.url=!1,g.strings.url=g.url);break;case "MATH":void 0!=g.number1&&(g.input1=g.number1);void 0!=g.number2&&(g.input2=g.number2);void 0!=g.input1&&(g.floats.inp1=g.input1);void 0!=g.input2&&
(g.floats.inp2=g.input2);break;case "REGSTORE":g.floats||(g.floats={});g.strings||(g.strings={});void 0!=g.number1&&(g.input1=g.number1);if(void 0!=g.input1)switch(typeof g.input1){case "number":g.floats.inp1=g.input1;g.common_usage_names.variable_type="NUMBER";break;default:g.strings.inp1=g.input1,g.common_usage_names.variable_type="STRING"}switch(g.common_usage_names.variable_type){case "NUMBER":g.common_usage_names.variable_type=E.SF;break;case "STRING":g.common_usage_names.variable_type=E.TF}break;
case "PAGEPARAM":g.bools||(g.bools={});void 0===g.bools.hsh&&(g.bools.hsh=!1);g.floats||(g.floats={});void 0===g.floats.ptp&&(g.floats.ptp=0);break;case "PLAY_ANIM":c(g.objects_paths,{b4w_do_not_batch:!0});g.bools||(g.bools={});void 0===g.bools.env&&(g.bools.env=!1);(m=g.common_usage_names.param_anim_behavior)||(m="FINISH_STOP");g.common_usage_names.param_anim_behavior=u.nu(m);break;case "STOP_ANIM":g.bools||(g.bools={});void 0===g.bools.env&&(g.bools.env=!1);break;case "STRING":switch(g.common_usage_names.string_operation){case "JOIN":g.common_usage_names.string_operation=
E.MF;break;case "FIND":g.common_usage_names.string_operation=E.LF;break;case "REPLACE":g.common_usage_names.string_operation=E.NF;break;case "SPLIT":g.common_usage_names.string_operation=E.OF;break;case "COMPARE":g.common_usage_names.string_operation=E.KF}if("cnd"in g.floats)g.common_usage_names.condition=g.floats.cnd;else switch(g.common_usage_names.condition){case "GEQUAL":g.common_usage_names.condition=E.Ey;break;case "LEQUAL":g.common_usage_names.condition=E.Gy;break;case "GREATER":g.common_usage_names.condition=
E.Fy;break;case "LESS":g.common_usage_names.condition=E.Hy;break;case "NOTEQUAL":g.common_usage_names.condition=E.Iy;break;case "EQUAL":g.common_usage_names.condition=E.Dy}break;case "REDIRECT":void 0!=g.url&&(g.bools.url=!1,g.strings.url=g.url);break;case "SET_CAMERA_MOVE_STYLE":switch(g.common_usage_names.camera_move_style){case "STATIC":g.common_usage_names.camera_move_style=E.DF;break;case "TARGET":g.common_usage_names.camera_move_style=E.EF;break;case "EYE":g.common_usage_names.camera_move_style=
E.BF;break;case "HOVER":g.common_usage_names.camera_move_style=E.CF}break;case "ENTRYPOINT":g.bools||(g.bools={});void 0===g.bools.js&&(g.bools.js=!1);g.bools.js&&(g.mute=!0);break;case "JS_CALLBACK":for(p in g=g.common_usage_names.js_cb_params,g)switch(g[p]){case "OBJECT":g[p]=E.FF;break;case "VARIABLE":g[p]=E.GF}}}}};b4w.module.__scenegraph=function(a,q){function e(a,b){var c=[];D.Lf(a,function(b,d,h){-1<c.indexOf(h)?D.nO(a,b,d,h,I(h)):c.push(h)});D.la(a,function(a,d){for(var h=0;h<d.Qa.length;h++){var f=d.Qa[h];b||d.type!=M.nd&&d.type!=M.Sc&&d.type!=M.of||(f.Ge=!0);-1<c.indexOf(f)?d.Qa[h]=I(f):c.push(f)}})}function d(a,c){D.la(a,function(b,d){d.type==M.ry&&D.ih(a,b,function(a,b){if(b.type==M.yg)for(var c=0;c<b.Qa.length;c++){var d=b.Qa[c];d.Ga=L.I;d.Fa=L.I}});c||D.ih(a,b,function(a,b,c){"DEPTH"==c.from&&(c.Ge=
!0)})});D.la(a,function(c){var d={};b(a,c,d);for(var h in d){c=d[h];for(var f=c[0],e=0;e<c.length;e++)if(c[e].Ga==L.I){f=c[e];break}for(var k=c[0],e=0;e<c.length;e++)if(c[e].Fa==L.I){k=c[e];break}for(var g=c[0],e=0;e<c.length;e++)if(!c[e].Ge){g=c[e];break}for(e=0;e<c.length;e++)c[e].Ga=f.Ga,c[e].Fa=k.Fa,c[e].Ge=g.Ge}})}function b(a,c,d){D.ih(a,c,function(c,h,f){f.pc&&f.from==f.to&&(d[f.from]=d[f.from]||[],-1==d[f.from].indexOf(f)&&d[f.from].push(f),b(a,c,d))});D.yj(a,c,function(a,b,c){c.pc&&(d[c.from]=
d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=D.Pa(a,c);if(c.type==M.yg)for(var h=0;h<c.Qa.length;h++){var f=c.Qa[h];d[f.from].push(f)}}function g(a){var b=[M.yg,M.du,M.vq,M.nd,M.Sc,M.xn],c=D.Rx(a),d=[];D.la(c,function(a,h){for(var e=0;e<h.Qa.length;e++){var k=h.Qa[e];-1<b.indexOf(h.type)&&(k.xt=!0);var g=r(d,k,l(k));k.Xa=g;h.gh[e]=g}for(e=0;e<h.gh.length;e++)g=h.gh[e],n(d,g);D.yj(c,a,function(e,k,g){-1<b.indexOf(h.type)&&(g.xt=!0);g.Xa||((e=w(c,a,g.from))&&g.pc&&!g.Xa?f(d,e):e=r(d,
g,l(g)),g.Xa=e)});D.ih(c,a,function(a,b,c){n(d,c.Xa)});D.yj(c,a,function(a,b,c){c.Xa&&"NONE"==c.to&&n(d,c.Xa)})})}function l(a){a=T.yh(a);delete a.to;delete a.pc;delete a.Xa;return JSON.stringify(a)}function w(a,b,c){var d=null;D.ih(a,b,function(a,b,h){if(h.pc&&h.from==h.to&&h.from==c&&h.Xa)return d=h.Xa,!0});D.yj(a,b,function(a,b,h){if(h.pc&&h.from==c&&h.Xa)return d=h.Xa,!0});return d}function f(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Nx===b&&d.Ap++}}function n(a,b){for(var c=0;c<a.length;c++){var d=
a[c];d.Nx===b&&d.Ap&&d.Ap--}}function r(a,b,c){if(b.Em)return f(a,b.Em.Xa),b.Em.Xa;if(b.xt)return v(b);for(var d=null,h=0;h<a.length;h++){var e=a[h];if(e.id==c&&0===e.Ap){d=e;break}}if(d&&!U.IA)return d.Ap++,d.Nx;b=v(b);a.push({id:c,Ap:1,Nx:b});return b}function v(a){var b=a.cl*a.size,c=a.el*a.size;switch(a.from){case "COLOR":if(a.Ge){var d=L.Ll("COLOR_RB",a.$i?L.Aq:L.zq,a.$p);L.resize(d,b,c)}else d=L.Ll("COLOR",L.qi,a.$p),L.resize(d,b,c),L.mx(d,a.Ga,a.Fa);return d;case "DEPTH":return a.Ge?(d=L.Ll("DEPTH_RB",
a.$i?L.yq:L.xq,a.$p),L.resize(d,b,c)):(d=L.Ll("DEPTH_TEX",L.Bl,a.$p),L.resize(d,b,c),L.mx(d,a.Ga,a.Fa)),d;case "CUBEMAP":return d=L.gA("CUBEMAP",b);case "SCREEN":case "NONE":return null;default:T.r("Wrong slink param: "+a.from)}}function c(a,b){var c=!1;D.Lf(a,function(d,h,e){if(e&&(d=D.Pa(a,d),h=D.Pa(a,h),b(e,!1,d,h)))return c=!0});c||D.la(a,function(a,c){for(var d=0;d<c.Qa.length;d++)if(b(c.Qa[d],!0,c,null))return!0})}function m(a){D.la(a,function(b,c){if(c.type!=M.Al){var d=c.p;D.yj(a,b,function(a,
b,c){c.pc&&c.Xa&&(C.$s(d,c.from,c.Xa),c.from==c.to&&b.p&&C.$s(b.p,c.from,c.Xa))});for(var h=0;h<c.Qa.length;h++){var e=c.Qa[h];e.pc&&e.from==e.to&&C.$s(d,e.from,c.gh[h])}!d.bc&&!d.ue||d.xe||(d.xe=aa.jO(d.bc,d.ue))}});D.la(a,function(b,c){if(c.type==M.zl||c.type==M.Ut){var d=A(a,c);c.p.Io=d[0].p.xe}})}function p(a){var b=null,c=0;D.la(a,function(a,d){if(d.type==N.MP){if(c==N.LP)return b=d,!0;c++}});return b}function y(a,b){var c=D.hg(a,b),d=M.ed("NONE"),h=D.H(a,d),e=D.Oo(a)[0];D.Lf(a,function(b,c){c==
e&&D.dO(a,b,e,b,h)});var f=E(b,a);D.Lf(a,function(h,e,k){if(h==c){if(f){h=M.dr();D.H(a,h);e=x("COLOR","RESOLVE",1,1,1,!0);e.$i=!0;e.Ge=!0;var g=x("DEPTH","RESOLVE",1,1,1,!0);g.$i=!0;g.Ge=!0;D.s(a,b,h,e);D.s(a,b,h,g);b=h}D.s(a,b,d,x(N.nP,"u_color",k.size,k.cl,k.el,k.Wp));return!0}});D.Lc(a,h,e,x("SCREEN","NONE",.5,.5,.5,!0))}function E(a,b){var c=!1,d=D.hg(b,a);D.kg(b,d)&&(c=D.cg(b,d,0),d=D.yd(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=D.Pa(b,c),c=E(d,b)):c="RESOLVE"==
d.to);return c}function u(a,b,c,d){var h=c.W,e=b.Ro,f=b.$g.Xg,k=b.$g.Ns,g=D.nt(a,D.aM(a,d),D.nq),m=[],l=[],p=[],g=D.clone(g,function(b){var d;if(-1<qa.indexOf(b.type))l.push(b),d=b;else{d=M.aJ(b);if(d.type==M.nd)for(var g=0;g<f.length;g++)if(f[g][0]==b){f[g]=[b,d];d.p.Xb=b.p.Xb;c.W.push(d.p);break}if(b.type==M.Ne)for(g=0;g<f.length;g++){if(k[g][0]==b){k[g]=[b,d];d.p=f[g][1].p;break}}else-1<h.indexOf(b.p)&&(e?(C.ps(b.p,C.ne),C.ps(d.p,C.oe)):(C.ps(b.p,C.Ac),C.ps(d.p,C.Kc)),h.push(d.p));var n=D.hg(a,
b);D.ih(a,n,function(a,b,c){-1<qa.indexOf(b.type)&&m.push([b,d,c])});if(b.type!==M.yg)for(g=0;g<b.Qa.length;g++)d.Qa[g].Em=b.Qa[g];b=!0;for(g=0;g<D.hm(a,n);g++){var t=D.Hh(a,n,g),t=D.Pa(a,t);-1==qa.indexOf(t.type)&&(b=!1)}b&&p.push(d)}return d},function(a){var b=I(a,!0);b.Em=a;return b});D.Lf(g,function(a,b,c){D.Pa(g,a).type===M.yg&&(c.Em=null)});for(var n=0;n<l.length;n++)D.Gf(g,D.hg(g,l[n]));D.Iu(g);b=M.gK(e);var n=D.H(a,b),t=M.Wu();D.H(a,t);var v=x("COLOR","COPY",1,1,1,!0);D.s(a,d,t,v);var r=x("COLOR",
"u_sampler_left",1,1,1,!0);r.xt=!0;r.Ga=L.I;r.Fa=L.I;D.s(a,t,b,r);d.dc||(d=M.Wu(),D.H(g,d),r=x("COLOR","COPY",1,1,1,!0),r.Em=v,v=D.Oo(g)[0],v=D.Pa(g,v),D.s(g,v,d,r));d=x("COLOR","u_sampler_right",1,1,1,!0);d.Ga=L.I;d.Fa=L.I;D.DH(g,a,[D.Oo(g)[0],n,d]);for(n=0;n<m.length;n++)D.s(a,m[n][0],m[n][1],m[n][2]);d=x("SCREEN","NONE",0,0,0,!1);for(n=0;n<p.length;n++)D.s(a,t,p[n],d);e&&z(a,.5,1);return b}function z(a,b,c){var d=[];D.la(a,function(b,c){if(-1==qa.indexOf(c.type)&&c.Qa.length&&B(a,c,M.pi))for(var h=
0;h<c.Qa.length;h++){var e=c.Qa[h];-1==d.indexOf(e)&&d.push(e)}});D.Lf(a,function(b,c,h){b=D.Pa(a,b);c=D.Pa(a,c);-1==qa.indexOf(b.type)&&B(a,c,M.pi)&&-1==d.indexOf(h)&&d.push(h)});for(var h=0;h<d.length;h++)d[h].cl*=b,d[h].el*=c}function x(a,b,c,d,h,e){return{from:a,to:b,size:c,cl:d,el:h,Wp:e,pc:!0,Xa:null,$i:!1,Ge:!1,Ga:L.Td,Fa:L.Td,xt:!1,$p:!1}}function I(a,b){if(b){var c=a.Xa;a.Xa=null}a.Xa&&T.r("Failed to clone slink with attached texture");var d=T.yh(a);b&&(a.Xa=c,d.Xa=c);return d}function B(a,
b,c){if(b.type==c)return!0;b=J(a,b);for(var d=0;d<b.length;d++)if(B(a,b[d],c))return!0;return!1}function G(a,b,c){if(b.type==c)return!0;b=A(a,b);for(var d=0;d<b.length;d++)if(G(a,b[d],c))return!0;return!1}function A(a,b){var c=D.hg(a,b);c==D.cu&&T.r("Subscene not in graph");for(var d=[],h=D.hm(a,c),e=0;e<h;e++){var f=D.Hh(a,c,e);f!=c&&d.push(D.Pa(a,f))}return d}function J(a,b){var c=D.hg(a,b);c==D.cu&&T.r("Subscene not in graph");for(var d=[],h=D.kg(a,c),e=0;e<h;e++){var f=D.cg(a,c,e);f!=c&&d.push(D.Pa(a,
f))}return d}function t(a){var b=[],d=[];c(a,function(a){a.Xa&&-1==b.indexOf(a.Xa)&&(b.push(a.Xa),d.push(a.Xa,b.length-1))});return d}function h(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.Wp){var d=a.cl,h=a.el;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(h)!=h&&(h=h.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==h?"":h)+"S")}else d=a.cl,h=a.el,c+=a.size*d+"x"+a.size*h;if("SCREEN"!=a.from){c+=" ";if(a.Ge)c+="RR";else{var d=a.Ga,h=a.Fa,e="";d==L.I?e+="L":d==L.Td&&(e+="N");h==L.I?
e+="L":h==L.Td&&(e+="N");c+=e}for(d=0;d<b.length;d+=2)b[d]==a.Xa&&(c+=" "+b[d+1])}return c+")\\n"}var C=q("__camera"),k=q("__config"),F=q("__debug"),D=q("__graph"),aa=q("__renderer"),M=q("__subscene"),L=q("__textures"),T=q("__util"),N=k.ro,U=k.A,O=k.Ep,qa=[M.qh,M.Jc,M.Sc,M.me];a.OI=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.XP=c;a.CJ=function(a,b,c,h){function f(c){var d=C.qc(Qa,
!0);b.W.push(d);d=M.ik(c,d,!1,E,G,ya,ta,Ca,a.ei);D.H(k,d);c==M.of?(D.s(k,l[0],d,x("COLOR","COLOR",1,1,1,!0)),d.Qa.push(x("DEPTH","DEPTH",1,1,1,!0))):(c=Z&&l[0].type==M.zl?Cb:l[0],D.s(k,c,d,xa),D.s(k,c,d,rb));Na&&(D.s(k,Na,d,lb),D.s(k,Na,d,Ra));for(c=0;c<t.length;c++)D.s(k,t[c],d,v[c]);bc&&D.s(k,bc,d,fd);if(r.length){var h=r.length;for(c=0;c<h;c++)D.s(k,r[c],d,w[c])}if(z.length)for(c=0;c<z.length;c++)D.s(k,z[c],d,q[c]);cc&&D.s(k,cc,d,$c);return d}var k=D.create(),l=[],n=[],t=[],v=[],r=[],w=[],z=[],
q=[],G=a.LM,E=a.xc,K=a.shore_smoothing,B=a.pP,qa=a.ssao,va=a.god_rays,P=a.$g,Y=a.bC,na=a.dI,aa=a.motion_blur,Aa=a.compositing,ja=a.antialiasing,ta=a.sn,ya=a.TE,Ca=a.bd,sa=a.tN,S=a.BI,oa=a.iM,wa=a.IN,Da=a.dof,La=a.xK,ba=a.refractions,la=Boolean(h.length),Z=1<U.tc,rb=x("COLOR","COLOR",1,1,1,!0),xa=x("DEPTH","DEPTH",1,1,1,!0);if(Z){I(xa);var Ia=I(xa);rb.$i=!0;rb.Ge=!0;xa.$i=!0;xa.Ge=!0}var Qa=b.W[0];if(Ca){C.by(Qa,Ca);for(var ga=0;ga<Ca.eg.length;ga++)for(var Nb=Ca.csm_num,ra=0;ra<Nb;ra++){var Q=M.bK(ra,
ga,Ca,G);D.H(k,Q);t.push(Q);var Sa=Ca.csm_resolution,Fa=Q.p;b.pD.push(Fa);Fa.width=Sa;Fa.height=Sa;Q.jb=!1;var Ja=x("DEPTH","u_shadow_map"+(0<ga?ga:ra),Sa,1,1,!1);U.io&&(Ja.Ga=L.I,Ja.Fa=L.I,Ja.$p=!0);v.push(Ja);(F.II()||U.qD)&&Q.Qa.push(x("COLOR","COLOR",Sa,1,1,!1))}}if(P&&P.oC&&!la)for(ra=0;ra<P.oC;ra++){Fa=C.Oc(C.od);Fa.width=a.Ch;Fa.height=a.Ch;C.at(Fa,90,.1,100);C.rj(Fa,Fa.pb);var Ka=M.ik(M.Sc,Fa,!1,E,G,ya,ta,null,a.ei);Ka.jk=T.uL();for(ga=0;6>ga;ga++)Ka.oo.push(C.rJ());D.H(k,Ka);var sb=x("CUBEMAP",
"u_cube_reflection",a.Ch,1,1,!1);sb.Ga=L.I;sb.Fa=L.I;q.push(sb);if(P.uB){var Ma=M.ik(M.me,Fa,!1,E,G,ya,ta,null,a.ei);Ma.jk=Ka.jk;Ma.oo=Ka.oo;D.H(k,Ma);var Ga=x("DEPTH","DEPTH",a.Ch,1,1,!1),mb=x("COLOR","COLOR",a.Ch,1,1,!1);D.s(k,Ka,Ma,Ga);D.s(k,Ka,Ma,mb);z.push(Ma);P.$u.push(Ma)}else{var dc=x("DEPTH","DEPTH",a.Ch,1,1,!1);Ka.Qa.push(dc);z.push(Ka)}P.Bh.push(Ka)}if(P&&0<P.NC.length&&!la)for(ga=0;ga<P.NC.length;ga++)Fa=C.qc(Qa,!0),Fa.Xb=new Float32Array(4),b.W.push(Fa),Ka=M.ik(M.nd,Fa,!1,E,G,ya,ta,null,
a.ei),D.H(k,Ka),sb=x("COLOR","u_plane_reflection",1,a.ng,a.ng,!0),sb.Ga=L.I,sb.Fa=L.I,w.push(sb),P.uB?(Ma=M.ik(M.Ne,Fa,!1,E,G,ya,ta,null,a.ei),D.H(k,Ma),Ga=x("DEPTH","DEPTH",1,a.ng,a.ng,!0),mb=x("COLOR","COLOR",1,a.ng,a.ng,!0),mb.Ga=L.Td,mb.Fa=L.Td,D.s(k,Ka,Ma,Ga),D.s(k,Ka,Ma,mb),P.Ns.push([Ma]),r.push(Ma)):(dc=x("DEPTH","DEPTH",1,a.ng,a.ng,!0),Ka.Qa.push(dc),r.push(Ka)),P.Xg.push([Ka]);if(a.rc){var Na=M.VJ();D.H(k,Na);Sa=O.Jr;Na.p.width=Sa;Na.p.height=Sa;var lb=x("DEPTH","u_grass_map_depth",Sa,1,
1,!1);U.Sb||(lb.Ga=L.I,lb.Fa=L.I);var Ra=x("COLOR","u_grass_map_color",Sa,1,1,!1);Ra.Ga=L.I;Ra.Fa=L.I}else Ra=lb=Na=null;if(La&&Ca){var Wa=C.qc(Qa,!0);b.W.push(Wa);var cb=M.cK(Wa,G);D.H(k,cb);cb.self_shadow_normal_offset=Ca.self_shadow_normal_offset;for(ra=0;ra<t.length;ra++)Q=t[ra],D.s(k,Q,cb,v[ra]);var Vb=x("COLOR","u_color",1,1,1,!0),tc=x("DEPTH","u_depth",1,1,1,!0);if(qa){var xb=C.qc(Qa,!0);b.W.push(xb);var Oa=a.GP,Wb=M.eK(xb,ya,Oa);D.H(k,Wb);var gd=x("COLOR","u_ssao_mask",1,1,1,!0);D.s(k,cb,
Wb,Vb);D.s(k,cb,Wb,tc);var Lc=C.qc(Qa,!0);b.W.push(Lc);var uc=M.fK(Lc,Oa);D.H(k,uc);var pd=x("COLOR","u_shadow_mask",1,1,1,!0);D.s(k,Wb,uc,gd);D.s(k,cb,uc,tc)}Z?cb.Qa.push(x("DEPTH","DEPTH",1,1,1,!0)):cb.Qa.push(xa);Na&&(D.s(k,Na,cb,lb),D.s(k,Na,cb,Ra))}else cb=null;var Cb=M.ik(M.Bb,Qa,!0,E,G,ya,ta,null,a.ei);D.H(k,Cb);if(Z){var fb=M.dr();D.H(k,fb);n.push(fb);var ec=x("COLOR","RESOLVE",1,1,1,!0);ec.$i=!0;ec.Ge=!0;var Ec=x("DEPTH","RESOLVE",1,1,1,!0);Ec.$i=!0;Ec.Ge=!0;D.s(k,Cb,fb,ec);D.s(k,Cb,fb,Ec)}else n.push(Cb);
cb&&(gd?D.s(k,uc,Cb,pd):Ca?D.s(k,cb,Cb,x("COLOR","u_shadow_mask",1,1,1,!0)):T.r("Internal error"));Na&&(D.s(k,Na,Cb,lb),D.s(k,Na,Cb,Ra));if(r.length)for(var hd=r.length,ga=0;ga<hd;ga++)D.s(k,r[ga],Cb,w[ga]);if(z.length)for(ga=0;ga<z.length;ga++)D.s(k,z[ga],Cb,q[ga]);l=n;n=[];if(!la&&a.bJ){Fa=C.qc(Qa,!0);Fa.width=1;Fa.height=1;b.W.push(Fa);var vc=M.iA(Fa,!1,G);D.H(k,vc);if(a.xg){Fa=C.qc(Qa,!0);Fa.width=1;Fa.height=1;b.W.push(Fa);var Sc=M.iA(Fa,!0,G);D.H(k,Sc);D.s(k,vc,Sc,x("COLOR","COLOR",1,1,1,!1));
D.s(k,vc,Sc,x("DEPTH","DEPTH",1,1,1,!1))}}else vc=null;if(!Y.refractions&&!ba||la)cc=null;else{if(Z)cc=fb;else{var cc=M.Wu();D.H(k,cc);D.s(k,l[0],cc,x("COLOR","COPY",1,1,1,!0))}var $c=x("COLOR","u_refractmap",1,1,1,!0)}if(La&&(ba||K||B)){var ad=C.qc(Qa,!0);b.W.push(ad);var bc=M.SJ(ad);D.H(k,bc);D.s(k,Z?fb:Cb,bc,x("DEPTH","u_depth",1,1,1,!0));var fd=x("COLOR","u_scene_depth",1,1,1,!0);fd.Ga=L.Td;fd.Fa=L.Td}else bc=null;if(a.Hr){var Tc=f(M.zc);n.push(Tc);l=n;n=[]}if(a.Ih){var Uc=C.qc(Qa,!0);b.W.push(Uc);
var Jb=M.ik(M.Ed,Uc,!1,E,G,ya,ta);D.H(k,Jb);bc&&D.s(k,bc,Jb,fd);cc&&D.s(k,cc,Jb,$c);Na&&(D.s(k,Na,Jb,lb),D.s(k,Na,Jb,Ra));if(r.length)for(hd=r.length,ga=0;ga<hd;ga++)D.s(k,r[ga],Jb,w[ga]);if(z.length)for(ga=0;ga<z.length;ga++)D.s(k,z[ga],Jb,q[ga]);D.s(k,Z?fb:Cb,Jb,Z?Ia:xa);var wc=M.ed("X_GLOW_BLUR");wc.ub="GLOW_MASK_SMALL";wc.Kf=a.Ni.small_glow_mask_width;var kd=x("COLOR","u_color",1,1,1,!0);kd.Ga=L.I;kd.Fa=L.I;D.H(k,wc);D.s(k,Jb,wc,kd);var xc=M.ed("Y_GLOW_BLUR");xc.ub="GLOW_MASK_SMALL";xc.Kf=a.Ni.small_glow_mask_width;
var nc=x("COLOR","u_color",1,.5,.5,!0);nc.Ga=L.I;nc.Fa=L.I;D.H(k,xc);D.s(k,wc,xc,nc);var Vc=M.ed("X_GLOW_BLUR");Vc.ub="GLOW_MASK_LARGE";Vc.Kf=a.Ni.large_glow_mask_width;var Kb=x("COLOR","u_color",1,.5,.5,!0);Kb.Ga=L.I;Kb.Fa=L.I;D.H(k,Vc);D.s(k,xc,Vc,Kb);var fc=M.ed("Y_GLOW_BLUR");fc.ub="GLOW_MASK_LARGE";fc.Kf=a.Ni.large_glow_mask_width;var yc=x("COLOR","u_color",1,.25,.25,!0);yc.Ga=L.I;yc.Fa=L.I;D.H(k,fc);D.s(k,Vc,fc,yc);var jb=C.qc(Qa,!0);b.W.push(jb);var Xa=M.TJ(jb,a);D.H(k,Xa);var Db=x("COLOR",
"u_src_color",1,1,1,!0);if(a.Hr)if(Z){var ab=M.dr();D.H(k,ab);D.s(k,Tc,ab,ec);D.s(k,Tc,ab,Ec);D.s(k,ab,Xa,Db)}else D.s(k,Tc,Xa,Db);else D.s(k,Z?fb:Cb,Xa,Db);D.s(k,a.Hr?Tc:Cb,Xa,xa);var Fc=x("COLOR","u_glow_mask_small",1,.5,.5,!0);Fc.Ga=L.I;Fc.Fa=L.I;D.s(k,xc,Xa,Fc);var Mc=x("COLOR","u_glow_mask_large",1,.25,.25,!0);Mc.Ga=L.I;Mc.Fa=L.I;D.s(k,fc,Xa,Mc);l=[Xa];n=[]}a.Hr||(Tc=f(M.zc),n.push(Tc),l=n,n=[]);if(U.debug_view){Fa=C.qc(Qa,!0);b.W.push(Fa);var tb=M.RJ(Fa);n.push(tb);D.H(k,tb);D.s(k,l[0],tb,rb);
D.s(k,l[0],tb,xa);Na&&(D.s(k,Na,tb,lb),D.s(k,Na,tb,Ra));F.IO(tb);l=n;n=[]}if(Z){var oc=M.dr();D.H(k,oc);n.push(oc);D.s(k,l[0],oc,ec);D.s(k,l[0],oc,Ec);l=n;n=[]}var gc=l.slice(0);if(!la&&a.jH&&!U.HA){Fa=C.qc(Qa,!0);b.W.push(Fa);var hc=M.NJ(Fa);D.H(k,hc);D.s(k,l[0],hc,Z?Ia:xa)}if(va&&La&&!la){var Lb=oa.rm,Wc=oa.Vv,Mb=oa.Zm,Ta=l[0],zc=E?!0:!1,bd=x("DEPTH","u_input",1,1,1,!0),Nc=x("COLOR","u_input",1,.25,.25,!0);Nc.Ga=L.I;Nc.Fa=L.I;var wb=Lb/Mb,Qb=C.qc(Qa,!0);b.W.push(Qb);var kb=M.Xu(Qb,zc,Lb,!0,wb,G,
Mb);D.H(k,kb);D.s(k,Ta,kb,bd);var wb=Lb/Mb*.5,db=C.qc(Qa,!0);b.W.push(db);var Rb=M.Xu(db,zc,Lb,!1,wb,G,Mb);D.H(k,Rb);D.s(k,kb,Rb,Nc);var wb=Lb/Mb*.25,cd=C.qc(Qa,!0);b.W.push(cd);var Oc=M.Xu(cd,zc,Lb,!1,wb,G,Mb);D.H(k,Oc);D.s(k,Rb,Oc,Nc);var ic=M.UJ(Wc,G);n.push(ic);D.H(k,ic);D.s(k,Ta,ic,x("COLOR","u_main",1,1,1,!0));D.s(k,Oc,ic,x("COLOR","u_god_rays",1,1,1,!0));l=n;n=[]}if(na&&!la){var Ta=l[0],pc=M.WJ();D.H(k,pc);D.s(k,Ta,pc,x("COLOR","u_input",1,1,1,!0));var yb=M.OJ();D.H(k,yb);yb.p.width=U.Ao?2:
1;yb.p.height=U.Ao?2:1;var Gc=x("COLOR","u_input",1,.25,.25,!0);Gc.Ga=L.I;Gc.Fa=L.I;var qc=x("COLOR","u_luminance",1,.25,.25,!0);qc.Ga=L.I;qc.Fa=L.I;D.s(k,pc,yb,Gc);var dd=na.key,Ac=na.edge_lum,Xb=C.qc(Qa,!0);b.W.push(Xb);var Ua=M.XJ(dd,Ac,G,Xb);D.H(k,Ua);D.s(k,Ta,Ua,x("COLOR","u_main",1,1,1,!0));D.s(k,pc,Ua,qc);D.s(k,yb,Ua,x("COLOR","u_average_lum",1,1,1,!1));var nb=x("COLOR","u_color",1,.25,.25,!0);nb.Ga=L.I;nb.Fa=L.I;wc=M.hA("X_BLUR");D.H(k,wc);D.s(k,Ua,wc,nb);xc=M.hA("Y_BLUR");D.H(k,xc);D.s(k,
wc,xc,nb);var Ya=M.PJ(na.blur);D.H(k,Ya);var Yb=x("COLOR","u_bloom",1,.25,.25,!0);Yb.Ga=L.I;Yb.Fa=L.I;D.s(k,xc,Ya,Yb);D.s(k,Ta,Ya,x("COLOR","u_main",1,1,1,!0));n.push(Ya);l=n;n=[]}if(Da&&La&&!la){var Ta=l[0],$a=C.qc(Qa,!0);b.W.push($a);if(c.Xc){var rc=x("COLOR","u_color",1,1,1,!0);rc.Ga=L.I;rc.Fa=L.I;var zb=x("DEPTH","u_depth",1,1,1,!0),Ab=x("COLOR","u_color",1,.5,.5,!0);Ab.Ga=L.Td;Ab.Fa=L.Td;nb=x("COLOR","u_color",1,.5,.5,!0);nb.Ga=L.Td;nb.Fa=L.Td;var Zb=x("COLOR","u_blurred1",1,.5,.5,!0);Zb.Ga=
L.I;Zb.Fa=L.I;var $b=x("COLOR","u_blurred2",1,.5,.5,!0);$b.Ga=L.I;$b.Fa=L.I;var pb=gc[0];if(c.fd){var gb=C.qc(Qa,!0);b.W.push(gb);var ub=M.Vu(gb,"COC_FOREGROUND");gb.dof_distance=c.dof_distance;gb.Dc=c.Dc;gb.dof_front_start=c.dof_front_start;gb.dof_front_end=c.dof_front_end;gb.dof_rear_start=c.dof_rear_start;gb.dof_rear_end=c.dof_rear_end;gb.dof_power=c.dof_power;gb.Xc=c.Xc;gb.gb=c.gb;gb.fd=c.fd;gb.dof_on=!0;D.H(k,ub);D.s(k,Ta,ub,rc);D.s(k,pb,ub,zb);var Bb=M.ed("X_ALPHA_BLUR");D.H(k,Bb);D.s(k,ub,
Bb,Ab);var Pa=M.ed("Y_ALPHA_BLUR");D.H(k,Pa);D.s(k,Bb,Pa,nb);var Va=C.qc(Qa,!0),ob=M.Vu(Va,"COC_COMBINE");b.W.push(Va);Va.dof_distance=c.dof_distance;Va.Dc=c.Dc;Va.dof_front_start=c.dof_front_start;Va.dof_front_end=c.dof_front_end;Va.dof_rear_start=c.dof_rear_start;Va.dof_rear_end=c.dof_rear_end;Va.dof_power=c.dof_power;Va.Xc=c.Xc;Va.gb=c.gb;Va.fd=c.fd;Va.dof_on=!0;D.H(k,ob);D.s(k,Ta,ob,rc);D.s(k,pb,ob,zb);D.s(k,Pa,ob,x("COLOR","u_coc_fg",1,.5,.5,!0))}else Va=C.qc(Qa,!0),b.W.push(Va),ob=M.Vu(Va,"COC_ALL"),
Va.dof_distance=c.dof_distance,Va.Dc=c.Dc,Va.dof_front_start=c.dof_front_start,Va.dof_front_end=c.dof_front_end,Va.dof_rear_start=c.dof_rear_start,Va.dof_rear_end=c.dof_rear_end,Va.dof_power=c.dof_power,Va.Xc=c.Xc,Va.gb=c.gb,Va.fd=c.fd,Va.dof_on=!0,D.H(k,ob),D.s(k,Ta,ob,rc),D.s(k,pb,ob,zb);var hb=M.ed("X_DOF_BLUR");hb.p.gb=c.gb;D.H(k,hb);D.s(k,ob,hb,Ab);var Za=M.ed("Y_DOF_BLUR");Za.p.gb=c.gb;D.H(k,Za);D.s(k,hb,Za,nb);var vb=M.ed("Y_DOF_BLUR");vb.p.gb=c.gb;D.H(k,vb);D.s(k,hb,vb,nb);var eb=M.jA($a);
$a.dof_distance=c.dof_distance;$a.Dc=c.Dc;$a.dof_front_start=c.dof_front_start;$a.dof_front_end=c.dof_front_end;$a.dof_rear_start=c.dof_rear_start;$a.dof_rear_end=c.dof_rear_end;$a.dof_power=c.dof_power;$a.Xc=c.Xc;$a.gb=c.gb;$a.fd=c.fd;$a.dof_on=!0;n.push(eb);D.H(k,eb);D.s(k,Ta,eb,x("COLOR","u_sharp",1,1,1,!0));D.s(k,Za,eb,Zb);D.s(k,vb,eb,$b)}else{var ac=x("COLOR","u_color",1,1,1,!0);ac.Ga=L.I;ac.Fa=L.I;var Sb=x("COLOR","u_color",1,1,1,!0);Sb.Ga=L.I;Sb.Fa=L.I;hb=M.ed("X_BLUR");D.H(k,hb);D.s(k,Ta,
hb,ac);var Ob=M.ed("Y_BLUR");D.H(k,Ob);D.s(k,hb,Ob,Sb);var Pc=gc[0],eb=M.jA($a);$a.dof_distance=c.dof_distance;$a.Dc=c.Dc;$a.dof_front_start=c.dof_front_start;$a.dof_front_end=c.dof_front_end;$a.dof_rear_start=c.dof_rear_start;$a.dof_rear_end=c.dof_rear_end;$a.dof_power=c.dof_power;$a.Xc=c.Xc;$a.gb=c.gb;$a.fd=c.fd;$a.dof_on=!0;n.push(eb);D.H(k,eb);D.s(k,Ta,eb,x("COLOR","u_sharp",1,1,1,!0));D.s(k,Ob,eb,x("COLOR","u_blurred",1,1,1,!0));D.s(k,Pc,eb,x("DEPTH","u_depth",1,1,1,!0))}l=n;n=[]}if(a.xg){var Qc=
f(M.of);n.push(Qc);l=n;n=[]}if(aa&&!la){var Tb=l[0],jc=M.YJ(sa.mb_decay_threshold,sa.mb_factor);n.push(jc);D.H(k,jc);D.s(k,Tb,jc,x("COLOR","u_mb_tex_curr",1,1,1,!0));jc.Qa.push(x("COLOR","u_mb_tex_accum",1,1,1,!0));l=n;n=[]}if(!la&&a.outline){var Ta=l[0],Eb=C.qc(Qa,!0);b.W.push(Eb);var Bc=M.$J(Eb,G);D.H(k,Bc);var Fb=M.ed("X_EXTEND"),Rc=x("COLOR","u_color",1,1,1,!0),kc=x("COLOR","u_outline_mask",1,1,1,!0);Fb.Wo=!0;D.H(k,Fb);D.s(k,Bc,Fb,Rc);var Hc=x("COLOR","u_color",1,.5,.5,!0);Hc.Ga=L.I;Hc.Fa=L.I;
var qb=M.ed("Y_EXTEND");qb.Wo=!0;D.H(k,qb);D.s(k,Fb,qb,Hc);hb=M.ed("X_BLUR");hb.Wo=!0;D.H(k,hb);D.s(k,qb,hb,Hc);var Ic=x("COLOR","u_color",1,.25,.25,!0);Ic.Ga=L.I;Ic.Fa=L.I;var lc=x("COLOR","u_outline_mask_blurred",1,.25,.25,!0);lc.Ga=L.I;lc.Fa=L.I;Ob=M.ed("Y_BLUR");Ob.Wo=!0;D.H(k,Ob);D.s(k,hb,Ob,Ic);var Gb=M.ZJ(wa);D.H(k,Gb);D.s(k,Ta,Gb,x("COLOR","u_outline_src",1,1,1,!0));D.s(k,Bc,Gb,kc);D.s(k,Ob,Gb,lc);n.push(Gb);l=n;n=[]}e(k,La);if((a.anaglyph_use||a.Ro)&&!la){var Hb=u(k,a,b,l[0]);n.push(Hb);
l=n;n=[]}if(Aa&&!la){var Ta=l[0],Cc=M.QJ(S.brightness,S.contrast,S.exposure,S.saturation);D.H(k,Cc);D.s(k,Ta,Cc,x("COLOR","u_color",1,1,1,!0));n.push(Cc);l=n;n=[]}if(ja){Ta=l[0];if(U.smaa){var ib=x("COLOR","u_color",1,1,1,!0);ib.Ga=L.I;ib.Fa=L.I;var bb=M.Yu(M.uq,a);D.H(k,bb);D.s(k,Ta,bb,ib);var mc=M.Yu(M.zn,a);D.H(k,mc);D.s(k,bb,mc,ib);var Jc=x("COLOR","u_search_tex",1,1,1,!1),Ib=x("COLOR","u_area_tex",1,1,1,!1);Jc.Ga=L.I;Jc.Fa=L.I;Ib.Ga=L.I;Ib.Fa=L.I;mc.Qa.push(Jc);mc.Qa.push(Ib);var Xc=M.Yu(M.vq,
a);D.H(k,Xc);D.s(k,Ta,Xc,ib);var Yc=x("COLOR","u_blend",1,1,1,!0);Yc.Ga=L.I;Yc.Fa=L.I;D.s(k,mc,Xc,Yc);n.push(Xc)}else{var ed=M.MJ(a);D.H(k,ed);var Pb=x("COLOR","u_color",1,1,1,!0);Pb.Ga=L.I;Pb.Fa=L.I;D.s(k,Ta,ed,Pb);n.push(ed)}l=n;n=[]}var jd=D.hg(k,l[0]);if(l[0].type==M.yg||l[0].type==M.zl)var qd=!0;else qd=!1,D.ih(k,jd,function(a,b,c){if(c.from==c.to)return qd=!0});if(qd){var ld=M.ed("NONE");D.H(k,ld);D.s(k,l[0],ld,x("COLOR","u_color",1,1,1,!0));n.push(ld);l=n;n=[]}n.push(l[0]);vc&&(Sc?n.push(Sc):
n.push(vc));hc&&n.push(hc);Sa=O.fr;if(a.gt.OC){var rd=a.gt,sd=a.sn,xd=sd.Rm,Sa=xd?xd.OP:Sa,yd=M.dK(sd,G,rd,Sa);D.H(k,yd);n.push(yd)}var sc=M.kA();D.H(k,sc);for(ra=0;ra<n.length;ra++){var md=n[ra];switch(md.type){case M.Le:case M.ph:D.s(k,md,sc,x("COLOR","NONE",1,1,1,!1));D.s(k,md,sc,x("DEPTH","NONE",1,1,1,!1));break;case M.Of:D.s(k,md,sc,x("CUBEMAP","u_sky",Sa,1,1,!1));break;case M.vl:D.s(k,md,sc,x("COLOR","NONE",1,1,1,!0));break;default:if(la){var td=h[0].q,Dc=x("COLOR","OFFSCREEN",1,1,1,!0);Dc.Xa=
td;D.s(k,n[ra],sc,Dc);for(ga=1;ga<h.length;ga++){var Zc=h[ga].q,nd=M.ed("NONE");D.H(k,nd);D.s(k,n[ra],nd,x("COLOR","SCALE",1,1,1,!0));var ud=Zc.$h/td.$h,Dc=x("COLOR","OFFSCREEN",1,ud,ud,!0);Dc.Xa=Zc;D.s(k,nd,sc,Dc)}}else D.s(k,n[ra],sc,x("SCREEN","NONE",1,1,1,!0))}}fb&&!J(k,fb).length&&(D.Gf(k,D.hg(k,fb)),D.Iu(k));e(k,La);d(k,La);if(N.enabled){var vd=p(k);vd&&y(k,vd)}g(k);m(k);Ca&&D.la(k,function(a,b){if(b.type==M.Oe||b.type==M.zc||b.type==M.of){for(var c=0,d=A(k,b),h=0,e=0;e<d.length;e++){var f=
d[e];f.type==M.Jc&&(h++,b.Vk=b.Vk||[],b.Vk[0<f.rg?f.rg:c]=f.p.lb,c++)}b.Bt&&b.At||(U.os?b.iy=new Float32Array(9*h):(b.Bt=new Float32Array(4*h),b.At=new Float32Array(4*h)))}});return k};a.zN=z;a.jd=function(a,b,c){var d=a.Kf;a.Ox[0]=b*a.vb[0]*d;a.Ox[1]=c*a.vb[1]*d};a.wc=function(a,b){a.Kf=b};a.BJ=function(){var a=D.create(),b=M.aK(),c=C.Oc(C.Tc);c.width=512;c.height=512;b.p=c;D.H(a,b);b.Qa.push(x("COLOR","u_color",512,1,1,!1));c=M.kA();D.H(a,c);D.s(a,b,c,x("COLOR","NONE",512,1,1,!1));g(a);m(a);return a};
a.$K=function(a){var b=null;D.la(a,function(a,c){return c.p&&null===c.p.xe?(b=c,!0):!1});return b};a.rb=function(a,b,c){a=A(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.Gv=function(a,b,c){a=A(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.RS=B;a.TS=G;a.YL=A;a.bM=J;a.Pb=function(a,b){var c=null;D.la(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.rK=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+
"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=t(a);D.la(a,function(a,d){var k=b+="    ",e=M.Fx(d);if(d.p){for(var e=e+"\\n",f=0;f<c.length;f+=2){var g=d.p.bc;c[f]==g&&(e=L.lm(g)?e+("CR"+c[f+1]+" "):e+("C"+c[f+1]+" "))}for(f=0;f<c.length;f+=2)g=d.p.ue,c[f]==g&&(e=L.lm(g)?e+("DR"+c[f+1]):e+("D"+c[f+1]))}d.Qa.length&&(e+="\\n-----\\n");for(f=0;f<d.Qa.length;f++)e+=h(d.Qa[f],c);f=d.type==M.Al?"dotted":d.enqueue?"solid":"dashed";b=k+(String(a)+' [label="'+e+'" color="black" style="'+
(f+",bold")+'"];\n')});D.Lf(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+h(e,c)+'" style="'+(e.pc?"solid":"dotted")+'"];\n'});return b+="}"};a.DJ=function(a){a=D.RP(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b}};b4w.module.__subscene=function(a,q){function e(a,b){a.Cs=b;a.gw=new Float32Array(3*b);a.cp=new Float32Array(4*b);a.bp=new Float32Array(4*b)}function d(a){a={type:a,ub:"",yb:!1,vC:!1,pu:!1,xs:!1,qo:0,Ue:0,kk:[],debug_view_mode:0,debug_colors_seed:0,qA:1,jv:!1,time:0,p:null,jk:null,oo:[],La:[],Qa:[],gh:[],mi:new Float32Array(3),Hd:new Float32Array(3),Yd:new Float32Array(4),tf:new Float32Array(4),Xd:new Float32Array(16),it:0,$f:0,Cs:0,gw:null,cp:null,bp:null,gT:null,Jd:new Float32Array(3),Rd:new Float32Array(3),
jt:new Float32Array(4),RD:new Float32Array(3),Gx:new Float32Array([0,0,1]),SD:new Float32Array(4),ht:new Float32Array(3),kp:0,lv:0,Wo:!1,Vh:new Float32Array(3),mh:!1,Eu:0,nh:null,my:0,ny:0,Jj:0,xc:null,Sf:!1,Iz:0,Jz:new Float32Array(2),Hz:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,Qm:new Float32Array(3),ssao_hemisphere:0,
ssao_blur_depth:0,ssao_blur_discard_value:0,Vm:0,Um:0,Tm:0,GD:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,rm:0,Ts:0,Zm:0,Zu:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,Bt:null,At:null,iy:null,Vk:null,dc:!1,OA:"",Pq:0,El:0,Oq:0,vu:0,rv:0,mb_decay_threshold:0,mb_factor:0,gC:0,Os:"",Xz:"",GM:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,Ox:new Float32Array(2),vb:new Float32Array(2),
lk:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,rg:0,Bw:!0,tD:!1,yD:!1,uD:!1,vD:!1,xD:!1,wD:!1,sD:"",dq:!1,fq:!1,gq:!1,Lb:!0,enqueue:!0,jb:!0,qb:!0,sd:!0,ra:!0,Kf:1};a.vb[0]=1;a.vb[1]=1;a.lk[2]=.5;a.lk[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function g(a,c){return-b(a.Pf,c.Pf)||b(a.Df,c.Df)||b(a.nb.qx,c.nb.qx)}var l=q("__camera"),w=q("__config"),f=q("__util"),n=q("__boundings"),r=w.nc;a.Bb=0;a.zc=1;a.of=2;a.nd=3;a.Sc=4;a.Ne=5;a.me=6;a.Ed=7;
a.Jc=8;a.Oe=9;a.qh=10;a.Ob=11;a.un=12;a.wn=13;a.zl=14;a.Le=15;a.ph=16;a.Me=17;a.vl=18;a.xy=19;a.wq=20;a.fu=21;a.ry=22;a.zn=23;a.uq=24;a.du=25;a.vq=26;a.Tt=27;a.yg=28;a.St=29;a.vn=30;a.Nf=31;a.xl=32;a.oi=33;a.rq=34;a.Of=35;a.Ut=36;a.pi=37;a.LUMINANCE=38;a.XE=39;a.sq=40;a.tn=41;a.UG=42;a.Al=43;a.xn=44;a.bK=function(a,b,g,n){var r=d(8);r.Zu=a;r.self_shadow_polygon_offset=g.self_shadow_polygon_offset;r.rg=b;switch(g.eg[b]){case "SPOT":case "POINT":r.p=l.Oc(l.od);a=f.rad_to_deg(g.ED[b]);l.at(r.p,a,g.Zn[b],
g.Yn[b]);break;default:r.p=l.Oc(l.rh)}e(r,n);return r};a.aJ=function(a){var b=a.p;a.p=null;var d=f.P(a);a.p=b;d.p=l.qc(b,!0);return d};a.VJ=function(){var a=d(10);a.p=l.Oc(l.zg);return a};a.ed=function(a){var b=d(11);b.jb=!1;b.qb=!1;b.sd=!1;b.dc=!0;b.p=l.Oc(l.Tc);b.Os=a;switch(a){case "NONE":b.vb[0]=1;b.vb[1]=1;break;case "GRAYSCALE":b.vb[0]=1;b.vb[1]=1;break;case "X_BLUR":b.vb[0]=1;b.vb[1]=0;break;case "Y_BLUR":b.vb[0]=0;b.vb[1]=1;break;case "X_GLOW_BLUR":b.vb[0]=1;b.vb[1]=0;break;case "Y_GLOW_BLUR":b.vb[0]=
0;b.vb[1]=1;break;case "X_DOF_BLUR":b.vb[0]=1;b.vb[1]=1;break;case "Y_DOF_BLUR":b.vb[0]=1;b.vb[1]=1;break;case "X_ALPHA_BLUR":b.vb[0]=1;b.vb[1]=0;b.Kf=3;break;case "Y_ALPHA_BLUR":b.vb[0]=0;b.vb[1]=1;b.Kf=3;break;case "X_EXTEND":b.vb[0]=1;b.vb[1]=0;break;case "Y_EXTEND":b.vb[0]=0;b.vb[1]=1;break;default:f.r("Wrong postprocessing effect: "+a)}return b};a.hA=function(a){var b=d(12);b.jb=!1;b.qb=!1;b.sd=!1;b.p=l.Oc(l.Tc);b.Os=a;b.dc=!0;switch(a){case "X_BLUR":b.vb[0]=1;b.vb[1]=0;break;case "Y_BLUR":b.vb[0]=
0;b.vb[1]=1;break;default:f.r("Wrong postprocessing effect for bloom blur: "+a)}return b};a.TJ=function(a,b){var e=d(13);e.jb=!1;e.qb=!1;e.sd=!1;e.small_glow_mask_coeff=b.Ni.small_glow_mask_coeff;e.large_glow_mask_coeff=b.Ni.large_glow_mask_coeff;e.small_glow_mask_width=b.Ni.small_glow_mask_width;e.large_glow_mask_width=b.Ni.large_glow_mask_width;e.p=a;e.dc=!0;return e};a.ik=function(a,b,g,l,n,r,u,w,q){var I=d(a);0==a?(I.jb=!0,I.qb=g,I.yb=!1):1==a?(I.jb=!1,I.qb=!1,I.yb=!0):2==a?(I.jb=!1,I.qb=!0,I.yb=
!0):3==a||4==a?(I.jb=!0,I.qb=!0,I.yb=!1):5==a||6==a?(I.jb=!1,I.qb=!1,I.yb=!0):7==a?(I.jb=!0,I.qb=!1,I.yb=!0):f.r("wrong main subscene type");I.yb&&w&&(I.self_shadow_normal_offset=w.self_shadow_normal_offset);I.p=b;if(a=u.Rm)I.jt.set([a.rz,a.xB,a.VE,a.UE]),I.ht.set(a.color),I.it=a.wa;I.Jd.set(u.Jd);I.Rd.set(u.Rd);I.$f=u.$f;I.Yd=r.Yd;I.tf=r.tf;l&&(I.xc=l,l.Yd&&(I.nh=new Float32Array(l.Yd)),I.my=l.waves_height,I.ny=l.waves_length,I.Jj=l.Jj,l.Sf&&q&&(I.Sf=!0,I.Iz=l.zI,I.Hz=l.yI,I.Jz.set(l.AI)));e(I,n);
return I};a.dr=function(){var a=d(14);a.dc=!0;a.p=l.Oc(l.Tc);return a};a.iA=function(a,b,f){var g=d(15);b&&(g.type=16,g.jb=!1,g.qb=!0);g.enqueue=!1;g.p=a;e(g,f);return g};a.RJ=function(a){var b=d(17);b.Lb=!1;b.jb=!1;b.qb=!1;b.p=a;return b};a.NJ=function(a){var b=d(18);b.jb=!0;b.qb=!1;b.p=a;return b};a.cK=function(a,b){var f=d(9);f.p=a;e(f,b);return f};a.SJ=function(a){var b=d(19);b.jb=!1;b.qb=!1;b.p=a;b.dc=!0;return b};a.eK=function(a,b,e){var f=d(20);f.jb=!1;f.qb=!1;f.sd=!1;f.p=a;f.Yd=b.Yd;f.nh=
new Float32Array(b.Yd);f.Vm=e.radius_increase;f.ssao_hemisphere=e.oM;f.Um=e.influence;f.Tm=e.dist_factor;f.GD=e.zO;f.dc=!0;return f};a.fK=function(a,b){var e=d(21);e.jb=!1;e.qb=!1;e.sd=!1;e.p=a;e.ssao_blur_depth=b.eI;e.ssao_blur_discard_value=b.uz;e.dc=!0;return e};a.MJ=function(a){var b=d(22);b.jb=!1;b.qb=!1;b.sd=!1;b.Kf=1/a.Jm;b.OA=a.Ry;b.p=l.Oc(l.Tc);b.dc=!0;return b};a.Yu=function(a,b){var e=d(a);e.jb=23==a||24==a?!0:!1;e.qb=!1;e.sd=!1;e.Kf=1/b.Jm;e.p=l.Oc(l.Tc);23==a&&(e.HM=new Float32Array(4));
e.dc=!0;return e};a.QJ=function(a,b,e,f){var g=d(27);g.jb=!1;g.qb=!1;g.sd=!1;g.p=l.Oc(l.Tc);g.brightness=a;g.contrast=b;g.exposure=e;g.saturation=f;g.dc=!0;return g};a.YJ=function(a,b){var e=d(28);e.jb=!1;e.qb=!1;e.sd=!1;e.p=l.Oc(l.Tc);e.pu=!0;e.mb_decay_threshold=a;e.mb_factor=b;e.dc=!0;return e};a.Vu=function(a,b){var e=d(29);e.jb=!1;e.qb=!1;e.sd=!1;e.p=a;e.Kf=e.p.dof_power;e.Xz=b;e.dc=!0;return e};a.jA=function(a){var b=d(30);b.jb=!1;b.qb=!1;b.sd=!1;b.p=a;b.Kf=b.p.dof_power;b.dc=!0;return b};a.$J=
function(a,b){var f=d(31);f.sd=!1;f.p=a;e(f,b);return f};a.ZJ=function(a){var b=d(32);r.outlining_overview_mode?b.Vh.set(r.Vh):b.Vh.set(a.Vh);b.kp=a.kp;b.rv=5;b.vu=3;b.sd=!1;b.p=l.Oc(l.Tc);b.dc=!0;return b};a.Xu=function(a,b,f,g,l,n,r){var w=d(33);w.jb=!1;w.qb=!1;w.sd=!1;w.Jd=new Float32Array([1,1,1]);w.Rd=new Float32Array([1,1,1]);w.$f=1;w.vC=g;w.mh=b;w.Ts=l;w.rm=f;w.Zm=r;w.p=a;e(w,n);return w};a.UJ=function(a,b){var f=d(34);f.jb=!1;f.qb=!1;f.sd=!1;f.p=l.Oc(l.Tc);f.god_rays_intensity=a;e(f,b);f.dc=
!0;return f};a.dK=function(a,b,g,n){var r=d(35);r.enqueue=!1;r.jb=!1;r.qb=!1;r.sd=!1;var w=l.Oc(l.Tc);w.width=n;w.height=n;r.p=w;r.jk=f.qL();e(r,b);r.Jd=new Float32Array([1,1,1]);r.Rd=new Float32Array([1,1,1]);r.$f=1;r.Qm.set(g.Qm);r.procedural_skydome=g.procedural_skydome;r.use_as_environment_lighting=g.use_as_environment_lighting;r.rayleigh_brightness=g.rayleigh_brightness;r.mie_brightness=g.mie_brightness;r.spot_brightness=g.spot_brightness;r.scatter_strength=g.scatter_strength;r.rayleigh_strength=
g.rayleigh_strength;r.mie_strength=g.mie_strength;r.rayleigh_collection_power=g.rayleigh_collection_power;r.mie_collection_power=g.mie_collection_power;r.mie_distribution=g.mie_distribution;if(a){r.Jd.set(a.Jd);r.Rd.set(a.Rd);r.$f=a.$f;if(b=a.Rm)r.jt.set([b.rz,b.xB,b.VE,b.UE]),r.ht.set(b.color),r.it=b.wa,r.tD=b.invert,r.yD=b.BE,r.uD=b.wE,r.vD=b.xE,r.xD=b.zE,r.wD=b.yE,r.sD=b.sz;r.dq=a.dq;r.fq=a.fq;r.gq=a.gq}return r};a.Wu=function(){var a=d(36);a.jb=!1;a.qb=!1;a.p=l.Oc(l.Tc);a.dc=!0;return a};a.gK=
function(a){var b=d(37);b.jb=!1;b.qb=!1;b.ub=a?"HMD":"ANAGLYPH";b.p=l.Oc(l.Tc);b.dc=!0;return b};a.WJ=function(){var a=d(38);a.jb=!1;a.qb=!1;a.p=l.Oc(l.Tc);a.dc=!0;return a};a.OJ=function(){var a=d(39);a.jb=!1;a.qb=!1;a.p=l.Oc(l.Tc);a.dc=!0;return a};a.XJ=function(a,b,f,g){var l=d(40);l.jb=!1;l.qb=!1;l.Pq=a;l.Oq=b;l.p=g;e(l,f);l.dc=!0;return l};a.PJ=function(a){var b=d(41);b.jb=!1;b.qb=!1;b.p=l.Oc(l.Tc);b.El=a;b.dc=!0;return b};a.jS=function(a){var b=d(42);b.jb=!1;b.qb=!1;b.p=a;b.dc=!0;return b};
a.kA=function(){var a=d(43);a.enqueue=!1;return a};a.aK=function(){var a=d(44);a.dc=!0;return a};a.Fx=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.Os.replace(/_/g,
" ")+")";case 12:return"BLOOM BLUR";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";
case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Cc=function(a,b){for(var d=b.qa,e=d.nb,f=
0;f<a.La.length;f++){var g=a.La[f].oa,l=g.indexOf(b);-1!=l&&(g.splice(l,1),g.length||a.La.splice(f,1))}f=a.yb?d.Df:0;a:{g=a.La;for(l=0;l<g.length;l++){var n=g[l];if(n.nb==e&&f==n.Df){g=n;break a}}g=null}g?g.oa.push(b):(a.La.push({nb:e,oa:[b],Pf:d.Pf,Df:f,Lb:!0}),a.Bw=!0)};a.Qg=function(a,b){var d={Lb:!0,kv:[!0,!0,!0,!0,!0,!0],Th:b,qa:a,Wr:null};if(a.Ke&&a.ha.Ad){var e=a.ha.Ad;d.Wr={uN:new Float32Array(e.length),vN:new Float32Array(e.length),AK:new Float32Array(e.length/3),WE:new Float32Array(3),ZH:n.qI(a.K)}}return d};
a.tP=function(a){a.La.sort(g);a.Bw=!1}};b4w.module.__texcomp=function(a,q){function e(a,b,d,e){var w=new Int32Array(d,0,31),q,u,z,x,I,B;if(542327876!=w[0])return l.error("Invalid magic number in DDS header"),0;if(!w[20]&4)return l.error("Unsupported format, must contain a FourCC code"),0;q=w[21];switch(q){case f:u=8;z=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case n:u=16;z=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case r:u=16;z=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return l.error("Unsupported FourCC code:",g(q)),null}B=
1;w[2]&131072&&!1!==e&&(B=Math.max(1,w[7]));x=w[4];I=w[3];w=w[1]+4;if(b)for(q=0;q<B;++q)e=Math.max(4,x)/4*Math.max(4,I)/4*u,b=new Uint8Array(d,w,e),a.compressedTexImage2D(a.TEXTURE_2D,q,z,x,I,0,b),w+=e,x=Math.max(.5*x,1),I=Math.max(.5*I,1);else if(q==f){Math.max(4,x);Math.max(4,I);d=b=new Uint16Array(d);u=w/2;z=x;var G=I,w=new Uint16Array(4);b=new Uint16Array(z*G);for(var A=0,J=0,t=J=A=q=0,h=0,C=0,k=0,F=z/4,G=G/4,D=0;D<G;D++)for(var aa=0;aa<F;aa++)q=u+4*(D*F+aa),w[0]=d[q],w[1]=d[q+1],A=w[0]&31,J=
w[0]&2016,t=w[0]&63488,h=w[1]&31,C=w[1]&2016,k=w[1]&63488,w[2]=5*A+3*h>>3|5*J+3*C>>3&2016|5*t+3*k>>3&63488,w[3]=5*h+3*A>>3|5*C+3*J>>3&2016|5*k+3*t>>3&63488,A=d[q+2],J=4*D*z+4*aa,b[J]=w[A&3],b[J+1]=w[A>>2&3],b[J+2]=w[A>>4&3],b[J+3]=w[A>>6&3],J+=z,b[J]=w[A>>8&3],b[J+1]=w[A>>10&3],b[J+2]=w[A>>12&3],b[J+3]=w[A>>14],A=d[q+3],J+=z,b[J]=w[A&3],b[J+1]=w[A>>2&3],b[J+2]=w[A>>4&3],b[J+3]=w[A>>6&3],J+=z,b[J]=w[A>>8&3],b[J+1]=w[A>>10&3],b[J+2]=w[A>>12&3],b[J+3]=w[A>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,x,I,0,
a.RGB,a.UNSIGNED_SHORT_5_6_5,b);e&&a.generateMipmap(a.TEXTURE_2D)}else return l.error("No manual decoder for",g(q),"and no native support"),0;return B}function d(a,b,d,f,g){var l=new XMLHttpRequest;l.open("GET",d,!0);l.responseType="arraybuffer";l.onload=function(){if(200==l.status){a.bindTexture(a.TEXTURE_2D,f);var d=e(a,b,l.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<d?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}g&&g(f)};l.send(null)}
function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function g(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var l=q("__print"),w=q("__util"),f=b("DXT1"),n=b("DXT3"),r=b("DXT5");a.HQ=e;a.IQ=function(a,b,d){var e=new Uint32Array(d,0,13);if(55727696==e[0]){var f=e[7],g=e[6],l=e[11],n=52+e[12];switch(e[2]){case 0:var r=2,q=1;break;case 1:r=2;q=3;break;case 2:r=4;q=0;break;case 3:r=4;q=2;break;default:w.r("Unsupported PVR V3 format.")}}else if(559044176==
e[11]){f=e[2];g=e[1];l=e[3];n=e[0];l++;var B=e[4]&255,e=0<e[10];25==B?(r=4,q=e?2:0):24==B?(r=2,q=e?3:1):w.r("Unsupported PVR V2 format.")}else w.r("Unsupported PVR version.");B=2==r?8:4;e=4;switch(q){case 0:var G=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:G=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:G=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:G=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=B*e*r/8;for(r=0;r<l;r++){var q=Math.max(f>>r,1),A=Math.max(g>>r,1),J=q/B,t=A/e;2>J&&(J=2);2>t&&(t=2);J=
J*t*b;t=new Uint8Array(d,n,J);a.compressedTexImage2D(a.TEXTURE_2D,r,G,q,A,0,t);n+=J}};a.rB=function(a,b){switch(b){case "dds":var d=new Int32Array(a,0,31);return{width:d[4],height:d[3]};case "pvr":d=new Uint32Array(a,0,13);if(55727696==d[0])var e=d[7],d=d[6];else e=d[2],d=d[1];return{width:e,height:d}}};a.HL=function(a,b){var d=1;if("dds"==b){var e=new Int32Array(a,0,31),w=e[21];switch(w){case f:d=6;break;case n:case r:d=4;break;default:l.error("Unsupported FourCC code:",g(w))}}else if("pvr"==b)if(e=
new Uint32Array(a,0,13),55727696==e[0])switch(e[2]){case 0:d=12;break;case 1:d=16;break;case 2:d=6;break;case 3:d=8}else w=e[4]&255,e=0<e[10],25==w?d=e?8:6:24==w&&(d=e?16:12);return d};a.iT=function(a,b,e,f){var g=a.createTexture();d(a,b,e,g,f);return g}};b4w.module.__textures=function(a,q){function e(){var a={name:"",type:0,source:"",Mp:"",width:0,height:0,ko:1,$h:1024,pk:!1,Vd:null,eb:0,ib:null,le:null,Kk:!1,vg:-1,ya:null,Zi:0,bg:0,pa:0,Fb:0,Ki:0,Af:!1,pg:1,ad:null,Gp:0,Fp:0,Zh:-1,Ip:!1,qj:-1,pn:!1,fy:!1,ii:!1,kn:!1,repeat:!0,rd:!0,Qi:"",Ri:"",gm:"",Dk:"",fm:!1,Ck:"",VR:""};Ha.push(a);return a}function d(c,d,h,f){var k=c.type,g=new Uint8Array([204,204,204,255]),m=e();m.yz=c.uuid;var l=c.image;l&&(m.Ri=l.uuid,m.Qi=l.filepath,m.gm=l.source,m.Dk=l.name,
m.fm=l.Uc)&&(m.Ck=l.Cq);switch(k){case "DATA_TEX2D":case "IMAGE":var n=K.createTexture(),p=K.TEXTURE_2D;K.bindTexture(p,n);K.texImage2D(p,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,g);l&&"MOVIE"==l.source&&(m.Kk=!0,m.pa=c.frame_start,m.Fb=c.frame_offset,m.Ki=c.frame_duration,m.fy=c.use_auto_refresh,m.ii=c.use_cyclic,m.Zi=c.movie_length,m.kn=c.b4w_nla_video,0!=m.Fb&&O.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));break;case "NONE":n=
K.createTexture();p=K.TEXTURE_2D;K.bindTexture(p,n);if("NONE"==c.b4w_source_type)return null;if("SCENE"==c.b4w_source_type)if(c.b4w_source_id&&(h=fa.keysearch("name",c.b4w_source_id,h)))m.$h=c.b4w_source_size,h.pf=h.pf||[],h.pf.push(c),K.texImage2D(p,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,g);else return null;break;case "ENVIRONMENT_MAP":n=K.createTexture();p=K.TEXTURE_CUBE_MAP;K.bindTexture(p,n);h="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(l=0;6>l;l++)K.texImage2D(K["TEXTURE_CUBE_MAP_"+
h[l]],0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,g);break;case "BLEND":return null;case "NODE_TEX":n=K.createTexture();p=K.TEXTURE_2D;K.bindTexture(p,n);K.texImage2D(p,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,g);break;default:return O.error('texture "'+c.name+'" has unsupported type "'+k+'"'),null}"NONE"==k&&(!c.b4w_enable_canvas_mipmapping||"CANVAS"!=c.b4w_source_type)||"DATA_TEX2D"==k||"IMAGE"==k&&"MOVIE"==c.image.source||"NODE_TEX"==k?K.texParameteri(p,K.TEXTURE_MIN_FILTER,K.LINEAR):K.texParameteri(p,
K.TEXTURE_MIN_FILTER,Ba[V.dn]);K.texParameteri(p,K.TEXTURE_MAG_FILTER,K.LINEAR);g=p;h=c.b4w_anisotropic_filtering;"DEFAULT"===h&&(h=d);"OFF"!==h&&V.anisotropic_filtering&&(d=U.CL())&&(h=parseFloat(h.split("x")[0]),K.texParameterf(g,d.TEXTURE_MAX_ANISOTROPY_EXT,h));if("REPEAT"!=c.extension||c.b4w_shore_dist_map)m.repeat=!1;m.type=a.qi;m.width=1;m.height=1;m.ib=n;m.eb=p;"CANVAS"==c.b4w_source_type&&"NONE"==k?(k=c.b4w_source_id,n=c.b4w_source_size,m.pk=c.b4w_enable_canvas_mipmapping,m.Mp=k,m.source=
"CANVAS",p=document.createElement("canvas"),p.width=n,p.height=n,m.Vd=p.getContext("2d"),f in Ea||(Ea[f]={}),Ea[f][k]=m,b(m)):"SCENE"==c.b4w_source_type&&"NONE"==k?(m.Mp=c.b4w_source_id,m.source="SCENE"):(m.source=k,K.generateMipmap(p),K.bindTexture(p,null));m.name=c.name;return c.q=m}function b(a){"CANVAS"!=a.source&&fa.r("Wrong texture");var b=a.eb;K.bindTexture(b,a.ib);var c=p(a),d=y(a),h=E(a),e=a.Vd.canvas;K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!0);K.texImage2D(b,0,d,c,h,e);K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,
!1);a.pk&&K.generateMipmap(b);K.bindTexture(b,null);a.width=e.width;a.height=e.height}function g(a){var b=a.eb;K.bindTexture(b,a.ib);K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!0);4!=a.ya.length?a.Af?f(a,a.ya,a.width*a.pg,a.height*a.pg,!1):K.texImage2D(b,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,a.ya):K.texImage2D(b,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,a.ya);K.bindTexture(b,null)}function l(a){var b=a.eb;K.bindTexture(b,a.ib);K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!0);a.Af?f(a,a.ad[a.Zh],a.width*a.pg,a.height*a.pg,
!1):K.texImage2D(b,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,a.ad[a.Zh]);K.bindTexture(b,null)}function w(){ua||(ua=document.createElement("canvas"));return ua}function f(a,b,c,d,h){h||(r(K.TEXTURE_2D),K.texImage2D(K.TEXTURE_2D,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,b));K.bindTexture(K.TEXTURE_2D,null);W.EK(a,c,d,X,ca)}function n(a,b,c,d){for(var h=0;6>h;h++){var e=d[h],f=w();f.width=c;f.height=c;var k=f.getContext("2d");"POSITIVE_Y"==e[0]||"NEGATIVE_Y"==e[0]?(k.translate(0,c),k.scale(1,-1)):(k.translate(c,0),k.scale(-1,
1));k.drawImage(a,e[1]*b,e[2]*b,b,b,0,0,c,c);K.texImage2D(K["TEXTURE_CUBE_MAP_"+e[0]],0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,f)}}function r(a){X||(X=K.createFramebuffer());K.bindTexture(a,null);ca||(ca=K.createTexture());K.bindTexture(a,ca);K.texParameteri(a,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE);K.texParameteri(a,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE);K.texParameteri(a,K.TEXTURE_MAG_FILTER,K.LINEAR);K.texParameteri(a,K.TEXTURE_MIN_FILTER,K.LINEAR)}function v(a,b,d,h,e){var k=a.source,g=a.ib,l=a.eb,p=1,t=1;K.bindTexture(l,
g);a.repeat?(K.texParameteri(l,K.TEXTURE_WRAP_S,K.REPEAT),K.texParameteri(l,K.TEXTURE_WRAP_T,K.REPEAT)):(K.texParameteri(l,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(l,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE));if(4==b.length){var H=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==k)if(H)K.texImage2D(l,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(d){t=T.rB(b,d);H=fa.Xn(t.width)||fa.Xn(t.height);if(t.width>ia.mc||t.height>ia.mc){O.error('Texture "'+h+'" has unsupported size: '+
t.width+"x"+t.height+". Max available: "+ia.mc+"x"+ia.mc+".");return}p=t.width;t=t.height;if(H||"pvr"==d)a.Af=!0,r(l),p=m(p*a.pg),t=m(t*a.pg);"dds"==d?T.HQ(K,U.jB(),b,!0):"pvr"==d&&T.IQ(K,U.iB(),b);a.Af&&(f(a,null,p,t,!0),K.bindTexture(l,g),K.generateMipmap(l));a.width=p;a.height=t;a.ko=T.HL(b,d)}else{K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!0);a.Kk?V.Hp?(p=b[0].width,t=b[0].height):(p=b.videoWidth,t=b.videoHeight):(p=b.width,t=b.height);a.width=p;a.height=t;if(p>ia.mc||p>ia.mc)O.warn('Texture "'+h+'" has unsupported size: '+
p+"x"+t+". Max available: "+ia.mc+"x"+ia.mc+". Reduced image size will be used."),a.pg=Math.min(ia.mc/p,ia.mc/t),a.Af=!0;a.Kk&&(V.Hp?(e in da||(da[e]={}),da[e][a.name]=a,a.ad=b,a.Gp=b.length,a.bg=a.Fp*a.Zi/b.length,b=b[0]):(e in da||(da[e]={}),da[e][a.name]=a,a.ya=b,a.ya.loop=a.ii,a.bg=b.duration?a.Zi/b.duration:qa.Zc(),pa.xA||(b.playbackRate=qa.Zc()/a.bg,pa.Uz&&2<b.playbackRate&&(b.playbackRate=2)),c(a)));p=m(a.width*a.pg);t=m(a.height*a.pg);a.Af?(h=w(),d=h.getContext("2d"),h.width=p,h.height=t,
d.drawImage(b,0,0,a.width,a.height,0,0,p,t),K.texImage2D(l,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,h)):V.Sb||!fa.Xn(a.width)&&!fa.Xn(a.height)?K.texImage2D(l,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,b):(f(a,b,p,t,!1),a.Af=!0);g=a.ib;a.Kk||(K.bindTexture(l,g),K.generateMipmap(l),K.bindTexture(l,null));a.width=p;a.height=t}else if("ENVIRONMENT_MAP"==k)if(p=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],H){for(h=0;6>h;h++)K.texImage2D(K["TEXTURE_CUBE_MAP_"+
p[h][0]],0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){O.error('Cubemap texture "'+h+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}t=b.width/3;t>ia.Mh?(O.warn('Cubemap texture "'+h+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*ia.Mh+"x"+2*ia.Mh+". Reduced image size will be used."),h=m(ia.Mh/t*t),a.Af=!0):
(h=m(t),!V.Sb&&(3*h>ia.mc||2*h>ia.mc)&&(a.Af=!0));if(a.Af||V.ex)n(b,t,h,p);else{g=b;d=h;r(K.TEXTURE_2D);K.texImage2D(K.TEXTURE_2D,0,K.RGBA,K.RGBA,K.UNSIGNED_BYTE,g);K.bindTexture(K.TEXTURE_2D,null);for(g=0;6>g;g++)K.texImage2D(K.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,K.RGBA,d,d,0,K.RGBA,K.UNSIGNED_BYTE,null);K.bindTexture(a.eb,null);K.bindFramebuffer(K.FRAMEBUFFER,X);for(g=0;6>g;g++)W.DK(a,K.TEXTURE_CUBE_MAP_POSITIVE_X+g,d,t,ca,g);K.bindFramebuffer(K.FRAMEBUFFER,null);K.bindTexture(a.eb,a.ib);K.texParameteri(a.eb,
K.TEXTURE_MIN_FILTER,Ba[V.dn]);K.texParameteri(a.eb,K.TEXTURE_MAG_FILTER,K.LINEAR)}N.KI()&&(O.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),n(b,t,M.Jy,p));a.width=3*h;a.height=2*h;K.generateMipmap(l)}else if("DATA_TEX2D"==k||"NODE_TEX"==k)K.texImage2D(l,0,K.RGBA,b.width,b.height,0,K.RGBA,K.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height;K.bindTexture(l,null)}function c(a){a.ya.qT=function(){g(a)}}function m(a){return fa.Xn(a)?fa.clamp(Math.pow(2,parseInt(a).toString(2).length),
2,ia.mc):a}function p(b){var c;switch(b.type){case a.qi:c=K.RGBA;break;case a.Bq:c=K.RGB;break;case a.An:c=K.RGBA;break;case a.Bn:c=K.RGB;break;case a.Bl:c=K.DEPTH_COMPONENT;break;default:fa.r("Wrong texture type")}return c}function y(b){var c;switch(b.type){case a.qi:c=V.Sb?K.RGBA8:K.RGBA;break;case a.Bq:c=V.Sb?K.RGB8:K.RGB;break;case a.An:c=V.Sb?K.RGBA8:K.RGBA;break;case a.Bn:c=V.Sb?K.RGB8:K.RGB;break;case a.Bl:c=V.Sb?K.DEPTH_COMPONENT24:K.DEPTH_COMPONENT;break;default:fa.r("Wrong texture type")}return c}
function E(b){var c;switch(b.type){case a.qi:c=K.UNSIGNED_BYTE;break;case a.Bq:c=K.UNSIGNED_BYTE;break;case a.An:c=K.FLOAT;break;case a.Bn:c=K.FLOAT;break;case a.Bl:c=K.UNSIGNED_INT;break;default:fa.r("Wrong texture type")}return c}function u(a){return a&&a.name&&a.le?!0:!1}function z(a,b){var c=null;switch(a){case "SSAO_TEXTURE":c={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};d(c,null,b,0);c.image={filepath:null};break;case "NODE_TEX":c={name:"",
type:"NODE_TEX",extension:"CLIP",b4w_anisotropic_filtering:"OFF"},d(c,null,b,0),c.image={filepath:null}}return c}function x(a,b){if(b in da&&a in da[b]){var c=da[b][a];c.ya?c.ya.play():c.ad&&(c.Ip=!0);return!0}return!1}function I(a,b){if(b in da&&a in da[b]){var c=da[b][a];c.ya?c.ya.pause():c.ad&&(c.Ip=!1);return!0}return!1}function B(a,b){if(b in da&&a in da[b]){var c=da[b][a];c.ya?c.ya.currentTime=c.Fb/c.bg:c.ad&&(c.Zh=A(c,c.Fb),l(c));return!0}return!1}function G(a){return a.ya?!a.ya.paused:a.ad?
a.Ip:!1}function A(a,b){return Math.round(b*a.Gp/a.Zi)}function J(a,b){if(R.is_dynamic(a))return t(a,b);for(var c=a.ts,d=0;d<c.length;d++){var h=t(c[d],b);if(h)return h}return null}function t(a,b){var c=a.G;if(c.length)for(var c=c[0].T,d=0;d<c.length;d++){var h=c[d];if("MAIN"==h.type||"SKY"==h.type)for(var e=0;e<h.X.length;e++)if(h.X[e].name==b)return h.X[e]}return null}function h(a,b,c){a=a.G;if(a.length){a=a[0].T;for(var d=0;d<a.length;d++){var h=a[d];if("MAIN"==h.type)for(var e=0;e<h.X.length;e++)h.X[e].name==
b&&(h.X[e]=c)}}}function C(a,b){var c=a.G;if(c.length)for(var c=c[0].T,d=0;d<c.length;d++){var h=c[d];if("MAIN"==h.type)for(var e=0;e<h.X.length;e++){var f=h.X[e];-1==ka.indexOf(f.source)&&-1==b.indexOf(f.name)&&b.push(f.name)}}}function k(a,b,c){var d=a.elements;a=a.interpolation;for(var h=0;h<b;h++){var e=h/(b-1),f=F(d,e,!0),k=D(d,e,!0);if(f&&k)if("CONSTANT"==a)c.push.apply(c,f.color);else{var g=c,m=f,l=k;m==l?g.push.apply(g,m.color):(g.push(ha.ks(l.color[0],l.position,m.color[0],m.position,e)),
g.push(ha.ks(l.color[1],l.position,m.color[1],m.position,e)),g.push(ha.ks(l.color[2],l.position,m.color[2],m.position,e)),g.push(ha.ks(l.color[3],l.position,m.color[3],m.position,e)))}k&&!f&&c.push.apply(c,k.color);f&&!k&&c.push.apply(c,f.color)}}function F(a,b,c){for(var d=null,h=0;h<a.length;h++){var e=c?b-a[h].position:b-a[h][1][0];0<=e&&(d?e<=(c?b-d.position:b-a[h][1][0])&&(d=a[h]):d=a[h])}return d}function D(a,b,c){for(var d=null,h=0;h<a.length;h++){var e=c?a[h].position-b:a[h][1][0]-b;0<=e&&
(d?e<=(c?d.position-b:d[1][0]-b)&&(d=a[h]):d=a[h])}return d}function aa(a,b){var c=a.texture,d=c.q,c=c.image;d&&b&&c&&v(d,b,c.Uc,c.filepath);return d}var M=q("__compat"),L=q("__config"),T=q("__texcomp"),N=q("__debug"),U=q("__extensions"),O=q("__print"),qa=q("__time"),fa=q("__util"),W=q("__renderer"),R=q("__obj_util"),ha=q("__curve"),H=q("__vec3"),ma=q("__scenes"),V=L.A,ia=L.zh,pa=L.S,ua=null,ca=null,X=null;a.Td=0;a.I=0;a.SG=0;a.QG=0;a.RG=0;a.PG=0;a.qi=10;a.Bq=20;a.An=30;a.Bn=40;a.Bl=50;a.zq=60;a.xq=
70;a.Aq=80;a.yq=90;a.wy=128;a.YE=128;a.Ny=128;var ka=["NONE","NODE_TEX","SSAO_TEXTURE"],Ha=[],Ea={},da={},K=null,Ba;a.jf=function(b){Ba=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Td=b.NEAREST;a.I=b.LINEAR;a.SG=b.NEAREST_MIPMAP_NEAREST;a.QG=b.LINEAR_MIPMAP_NEAREST;a.RG=b.NEAREST_MIPMAP_LINEAR;a.PG=b.LINEAR_MIPMAP_LINEAR;K=b};a.FS=function(a,b){return b in Ea&&a in Ea[b]?Ea[b][a].Vd:null};a.ST=function(a,c){return c in Ea&&a in Ea[c]?(b(Ea[c][a]),
!0):!1};a.Ll=function(b,c,d){var h=e();h.name=b;h.type=c;h.source="NONE";if(c==a.zq||c==a.xq||c==a.Aq||c==a.yq)h.le=K.createRenderbuffer();else{b=K.TEXTURE_2D;c=K.createTexture();K.bindTexture(b,c);K.texParameteri(b,K.TEXTURE_MAG_FILTER,K.LINEAR);K.texParameteri(b,K.TEXTURE_MIN_FILTER,K.LINEAR);K.texParameteri(b,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE);K.texParameteri(b,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE);var f=new Uint8Array([204,204,204,255]);K.texImage2D(b,0,K.RGBA,1,1,0,K.RGBA,K.UNSIGNED_BYTE,f);V.io&&
d&&K.texParameterf(b,K.TEXTURE_COMPARE_MODE,K.COMPARE_REF_TO_TEXTURE);K.bindTexture(b,null);h.eb=b;h.ib=c}return h};a.gA=function(b,c){var d=K.createTexture(),h=K.TEXTURE_CUBE_MAP;K.bindTexture(h,d);K.texParameteri(h,K.TEXTURE_MAG_FILTER,K.LINEAR);K.texParameteri(h,K.TEXTURE_MIN_FILTER,K.LINEAR);K.texParameteri(h,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE);K.texParameteri(h,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE);for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),
k=0;6>k;k++)K.texImage2D(K[f[k]],0,K.RGBA,c,c,0,K.RGBA,K.UNSIGNED_BYTE,null);K.bindTexture(h,null);h=e();h.name=b;h.type=a.qi;h.source="NONE";h.width=3*c;h.height=2*c;h.ko=1;h.ib=d;h.eb=K.TEXTURE_CUBE_MAP;return h};a.mx=function(a,b,c){if(!u(a)){var d=a.eb;K.bindTexture(d,a.ib);b&&K.texParameteri(d,K.TEXTURE_MIN_FILTER,b);c&&K.texParameteri(d,K.TEXTURE_MAG_FILTER,c);K.bindTexture(d,null)}};a.IS=function(b){if(u(b))return{min:a.Td,jN:a.Td};var c=b.eb;K.bindTexture(c,b.ib);b=K.getTexParameter(c,K.TEXTURE_MIN_FILTER);
var d=K.getTexParameter(c,K.TEXTURE_MAG_FILTER);K.bindTexture(c,null);return{min:b,jN:d}};a.resize=function(b,c,d){c=Math.max(c,V.Ao?2:1);d=Math.max(d,V.Ao?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.zq:K.bindRenderbuffer(K.RENDERBUFFER,b.le);K.renderbufferStorage(K.RENDERBUFFER,K.RGB565,c,d);K.bindRenderbuffer(K.RENDERBUFFER,null);break;case a.xq:K.bindRenderbuffer(K.RENDERBUFFER,b.le);K.renderbufferStorage(K.RENDERBUFFER,K.DEPTH_COMPONENT16,c,d);K.bindRenderbuffer(K.RENDERBUFFER,null);
break;case a.Aq:K.bindRenderbuffer(K.RENDERBUFFER,b.le);K.renderbufferStorageMultisample(K.RENDERBUFFER,V.tc,K.RGBA8,c,d);K.bindRenderbuffer(K.RENDERBUFFER,null);break;case a.yq:K.bindRenderbuffer(K.RENDERBUFFER,b.le);K.renderbufferStorageMultisample(K.RENDERBUFFER,V.tc,K.DEPTH_COMPONENT24,c,d);K.bindRenderbuffer(K.RENDERBUFFER,null);break;default:var h=b.eb;K.bindTexture(h,b.ib);var e=p(b),f=y(b),k=E(b);K.texImage2D(h,0,f,c,d,0,e,k,null);K.bindTexture(h,null)}c>ia.mc||d>ia.mc?fa.r('Slink texture "'+
b.name+'" has unsupported size: '+c+"x"+d+". Max available: "+ia.mc+"x"+ia.mc+"."):(b.width=c,b.height=d)}};a.hK=d;a.tE=g;a.sE=l;a.yt=v;a.sI=m;a.wK=function(a){K.deleteTexture(a)};a.mm=function(a){return a&&a.name&&(a.ib||a.le)?!0:!1};a.lm=u;a.$S=function(b){return b.type==a.An||b.type==a.Bn?!0:!1};a.fM=function(b){var c=0;switch(b.type){case a.qi:case a.Bq:c=4;break;case a.An:case a.Bn:c=16;break;case a.Bl:c=3;break;case a.zq:case a.xq:c=2;break;case a.Aq:c=4*V.tc;break;case a.yq:c=3*V.tc}return c};
a.yL=z;a.cleanup=function(){if(!V.Hp)for(var a in da)for(var b in da[a])da[a][b].ya.pause(),da[a][b].ya.src="",da[a][b].ya.load();Ha.length=0;Ea={};da={}};a.pause=function(){for(var a in da)for(var b in da[a]){var c=da[a][b];G(c)&&(I(b,a),c.pn=!0)}};a.reset=function(){for(var a in da)for(var b in da[a])B(b,a),da[a][b].pn=!1};a.play=function(a){for(var b in da)for(var c in da[b]){var d=da[b][c];if(!a||d.pn)x(c,b),d.pn=!1}};a.ky=function(a,b){return b in da&&a in da[b]?da[b][a].kn:!1};a.play_video=
x;a.pause_video=I;a.reset_video=B;a.MO=function(a,b,c){c in da&&a in da[c]&&(a=da[c][a],a.ya?a.ya.currentTime=b/a.bg:a.ad&&(a.Zh=b,l(a)))};a.OE=G;a.PE=function(a){return a.ya||a.ad?a.ya?2<=a.ya.readyState:!0:0};a.LE=function(a){return a.ya||a.ad?a.ya?Math.round(a.ya.currentTime*a.bg):a.Zh:0};a.NE=function(a){return a.ya||a.ad?a.ya?a.Fb:A(a,a.Fb):0};a.WQ=function(a){if(!a.ya&&!a.ad)return 0;var b=Math.min(a.Ki,a.Zi-a.Fb);return a.ya?a.Fb+b:A(a,a.Fb+b)};a.Zs=function(a,b){return Math.round(b*a.Fp*(qa.Zc()/
a.bg))};a.ME=function(a){return Math.min(a.Ki,a.Zi-a.Fb)};a.VQ=A;a.FL=function(a,b){var c=J(a,b);return c&&"CANVAS"==c.source?c.Vd:null};a.nQ=function(a,c){var d=J(a,c);return d&&"CANVAS"==d.source?(b(d),!0):!1};a.get_texture_names=function(a){var b=[];if(R.is_dynamic(a))C(a,b);else{a=a.ts;for(var c=0;c<a.length;c++)C(a[c],b)}return b};a.lP=function(a){for(var c={},d=0;d<a.length;d++){for(var h=a[d].X,f=[],k=0;k<h.length;k++){var g=h[k];if("CANVAS"==g.source)if(g.name in c)g=c[g.name];else{var m=
h[k],g=e();g.name=m.name;g.source="CANVAS";g.width=m.width;g.height=m.height;g.pk=m.pk;g.type=m.type;m=document.createElement("canvas");m.width=g.width;m.height=g.height;g.Vd=m.getContext("2d");g.eb=K.TEXTURE_2D;g.ib=K.createTexture();K.bindTexture(K.TEXTURE_2D,g.ib);g.pk?K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,Ba[V.dn]):K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR);K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR);K.bindTexture(K.TEXTURE_2D,null);m=g;m.Vd.drawImage(h[k].Vd.canvas,
0,0);b(m);c[g.name]=g}f.push(g)}a[d].X=f}};a.mJ=function(a,b){for(var c=[],d=0;d<a.length;d++)k(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return fa.clamp(255*a,0,255)}))};a.oI=k;a.jK=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),h=[],e=0;e<a.length;e++){for(var f=a[e].data.value,k=[],g=f.curve_mapping.curves_data,m=f.curve_mapping.curve_extend,l=f.curve_mapping.curves_handle_types,f=0;f<g.length;f++){for(var n=m[f],p=g[f],t=[],r=l[f],u=0;u<p.length;u++)t.push([new Float32Array(3),
new Float32Array(p[u].concat(0)),new Float32Array(3)]);ha.Cu(t[0],null,t[1],r[0],r[0]);for(u=1;u<t.length-1;u++)ha.Cu(t[u],t[u-1],t[u+1],r[u],r[u]);ha.Cu(t[t.length-1],t[t.length-2],null,r[t.length-1],r[t.length-1]);if(2<t.length){if("AUTO"==r[0]){H.subtract(t[0][2],t[0][1],c);u=H.length(c);H.copy(t[1][0],d);d[0]<t[0][1][0]&&(d[0]=t[0][1][0]);H.subtract(d,t[0][1],d);var v=H.length(d);1E-8<v&&(H.scale(d,u/v,d),H.add(t[0][1],d,t[0][2]),H.subtract(t[0][1],d,t[0][0]))}p=t.length-1;"AUTO"==r[0]&&(H.subtract(t[p][0],
t[p][1],c),u=H.length(c),H.copy(t[p-1][2],d),d[0]>t[p][1][0]&&(d[0]=t[p][1][0]),H.subtract(d,t[p][1],d),v=H.length(d),1E-8<v&&(H.scale(d,u/v,d),H.add(t[p][1],d,t[p][0]),H.subtract(t[p][1],d,t[p][2])))}for(p=0;p<t.length-1;p++)ha.dJ(t[p][1],t[p][2],t[p+1][0],t[p+1][1]);p=[];3>=g.length?(u=Math.round(-b/2),r=Math.round(b/2)):(u=0,r=b);for(;u<r;u++){var v=u/(r-1),ba=F(t,v,!1),la=D(t,v,!1);ba&&la?p.push(ha.mz(v,ba[1],ba[2],la[0],la[1],.001)):la&&!ba?"EXTRAPOLATED"==n?(v=la[1][0]==la[2][0]?la[1][1]:ha.XB(v,
la[1],la[2]),p.push(v)):p.push(la[1][1]):ba&&!la&&("EXTRAPOLATED"==n?(v=ba[0][0]==ba[1][0]?ba[1][1]:ha.XB(v,ba[0],ba[1]),p.push(v)):p.push(ba[1][1]))}k.push(p)}h.push(k)}c=[];for(u=0;u<h.length;u++)for(k=h[u],f=0;f<k[0].length;f++)3>=k.length?(d=fa.clamp(127.5*(k[0][f]+1),0,255),e=fa.clamp(127.5*(k[1][f]+1),0,255),g=fa.clamp(127.5*(k[2][f]+1),0,255),p=255):(d=fa.clamp(255*k[0][f],0,255),e=fa.clamp(255*k[1][f],0,255),g=fa.clamp(255*k[2][f],0,255),p=fa.clamp(255*k[3][f],0,255)),c.push(d,e,g,p);return new Uint8Array(c)};
a.change_image=function(a,b,c){var d=J(a,b);if(d){if("WORLD"!=a.type){var f;f=e();f.name=d.name;f.type=d.type;f.source=d.source;f.Mp=d.Mp;f.width=d.width;f.height=d.height;f.ko=d.ko;f.$h=d.$h;f.pk=d.pk;f.Vd=d.Vd;f.eb=d.eb;f.ib=d.ib;f.le=d.le;f.Kk=d.Kk;f.vg=d.vg;f.ya=d.ya;f.Zi=d.Zi;f.bg=d.bg;f.pa=d.pa;f.Fb=d.Fb;f.Ki=d.Ki;f.Af=d.Af;f.pg=d.pg;f.ad=d.ad;f.Gp=d.Gp;f.Fp=d.Fp;f.Zh=d.Zh;f.Ip=d.Ip;f.qj=d.qj;f.pn=d.pn;f.fy=d.fy;f.ii=d.ii;f.kn=d.kn;f.repeat=d.repeat;f.rd=d.rd;f.Qi=d.Qi;f.Ri=d.Ri;f.gm=d.gm;f.Dk=
d.Dk;f.fm=d.fm;f.Ck=d.Ck;var k=f;K.bindTexture(d.eb,d.ib);var g=K.getTexParameter(d.eb,K.TEXTURE_MAG_FILTER),m=K.getTexParameter(d.eb,K.TEXTURE_MIN_FILTER),l=K.getTexParameter(d.eb,K.TEXTURE_WRAP_S),d=K.getTexParameter(d.eb,K.TEXTURE_WRAP_T);k.ib=K.createTexture();K.bindTexture(k.eb,k.ib);K.texParameteri(k.eb,K.TEXTURE_MAG_FILTER,g);K.texParameteri(k.eb,K.TEXTURE_MIN_FILTER,m);K.texParameteri(k.eb,K.TEXTURE_WRAP_S,l);K.texParameteri(k.eb,K.TEXTURE_WRAP_T,d);K.bindTexture(k.eb,null);d=f;if(R.is_dynamic(a))h(a,
b,d);else for(a=a.ts,k=0;k<a.length;k++)h(a[k],b,d);v(f,c,!1,c.src,0)}else v(d,c,!1,c.src,0),ma.DQ(a);return!0}return!1};a.Yc=aa;a.UA=function(a,b){var c={texture:z("NODE_TEX",null)};return aa(c,{width:b,height:a.length/(4*b),data:a})};a.rO=function(){K=null};a.XA=function(){return Ha}};b4w.module.__assets=function(a,q){function e(){return y.DB()?q(y.be.Sq).data:null}function d(){var a={Dq:null,fH:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.Dq=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=e();b&&a.Dq in b&&(a.status=200,b[a.Dq]&&(a.response=a.fH(b[a.Dq])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];20===e.state&&c++;if(c>=G.rN)break;if(10===e.state)switch(e.state=20,c++,e.type){case a.AT_ARRAYBUFFER:g(e,"arraybuffer");break;case a.AT_JSON:g(e,"json");break;case a.AT_TEXT:g(e,"text");break;case a.AT_AUDIOBUFFER:l(e);break;case a.AT_IMAGE_ELEMENT:w(e);
break;case a.AT_AUDIO_ELEMENT:f(e);break;case a.mq:n(e);break;case a.lq:r(e);break;default:x.r("Wrong asset type: "+e.type)}}}function g(b,c){var f=e(),g=f&&b.url in f?new d:new XMLHttpRequest,f=null;if("GET"==b.Be)g.open("GET",b.url,!0);else if("POST"==b.Be)switch(g.open("POST",b.url,!0),b.jj){case a.ty:f="text/plain";break;case a.sy:f="application/json"}if(b.gj)for(var m in b.gj)"Content-Type"==m?f=b.gj[m]:g.setRequestHeader(m,b.gj[m]);f&&g.setRequestHeader("Content-Type",f);"text"==c?(g.overrideMimeType("text/plain"),
g.responseType="text"):"json"==c?(g.overrideMimeType("application/json"),g.responseType="text"):g.responseType=c;g.onreadystatechange=function(){if(40!=b.state&&4==g.readyState){if(200==g.status||0==g.status){var a=g.response;if(a){if("json"==c&&"string"==typeof a)try{a=JSON.parse(a,b.IM)}catch(d){u.error(d+" (parsing JSON "+b.url+")");b.Mc(null,b.id,b.type,b.url,b.Wb);return}b.Mc(a,b.id,b.type,b.url,b.Wb)}else u.error("empty responce when trying to get "+b.url),b.Mc(null,b.id,b.type,b.url,b.Wb)}else u.error(g.status+
" when trying to get "+b.url),b.Mc(null,b.id,b.type,b.url,b.Wb);b.state=30}};g.addEventListener("progress",function(a){a.lengthComputable&&b.GC(a.loaded/a.total)},!1);g.send(b.Wh)}function l(a){"GET"!=a.Be&&x.r("Unsupported request type for audio buffer");var b=e(),c=b&&a.url in b?new d:new XMLHttpRequest;c.open("GET",a.url,!0);c.responseType="arraybuffer";c.onreadystatechange=function(){if(40!=a.state&&4==c.readyState)if(200==c.status||0==c.status){var b=c.response;b?z.vK(b,function(b){a.Mc(b,a.id,
a.type,a.url,a.Wb);a.state=30},function(){a.Mc(null,a.id,a.type,a.url,a.Wb);u.error("failed to decode "+a.url);a.state=30}):(a.Mc(null,a.id,a.type,a.url,a.Wb),u.error("empty responce when trying to get "+a.url),a.state=30)}else a.Mc(null,a.id,a.type,a.url,a.Wb),u.error(c.status+" when trying to get "+a.url),a.state=30};c.send(a.Wh)}function w(a){"GET"!=a.Be&&x.r("Unsupported request type for image element");var b=document.createElement("img");B.allow_cors&&(b.crossOrigin="Anonymous");b.onload=function(){40!=
a.state&&(a.Mc(b,a.id,a.type,a.url,a.Wb),a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.Mc(null,a.id,a.type,a.url,a.Wb),u.error("could not load image: "+a.url),a.state=30)},!1);var d=e();if(d&&a.url in d)if(d[a.url]){var f=c(a.url);b.src="data:"+f+";base64,"+d[a.url]}else E.is_ie11()?(d=document.createEvent("CustomEvent"),d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),b.dispatchEvent(d);else b.src=a.url}function f(a){"GET"!=a.Be&&x.r("Unsupported request type for audio element");
var b=document.createElement("audio");B.allow_cors&&(b.crossOrigin="Anonymous");b.addEventListener("loadeddata",function(){40!=a.state&&(a.Mc(b,a.id,a.type,a.url,a.Wb),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.Mc(null,a.id,a.type,a.url,a.Wb),u.error("could not load sound: "+a.url),a.state=30)},!1);b.addEventListener("stalled",function(){40!=a.state&&(a.Mc(null,a.id,a.type,a.url,a.Wb),u.error("could not load sound: "+a.url),a.state=30)},!1);var c=e();if(c&&a.url in c)if(c[a.url]){var d=
m(a.url);b.src="data:"+d+";base64,"+c[a.url];40!=a.state&&(a.Mc(b,a.id,a.type,a.url,a.Wb),a.state=30)}else E.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url,B.is_mobile_device&&b.load();B.tw&&(b.autoplay=!0,b.pause());setTimeout(function(){b.sP=1},5E3)}function n(a){function b(){40!=a.state&&(a.Mc(null,a.id,a.type,a.url),u.error("could not load video: "+a.url,a.Wb),a.state=30)}"GET"!=a.Be&&x.r("Unsupported request type for video element");
var c=document.createElement("video");c.muted=!0;if(B.allow_cors||B.is_mobile_device)c.crossOrigin="Anonymous";c.addEventListener("loadeddata",function(){c.removeEventListener("error",b,!1);40!=a.state&&(a.Mc(c,a.id,a.type,a.url,a.Wb),a.state=30)},!1);c.addEventListener("error",b,!1);var d=e();if(d&&a.url in d)if(d[a.url]){var f=p(a.url);c.src="data:"+f+";base64,"+d[a.url];40!=a.state&&c.addEventListener("loadeddata",function(){a.Mc(c,a.id,a.type,a.url,a.Wb);a.state=30},!1)}else E.is_ie11()?(d=document.createEvent("CustomEvent"),
d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.url,B.is_mobile_device&&c.load();B.tw&&(c.autoplay=!0,c.pause());setTimeout(function(){c.sP=1},1E4)}function r(b){function c(a){b.Mc(a,b.id,b.type,b.url,b.Wb);b.state=30}"GET"!=b.Be&&x.r("Unsupported request type for seq video element");var f=e(),g=f&&b.url in f?new d:new XMLHttpRequest;if(null==b.jj&&null==b.Wh)g.open("GET",b.url,!0);else switch(g.open("POST",b.url,!0),b.jj){case a.ty:g.setRequestHeader("Content-type",
"text/plain");break;case a.sy:g.setRequestHeader("Content-type","application/json")}g.responseType="arraybuffer";g.onreadystatechange=function(){if(40!=b.state&&4==g.readyState)if(200==g.status||0==g.status){var a=g.response;a?v(a,c):(b.Mc(null,b.id,b.type,b.url,b.Wb),u.error("empty responce when trying to get "+b.url),b.state=30)}else b.Mc(null,b.id,b.type,b.url,b.Wb),u.error(g.status+" when trying to get "+b.url),b.state=30};g.addEventListener("progress",function(a){a.lengthComputable&&b.GC(a.loaded/
a.total)},!1);g.send(b.Wh)}function v(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],tz:[],bg:c[4]},g=20,m=0;m<e;m++){var l=c[g/4],n=new Blob([d.subarray(g+4,g+4+l)],{type:"image/jpg"}),p=document.createElement("img");p.src=window.URL.createObjectURL(n);f.images.push(p);f.tz.push(n);g+=l+8-l%4}p.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.tz;b(f)}}function c(a){var b="image";switch(x.Dv(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function m(a){var b="audio";switch(x.Dv(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function p(a){var b="video";switch(x.Dv(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var y=q("__config"),E=q("__compat"),u=q("__print"),z=q("__sfx"),x=q("__util"),I=q("__version"),B=y.A,G=y.pd;a.AT_ARRAYBUFFER=
10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.mq=70;a.lq=80;a.sy=a.AT_JSON;a.ty=a.AT_TEXT;var A=[],J=0,t={};a.Sm=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.MS=function(a){if(t[a])return t[a];var b=G.prevent_caching?a+I.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return t[a]=
b;x.r("Error XHR: responce is empty, GET "+a)}else x.r("Error XHR: "+c.status+", GET "+a)};a.cleanup=function(){for(var a=0;a<A.length;a++)A[a].state=40;A=[];J=0;t={}};a.enqueue=function(a,c,d,f,g){for(var m=0;m<a.length;m++){var l=a[m],l={id:l.id,type:l.type,url:l.url,Be:l.Be?l.Be:"GET",jj:l.jj?l.jj:null,gj:l.gj?l.gj:null,Wh:l.Wh?l.Wh:null,Wb:l.Wb?l.Wb:null,state:10,Mc:c||function(){},wC:d||function(){},GC:f||function(){},IM:g||null,xC:J};if(G.prevent_caching){var n=e();n&&l.url in n||(l.url+=I.timestamp())}A.push(l)}b(A);
J++};a.update=function(){b(A);for(var a=A,c=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.xC===a[c].xC?30!==f.state&&(d=!1):(d&&(a[e-1].wC(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].wC(),a.splice(c))}};a.LI=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1}};b4w.module.__loader=function(a,q){function e(b,e,f,g){var m=x,l=E.create(),h;for(h in e){var n=d(e[h]);(g&&n.ec||!b&&n.vc)&&c(n);E.H(l,n)}for(h in e)for(n=e[h],n.name=h,b=0;b<n.J.length;b++)E.s(l,e[n.J[b]],n,null);e=d({name:"out",Rb:a.bF,ic:function(a,b,c,d,e){b.zb&&(m.Ax=!0);y(b)||(b.status=2);b.ZB(b.id,!0);e(b,c);u.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},fc:5});if(f)f=E.Oo(l);else{h=E.clone(l);do{f=E.Oo(h);n=[];for(b=0;b<f.length;b++){g=f[b];var k=E.Pa(h,g);k.Zb&&n.push(g)}for(b=
0;b<n.length;b++)E.Gf(h,n[b]);n.length&&E.Iu(h)}while(n.length)}E.H(l,e);for(b=0;b<f.length;b++)g=f[b],k=E.Pa(l,g),e.J.push(k.name),E.s(l,k,e,null);return l}function d(a){a.Zb=a.Zb||!1;a.Rb||0===a.Rb||(a.Rb=a.Sd);a.J=a.J||[];a.Hk=a.Hk||!1;a.vx=a.vx||!1;a.fc=a.fc||0;a.ec=a.ec||!1;a.vc=a.vc||!1;a.status=0;a.jT=0;a.iw=0;a.Un=a.Un||null;return a}function b(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];E.Pa(a.eh,f).Hk&&(E.yj(a.eh,f,function(d){var e=!0;E.ih(a.eh,d,function(a,b){if(!b.Hk)return e=
!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-1;0<=e;e--)b.splice(d[e],1);return c}function g(a){function c(b,d){var e=E.Pa(a.eh,b),f=E.Pa(a.eh,d),g=f.Rb-e.Rb;0==g&&(g=e.Zb-f.Zb);return g}var d=[],e=a.ci,f=!1;do{var g=b(a,e);d.push.apply(d,e);0<g.length&&(f=!0);e=g}while(0<g.length);f&&d.sort(c);a.ci=d;return a.ci.length}function l(a,b,c){if(b.vx)return b.Hk=!0,f(a,b),!1;if(!b.ic&&!b.Ai&&!b.Tn)return f(a,b),!1;if(0==b.status&&(b.status++,b.ic))return b.ic(c,a,
b,b.Un,f,n),!0;if(1==b.status){if(b.Ai)return b.Ai(c,a,b,b.Un,f,n),!0;b.status++}return 2==b.status&&(b.status++,b.Tn)?(b.Tn(c,a,b,b.Un,f,n),!0):!1}function w(a){if(0==a.lt)return 100;var b=0;E.la(a.eh,function(c,d){a.do_not_load_resources&&d.ec||(b+=d.iw*d.fc)});return z.trunc(100*b/a.lt)}function f(a,b){b.Hk=!0;b.status=3;r(a,b,1)}function n(a,b,c){1>c?r(a,b,c):b.status++}function r(a,b,c){var d=x;if(b.ic||b.Ai||b.Tn)if(b.iw=c,b=w(a),a.oA!=b||1==c)a.zx(b,performance.now()-a.dE),a.oA=b,d.kw=!0}function v(a,
b){var c=null;E.la(a.eh,function(a,d){if(d.name==b)return c=d,1});return c}function c(a){a.vx=!0;a.iw=1}function m(a){a.zx=null;a.Ou=null;a.eh=null;a.ci=null}function p(){return 0==x.Fq}function y(a){return a&&(3==a.status||4==a.status)}var E=q("__graph"),u=q("__print"),z=q("__util");a.Sd=0;a.Mj=1;a.bF=2;var x=null;a.lB=function(){return x};a.EJ=function(){var a={hh:[],cv:0,Fq:0,Ax:!1,kw:!1};return x=a};a.iK=function(a,b,c,d,f,g,h,m){var k=x,l=k.hh.length,n={id:l,zb:0==l,status:0,Ng:b,pz:"",ZB:c||
function(){},YB:m||!1,VT:g,dE:0,oA:0,lt:0,dx:!1,zx:d||function(){},Ou:f||function(){},eh:null,ci:null,Rv:!1,Pv:!1,Sv:!1};a=e(n.zb,a,g,h);n.eh=a;b=[];c=E.dM(a);for(d=0;d<c.length;d++)b.push(c[d]);n.ci=b;E.la(a,function(a,b){!(b.ic||b.Ai||b.Tn)||n.do_not_load_resources&&b.ec||(n.lt+=b.fc)});k.hh.push(n);k.Fq++;return n.id};a.AQ=function(b){var c=x;if(c&&!p())if(c.kw)c.kw=!1;else{var d=performance.now();do{var e=c.hh[c.cv],f=b[e.id];if(!y(e))if(0==e.status&&(e.status=1,e.dE=performance.now(),e.zx(0,
0)),g(e)){var n=e,h=n.ci.length;do{var r=E.Pa(n.eh,n.ci[0]),k=l(n,r,f);r.Rb==a.Mj&&(n.dx=!0);r=n.ci.shift();n.ci.push(r);h--}while(!k&&0!=h)}else n=c,h=e,h.Ou(f,h),h.status=3,n.Fq--,m(h);c.Ax&&(c.cv=(c.cv+1)%c.hh.length);if(e.dx){e.dx=!1;break}}while(16>performance.now()-d)}};a.Sy=function(a){var b=x;a.Ou(null,a);a.status=3;b.Fq--;m(a);a.status=4;a.zb&&(b.Ax=!0);a.ZB(a.id,!1)};a.JT=n;a.ft=function(a,b){var d=v(a,b);null!==d&&c(d)};a.Hk=p;a.PP=y;a.is_primary_loaded=function(a){var b=x;if(!b)return!1;
a|=0;return b.hh[a]&&(3==b.hh[a].status||2==b.hh[a].status)};a.jM=function(){u.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.cleanup=function(){x=null}};b4w.module.__logic_nodes=function(a,q){function e(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];if(-2==c.state){for(var f=0;f<c.Ys;f++)if(B.get_sensor_value(a,b,f))for(var h=0;h<c.Xs.length;h++)if(c.Xs[h]==f){e.Rk==c.$D?(E.is_play(e.na)&&(c.state=-1),d.lf.af||(c.state=1,c.Kp=c.ls[h])):(c.state=1,c.Kp=c.ls[h]);return}c.state=0}}}function d(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.Ys;f++)if(B.get_sensor_value(a,b,f)&&f==c.ZC){if(E.is_play(e.na)&&e.Rk==c.$D)c.state=-1;
else if(!d.lf.af||c.M.no_wait)c.state=1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Ha:a.slot_idx_order,Kp:a.slot_idx_jump,pa:a.frame_range[0],Sa:a.frame_range[1],gL:a.frame_range_mask?a.frame_range_mask[0]:!0,fL:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,Ys:-1,ZC:-1,JN:a.param_name,HN:a.operation,mute:a.mute,yo:a.object,obj:null,Qb:null,$b:null,Ta:{},qf:a.anim_name,hc:m.SLOT_ALL,LN:a.parse_json_vars,KN:a.parse_json_paths,uc:a.objects_paths,nC:a.nodes_paths,
wb:a.floats,M:a.bools,N:a.variables,di:a.strings,lw:a.materials_names,nD:a.shader_nd_type,Wd:a.common_usage_names,LK:a.encode_json_vars,KK:a.encode_json_paths,$D:b,FC:W[a.type]?W[a.type]:f,Qs:!1,st:0,Xs:null,ZM:a.links,ls:[]}}function g(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function l(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function w(a,b,c){switch(b.state){case 2:c.ia=a.Ha}}function f(a,b,c){switch(b.state){case 1:z.error("Unknown node type: "+a.type);break;case 2:c.ia=a.Ha}}function n(a){return u.cc(u.yc,
a.yo||[],0)}function r(a,c){var d=a.b4w_logic_nodes,e=c.Kd;c.state=1;for(var f=0;f<d.length;f++){var h={L:[],lf:{mb:a,ia:0,af:!1,Px:f,u:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(h);for(var k=e[e.length-1],g=d[f],m=0;m<g.length;m++){var l=b(g[m],k);k.L.push(l)}for(g=0;g<k.L.length;g++)l=k.L[g],l.mute||l.FC(l,c,h.lf,0,0)}var d=a.timeline_markers,n;for(n in d)c.Lp.push(d[n]);c.Lp.sort(function(a,b){return a-b});c.state=2;R.push(c)}function v(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):
0;case 1:return String(a);default:return null}}function c(a){switch(typeof a){case "string":return v(a,1);case "number":return v(a,0);default:return v(a,1)}}var m=q("__animation"),p=q("__assets"),y=q("__camera"),E=q("__nla"),u=q("__objects"),z=q("__print"),x=q("__scenes"),I=q("__config"),B=q("__controls"),G=q("__batch"),A=q("__geometry"),J=q("__mat3"),t=q("__mat4"),h=q("__physics"),C=q("__quat"),k=q("__sfx"),F=q("__time"),D=q("__transform"),aa=q("__tsr"),M=q("__util"),L=q("__vec3"),T=new Float32Array(4);
new Float32Array(4);var N=new Float32Array(3),U=new Float32Array(3),O=new Float32Array(2),qa=new Float32Array(9),fa=new Float32Array(16);a.SF=0;a.TF=1;a.MF=0;a.LF=1;a.NF=2;a.OF=3;a.KF=4;a.Ey=0;a.Gy=1;a.Fy=2;a.Hy=3;a.Iy=4;a.Dy=5;a.RF=0;a.QF=1;a.PF=2;a.DF=0;a.EF=1;a.BF=2;a.CF=3;a.FF=0;a.GF=1;var W={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.ia=a.Ha}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=n(a);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;
case 2:x.Vn(a.obj,!0),c.ia=a.Ha}},SHOW:function(a,b,c){switch(b.state){case 1:a.obj=n(a);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:x.Vn(a.obj,!1),c.ia=a.Ha}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=a.N.vd;b=b.u;var e=c.u,f;a:{f=a.JN;var h=a.wb.ptp,k=a.M.hsh,g=I.get("url_params");if(g&&f in g)f=Number(g[f]);else{if(k=k?location.hash:location.search)for(k=k.slice(1).split("&"),g=0;g<k.length;g++){var m=k[g].split("=");if(1<m.length&&
m[0]==f){f=v(m[1],h);break a}}f=0}}l(d,b,e,f);c.ia=a.Ha}},SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.Kd[c.Px];var d=u.get_selectable_objects();a.Xs=[];a.ls=[];for(var f in a.uc){var h=u.cc(u.yc,a.uc[f],0),k=d.indexOf(h);if(-1==k){z.error("logic script error: non-selectable object:",a.uc[f][a.uc[f].length-1]);break a}a.Xs.push(k);a.ls.push(a.ZM[f])}a.state=-1;a.Ys=d.length;f=[];for(k=0;k<d.length;k++)f.push(B.create_selection_sensor(d[k],!1));B.create_sensor_manifold(h,"LOGIC_NODES_SWITCH_SELECT_"+
a.label,B.CT_SHOT,f,B.default_OR_logic_fun,e(),[a,b,c])}break;case 2:if(-1==a.state){b=b.Kd[c.Px].L;for(h=0;h<b.length;h++)d=b[h],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}if(0==a.state||1==a.state)c.ia=a.state?a.Kp:a.Ha,a.state=-1}},SELECT:function(a,b,c){switch(b.state){case 1:c=b.Kd[c.Px];var e=n(a),f=u.get_selectable_objects(),h=f.indexOf(e);if(-1==h)z.error("logic script error: non-selectable object:",a.yo[a.yo.length-1]);else{a.state=-1;a.Ys=f.length;a.ZC=h;for(var h=[],k=0;k<f.length;k++)h.push(B.create_selection_sensor(f[k],
!1));B.create_sensor_manifold(e,"LOGIC_NODES_SELECT_"+a.label,B.CT_SHOT,h,B.default_OR_logic_fun,d(),[a,b,c])}break;case 2:if(0==a.state||1==a.state){c.ia=a.state?a.Kp:a.Ha;a.state=-1;break}a.M.not_wait&&(c.ia=a.Ha)}},PLAY:function(a,b,c,d){switch(b.state){case 1:E.Bx();a.state=-1;a.M.not_wait||(a.M.not_wait=!1);break;case 2:switch(a.state){case -1:if(E.is_play(b.na))if(b.av==b.Rk&&c.af)break;else{var e=b.Rk;if(e){e.lf.ia=e.L[e.lf.ia].Ha;e.L[e.lf.ia].state=-1;for(var e=b.Rk.L,f=0;f<e.length;f++){var h=
e[f];"PLAY"==h.type&&(h.state=-1)}}}c.af=!a.M.not_wait;b.Rk=b.av;a.state=0;a.gL&&(E.ZO(a.pa),E.fD(d));if(a.fL)E.nx(a.Sa);else{d=E.get_frame(d);var e=-1,k;for(k in b.Lp)if(d<b.Lp[k]){e=k;break}0<=e?E.nx(b.Lp[e]):E.nx(E.get_frame_end())}E.CC(null);a.M.not_wait&&(c.ia=a.Ha,a.state=-1,c.af=!1);break;case 0:E.is_play()||(c.ia=a.Ha,a.state=-1,c.af=!1);break;case 1:c.ia=a.Ha;a.state=-1;b.Rk=null;c.af=!1;break;default:M.r("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=
a.M.url?v(g(a.N.url,b.u,c.u),1):a.di.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.N.v1[1]?a.wb.inp1:v(g(a.N.v1,b.u,c.u),0),e=-1==a.N.v2[1]?a.wb.inp2:v(g(a.N.v2,b.u,c.u),0),f=0;switch(a.HN){case "ADD":f=d+e;break;case "MUL":f=d*e;break;case "SUB":f=d-e;break;case "DIV":0==e&&M.r("Division by zero in Logic script");f=d/e;break;case "RAND":f=Math.random()*(e-d)+d}l(a.N.vd,b.u,c.u,f);c.ia=a.Ha}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var d=a.M.str?1:0,e=a.M.str?a.di:
a.wb,f=-1==a.N.v1[1]?e.inp1:v(g(a.N.v1,b.u,c.u),d);b=-1==a.N.v2[1]?e.inp2:v(g(a.N.v2,b.u,c.u),d);d=!1;switch(a.Wd.condition){case 5:f==b&&(d=!0);break;case 4:f!=b&&(d=!0);break;case 3:f<b&&(d=!0);break;case 2:f>b&&(d=!0);break;case 1:f<=b&&(d=!0);break;case 0:f>=b&&(d=!0)}c.ia=d?a.Kp:a.Ha}},REGSTORE:function(a,b,c){switch(b.state){case 2:l([a.M.gl||a.N.vd[0],a.N.vd[1]],b.u,c.u,(1==a.Wd.variable_type?a.di:a.wb).inp1),c.ia=a.Ha}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.M.env?u.get_world_by_name(a.yo[0],
0):n(a);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:switch(0!=a.state||m.is_play(a.obj,a.hc)||(a.state=1),a.state){case -1:for(var d in b.Kd){var e=b.Kd[d].lf.ia;-1!=e&&(e=b.Kd[d].L[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}b=a.Wd.param_anim_behavior;if(""==a.qf)m.apply_def(a.obj),m.set_behavior(a.obj,b,m.SLOT_ALL);else{a:{d=a.obj;for(var e=a.qf,f=-1,h=0;8>h;h++){var k=d.ba[h];if(k&&k.th&&m.ND(k.th)==m.ND(e))if(-1!=f)f=
h;else{d=-1;break a}}d=f}-1==d?(a.hc=m.oP(a.obj,a.qf),m.apply(a.obj,null,a.qf,a.hc)):a.hc=d;m.set_behavior(a.obj,b,a.hc)}a.M.not_wait||(c.af=!0);m.play(a.obj,null,a.hc);a.state=0;a.M.not_wait&&(c.ia=a.Ha,a.state=-1);break;case 0:break;case 1:a.M.not_wait||(c.af=!1);c.ia=a.Ha;a.state=-1;break;default:M.r("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:w,SEND_REQ:function(a,b,c){function d(a,e,f,h,k){a=JSON.stringify(a);l(k[0].N.dst,b.u,c.u,a);k[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=
0;var e=a.M.url?v(g(a.N.url,b.u,c.u),1):a.di.url,f={};a.M.ct&&(f["Content-Type"]=a.di.ct);"GET"==a.Wd.request_type?p.enqueue([{id:e,type:p.AT_JSON,url:e,gj:f,Wb:[a,c.u]}],d,null,null,null):"POST"==a.Wd.request_type&&p.enqueue([{id:e,type:p.AT_JSON,url:e,gj:f,Be:"POST",jj:p.AT_JSON,Wh:v(g(a.N.dst1,b.u,c.u),1),Wb:[a,c.u]}],d,null,null,null);break;case 1:a.state=-1,c.ia=a.Ha}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.Ta["id"+b]=u.cc(u.yc,a.uc["id"+b],0),a.Ta["id"+b]||(z.error("Logic script error: object not found. Node: ",
a.name),a.mute=!0);break;case 2:G.inherit_material(a.Ta.id0,a.lw.id0,a.Ta.id1,a.lw.id1),c.ia=a.Ha}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.uc.id0&&(a.Ta.id0=u.cc(u.yc,a.uc.id0,0),a.uc.id0||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0),a.nC.id0.unshift(a.lw.id0));break;case 2:var d=a.Ta.id0,e=a.nC.id0,f=e[0],h=G.Oa(d,f,"MAIN");c.ia=a.Ha;if(null===h){z.error('Material "'+f+'" was not found in the object "'+d.name+'".');break}if("ShaderNodeRGB"==a.nD){var k=
G.Pg(h.ef,e);G.set_nodemat_rgb(d,f,k,a.M.id0?v(g(a.N.id0,b.u,c.u),0):a.wb.id0,a.M.id1?v(g(a.N.id1,b.u,c.u),0):a.wb.id1,a.M.id2?v(g(a.N.id2,b.u,c.u),0):a.wb.id2)}"ShaderNodeValue"==a.nD&&(k=G.Pg(h.ff,e),G.set_nodemat_value(d,f,k,a.M.id0?v(g(a.N.id0,b.u,c.u),0):a.wb.id0))}},DELAY:function(a,b,c,d,e){switch(b.state){case 2:-1==a.state?(a.state=0,a.st=0,c.af=!0):0==a.state&&(a.st+=e,(a.M.dl?v(g(a.N.dl,b.u,c.u),0):a.wb.dl)<a.st&&(a.state=-1,c.ia=a.Ha,c.af=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=
a.Ta.id0=u.cc(u.yc,a.uc.id0,0);b||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c=a.Wd.sk;A.check_shape_keys(b)?A.Qv(b,c)||(z.error("Wrong key name:",c),a.mute=!0):(z.error("No shape keys in object:",b.name),a.mute=!0);break;case 2:A.az(a.Ta.id0,a.Wd.sk,a.M.skv?v(g(a.N.skv,b.u,c.u),0):a.wb.skv),c.ia=a.Ha}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=a.Ta.id0=u.cc(u.yc,a.uc.id0,0);d||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);d&&
d.k&&d.k.nc||(z.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0);break;case 2:d=a.Ta.id0;switch(a.Wd.outline_operation){case "PLAY":b=d.k.Wg;u.apply_outline_anim(d,b.dj,b.ej,b.fj);break;case "STOP":u.clear_outline_anim(d);break;case "INTENSITY":d.k.lg=a.M["in"]?v(g(a.N["in"],b.u,c.u),0):a.wb["in"]}c.ia=a.Ha}},MOVE_CAMERA:function(a,b,c){function d(a,b,c,e){switch(y.get_move_style(a)){case y.MS_TARGET_CONTROLS:y.set_trans_pivot(a,b,c);break;case y.MS_EYE_CONTROLS:case y.MS_STATIC:D.set_tsr(a,
e);break;case y.MS_HOVER_CONTROLS:L.sub(c,b,N),L.normalize(N,N),y.set_hover_pivot(a,c),c=b=0,U[0]=N[0],U[1]=0,U[2]=N[2],b=L.dot(U,N),c=Math.acos(b/(L.length(U)*L.length(N))),b=N[2]?Math.atan(N[0]/N[2]):0<N[0]?0:Math.PI,0<N[2]&&0<N[0]?O[1]=-(Math.PI+O[1]):0<N[2]&&0>N[0]?O[1]=-(Math.PI+O[1]):0>N[2]&&0>N[0]?(O[0]+=Math.PI,b=-(Math.PI-b)):0>N[2]&&0<N[0]&&(O[0]+=Math.PI,b-=Math.PI),y.rotate_hover_camera(a,b+Math.PI,-c,!0,!0)}D.B(a);h.sync_transform(a)}function e(a,b,c,d){t.lookAt(b,c,M.AXIS_Z,fa);t.invert(fa,
fa);J.fromMat4(fa,qa);C.fromMat3(qa,T);C.normalize(T,T);a=aa.get_scale(a.k.n);aa.set_sep(b,a,T,d)}switch(b.state){case 1:var f=null,f=a.Ta.ca=u.cc(u.yc,a.uc.id0,0);f||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.Ta.tr=u.cc(u.yc,a.uc.id1,0);a.Ta.tr||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.Ta.ta=u.cc(u.yc,a.uc.id2,0);a.Ta.ta||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.state=-1;a.$b={hE:new Float32Array(3),
gE:new Float32Array(3),Xv:new Float32Array(3),Lx:new Float32Array(3),XD:new Float32Array(3),Wv:new Float32Array(3),Aj:new Float32Array(8),jh:new Float32Array(8),Uo:new Float32Array(8)};break;case 2:var k=a.Ta.ca,f=aa.get_trans_view(a.Ta.tr.k.n),m=aa.get_trans_view(a.Ta.ta.k.n);switch(a.state){case -1:b=a.M.dur?v(g(a.N.dur,b.u,c.u),0):a.wb.dur;if(0==b){e(k,f,m,a.$b.jh);d(k,f,m,a.$b.jh);c.ia=a.Ha;break}c=aa.get_trans_view(k.k.n);L.copy(c,a.$b.hE);var l=y.get_move_style(k);l==y.MS_HOVER_CONTROLS?L.copy(k.k.Hb,
a.$b.Lx):l==y.MS_STATIC||l==y.MS_EYE_CONTROLS?(aa.copy(k.k.n,a.$b.Aj),e(k,f,m,a.$b.jh)):L.copy(k.k.pivot,a.$b.Lx);L.copy(f,a.$b.gE);L.copy(m,a.$b.XD);a.state=0;var n=F.animate(0,1,1E3*b,function(b){x.va()&&(l==y.MS_STATIC||l==y.MS_EYE_CONTROLS?aa.interpolate(a.$b.Aj,a.$b.jh,M.smooth_step(b),a.$b.Uo):(a.$b.Wv=L.lerp(a.$b.Lx,a.$b.XD,M.smooth_step(b),a.$b.Wv),a.$b.Xv=L.lerp(a.$b.hE,a.$b.gE,M.smooth_step(b),a.$b.Xv)),d(k,a.$b.Xv,a.$b.Wv,a.$b.Uo),1==b&&(a.state=1))});break;case 1:F.clear_animation(n),
a.state=-1,c.ia=a.Ha}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d=null,d=a.Ta.ca=u.cc(u.yc,a.uc.id0,0);d||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);b=d.k;a.wI={xj:b.xj,use_panning:b.use_panning,Ya:b.Ya,fa:b.fa,fb:b.fb,jc:b.jc,kc:b.kc,Cd:b.Cd,Lg:b.Lg};break;case 2:var d=a.Ta.ca,e=d.k,f=a.wI;y.kq(d);switch(a.Wd.camera_move_style){case 0:e.hb=y.MS_STATIC;break;case 2:e.hb=y.MS_EYE_CONTROLS;var k=aa.get_trans_view(e.n);y.jD(d,k,null,f.Ya,f.fa);
break;case 3:e.hb=y.MS_HOVER_CONTROLS;var k=aa.get_trans_view(e.n),m=N;a.M.pvo?(m=u.cc(u.yc,a.uc.id1,0),m=aa.get_trans_view(m.k.n)):(m[0]=a.M.pvx?v(g(a.N.pvx,b.u,c.u),0):a.wb.pvx,m[1]=a.M.pvy?v(g(a.N.pvy,b.u,c.u),0):a.wb.pvy,m[2]=a.M.pvz?v(g(a.N.pvz,b.u,c.u),0):a.wb.pvz);y.kD(d,k,m,f.fb,f.fa,f.jc,f.kc,f.Lg);break;case 1:e.hb=y.MS_TARGET_CONTROLS,k=aa.get_trans_view(e.n),m=N,a.M.pvo?(m=u.cc(u.yc,a.uc.id1,0),m=aa.get_trans_view(m.k.n)):(m[0]=a.M.pvx?v(g(a.N.pvx,b.u,c.u),0):a.wb.pvx,m[1]=a.M.pvy?v(g(a.N.pvy,
b.u,c.u),0):a.wb.pvy,m[2]=a.M.pvz?v(g(a.N.pvz,b.u,c.u),0):a.wb.pvz),y.lD(d,k,m,f.Ya,f.fa,f.pS,f.Cd,f.use_panning)}U[0]=a.M.vtr?v(g(a.N.vtr,b.u,c.u),0):a.wb.vtr;U[1]=a.M.vro?v(g(a.N.vro,b.u,c.u),0):a.wb.vro;U[2]=a.M.vzo?v(g(a.N.vzo,b.u,c.u),0):a.wb.vzo;U[0]=M.clamp(U[0],0,Infinity);U[1]=M.clamp(U[1],0,Infinity);U[2]=M.clamp(U[2],0,.99);e.Fj=U[0];e.Ej=U[1];e.Gj=U[2];D.B(d);h.sync_transform(d);y.im(d);c.ia=a.Ha}},MOVE_TO:function(a,b,c){function d(a,b){D.set_tsr(a,b);D.B(a);h.sync_transform(a)}switch(b.state){case 1:a.Ta.ob=
u.cc(u.yc,a.uc.id0,0);a.Ta.ob||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.Ta.de=u.cc(u.yc,a.uc.id1,0);a.Ta.de||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.state=-1;a.Qb={wA:new Float32Array(8),gv:new Float32Array(8),BB:new Float32Array(8)};break;case 2:var e=a.Ta.ob;aa.copy(a.Ta.ob.k.n,a.Qb.wA);aa.copy(a.Ta.de.k.n,a.Qb.gv);switch(a.state){case -1:b=a.M.dur?v(g(a.N.dur,b.u,c.u),0):a.wb.dur;if(0==b){d(e,a.Qb.gv);c.ia=a.Ha;break}a.state=
0;var f=F.animate(0,1,1E3*b,function(b){x.va()&&(a.Qb.XS=aa.interpolate(a.Qb.wA,a.Qb.gv,M.smooth_step(b),a.Qb.BB),d(e,a.Qb.BB),1==b&&(a.state=1))});break;case 1:F.clear_animation(f),a.state=-1,c.ia=a.Ha}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?D.set_tsr(a,b):D.set_tsr_rel(a,b);D.B(a);h.sync_transform(a)}switch(b.state){case 1:a.Ta.ob=u.cc(u.yc,a.uc.id0,0);a.Ta.ob||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.state=-1;a.Qb={kt:0,Aj:new Float32Array(8),
jh:new Float32Array(8),Uo:new Float32Array(8)};break;case 2:var e=a.Ta.ob;switch(a.state){case -1:U[0]=a.M.trx?v(g(a.N.trx,b.u,c.u),0):a.wb.trx;U[1]=a.M["try"]?v(g(a.N["try"],b.u,c.u),0):a.wb["try"];U[2]=a.M.trz?v(g(a.N.trz,b.u,c.u),0):a.wb.trz;N[0]=a.M.rox?v(g(a.N.rox,b.u,c.u),0)*Math.PI/180:a.wb.rox;N[1]=a.M.roy?v(g(a.N.roy,b.u,c.u),0)*Math.PI/180:a.wb.roy;N[2]=a.M.roz?v(g(a.N.roz,b.u,c.u),0)*Math.PI/180:a.wb.roz;var f=a.M.sc?g(a.N.sc,b.u,c.u):a.wb.sc;M.euler_to_quat(N,T);aa.set_sep(U,f,T,a.Qb.jh);
a.Qb.kt=a.Wd.space_type;switch(a.Qb.kt){case 0:D.get_tsr(e,a.Qb.Aj);break;case 1:D.get_tsr_rel(e,a.Qb.Aj);break;case 2:D.get_tsr_rel(e,a.Qb.Aj),aa.multiply(a.Qb.Aj,a.Qb.jh,a.Qb.jh)}b=a.M.dur?v(g(a.N.dur,b.u,c.u),0):a.wb.dur;if(0==b){d(e,a.Qb.jh,a.Qb.kt);c.ia=a.Ha;break}a.state=0;f=F.animate(0,1,1E3*b,function(b){x.va()&&(aa.interpolate(a.Qb.Aj,a.Qb.jh,M.smooth_step(b),a.Qb.Uo),d(e,a.Qb.Uo,a.Qb.kt),1==b&&(a.state=1))});break;case 1:F.clear_animation(f),a.state=-1,c.ia=a.Ha}}},SPEAKER_PLAY:function(a,
b,c){switch(b.state){case 1:a.obj=u.cc(u.yc,a.uc.id0,0);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);void 0==a.M.not_wait&&(a.M.not_wait=!0);break;case 2:switch(k.is_playing(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.Kd){var e=b.Kd[d].lf.ia;-1!=e&&(e=b.Kd[d].L[e],"SPEAKER_PLAY"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}a.M.not_wait||(c.af=!0);k.play_def(a.obj);a.state=0;break;case 0:a.M.not_wait&&(c.ia=a.Ha,a.state=-1);break;case 1:a.M.not_wait||
(c.af=!1);c.ia=a.Ha;a.state=-1;break;default:M.r("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.obj=u.cc(u.yc,a.uc.id0,0);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:k.stop(a.obj),c.ia=a.Ha}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.M.env?u.get_world_by_name(a.yo[0],0):n(a);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:m.stop(a.obj,m.SLOT_ALL),
a.M.rst&&m.set_first_frame(a.obj,m.SLOT_ALL),c.ia=a.Ha}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.M.rst&&E.fD(d),E.Bx(),c.ia=a.Ha}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},e;for(e in a.N)d[a.N[e][1]]=g(a.N[e],b.u,c.u);z.log(a.Wd.msg,JSON.stringify(d));c.ia=a.Ha}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.M.id0?v(g(a.N.id0,b.u,c.u),1):a.di.id0,e=a.M.id1?v(g(a.N.id1,b.u,c.u),1):a.di.id1,f=0;switch(a.Wd.string_operation){case 0:f=d+e;break;case 1:f=d.indexOf(e);
break;case 2:f=d.replace(e,a.M.id2?v(g(a.N.id2,b.u,c.u),1):a.di.id2);break;case 3:var h=a.N,f=d.substring(0,d.indexOf(e));l(h.dst1,b.u,c.u,d.substring(d.indexOf(e)+1,d.length));""==g(h.dst,b.u,c.u)&&(f=g(h.dst1,b.u,c.u),l(h.dst1,b.u,c.u,""));break;case 4:switch(a.Wd.condition){case 5:f=d==e?1:0;break;case 4:f=d!=e?1:0;break;case 3:f=d<e?1:0;break;case 2:f=d>e?1:0;break;case 1:f=d<=e?1:0;break;case 0:f=d>=e?1:0}}l(a.N.dst,b.u,c.u,f);c.ia=a.Ha}},GET_TIMELINE:function(a,b,c,d){switch(b.state){case 2:d=
a.M.nla?v(E.get_frame(d),0):v(F.get_frame(d),0),l(a.N.vd,b.u,c.u,d),c.ia=a.Ha}},JSON:function(a,b,d){function e(a,b,d,f){for(var h=0;h<b.length;h++){for(var k=b[h].split("."),g=a,m=d[h],l=0;l<k.length&&(g=g[k[l]],void 0!==g&&null!==g);l++);g=c(g);f[m]=g}}function f(a,b,d,e){e||(e={});for(var h=0;h<b.length;h++){var k=b[h].split("."),g=e,m=d[h];if(!(!m in a)){for(var l=0;l<k.length-1;l++)void 0===g[k[l]]&&(g[k[l]]=isNaN(k[l+1])?{}:[]),g=g[k[l]];g[k[k.length-1]]=c(a[m])}}}switch(b.state){case 2:switch(a.Wd.json_operation){case "PARSE":try{var h=
JSON.parse(v(g(a.N.jsn,b.u,d.u),1));e(h,a.KN,a.LN,d.u)}catch(k){z.error("logic script error: non valid JSON string")}break;case "ENCODE":h={},f(d.u,a.KK,a.LK,h),h=v(JSON.stringify(h),1),l(a.N.jsn,b.u,d.u,h)}d.ia=a.Ha}},JS_CALLBACK:function(a,b,d){switch(b.state){case 2:for(var e=a.M.cb?v(g(a.N.cb,b.u,d.u),1):a.di.cb,f=[],h=0,k="id"+h,m=a.Wd.js_cb_params;k in m;)k=0==m[k]?u.cc(u.yc,a.uc[k],0):g(a.N[k],b.u,d.u),f.push(k),h++,k="id"+h;m=[];h=0;for(k="out"+h;k in a.N;)k=g(a.N[k],b.u,d.u),m.push(k),h++,
k="out"+h;h=1;if(e in ha){if(h=!ha[e](f,m))for(e=0;e<m.length;e++)k="out"+e,k in a.N&&l(a.N[k],b.u,d.u,c(m[e]))}else z.error("logic script error: no custom callback with id "+e);h&&(d.ia=a.Ha)}},EMPTY:w},R=[],ha={};a.qM=function(a,b){var c={Fd:b,XC:a.name,state:0,Rk:null,mb:a,av:null,Kd:[],Lp:[],u:{}};a.KR=c;r(a,c)};a.update=function(a,b){var c=E.eM();if(!(0>=c))for(var d=0;d<R.length;d++)for(var e=d,f=a,h=b,k=c,g=R[e],m=0;m<R[e].Kd.length;m++){g.av=R[e].Kd[m];var l=R[e].Kd[m],n=g,p=f,t=h,r=k,u=l.L;
if(u.length){for(var v=0;v<u.length;v++)u[v].Qs=!1;for(v=0;v<u.length;v++){if(0<=l.lf.ia)var w=u[l.lf.ia];else break;if(w.Qs)break;if(w.mute)if("ENTRYPOINT"==w.type)break;else l.lf.ia=w.Ha,w.Qs=!0;else w.FC(w,n,l.lf,p,t,r),w.Qs=!0}}}};a.qH=function(a,b){ha[a]=b};a.fO=function(a){delete ha[a]};a.xO=function(a,b){for(var c=0;c<R.length;c++)if(R[c].XC==a){for(var c=R[c],d=0;d<c.Kd.length;d++){var e=c.Kd[d].L[0];if(e.name==b){e.M.js&&(e.mute=!1);c.Kd[d].lf.ia=0;break}}break}};a.cleanup=function(){R.length=
0;ha={}}};b4w.module.__math=function(a,q){function e(a,b){for(var c=a[1],d=1,e=2;e<a.length;e++)4!=e&&8!=e&&Math.abs(a[e])>Math.abs(c)&&(c=a[e],d=e);for(var f=Math.floor(d/3),d=d%3,c=.5*Math.atan(2*c/(a[3*f+f]-a[3*d+d])),e=0;e<b.length;e++)b[e]=0==e||4==e||8==e?1:0;b[d+3*f]=-Math.sin(c);b[f+3*d]=Math.sin(c);b[f+3*f]=Math.cos(c);b[d+3*d]=Math.cos(c);return b}function d(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var c=a.content[b];0<b;){var d=(b+1>>1)-1,e=a.content[d];if(a.al(c)<a.al(e))a.content[d]=
c,a.content[b]=e,b=d;else break}}function g(a,b){for(var c=a.content.length,d=a.content[b],e=a.al(d);;){var f=b+1<<1,g=f-1,l=null;if(g<c){var n=a.al(a.content[g]);n<e&&(l=g)}f<c&&a.al(a.content[f])<(null===l?e:n)&&(l=f);if(null!==l)a.content[b]=a.content[l],a.content[l]=d,b=l;else break}}var l=q("__mat3"),w=q("__vec3"),f=new Float32Array(3),n=new Float32Array(9),r=new Float32Array(9),v=new Float32Array(9),c=new Float32Array(9);a.get_pline_directional_vec=function(a,b){b=b||new Float32Array(3);b[0]=
a[3];b[1]=a[4];b[2]=a[5];return b};a.get_pline_initial_point=function(a,b){b=b||new Float32Array(3);return w.copy(a,b)};a.set_pline_initial_point=function(a,b){w.copy(b,a)};a.set_pline_directional_vec=function(a,b){w.normalize(b,f);a[3]=f[0];a[4]=f[1];a[5]=f[2]};a.calc_pline_point=function(a,b,c){c=c||new Float32Array(3);c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b};a.uI=function(a,b){b[0]=0;b[1]=0;for(var c=b[2]=0;c<a.length;c+=3)b[0]+=a[c],b[1]+=a[c+1],b[2]+=a[c+2];return w.scale(b,3/a.length,
b)};a.pI=function(a,b,c){for(var d=0;d<c.length;d++)c[d]=0;for(d=0;d<a.length;d+=3){var e=a[d]-b[0],f=a[d+1]-b[1],g=a[d+2]-b[2];c[0]+=e*e;c[1]+=e*f;c[2]+=e*g;c[4]+=f*f;c[5]+=f*g;c[8]+=g*g}c[3]=c[1];c[6]=c[2];c[7]=c[5];for(d=0;d<c.length;d++)c[d]*=3/a.length;return c};a.YK=function(a,b){var f=l.copy(a,n);if(5E-4>d(f))return l.identity(b);var g=e(f,r),u=l.transpose(g,v);l.multiply(f,u,c);l.multiply(g,c,f);for(var w=l.copy(g,b),q=1;5E-4<=d(f)&&100>q;)g=e(f,r),u=l.transpose(g,v),l.multiply(f,u,c),l.multiply(g,
c,f),l.multiply(g,w,w),q++;return w};a.point_plane_dist=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]};a.aI=function(a){return{content:[],al:a}};a.oz=function(a,c){a.content.push(c);b(a,a.content.length-1)};a.bI=function(a){var b=a.content[0],c=a.content.pop();0<a.content.length&&(a.content[0]=c,g(a,0));return b};a.UR=function(a,c){var d=a.content.indexOf(c),e=a.content.pop();d!==a.content.length-1&&(a.content[d]=e,a.al(e)<a.al(c)?b(d):g(d))};a.cI=function(a,c){b(a,a.content.indexOf(c))}};b4w.module.__navmesh=function(a,q){function e(a,c){function d(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var e=a.Ij,f=c.Ij,h=[],k=0;k<e.length;k++)0<=b(f,e[k])&&h.push(e[k]);if(2>h.length)return[];0<=b(h,e[0])&&0<=b(h,e[e.length-1])&&d(e);0<=b(h,f[0])&&0<=b(h,f[f.length-1])&&d(f);h=[];for(k=0;k<e.length;k++)0<=b(f,e[k])&&h.push(e[k]);return h}function d(a){function b(a){for(var c=a.Bf,d=0;d<c.length;d++){var e=c[d];void 0==e.island&&(e.island=a.island,b(e))}}a=a.VN;for(var c=[],d=0,e=0;e<a.length;e++){var f=
a[e];void 0==f.island&&(f.island=d++,b(f));c[f.island]||(c[f.island]=[]);c[f.island].push(a[e])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function g(a){function b(a,c){for(var d=0;d<a.length;d++)if(c===a[d])return d}for(var c={},f=a.nn,h=0;h<f.length;h++)f[h][0]=parseFloat(f[h][0].toFixed(2)),f[h][1]=parseFloat(f[h][1].toFixed(2)),f[h][2]=parseFloat(f[h][2].toFixed(2));c.nn=a.nn;a=d(a);c.$v=[];for(h=0;h<a.length;h++){for(var f=
[],k=a[h],g=0;g<k.length;g++){for(var l=[],m=k[g],n=0;n<m.Bf.length;n++)l.push(b(k,m.Bf[n]));for(var p=[],n=0;n<m.Bf.length;n++)p.push(e(m,m.Bf[n]));m.Nc[0]=parseFloat(m.Nc[0].toFixed(2));m.Nc[1]=parseFloat(m.Nc[1].toFixed(2));m.Nc[2]=parseFloat(m.Nc[2].toFixed(2));f.push({id:b(k,m),Bf:l,Ij:m.Ij,Nc:m.Nc,Gc:m.Gc,WN:p,uv:0,Jo:0,xb:0,eJ:1,ly:!1,closed:!1,parent:null})}c.$v.push(f)}return c}function l(a,b,c,d,e){function f(a,b){x.subtract(a,b,B);return x.dot(B,B)}function h(a,b){for(var c=[],d=0;d<b.Bf.length;d++)c.push(a[b.Bf[d]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.uv=0;c.Jo=0;c.xb=0;c.eJ=1;c.ly=!1;c.closed=!1;c.parent=null}})(a);var k=E.aI(function(a){return a.uv});for(E.oz(k,b);0<k.content.length;){var g=E.bI(k);if(g===c){a=g;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}g.closed=!0;for(var m=h(a,g),l=0,n=m.length;l<n;l++){var p=m[l];if(!p.closed){var t=g.Jo+x.dist(p.Nc,g.Nc),r=p.ly;if(!r||t<p.Jo)p.ly=!0,p.parent=g,p.xb=p.xb||f(p.Nc,e)+f(p.Nc,d),p.Jo=t,p.uv=p.Jo+p.xb,r?E.cI(k,
p):E.oz(k,p)}}}return[]}function w(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function f(a,b,c,d){b=x.subtract(b,a,B);a=x.subtract(c,a,G);a=x.cross(b,a,B);return z.sign(x.dot(d,a))}function n(a,b){x.subtract(a,b,B);return 1E-5>x.dot(B,B)}function r(a,b,c){var d=x.subtract(b.right,b.left,B),e=c.Gc,f=b.Gc;c=Math.acos(x.dot(e,f));e=z.sign(x.dot(d,x.cross(e,f,G)));c*=-e;e=u.identity(k);u.translate(e,b.left,e);u.rotate(e,c,d,e);u.translate(e,x.scale(b.left,-1,G),e);u.multiply(a,e,a)}function v(a,b,c,
d,e,f,k,g,m){for(var l=u.identity(h),n=e;n<c;n++)if(a[n].GB&&(n>e||!n)){var p,v=b,F=d;p=a[n].left;var q=a[n].right,z=f,C=l,y=x.create(),D=x.transformMat4(p,C,A);D[3]=1;C=x.transformMat4(q,C,B);C=x.subtract(C,D,J);v=x.subtract(F,v,B);z=x.cross(z,v,t);.01>Math.abs(x.dot(z,C))?F=.5:(x.normalize(z,z),z[3]=-x.dot(z,F),F=-I.dot(z,D)/I.dot(z,C));q=x.subtract(q,p,B);p=x.scaleAndAdd(p,q,F,y);w(k,p);g&&w(m,a[n].Gc);n&&r(l,a[n],a[n-1])}}function c(a,b){function c(b,d){z=q=t=d;g=k=h=b;x.copy(b,l);x.copy(b,m);
x.copy(a[t].Gc,p)}var d=[],e=[],h,k,g,l,m,p,t=0,q=0,z=0;h=a[0].right;k=a[0].left;g=a[0].right;l=x.copy(k,F);m=x.copy(g,D);p=x.copy(a[0].Gc,L);w(d,h);b&&w(e,a[0].Gc);for(var A=u.identity(C),y=1;y<a.length;y++){var G=a[y].left,E=a[y].right,B=x.transformMat4(G,A,aa),J=x.transformMat4(E,A,M);a[y].GB&&r(A,a[y],a[y-1]);if(0>=f(h,m,J,p)){var da=n(h,g);if(da||0<f(h,l,J,p))g=E,x.copy(J,m),z=y;else{(G=n(l,h))||v(a,l,q,h,t,p,d,b,e);A=u.identity(A);c(k,q);y=t;G||(w(d,h),b&&w(e,a[y].Gc));continue}}0<=f(h,l,B,
p)&&((da=n(h,k))||0>f(h,m,B,p)?(k=G,x.copy(B,l),q=y):((G=n(m,h))||v(a,m,z,h,t,p,d,b,e),A=u.identity(A),c(g,z),y=t,G||(w(d,h),b&&w(e,a[y].Gc))))}A=a.length-1;y=a[A].left;(G=n(h,y))||v(a,l,A,h,t,p,d,b,e);G&&t||w(d,y);return b?(w(e,a[A].Gc),{positions:new Float32Array(d),normals:new Float32Array(e)}):{positions:new Float32Array(d),normals:null}}function m(a,b,c,d,e){for(var f=null,h=Number.MAX_VALUE,k=0;k<a.length;k++){var g=a[k],l=e(c,g.Nc,g.Ij,b,h);l<h&&(f=g,h=l)}return 0<d&&h>d?null:f}function p(a,
b,c,d,e){a.push({left:b,right:c,GB:d,Gc:e})}var y=q("__geometry"),E=q("__math"),u=q("__mat4"),z=q("__util"),x=q("__vec3"),I=q("__vec4"),B=x.create(),G=x.create(),A=I.create(),J=I.create(),t=I.create(),h=u.create(),C=u.create(),k=u.create(),F=x.create(),D=x.create(),aa=x.create(),M=x.create(),L=x.create();a.BN=function(a){var b=y.Fr(a.Db,y.TG),c=a.Ad;a=[];for(var d=0;d<c.length;d+=3)a.push({ja:new Uint32Array([c[d],c[d+1],c[d+2]]),Nc:new Float32Array(3),Gc:new Float32Array(3)});c=[];for(d=0;d<b.length;d+=
3){var e=new Float32Array(3);e[0]=b[d];e[1]=b[d+1];e[2]=b[d+2];c.push(e)}for(b=0;b<a.length;b++)d=a[b],x.add(c[d.ja[0]],c[d.ja[1]],B),x.add(B,c[d.ja[2]],B),x.scale(B,1/3,d.Nc);for(b=0;b<a.length;b++){var d=a[b],e=x.subtract(c[d.ja[1]],c[d.ja[0]],B),f=x.subtract(c[d.ja[2]],c[d.ja[0]],G),e=x.cross(e,f,B);x.normalize(e,e);x.copy(e,d.Gc)}for(var h={},b=[],d=[],k,l,m=Math.pow(10,4),e=0,f=c.length;e<f;e++)k=c[e],l=Math.round(k[0]*m)+"_"+Math.round(k[1]*m)+"_"+Math.round(k[2]*m),void 0===h[l]?(h[l]=e,b.push(k),
d[e]=b.length-1):d[e]=d[h[l]];h=[];e=0;for(f=a.length;e<f;e++)for(k=a[e],k.ja[0]=d[k.ja[0]],k.ja[1]=d[k.ja[1]],k.ja[2]=d[k.ja[2]],k=[k.ja[0],k.ja[1],k.ja[2]],l=0;3>l;l++)if(k[l]==k[(l+1)%3]){h.push(e);break}for(e=h.length-1;0<=e;e--)a.splice(h[e],1);c.length=0;for(e in b)c.push(b[e]);d=[];for(b=e=0;b<a.length;b++)f=a[b],d.push({id:e++,Ij:f.ja,Nc:f.Nc,Gc:f.Gc,Bf:[]});a={VN:d,nn:c};c={};for(b=0;b<d.length;b++)for(e=0;3>e;e++)f=d[b].Ij[e],h=d[b].Ij[(e+1)%3],f=f>h?h+"-"+f:f+"-"+h,f in c||(c[f]=[]),c[f].push(d[b]);
d=Object.keys(c);b=0;for(h=d.length;b<h;b++)for(f=d[b],e=0;e<c[f].length;e++)for(k=e+1;k<c[f].length;k++)c[f][e].Bf.push(c[f][k]),c[f][k].Bf.push(c[f][e]);return g(a)};a.navmesh_get_island=function(a,b,c){for(var d=null,e=Number.MAX_VALUE,f=a.$v,h=0;h<f.length;h++)for(var k=0;k<f[h].length;k++){var g=f[h][k];x.subtract(g.Nc,b,B);g=c(b,g.Nc,g.Ij,a.nn,e);g<e&&(d=h,e=g)}return d};a.FM=function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(c[b[e]]);b=!1;c=-1;for(var e=d.length,f=e-1;++c<e;f=c)(d[c][1]<=
a[1]&&a[1]<d[f][1]||d[f][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[f][0]-d[c][0])*(a[1]-d[c][1])/(d[f][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};a.navmesh_find_path=function(a,b,d,e){var f;f=a.$v[e.island];var h=a.nn,k=m(f,h,b,e.allowed_distance,e.distance_to_closest);f=k?(h=m(f,h,d,e.allowed_distance,e.distance_to_farthest))?l(f,k,h,b,d):null:null;if(f&&f.length)if(e.do_not_pull_string)if(d=f,e.return_normals){b=new Float32Array(3*d.length);for(f=0;f<d.length;f++)b.set(d[f].Nc,3*f);d={positions:b,normals:null}}else{b=
new Float32Array(3*d.length);a=new Float32Array(3*d.length);for(f=0;f<d.length;f++)b.set(d[f].Nc,3*f),a.set(d[f].Gc,3*f);d={positions:b,normals:a}}else{a=a.nn;e=e.return_normals;k=[];p(k,b,b,!1,f[0]&&f[0].Gc||z.AXIS_Z);for(b=0;b<f.length;b++){var g=f[b];if(h=f[b+1]){var n=.999>Math.abs(x.dot(g.Gc,h.Gc));a:{for(var t=0;t<g.Bf.length;t++)if(g.Bf[t]===h.id){g=g.WN[t];break a}g=void 0}p(k,a[g[0]],a[g[1]],n,h.Gc)}}p(k,d,d,!1,k[k.length-1].Gc);d=c(k,e)}else d=null;return d}};b4w.module.__nla=function(a,q){function e(){return{type:"CLIP",pa:0,Sa:0,Yh:!1,paused:!1,qf:"",Fn:"",hc:0,ym:null,si:0,Nj:0,EA:0,DA:0,AE:!1,scale:1,repeat:1,Uy:0}}function d(a,b,c){if(a.animation_data){var e=a.animation_data.nla_tracks;if(e)for(var f=0;f<e.length;f++)e[f].ym=c,b.push(e[f])}a=a.nodes;for(f=0;f<a.length;f++)if(e=a[f],e.node_group){var g=e.node_group.node_tree;if(g){var k=c.slice();k.push(e.name);d(g,b,k)}}}function b(a,b){var c=Math.round(a)-b.pa;b.ii&&(c%=b.Ki,0>c&&(c+=b.Ki));return b.Fb+
c}function g(a,b){var c=(b-B)*z.Zc()+a.Fb;c>a.pa?(c-=a.pa,a.cyclic&&(c%=a.Sa-a.pa+1),c+=a.pa):c=a.pa;return c}function l(a,b){a=x.clamp(a,b.pa,b.Sa);var c=a==b.Sa?b.Uy:b.si+(a-b.pa)/b.scale%(b.Nj-b.si);b.AE&&(c=b.Nj-c+b.si);return c}function w(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],g=f.strips;if(g)for(var k=0;k<g.length;k++){var l=g[k],m=e();m.type=l.type;m.pa=l.frame_start;m.Sa=l.frame_end;m.hc=b;m.si=l.action_frame_start;m.Nj=l.action_frame_end;m.AE=l.use_reverse;m.scale=l.scale;m.repeat=
l.repeat;l.action&&(m.qf=l.action.name,m.Fn=l.action.uuid,m.ym=f.ym);c.push(m)}}return c}function f(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function n(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function r(a,b){var c=y.get_active();if(c.na){var d=g(c.na,b);c.na.Fb-=d-a;c.na.Zl=!0}}var v=q("__animation");q("__config");var c=q("__objects"),m=q("__obj_util"),p=q("__print"),y=q("__scenes"),E=q("__sfx"),u=q("__textures"),z=q("__time"),x=q("__util"),I=[],B=-1;a.Cj=function(a,b){var c,g=null;for(c=b.G.length-1;0<=c;c--){var h=b.G[c];if(h.mb.b4w_use_nla&&(g=h,h.mb.Qy))break}if(c=g){c.rC=!0;var l=0;if((g=a.animation_data)&&g.nla_tracks.length){var k=g.nla_tracks;if(m.is_armature(b)||m.is_camera(b)||
m.is_mesh(b)||m.is_empty(b)||m.is_lamp(b)||m.is_speaker(b)||m.is_world(b))k=w(k,l),k.length&&(b.Cf=b.Cf.concat(k),l++)}f(a)&&(k=a.data.animation_data.nla_tracks,k=w(k,l),k.length&&(b.Cf=b.Cf.concat(k),l++));if(m.is_mesh(b))for(h=a.data.materials,g=0;g<h.length;g++){var n=h[g];if(n.use_nodes&&n.node_tree&&(k=[],d(n.node_tree,k,[n.name]),k=w(k,l),k.length)){for(var n=l,p=k,r=v.AL(),u=[],q=0,z=0;z<p.length;z++){var y=p[z];""!=y.Fn?y=x.keysearch("uuid",y.Fn,r):(y=y.qf,y=x.keysearch("name",y,r)||x.keysearch("name",
y+"_B4W_BAKED",r));if(y){var y=y.fcurves,E=[],O;for(O in y)E.push(O);u.push(E)}}for(z=0;z<u.length;z++){r=!1;for(y=0;y<z;y++)if(x.NH(u[z],u[y])){p[z].hc=p[y].hc;r=!0;break}r||(p[z].hc=l+q++)}l=n+q;b.Cf=b.Cf.concat(k)}}if(!m.is_world(b)){for(g=0;g<a.particle_systems.length;g++)h=a.particle_systems[g],O=h.settings,"EMITTER"==O.type&&O.b4w_allow_nla&&(O=e(),O.type="CLIP",O.pa=c.mb.frame_start,O.Sa=c.mb.frame_end+1,O.qf=h.name,O.hc=l,O.si=O.pa,O.Nj=O.Sa,b.Cf.push(O),l++);c=l+1;for(g=0;g<b.Hc.length;g++)h=
b.Hc[g],h.iH&&(l=c,O=e(),O.type="CLIP",O.pa=h.pa,O.Sa=h.Sa,O.qf=h.name,O.hc=l,O.si=O.pa,O.Nj=O.Sa,b.Cf.push(O))}}};a.zQ=function(a,b,d){a.na||(a.na={pa:a.frame_start,Sa:a.frame_end,Fb:0,ap:-1,wp:a.frame_end,xp:a.frame_start,ln:null,cyclic:b,Ta:[],X:[],XC:a.name,Wi:!1,Zl:!1,fx:!0},I.push(a.na));b=a.na;for(var f=c.kB(a,"ALL",d),h=0;h<f.length;h++){var g=f[h];if(g.Cf.length){b.Ta[d]||(b.Ta[d]=[]);for(var k=0;k<g.G.length;k++){var l=g.G[k];l.mb==a&&l.rC&&b.Ta[d].push(g)}for(var k=g.Cf,l=b,m=g.name,n=
0;n<k.length;n++){var r=k[n];l.pa>r.Sa||l.Sa<r.pa?(p.warn("NLA: Strip is out of scene range: "+(m+" ["+r.pa+":"+r.Sa+"]")),k.splice(n,1),n--):r.qf||"CLIP"!=r.type||(p.warn('NLA: no action in strip for object "'+m+'".'),k.splice(n,1),n--)}g=g.Cf;k=b;for(l=0;l<g.length;l++){for(var m=g[l],n=k.pa,r=k.Sa+1,u=0;u<g.length;u++){var v=g[u];m.hc==v.hc&&(v.Sa<=m.pa&&(n=m.pa),v.pa>=m.Sa&&(r=Math.min(r,v.pa)))}m.EA=n;m.DA=r;m.Uy=0===m.repeat%1?m.Nj:m.si+m.repeat%1*(m.Nj-m.si)}}}a=a.q.on;for(h=0;h<a.length;h++)f=
a[h].q,f.kn&&(f.ya||f.ad)&&f.vg==d&&(g=e(),g.type="VIDEO",f.ii?(g.pa=0,g.Sa=b.Sa):(g.pa=x.clamp(f.pa,0,b.Sa),g.Sa=x.clamp(f.pa+f.Ki,0,b.Sa)),g.qf=a[h].name,b.X.push(f))};a.start=function(){B=0};a.eM=function(){return B};a.KS=function(a){return a.na?a.na.Fb:null};a.xT=function(a,b){return a.na?(a.na.Fb=b,!0):!1};a.update=function(a,c){if(!(0>B)){0==B&&(B=a);for(var d=0;d<I.length;d++){var e=I[d];e.Wi&&(e.Fb-=z.Zc()*c);var f=g(e,a);if((!e.Wi||e.Zl)&&f>=e.wp)if(e.cyclic){var f=e,m=a;f.ln&&f.ln();r(f.xp,
m);f.fx=!0;f=g(f,m)}else{var m=e,k=f;m.Wi=!0;m.Fb-=k-m.wp;m.ln&&m.ln()}if(!e.Wi||e.Zl){for(var m=e,k=f,n=0;n<m.Ta.length;n++){var p=m.Ta[n];if(p)for(var w=0;w<p.length;w++){for(var q=p[w],y=q.Cf,T=0;T<y.length;T++){var N=y[T];"SOUND"==N.type&&k<m.ap-1E-6&&(N.Yh=!1)}for(T=0;T<y.length;T++)switch(N=y[T],N.type){case "CLIP":if(N.EA<=k&&k<N.DA&&!N.Yh){var n=q,U=N,O=U.ym;""!=U.Fn?v.IH(n,O,U.Fn,U.hc):v.apply(n,O,U.qf,U.hc);v.set_behavior(n,v.AB_FINISH_STOP,U.hc);O=l(U.pa,U);v.set_frame(n,O,U.hc);for(n=
0;n<y.length;n++)y[n]!=N&&y[n].hc==N.hc&&(y[n].Yh=!1);N.Yh=!0}N.Yh&&(U=q,O=l(k,N),1E-6<Math.abs(O-v.cB(U,N.hc))&&v.set_frame(U,O,N.hc));break;case "SOUND":if((k<m.ap-1E-6||m.ap<N.pa)&&N.pa<=k&&k<N.Sa&&!N.Yh){var U=q,qa=N,O=(qa.pa-k)/z.Zc(),qa=(qa.Sa-qa.pa)/z.Zc();E.play(U,O,qa);N.Yh=!0}m.ap<N.Sa&&N.Sa<=k&&N.Yh&&(N.Yh=!1)}}}m=a;k=e;p=f;for(w=0;w<k.X.length;w++)if(q=k.X[w],q.ya||q.ad){y=u.LE(q);T=q;N=x.clamp(b(p,T),T.Fb,T.Fb+u.ME(T)-1);T.ad&&(N=u.VQ(T,N),N==T.Gp&&N--);T=N;N=u.NE(q);U=n=!1;if(k.Zl||
k.fx)U=!0;k.Wi||(O=b(p,q),O=q.Fb<=O&&O<=q.Fb+u.ME(q),qa=u.OE(q),q.ii&&T==N&&(U=!0),qa||y==T||(U=!0),O&&!qa?u.play_video(q.name,q.vg):O&&qa?n=!0:!O&&qa&&(q.ya&&y<T?n=!0:u.pause_video(q.name,q.vg)));U?(u.MO(q.name,T,q.vg),q.ad&&(q.qj=u.Zs(q,m))):n&&u.PE(q)&&(q.ya?u.tE(q):(y=u.Zs(q,m),y!=q.qj&&(q.Zh=T,u.sE(q)),q.qj=y))}e.ap=f}e.Zl=!1;e.fx=!1}}};a.cleanup=function(a){if(0==a)I.length=0,B=-1;else for(var b=0;b<I.length;b++)I[b].Ta[a]=null};a.wz=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||
f(a)||n(a)?!0:!1};a.set_frame=r;a.get_frame=function(a){var b=y.get_active();return b.na?g(b.na,a):-1};a.Bx=function(){var a=y.get_active();if(a.na){a.na.Wi=!0;for(var a=a.na.X,b=0;b<a.length;b++){var c=a[b];u.pause_video(c.name,c.vg)}}};a.CC=function(a){var b=y.get_active();b.na&&(b.na.Wi=!1,b.na.ln=a?a:null)};a.get_frame_start=function(){var a=y.get_active();return a.na?a.na.pa:-1};a.get_frame_end=function(){var a=y.get_active();return a.na?a.na.Sa:-1};a.is_play=function(){var a=y.get_active();
return a.na?!a.na.Wi:!1};a.check_nla=function(){var a=y.get_active();return a.na?a.b4w_use_nla:!1};a.check_logic_nodes=function(){var a=y.get_active();return a.na?0<a.b4w_logic_nodes.length:!1};a.set_range=function(a,b){var c=y.get_active();if(c.na)c.na.xp=a,c.na.wp=b;else return!1};a.nx=function(a){var b=y.get_active();b.na&&(b.na.wp=a)};a.ZO=function(a){var b=y.get_active();b.na&&(b.na.xp=a)};a.reset_range=function(){var a=y.get_active();if(a.na)a=a.na,a.xp=a.pa,a.wp=a.Sa;else return!1};a.set_cyclic=
function(a){var b=y.get_active();if(b.na)b.na.cyclic=a;else return!1};a.clear_callback=function(){var a=y.get_active();a.na&&(a.na.ln=null)};a.fD=function(a){var b=y.get_active().na;b&&(b.Fb=-(a-B)*z.Zc()+b.xp,b.Zl=!0)};a.get_frame_end=function(){var a=y.get_active().na;return a?a.Sa:null}};b4w.module.__camera=function(a,q){function e(a,b,c,d,e){va.set_translation(a,b);c&&x(a,b,c);A(a,d);J(a,e)}function d(a,b,c,d,e,f,h,g){var m=a.k;va.set_translation(a,b);m.pivot.set(c);x(a,b,c);A(a,d);J(a,e);k(a,f);F(a,h);m.use_panning=g}function b(a,b,c,d,e,f,h,k){var g=a.k;va.set_translation(a,b);g.Hb.set(c);x(a,b,c);C(a,d);t(a,e);D(a,f);aa(a,h);g.Lg=k}function g(a,b,c){var d=a.k,e=P.get_trans_view(d.n),f=P.get_quat_view(d.n),d=wa;d.set(Y.AXIS_Z);d[3]=0;a=m(a,ja)[1];f=Y.quat_to_dir(f,Y.AXIS_MZ,ya);
Ha.set_pline_initial_point(la,e);Ha.set_pline_directional_vec(la,f);if(!Y.line_plane_intersect(d,-b,la,c)||Math.abs(a)<Aa)da.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),c[0]=e[0],c[1]=0,c[2]=e[2];return c}function l(b){for(var c=b.k,d=0;d<b.G.length;d++){var e=b.G[d].W[0];if(e.type==a.Ud)switch(c.hb){case a.MS_TARGET_CONTROLS:var f=P.get_trans_view(c.n);c.Si=na.dist(f,c.pivot);c.Ti=e.top;break;case a.MS_HOVER_CONTROLS:f=
P.get_trans_view(c.n),c.Si=na.dist(f,c.Hb),c.Ti=e.top}}}function w(a){a={type:a,name:"",rD:1,width:0,height:0,xe:null,Io:null,bc:null,ue:null,pb:0,xd:0,near:0,far:0,left:0,right:0,top:0,bottom:0,Id:ea.create(),n:new Float32Array(9),Ab:new Float32Array(16),Gt:new Float32Array(16),lb:new Float32Array(16),Rc:new Float32Array(16),Ft:new Float32Array(16),Uw:new Float32Array(16),Hf:new Float32Array(16),direction:new Float32Array(3),Je:P.hk(),Ht:P.hk(),zp:P.hk(),Us:P.hk(),Jp:P.hk(),dof_distance:0,dof_front_start:0,
dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,gb:0,Dc:null,yA:!1,fd:!1,dof_on:!1,ms:new Float32Array(3),Og:n(),uj:0,De:0,Xb:null,Ig:null,no:null,er:new Float32Array(4),Fm:new Float32Array(4)};a.Id[0]=a.Id[2]=45;a.Id[1]=a.Id[3]=55;return a}function f(a,b){var c=w(a.type);c.name=a.name;c.rD=a.rD;c.width=a.width;c.height=a.height;b||(c.xe=a.xe,c.Io=a.Io,c.bc=a.bc,c.ue=a.ue);c.pb=a.pb;c.xd=a.xd;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;ea.copy(a.Id,
c.Id);P.copy(a.n,c.n);ka.copy(a.Ab,c.Ab);ka.copy(a.lb,c.lb);ka.copy(a.Rc,c.Rc);ka.copy(a.Ft,c.Ft);ka.copy(a.Uw,c.Uw);ka.copy(a.Hf,c.Hf);P.copy(a.Je,c.Je);P.copy(a.Ht,c.Ht);P.copy(a.zp,c.zp);P.copy(a.Us,c.Us);P.copy(a.Jp,c.Jp);c.dof_distance=a.dof_distance;c.dof_front_start=a.dof_front_start;c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=a.dof_power;c.gb=a.gb;c.Dc=a.Dc;c.yA=a.yA;c.fd=a.fd;c.dof_on=a.dof_on;na.copy(a.ms,c.ms);var d=a.Og,e=
c.Og;ea.copy(d.left,e.left);ea.copy(d.right,e.right);ea.copy(d.top,e.top);ea.copy(d.bottom,e.bottom);ea.copy(d.near,e.near);ea.copy(d.far,e.far);c.uj=a.uj;c.De=a.De;a.Xb&&(c.Xb=ea.clone(a.Xb));if(a.Ig){d=a.Ig.length;c.Ig=Array(d);for(e=0;e<d;e++)c.Ig[e]=na.clone(a.Ig[e]);c.no=new Float32Array(a.no)}ea.copy(a.er,c.er);ea.copy(a.Fm,c.Fm);return c}function n(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),
near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function r(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:Y.r("Unknown move style")}}function v(b){var c=w(b);if(b==a.Tc)return c;switch(b){case a.od:y(c,40,.1,1E3);break;case a.Ud:y(c,2.5,.1,1E3);break;case a.Ag:break;case a.zg:break;case a.rh:break;case a.Ac:case a.Kc:case a.ne:case a.oe:Y.r("Stereo camera may only be created from perspective one");
break;default:Y.r("Unknown camera type")}return c}function c(b,c,d){b.type!=a.Ac&&b.type!=a.Kc&&b.type!=a.ne&&b.type!=a.oe&&Y.r("set_stereo_params(): wrong camera type");if(b.type==a.Ac||b.type==a.Kc)b.uj=c;b.De=d;fa(b,b.pb);if(Ba.va()&&(c=Ba.get_active(),b=c.q.bd))for(c=Ea.ea(Ba.bm(c),c).W,d=0;d<c.length;d++)ma(c[d],b)}function m(a,b){var c=P.get_quat_view(a.k.n);return p(c,b)}function p(a,b){var c=Y.quat_to_dir(a,Y.AXIS_Z,ya),d=Y.quat_to_dir(a,Y.AXIS_MY,Ca),e=-Math.asin(c[2]/na.length(c)),c=Math.abs(e)>
Math.PI/4?na.scale(d,-Y.sign(e),sa):na.scale(c,-Y.sign(d[2]),sa),f=Math.atan(Math.abs(c[0]/c[1]));0<d[2]&&(e=Y.sign(e)*Math.PI-e);d=f;0<c[1]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function y(b,c,d,e,f){switch(b.type){case a.od:case a.Ac:case a.Kc:b.xd=c;b.pb=1;break;case a.Ud:b.top=c;b.pb=1;break;case a.Ag:b.xd=c;b.pb=f/c;break;case a.zg:b.top=c;b.pb=f/c;break;case a.ne:case a.oe:break;default:da.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=e}function E(b,
c){var d=P.Ub(c.k.n,ya),e=P.zd(c.k.n,S),f=ka.fromRotationTranslation(e,d,La);ka.invert(f,b.Ab);if(Ba.va())var f=Ba.get_active(),h=Ba.Ja(f,za.pi);if(b.type==a.Ac||h&&h.enable_hmd_stereo&&b.type==a.ne)b.Ab[12]+=b.De/2;else if(b.type==a.Kc||h&&h.enable_hmd_stereo&&b.type==a.oe)b.Ab[12]-=b.De/2;if(b.Xb){P.from_mat4(b.Ab,b.zp);P.invert(b.zp,b.Us);var f=b.Xb[0],h=b.Xb[1],k=b.Xb[2],g=b.Xb[3],m=b.Gt;m[0]=1-2*f*f;m[1]=-2*f*h;m[2]=-2*f*k;m[3]=0;m[4]=-2*f*h;m[5]=1-2*h*h;m[6]=-2*h*k;m[7]=0;m[8]=-2*f*k;m[9]=-2*
h*k;m[10]=1-2*k*k;m[11]=0;m[12]=-2*f*g;m[13]=-2*h*g;m[14]=-2*k*g;m[15]=1;ka.multiply(b.Ab,b.Gt,b.Ab);fa(b,b.pb,!0);f=wa;h=La;ka.invert(b.Ab,h);ka.transpose(h,h);ea.transformMat4(b.Xb,h,f);h=Da;h[0]=(Y.sign(f[0])+b.lb[8])/b.lb[0];h[1]=(Y.sign(f[1])+b.lb[9])/b.lb[5];h[2]=-1;h[3]=(1+b.lb[10])/b.lb[14];ea.scale(f,2/(f[0]*h[0]+f[1]*h[1]+f[2]*h[2]+f[3]*h[3]),f);b.lb[2]=f[0];b.lb[6]=f[1];b.lb[10]=f[2]+1;b.lb[14]=f[3];na.transformMat4(d,b.Gt,d)}P.from_mat4(b.Ab,b.Je);P.invert(b.Je,b.Ht);R(b);W(b);P.set_sep(d,
1,e,b.n)}function u(b,c,d,e){ka.lookAt(c,d,e,b.Ab);d=Ba.get_active();d=Ba.Ja(d,za.pi);Ba.va()&&(d=Ba.get_active(),d=Ba.Ja(d,za.pi));if(b.type==a.Ac||d&&d.enable_hmd_stereo&&b.type==a.ne)b.Ab[12]+=b.De/2;else if(b.type==a.Kc||d&&d.enable_hmd_stereo&&b.type==a.oe)b.Ab[12]-=b.De/2;P.from_mat4(b.Ab,b.Je);R(b);W(b);P.set_trans(c,b.n)}function z(a,b,c){c=na.subtract(c,b,ya);na.length(c)&&(na.normalize(c,c),c=Y.jx(Y.AXIS_MZ,c,S),va.set_rotation(a,c));va.set_translation(a,b)}function x(a,b,c){var d=a.k,e=
G(a);z(a,b,c);e?(b=na.copy(d.Ie,ya),na.negate(b,b),ca.correct_up(a,b,!0)):ca.correct_up(a,d.Ie,!0)}function I(a,b){for(var c=a.k,d=b.W,e=P.zd(c.n,S),e=Y.quat_to_dir(e,Y.AXIS_MZ,ya),f=P.Ub(c.n,Ca),h=b.pD,k=0;k<h.length;k++){var g=h[k];na.copy(e,g.direction);P.Ub(c.n,g.ms)}for(k=0;k<d.length;k++)g=d[k],E(g,a),na.copy(e,g.direction),Y.Vl(g.Rc,g.Og),g.Dc&&g.dof_on&&(c=va.get_translation(g.Dc,sa),c=na.dist(f,c),g.dof_distance=c)}function B(b){var c=b.k;c.hb==a.MS_TARGET_CONTROLS&&(c.xj=G(b))}function G(a){a=
P.get_quat_view(a.k.n);return 0>Y.quat_to_dir(a,Y.AXIS_Y,ya)[2]}function A(b,c){var d=b.k;if(c){d.Ya=d.Ya||{};d.Ya.left=c.left;d.Ya.right=c.right;d.Ya.pm=c.left;d.Ya.Lm=c.right;d.Ya.camera_space=Boolean(c.camera_space);var e=b.k;!(d=e.Ya)||e.hb!=a.MS_EYE_CONTROLS&&e.hb!=a.MS_TARGET_CONTROLS||(e=m(b,ja),d.camera_space?(d.left+=e[0],d.right+=e[0]):(d.pm-=e[0],d.Lm-=e[0]),d.left=Y.angle_wrap_0_2pi(d.left),d.right=Y.angle_wrap_0_2pi(d.right),d.pm=Y.angle_wrap_0_2pi(d.pm),d.Lm=Y.angle_wrap_0_2pi(d.Lm))}else d.Ya=
null}function J(a,b){var c=a.k;b?(c.fa=c.fa||{},c.fa.down=b.down,c.fa.up=b.up,c.fa.Sl=b.down,c.fa.hn=b.up,c.fa.camera_space=Boolean(b.camera_space),h(a)):c.fa=null}function t(a,b){var c=a.k;if(!b){var d=m(a,ja);b={down:d[1],up:d[1]}}c.fa=c.fa||{};c.fa.down=b.down;c.fa.up=b.up;h(a);c.fb&&c.fa&&qa(a)}function h(b){var c=b.k,d=c.fa;if(d)switch(c.hb){case a.MS_EYE_CONTROLS:case a.MS_TARGET_CONTROLS:b=m(b,ja);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.hn-=b[1],d.Sl-=b[1]);d.up=Y.angle_wrap_periodic(d.up,
-Math.PI,Math.PI);d.down=Y.angle_wrap_periodic(d.down,-Math.PI,Math.PI);d.hn=Y.angle_wrap_periodic(d.hn,-Math.PI,Math.PI);d.Sl=Y.angle_wrap_periodic(d.Sl,-Math.PI,Math.PI);break;case a.MS_HOVER_CONTROLS:d.up=Y.angle_wrap_periodic(d.up,-Math.PI,Math.PI),d.down=Y.angle_wrap_periodic(d.down,-Math.PI,Math.PI),d.up=Y.clamp(d.up,-Math.PI/2,0),d.down=Y.clamp(d.down,-Math.PI/2,0)}}function C(a,b){var c=a.k;if(!b){var d=va.Bm(a,c.Hb);b={min:d,max:d}}c.fb=c.fb||{};c.fb.min=b.min;c.fb.max=b.max;c.fb&&c.fa&&
qa(a)}function k(a,b){var c=a.k;b?(c.fb=c.fb||{},c.fb.min=b.min,c.fb.max=b.max):c.fb=null}function F(a,b){var c=a.k;b?(c.Cd=c.Cd||{},c.Cd.min_z=b.min_z,c.Cd.max_z=b.max_z):c.Cd=null}function D(a,b){var c=a.k;b?(c.jc=c.jc||{},c.jc.min=b.min,c.jc.max=b.max):c.jc=null}function aa(a,b){var c=a.k;b?(c.kc=c.kc||{},c.kc.min=b.min,c.kc.max=b.max):c.kc=null}function M(b){var c=b.k;if(Ea.is_camera(b))for(var d=b.G,e=0;e<d.length;e++){var f=d[e].W;if(f[0].type===a.Ud){switch(c.hb){case a.MS_TARGET_CONTROLS:var h=
P.get_trans_view(c.n),h=na.dist(h,c.pivot),h=h/c.Si*c.Ti;break;case a.MS_HOVER_CONTROLS:h=P.get_trans_view(c.n);h=na.distance(h,c.Hb);h=h/c.Si*c.Ti;break;default:h=f[0].top}for(var k=0;k<f.length;k++){var g=f[k];g.top=h;fa(g,g.pb)}I(b,d[e])}}}function L(b){var c=b.k,d=c.hb;if(d===a.MS_TARGET_CONTROLS||d===a.MS_EYE_CONTROLS){if(c.Ya){var e=c.Ya.left,f=c.Ya.right,h=m(b,ja);(h=d==a.MS_TARGET_CONTROLS?Y.$j(h[0],e,f):Y.$j(h[0],f,e))&&(d==a.MS_TARGET_CONTROLS?N(b,h,0):T(b,h,0))}c.fa&&(e=c.fa.down,f=c.fa.up,
h=m(b,ja),(h=d==a.MS_TARGET_CONTROLS?Y.$j(h[1],f,e):Y.$j(h[1],e,f))&&(d==a.MS_TARGET_CONTROLS?N(b,0,h):T(b,0,h)));if(d===a.MS_TARGET_CONTROLS&&c.fb){var h=b.k,e=P.get_trans_view(h.n),f=na.subtract(e,h.pivot,ya),k=na.length(f);k>h.fb.max?(na.scale(f,h.fb.max/k,f),na.add(h.pivot,f,e)):k<h.fb.min&&(k=P.get_quat_view(h.n),k=Y.quat_to_dir(k,Y.AXIS_MZ,Ca),na.scale(k,100*h.fb.min,k),na.add(f,k,f),na.scale(f,-h.fb.min/na.length(f),f),na.add(h.pivot,f,e))}}d===a.MS_TARGET_CONTROLS&&c.Cd&&(c=b.k,h=c.pivot[2],
e=Y.clamp(c.pivot[2],c.Cd.min_z,c.Cd.max_z),e!=h&&(h=na.set(0,0,e-h,ya),na.add(c.pivot,h,c.pivot),c=P.get_trans_view(c.n),na.add(c,h,c)));d===a.MS_HOVER_CONTROLS&&(d=b.k,d.jc&&(h=Y.clamp(d.Hb[0],d.jc.min,d.jc.max)-d.Hb[0],d.Hb[0]+=h,c=P.get_trans_view(d.n),c[0]+=h),d.kc&&(h=Y.clamp(d.Hb[1],d.kc.min,d.kc.max)-d.Hb[1],d.Hb[1]+=h,c=P.get_trans_view(d.n),c[1]+=h),d=b.k,c=m(b,ja)[1],(d=Y.$j(c,d.fa.up,d.fa.down))&&U(b,0,d))}function T(a,b,c,d,e){var f=a.k,h=b,k=c;if(d||e)a=m(a,ta),d&&(h=b-a[0]),e&&(k=c-
a[1]);if(h||k)b=K.identity(S),h&&(h=K.setAxisAngle(f.Ie,h,oa),K.multiply(b,h,b)),f=P.get_quat_view(f.n),k&&(h=Y.quat_to_dir(f,Y.AXIS_X,ya),k=K.setAxisAngle(h,k,oa),K.normalize(k,k),K.multiply(b,k,b)),K.multiply(b,f,f)}function N(a,b,c,d,e){var f=a.k,h=b,k=c;if(d||e){var g=m(a,ta);d&&(h=b-g[0]);e&&(k=c-g[1])}O(a,a.k.pivot,h,k);a=m(a,ta);a=Y.angle_wrap_periodic(a[1],-Math.PI,Math.PI);f.xj=Math.abs(a)>Math.PI/2}function U(a,b,c,d,e){var f=a.k,h=b,k=c;if(d||e){var g=m(a,ta);d&&(h=b-g[0]);e&&(k=c-g[1])}f.Lg||
(h=0);O(a,f.Hb,h,k);k&&qa(a)}function O(a,b,c,d){var e=a.k;if(c||d){var f=K.identity(S);c&&(c=K.setAxisAngle(Y.AXIS_Z,c,oa),K.multiply(f,c,f));H(a);a=P.get_quat_view(e.n);d&&(c=Y.quat_to_dir(a,Y.AXIS_X,ya),d=K.setAxisAngle(c,d,oa),K.normalize(d,d),K.multiply(f,d,f));e=P.get_trans_view(e.n);Y.vO(e,b,f,e);K.multiply(f,a,a)}}function qa(a){var b=a.k,c=m(a,ja)[1],d=a.k;a=d.fa;d=d.fb;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=P.get_trans_view(b.n);d=P.get_quat_view(b.n);
d=Y.quat_to_dir(d,Y.AXIS_MZ,ya);na.normalize(d,d);na.scale(d,c,d);na.subtract(b.Hb,d,a)}function fa(b,c,d){switch(b.type){case a.od:c||Y.r("No aspect ratio"),b.pb=c;case a.Ag:ka.perspective(Y.deg_to_rad(b.xd),b.pb,b.near,b.far,b.lb);break;case a.Ud:c||Y.r("No aspect ratio"),b.pb=c;case a.zg:c=b.top*b.pb;ka.ortho(-c,c,-b.top,b.top,b.near,b.far,b.lb);break;case a.rh:ka.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.lb);break;case a.Ac:case a.Kc:c||Y.r("No aspect ratio");b.pb=c;var e=Math.tan(b.xd*
Math.PI/360);c=b.near*e;var f=b.pb*b.uj*e;b.type==a.Ac?(e=f-b.De/2,f+=b.De/2):(e=f+b.De/2,f-=b.De/2);e=-(b.near/b.uj*e);f*=b.near/b.uj;ka.frustum(e,f,-c,c,b.near,b.far,b.lb);b.left=e;b.right=f;break;case a.ne:case a.oe:if(Ba.va())if(e=Ba.get_active(),(e=Ba.Ja(e,za.pi))&&e.enable_hmd_stereo){c=Math.tan(Y.deg_to_rad(b.Id[0]));var e=Math.tan(Y.deg_to_rad(b.Id[1])),f=Math.tan(Y.deg_to_rad(b.Id[2])),h=Math.tan(Y.deg_to_rad(b.Id[3]));b.top=b.near*c;b.right=b.near*e;b.bottom=-b.near*f;b.left=-b.near*h;ka.frustum(b.left,
b.right,b.bottom,b.top,b.near,b.far,b.lb)}else c||(c=b.pb),ka.perspective(Y.deg_to_rad(b.xd),c,b.near,b.far,b.lb);break;case a.Tc:return;default:Y.r("Wrong camera type: "+b.type)}d||(R(b),W(b))}function W(a){ka.copy(a.Ab,a.Hf);a.Hf[12]=0;a.Hf[13]=0;a.Hf[14]=0;a.Hf[15]=1;ka.multiply(a.lb,a.Hf,a.Hf);ka.invert(a.Hf,a.Hf)}function R(a){ka.copy(a.Ab,a.Rc);ka.multiply(a.lb,a.Rc,a.Rc);ka.invert(a.Rc,a.Ft)}function ha(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.near);d||(d=b.far);var h,k,g,m,l,n,p,ba;
switch(b.type){case a.Tc:Y.r("Extraction from NONE camera is not possible");break;case a.od:case a.Ag:h=c*Math.tan(b.xd*Math.PI/360);m=-h;k=h*b.pb;g=-k;l=d/c*h;ba=-l;n=l*b.pb;p=-n;break;case a.Ud:case a.zg:g=b.top*b.pb;h=l=b.top;k=n=g;m=ba=-b.top;g=p=-g;break;case a.rh:h=l=b.top;k=n=b.right;m=ba=b.bottom;g=p=b.left;break;case a.Ac:case a.Kc:l=c/b.near;h=c*Math.tan(b.xd*Math.PI/360);m=-h;k=b.right*l;g=b.left*l;p=d/c;l=h*p;ba=-l;n=k*p;p*=g;break;case a.ne:case a.oe:l=c/b.near;h=b.top*l;m=b.bottom*l;
k=b.right*l;g=b.left*l;p=d/c;l=h*p;ba=m*p;n=k*p;p*=g;break;default:Y.r("Wrong camera type: "+b.type)}e[0]=g;e[1]=m;e[2]=-c;e[3]=k;e[4]=m;e[5]=-c;e[6]=k;e[7]=h;e[8]=-c;e[9]=g;e[10]=h;e[11]=-c;e[12]=p;e[13]=ba;e[14]=-d;e[15]=p;e[16]=l;e[17]=-d;e[18]=n;e[19]=l;e[20]=-d;e[21]=n;e[22]=ba;e[23]=-d;f&&(c=La,ka.invert(b.Ab,c),Y.Hm(e,c,e,0));return e}function H(b){return Ea.is_camera(b)&&b.k&&b.k.hb==a.MS_HOVER_CONTROLS}function ma(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.Ig){var d=b.csm_num;a.Ig=Array(d);
for(var e=0;e<d;e++)a.Ig[e]=new Float32Array(3);a.no=new Float32Array(d)}for(d=0;d<c;d++){var e=0==d?a.near:V(b,a,d-1),f=V(b,a,d),e=ha(a,e,f,ba),e=ua.TL(e);a.Ig[d].set(e.D);a.no[d]=e.Ra;a.er[d]=na.length(e.D);a.Fm[d]=ia(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.Fm[0]=b.first_cascade_blur_radius}function V(a,b,c){var d=a.csm_num,e=Y.clamp(a.csm_first_cascade_border,b.near,b.far);a=Y.clamp(a.csm_last_cascade_border,b.near,b.far);return Y.clamp(ia(e,a,d,c),b.near,b.far)}function ia(a,
b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}function pa(a,b){b||(b=new Float32Array(3));var c=P.get_trans_view(a.k.n);na.copy(c,b);return b}var ua=q("__boundings");q("__config");var ca=q("__constraints"),X=q("__container"),ka=q("__mat4"),Ha=q("__math"),Ea=q("__obj_util"),da=q("__print"),K=q("__quat"),Ba=q("__scenes"),za=q("__subscene"),va=q("__transform"),P=q("__tsr"),Y=q("__util"),na=q("__vec3"),ea=q("__vec4");a.Tc=10;a.od=20;a.Ud=30;a.Ag=40;
a.zg=50;a.rh=60;a.Ac=70;a.Kc=80;a.ne=90;a.oe=100;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var Aa=Y.deg_to_rad(.5),ja=new Float32Array(2),ta=new Float32Array(2),ya=new Float32Array(3),Ca=new Float32Array(3),sa=new Float32Array(3),S=new Float32Array(4),oa=new Float32Array(4),wa=new Float32Array(4),Da=new Float32Array(4),La=new Float32Array(16),ba=new Float32Array(24),la=new Float32Array(6);a.xI=function(c,h){var k=h.k,m=c.data;switch(m.type){case "PERSP":var n=
v(a.od);if(m.angle_y)var p=Y.rad_to_deg(m.angle_y);y(n,p,m.clip_start,m.clip_end);break;case "ORTHO":n=v(a.Ud),y(n,m.ortho_scale/2,m.clip_start,m.clip_end)}n.name=h.name;p=h.G;p[0].W.push(n);for(var ba=1;ba<p.length;ba++){var t=f(n,!1);p[ba].W.push(t)}k.hb=r(m.b4w_move_style);k.dof_distance=m.dof_distance;n=m.dof_object;k.Dc=n?n.Ka:null;k.dof_front_start=m.b4w_dof_front_start;k.dof_front_end=m.b4w_dof_front_end;k.dof_rear_start=m.b4w_dof_rear_start;k.dof_rear_end=m.b4w_dof_rear_end;k.dof_power=m.b4w_dof_power;
k.Xc=m.b4w_dof_bokeh;k.gb=m.b4w_dof_bokeh_intensity;k.fd=m.b4w_dof_foreground_blur;k.Fj=m.b4w_trans_velocity;k.Ej=m.b4w_rot_velocity;k.Gj=m.b4w_zoom_velocity;n=h.k.hb;p=c.data;ba=null;n!=a.MS_TARGET_CONTROLS&&n!=a.MS_EYE_CONTROLS||!p.b4w_use_horizontal_clamping||(ba={left:p.b4w_rotation_left_limit,right:p.b4w_rotation_right_limit,camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},n==a.MS_EYE_CONTROLS&&(ba.left*=-1,ba.right*=-1));n=ba;p=h.k.hb;ba=c.data;t=null;p!=a.MS_TARGET_CONTROLS&&p!=a.MS_EYE_CONTROLS||
!ba.b4w_use_vertical_clamping?p==a.MS_HOVER_CONTROLS&&ba.b4w_use_zooming&&(ba.b4w_hover_angle_min<=ba.b4w_hover_angle_max?(t={down:ba.b4w_hover_angle_min,up:ba.b4w_hover_angle_max},t.down*=-1,t.up*=-1):da.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(t={down:ba.b4w_rotation_down_limit,up:ba.b4w_rotation_up_limit,camera_space:"LOCAL"==ba.b4w_vertical_clamping_type},p==a.MS_TARGET_CONTROLS&&(t.down*=-1,t.up*=-1));var p=t,ba=h.k.hb,t=c.data,la=null;ba==a.MS_TARGET_CONTROLS&&
t.b4w_use_target_distance_limits&&t.b4w_distance_min<=t.b4w_distance_max?la={min:t.b4w_distance_min,max:t.b4w_distance_max}:ba===a.MS_HOVER_CONTROLS&&t.b4w_use_zooming&&(t.b4w_distance_min<=t.b4w_distance_max?la={min:t.b4w_distance_min,max:t.b4w_distance_max}:da.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));ba=la;t=c.data;la=null;h.k.hb==a.MS_HOVER_CONTROLS&&t.b4w_use_horizontal_clamping&&t.b4w_horizontal_translation_min<=t.b4w_horizontal_translation_max&&(la={min:t.b4w_horizontal_translation_min,
max:t.b4w_horizontal_translation_max});var t=la,la=c.data,u=null;h.k.hb==a.MS_HOVER_CONTROLS&&la.b4w_use_vertical_clamping&&la.b4w_vertical_translation_min<=la.b4w_vertical_translation_max&&(u={min:la.b4w_vertical_translation_min,max:la.b4w_vertical_translation_max});var la=u,u=c.data,w=null;h.k.hb==a.MS_TARGET_CONTROLS&&u.b4w_use_pivot_limits&&(w={min_z:u.b4w_pivot_z_min,max_z:u.b4w_pivot_z_max});u=w;switch(k.hb){case a.MS_EYE_CONTROLS:k=P.get_trans_view(h.k.n);e(h,k,null,n,p);break;case a.MS_TARGET_CONTROLS:k=
P.get_trans_view(h.k.n);d(h,k,m.b4w_target,n,p,ba,u,m.b4w_use_panning);break;case a.MS_HOVER_CONTROLS:k=P.get_trans_view(h.k.n),n=g(h,c.data.b4w_hover_zero_level,Ca),b(h,k,n,ba,p,t,la,m.b4w_enable_hover_hor_rotation)}L(h);l(h)};a.jD=e;a.lD=d;a.kD=b;a.im=l;a.qc=f;a.rJ=n;a.nT=r;a.Oc=v;a.WR=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.bc);case "DEPTH":return Boolean(a.ue);case "SCREEN":return!Boolean(a.bc)&&!Boolean(a.ue);default:Y.r("Wrong attachment type: "+b)}};a.$s=function(a,
b,c){switch(b){case "COLOR":case "CUBEMAP":a.bc=c;break;case "DEPTH":a.ue=c;break;case "SCREEN":a.bc=null;a.ue=null;break;default:Y.r("Wrong attachment type: "+b)}};a.ES=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.bc;case "DEPTH":return a.ue;case "SCREEN":return null;default:Y.r("Wrong attachment type: "+b)}};a.ps=function(b,d){(b.type!=a.od||d!=a.Ac&&d!=a.Kc&&d!=a.ne&&d!=a.oe)&&Y.r("make_stereo(): wrong camera type");b.type=d;c(b,6,.065)};a.aP=c;a.get_camera_angles=m;a.Av=p;a.get_camera_angles_char=
function(a,b){m(a,b);b[0]=Y.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.at=y;a.OO=function(b,c,d,e,f,h,k){switch(b.type){case a.rh:b.left=c;b.right=d;b.bottom=e;b.top=f;b.near=h;b.far=k;break;default:da.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.k.hb};a.fP=E;a.zT=u;a.ox=function(a,b,c){var d=ya;d[0]=0;d[1]=0;d[2]=-1;na.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=Ca;e[0]=0;e[1]=1;e[2]=0;na.transformQuat(e,c,e);
u(a,b,d,e)};a.set_look_at=z;a.VO=x;a.mQ=I;a.lQ=function(b){var d=b.k;L(b);M(b);switch(d.hb){case a.MS_TARGET_CONTROLS:var e=P.get_trans_view(d.n),f=P.get_quat_view(d.n);ca.wO(e,f,d.pivot);for(f=0;f<b.G.length;f++)for(var h=b.G[f].W,k=0;k<h.length;k++){var g=h[k];g.type!=a.Ac&&g.type!=a.Kc||c(g,na.dist(e,d.pivot),g.De)}ca.correct_up(b,d.Ie);break;case a.MS_EYE_CONTROLS:b.Tb||ca.correct_up(b,d.Ie)}B(b)};a.cy=B;a.eD=A;a.hD=J;a.hover_set_vertical_limits=t;a.hover_set_distance_limits=C;a.KO=k;a.YO=F;a.PO=
D;a.eP=aa;a.wQ=M;a.rotate_eye_camera=T;a.rotate_target_camera=N;a.rotate_hover_camera=U;a.aT=function(b){switch(b.type){case a.od:case a.Ud:case a.Ac:case a.Kc:return!0;default:return!1}};a.YA=function(b){switch(b.type){case a.od:case a.Ag:case a.Ac:case a.Kc:return Y.deg_to_rad(b.xd);default:return da.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.rj=fa;a.FO=function(b,c,d,e,f){var h=1/Math.max(f,e);switch(b.type){case a.od:case a.Ag:f/=2;e/=2;d=-(d-f)/f*Math.tan(Y.deg_to_rad(b.xd)/
2);c=(c-e)/e*Math.tan(Y.deg_to_rad(b.xd)/2)*b.pb;e=b.near*(d+h);f=b.near*(c+h);d=b.near*(d-h);c=b.near*(c-h);ka.frustum(c,f,d,e,b.near,b.far,b.lb);break;case a.Ud:case a.zg:b.right=b.top*b.pb;d=-d/f;c/=e;e=b.top+(d+h)*(b.top+b.top);f=-b.right+(c+h)*(b.right+b.right);d=b.top+(d-h)*(b.top+b.top);c=-b.right+(c-h)*(b.right+b.right);ka.ortho(c,f,d,e,b.near,b.far,b.lb);break;case a.rh:d=-d/f,c/=e,e=b.top+(d+h)*(b.top-b.bottom),f=b.left+(c+h)*(b.right-b.left),d=b.top+(d-h)*(b.top-b.bottom),c=b.left+(c-h)*
(b.right-b.left),ka.ortho(c,f,d,e,b.near,b.far,b.lb)}ka.copy(b.Ab,b.Rc);ka.multiply(b.lb,b.Rc,b.Rc);Y.Vl(b.Rc,b.Og)};a.Bu=W;a.Ez=R;a.SK=ha;a.OH=function(a){a=a.k;var b=ua.Wc();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.K=b;var c=ua.Rq(1,Y.f32([0,0,0]));a.da=c;a.Ln=ua.jz(1,b);a.Nn=ua.lz(1,b);a.Mn=ua.kz(1,b)};a.is_static_camera=function(b){return Ea.is_camera(b)&&b.k&&b.k.hb==a.MS_STATIC};a.is_target_camera=function(b){return Ea.is_camera(b)&&b.k&&b.k.hb==a.MS_TARGET_CONTROLS};
a.is_eye_camera=function(b){return Ea.is_camera(b)&&b.k&&b.k.hb==a.MS_EYE_CONTROLS};a.is_hover_camera=H;a.is_ortho_camera=function(b){return Ea.is_camera(b)&&b.k&&b.G[0].W[0].type==a.Ud};a.by=ma;a.nK=V;a.project_point=function(b,c,d){b=b.G[0].W[0];switch(b.type){case a.od:case a.Ag:case a.Ud:case a.zg:case a.Ac:case a.Kc:case a.ne:case a.oe:var e=wa;e.set(c);e[3]=1;ea.transformMat4(e,b.Rc,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;X.XQ(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/
Math.abs(e[3])+1)/2);return d;default:return da.error("Non-compatible camera"),d}};a.NL=function(a){return a.G[0].W[0]};a.cm=function(b,c){switch(b.type){case a.od:case a.Ag:case a.Ac:case a.Kc:var d=Math.tan(Y.deg_to_rad(b.xd)/2);switch(c){case "LEFT":return-d*b.pb;case "RIGHT":return d*b.pb;case "TOP":return d;case "BOTTOM":return-d}break;case a.Ud:case a.zg:switch(c){case "LEFT":return-b.top*b.pb;case "RIGHT":return b.top*b.pb;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.rh:switch(c){case "LEFT":return b.left;
case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.ne:case a.oe:switch(c){case "LEFT":return Math.tan(Y.deg_to_rad(b.Id[3]));case "RIGHT":return Math.tan(Y.deg_to_rad(b.Id[1]));case "TOP":return Math.tan(Y.deg_to_rad(b.Id[0]));case "BOTTOM":return Math.tan(Y.deg_to_rad(b.Id[2]))}break;default:Y.r("Unknown camera type")}};a.EM=function(b){switch(b.type){case a.Ud:case a.zg:case a.rh:return!0;default:return!1}};a.get_fov=function(b,c){switch(b.type){case a.od:case a.Ag:case a.Ac:case a.Kc:var d=
Y.deg_to_rad(b.xd);return c?d*b.pb:d;default:return 0}};a.set_trans_pivot=function(a,b,c){a=a.k;P.set_trans(b,a.n);na.copy(c,a.pivot)};a.set_hover_pivot=function(a,b){var c=a.k,d=na.subtract(b,c.Hb,ya),e=P.get_trans_view(c.n),d=na.add(d,e,d);va.set_translation(a,d);na.copy(b,c.Hb)};a.bP=function(a,b){var c=a.k,d=na.subtract(b,c.pivot,ya),e=P.get_trans_view(c.n),d=na.add(d,e,d);va.set_translation(a,d);na.copy(b,c.pivot)};a.get_eye=pa;a.set_move_style=function(c,d){c.k.hb=d;c.k.Ya=null;c.k.fa=null;
c.k.fb=null;c.k.jc=null;c.k.kc=null;l(c);switch(d){case a.MS_HOVER_CONTROLS:var e=P.get_trans_view(c.k.n),f=g(c,0,Ca);b(c,e,f,null,null,null,null,c.k.Lg);break;case a.MS_TARGET_CONTROLS:e=pa(c,ya),f=P.get_quat_view(c.k.n),f=Y.quat_to_dir(f,Y.AXIS_MZ,Ca),f=na.scaleAndAdd(e,f,10,f),na.copy(f,c.k.pivot)}};a.kq=function(a){a=a.k;a.hb=0;na.set(0,0,0,a.pivot);na.set(0,0,0,a.Hb);a.xj=!1;a.use_panning=!1;a.Ya=null;a.fa=null;a.fb=null;a.jc=null;a.kc=null;a.Cd=null;a.Lg=!0};a.set_eye_distance=function(a,b){for(var d=
0;d<a.length;d++){var e=a[d];70!=e.type&&80!=e.type&&90!=e.type&&100!=e.type||c(e,e.uj,b)}};a.set_hmd_fov=function(a,b,c){var d=Ba.get_active();a=Ea.ea(a,d).W;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||100==e.type)90==e.type&&ea.copy(b,e.Id),100==e.type&&ea.copy(c,e.Id),e.Xb||fa(e),R(e),W(e)}}};b4w.module.__lights=function(a,q){function e(a){g.scale(a.color,a.Ve,a.ho)}q("__print");var d=q("__tsr"),b=q("__util"),g=q("__vec3"),l=new Float32Array(3);new Float32Array(3);a.KM=function(a,f){var n=a.data,r=f.$a={name:"",type:n.type,DC:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),ho:new Float32Array(3),sA:0,hy:!1,fl:0,Qp:0,Zn:.1,Yn:30,WA:!1,kC:!1,AA:!1,ll:!0,nl:!0,Ve:1,distance:25,sS:"INVERSE_SQUARE"};r.name=f.name;r.ll=n.use_diffuse;r.nl=n.use_specular;var v=d.get_quat_view(f.k.n),
v=b.quat_to_dir(v,b.AXIS_Z,l);g.normalize(v,v);r.direction.set(v);r.color[0]=n.color[0];r.color[1]=n.color[1];r.color[2]=n.color[2];r.Ve=r.sA=n.energy;e(r);r.distance=n.distance;r.hy=n.use_sphere;r.Zn=n.clip_start;r.Yn=n.clip_end;if("POINT"===r.type||"SPOT"===r.type)r.distance=n.distance;"SPOT"===r.type?(r.Qp=n.spot_blend,r.fl=n.spot_size):"POINT"===r.type&&(r.fl=Math.PI/2);r.WA=n.b4w_generate_shadows;r.AA=n.b4w_dynamic_intensity};a.set_light_color=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=
b[2];e(a)};a.SO=function(a,b){a.Qp=b};a.RO=function(a,b){a.distance=b};a.TO=function(a,b){a.fl=b};a.set_light_energy=function(a,b){a.Ve=b;e(a)};a.rQ=function(a){var e=a.$a;if(e){a=d.get_quat_view(a.k.n);b.quat_to_dir(a,b.AXIS_Z,e.direction);g.normalize(e.direction,e.direction);if("SUN"==e.type){a=Math.acos(g.dot(e.DC,b.hu));var l=Math.acos(g.dot(e.direction,b.hu));e.kC=Math.floor(a/.025)!=Math.floor(l/.025)?!0:!1}g.copy(e.direction,e.DC)}}};b4w.module.__scenes=function(a,q){function e(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.pf||!c.pf.length)return c}return null}function d(){xb||Ja.r("No active scene available");return xb}function b(a,b,c){if(!Ga.kr||!g(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>mb.mc?(d.csm_resolution=mb.mc,xa.error("Shadow map texture has unsupported size. Changed to "+mb.mc+".")):d.csm_resolution=c.csm_resolution;Ga.fI=c.blur_samples;d.qP=c.soft_shadows;a=ba.Er(b,Ga.ssao&&a.b4w_enable_ssao);
d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;d.eg=[];d.ED=[];d.Zn=[];d.Yn=[];for(b=0;b<a.length;b++)d.eg.push(a[b].$a.type),d.ED.push(a[b].$a.fl),d.Zn.push(a[b].$a.Zn),d.Yn.push(a[b].$a.Yn),"SPOT"!=d.eg[b]&&"POINT"!=d.eg[b]||!d.enable_csm||(xa.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=
c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,
d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function g(a,b,c){if(0!=b.length&&Ga.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,e=!1;a=Ga.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=c[b];f.b4w_shadow_cast&&(d=!0);f.b4w_shadow_receive&&(e=!0);if((a||d)&&e)return!0}return!1}function l(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].$a.type)return!0;return!1}function w(a){if(!Ga.shore_smoothing)return!1;
a=pa(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function f(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(ba.Pz(a[b],c[d].settings))return!0;return!1}function n(a){for(var b=pa(a),c=[],d=0;d<b.length;d++){var e=b[d];if(e.b4w_water){for(var f={},h=0;h<a.length;h++)for(var k=a[h],g=k.data.materials,m=0;m<g.length;m++)g[m]==e&&(f.Jj=k.location[2]);f.Yd=e.b4w_water_fog_color.slice(0);f.Yd.push(e.b4w_water_fog_density);
e.b4w_water_dynamic?(f.zo=!0,f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,
f.dst_min_fac=e.b4w_water_dst_min_fac,f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.zo=!1,f.waves_height=0,f.waves_length=0);f.Sf=e.b4w_water_enable_caust;f.zI=e.b4w_water_caust_scale;f.yI=e.b4w_water_caust_brightness;f.AI=new Float32Array([.3,.7]);f.sj=null;e=e.texture_slots;for(h=0;h<e.length;h++)k=e[h].texture,!0===k.b4w_shore_dist_map&&"FILE"==k.image.source&&(f.sj=k.image,f.tx=k.image.size[0],f.nw=k.b4w_max_shore_dist,k=k.b4w_shore_boundings,f.Nm=[(k[0]+k[1])/2,(k[2]+k[3])/2],f.Om=[k[0]-k[1],
k[2]-k[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.zo)for(d=0;d<c.length;d++)c[d].zo&&(f=c[d]);return f}return null}function r(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=pa(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.refractions=!0);e.node_tree&&b(e.node_tree)}return c}function v(a,b,c){if(Ga.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var d=0,e=!1,f=0;f<b.length;f++){var h=b[f];h.k.Pc&&"CUBE"==h.k.hf&&d++;if(h.Bp.length){for(var k=null,g=0;g<a.length;g++)if(a[g]==h){k=g;break}null==k&&a.push(h)}}for(f=0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(h=0;h<b.length;h++)if(k=b[h].game_settings.alpha_blend,"OPAQUE"!=k&&"CLIP"!=k){b=!0;break a}b=!1}else b=void 0;b&&(e=!0)}return{NC:a,oC:d,Bh:[],$u:[],Xg:[],Ns:[],uB:e}}function c(a,b){var c=a.b4w_sky_settings,d={};d.OC=c.render_sky||c.procedural_skydome;
d.procedural_skydome=c.procedural_skydome;d.use_as_environment_lighting=c.use_as_environment_lighting;d.Qm=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.$c=c.reflexible;d.Qc=c.reflexible_only;
!b&&c.procedural_skydome&&xa.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return d}function m(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.oM=a.hemisphere;b.eI=a.blur_depth;b.uz=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.zO=a.samples;return b}function p(a){if(!(Ga.bloom&&a.b4w_enable_bloom&&a.q.ei))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}
function y(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function E(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function u(a){var b={};a=a.b4w_god_rays_settings;b.Vv=a.intensity;b.rm=a.max_ray_length;b.Zm=a.steps_per_pass;return b}function z(a){var b={};b.Vh=a.b4w_outline_color;b.kp=a.b4w_outline_factor;return b}
function x(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function I(a,b){var c=a.light_settings,d={};d.$f=c.environment_energy;d.bq=c.use_environment_light;d.nv=c.environment_color;d.Jd=a.horizon_color.slice(0);d.Rd=a.zenith_color.slice(0);d.fq=a.use_sky_paper;d.dq=a.use_sky_blend;d.gq=a.use_sky_real;d.wx=null;
d.Rm=null;d.ov=null;c=!0;if(d.bq&&"SKY_TEXTURE"==d.nv&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var e=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&!a.texture_slots[f].texture.b4w_use_as_skydome){e=a.texture_slots[f];break}e?d.ov=e:c=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){c=!0;e=a.texture_slots[f];d.wx=e;f=Math.min(mb.Mh,Sa.sI(e.texture.image.size[0]/3));d.Rm={OP:f,rz:e.blend_factor,
xB:e.horizon_factor,VE:e.zenith_up_factor,UE:e.zenith_down_factor,color:e.color,wa:e.default_value,invert:e.invert,BE:e.use_rgb_to_intensity,sz:e.blend_type,wE:e.use_map_blend,xE:e.use_map_horizon,zE:e.use_map_zenith_up,yE:e.use_map_zenith_down};break}d.bq=d.bq?c:!1;return d}function B(a){var b=a.fog_settings,c={};c.NQ=b.use_fog;c.Vv=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.VK=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.Yd=new Float32Array([a[0],
a[1],a[2],1/c.depth]);c.tf=new Float32Array([c.Vv,c.depth,c.start,c.height]);return c}function G(a,b){if(!Ga.rc)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,d=!1,e=0;e<b.length;e++){for(var f=b[e],h=f.data.materials,k=0;k<h.length;k++)h[k].b4w_terrain&&(c=!0);f=f.particle_systems;for(k=0;k<f.length;k++)h=f[k].settings,"HAIR"==h.type&&h.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function A(a,b){if(dc.outlining_overview_mode)return!0;if(Ga.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Ka.k.ah)return!0;return!1}else return!1}function J(a,b){if(dc.outlining_overview_mode)return!0;if(Ga.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Ka.k.nc)return!0;return!1}else return!1}function t(a,b){if(Ga.Ih)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,
e=0;e<d.length;e++)if(Da.Oz(d[e]))return!0;return!1}else return!1}function h(a,b){if(Ga.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function C(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var e=c[d],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function k(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;
case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].Ka;if(d.anchor&&d.anchor.Ql)return!0}return!1}}function F(a,b,c){var d=sa.hg(a,b);sa.ih(a,d,function(a,b,d){if(d.pc){switch(d.from){case "COLOR":case "CUBEMAP":var e=b.p.bc;break;case "DEPTH":e=b.p.ue;break;case "SCREEN":e=null;break;case Q.Sc:return;default:Ja.r("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:e||Ja.r("Connection of SCREEN is forbidden"),e.le&&Ja.r("Batch texture can't use renderbuffer"),ra.Sz(c.nb,d.to)&&ea.Dl(c,e,d.to)}}});for(a=0;a<b.Qa.length;a++){var d=b.Qa[a],e=b.gh[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:e.le&&Ja.r("Batch texture can't use renderbuffer"),ra.Sz(c.nb,d.to)&&ea.Dl(c,e,d.to)}}}function D(a){if(a&&a.q&&a.q.Ma){var b=ga.Pb(a.q.Ma,Q.Of);b&&ia(a,b)}}function aa(a,
b,c,d,e,f){for(var h=b.k,k=ba.ea(b,e).T,g=0;g<k.length;g++){var m=k[g];if(!(m.kd||m.Qc||"MAIN"!=m.type&&"NODES_GLOW"!=m.type&&"PARTICLES"!=m.type&&"LINE"!=m.type)&&("OPAQUE"==m.ub&&"OPAQUE"==d||"BLEND"==m.ub&&"BLEND"==d||"XRAY"==m.ub&&"XRAY"==d||"NODES_GLOW"==m.type&&"GLOW"==d)){if(!f&&(M(m,a,b,c,d,e),!ea.oc(m)))if("DEBUG"===Ma.type())ea.Iq(m,"error.glslv","error.glslf"),ea.oc(m);else continue;var l=Q.Qg(m,h);Q.Cc(a,l);F(c,a,m);L(m)}}}function M(a,b,c,d,e,f){var h=c.k,k=f.q,g=ba.ea(c,f),m="NO_SHADOWS";
c=ca(f,[Q.Jc]);if(c.length&&a.cd){switch(e){case "OPAQUE":m="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":m="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":m="NO_SHADOWS";break;case "SHADOW":m="SHADOW_MASK_GENERATION";break;default:Ja.r("Wrong subscene type")}for(var l=0;l<c.length;l++)ea.cz(a,f.q.bd)}l="NO_SOFT_SHADOWS";if(k.bd&&k.bd.qP)switch(Ga.fI){case "16x":l="POISSON_X_16";break;case "8x":l="POISSON_X_8";break;case "4x":l="POISSON_X_4"}c=a.tb;ra.aa(c,"SHADOW_USAGE",
m);ra.aa(c,"POISSON_DISK_NUM",l);a.rc&&(l=ga.Pb(d,Q.qh))&&T(a,l,h);l=b.p;l.type==ja.Ud||l.type==ja.zg||l.type==ja.rh?ra.aa(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):ra.aa(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.Oi){e=b.Cs;ra.aa(c,"NUM_LIGHTS",e);ra.aa(c,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1);ra.aa(c,"REFLECTION_PASS","REFL_PASS_NONE");ra.aa(c,"SSAO_ONLY",0);if(e=k.xc)ra.aa(c,"WATER_EFFECTS",1),ra.aa(c,"WAVES_HEIGHT",ra.F(e.waves_height)),ra.aa(c,"WAVES_LENGTH",ra.F(e.waves_length)),
ra.aa(c,"WATER_LEVEL",ra.F(e.Jj));if(b.Sf&&h.Sf){ra.aa(c,"CAUSTICS",1);if(h=k.bd){h=h.eg;for(l=m=0;l<h.length;l++)"SUN"==h[l]&&(m=l);ra.aa(c,"SUN_NUM",m)}ra.aa(c,"CAUST_SCALE",ra.F(b.Iz));ra.aa(c,"CAUST_SPEED",ra.F(b.Jz,2));ra.aa(c,"CAUST_BRIGHT",ra.F(b.Hz))}b=g.Bh;g=g.Xg;if(-1!==a.dd.indexOf("u_mirrormap"))ra.aa(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.Pc&&b)b=b.p.bc,ea.Dl(a,b,"u_cube_reflection"),ra.aa(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.Pc&&g)for(l=0;l<g.length;l++)b=g[l].p.bc,ea.Dl(a,
b,"u_plane_reflection"),ra.aa(c,"REFLECTION_TYPE","REFL_PLANE");else ra.aa(c,"REFLECTION_TYPE","REFL_NONE");(g=ga.Pb(d,Q.Of))?a.lr?(b=g.p.bc,ea.Dl(a,b,"u_sky")):g.procedural_skydome&&(a.Xd=g.Xd,ra.aa(c,"PROCEDURAL_FOG",1)):ra.aa(c,"PROCEDURAL_FOG",0);h=k.sn;h.bq&&(ra.aa(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==h.nv?(b=null,h.ov?b=Sa.Yc(h.ov,!1):g&&(b=g.p.bc),ra.aa(c,"SKY_TEXTURE",1),ea.Dl(a,b,"u_sky_texture")):"SKY_COLOR"==h.nv&&ra.aa(c,"SKY_COLOR",1));b=k.TE;b.NQ&&(ra.aa(c,"USE_FOG",1),ra.aa(c,
"FOG_TYPE",b.VK));a.mj&&a.yb?(Ga.kr&&ra.aa(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.Oi||"NODES_GLOW"==a.type?(ra.aa(c,"REFRACTIVE",1),k.refractions?ra.aa(c,"USE_REFRACTION",1):ra.aa(c,"USE_REFRACTION",0)):k.refractions?ra.aa(c,"REFRACTIVE",1):ra.aa(c,"REFRACTIVE",0),(k.bC.refractions||k.refractions)&&ra.aa(c,"HAS_REFRACT_TEXTURE",1)):(ra.aa(c,"REFRACTIVE",0),ra.aa(c,"USE_REFRACTION",0),ra.aa(c,"USE_REFRACTION_CORRECTION",0));a.mh&&(Ga.shore_smoothing&&a.qn&&ga.Pb(d,Q.xy)?ra.aa(c,"SHORE_SMOOTHING",
1):ra.aa(c,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?ra.aa(c,"DYNAMIC",1):ra.aa(c,"DYNAMIC",0));"PARTICLES"==a.type&&(ra.aa(c,"SIZE_RAMP_LENGTH",a.Va.FT),ra.aa(c,"COLOR_RAMP_LENGTH",a.Va.$z));if(!a.uf)for(a=a.X,d=0;d<a.length;d++)if(b=a[d],"SCENE"==b.source)for(k=0;k<Oa.length;k++)for(c=Oa[k],g=Oa[k].pf,e=0;e<g.length;e++)g[e].q==b&&sa.s(Wb,c,f,null)}}function L(a){8<a.X.length&&xa.warn(a.type,"too many textures used - "+a.X.length+' (max 8), materials "'+a.lc.join(", ")+'"')}function T(a,
b,c){a.Hd=b.Hd;var d=b.Hd[0],e=b.Hd[1],f=b.Hd[2];c=c.K;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.Hd[2]=f;b=b.p;ja.at(b,f/2,-e,-d,f/2);ja.rj(b);d=a.Po||0;d=0==d?c:Math.max(d,c);a.Po=d}function N(a,b,c,d,e,f){for(var h=b.k,k=ba.ea(b,e).T,g=0;g<k.length;g++){var m=k[g];if(("MAIN"==m.type||"PARTICLES"==m.type||"LINE"==m.type)&&"REFLECT"==m.ub&&m.yb==d){if(a.type==Q.nd||a.type==Q.Ne){var l;a:{var n=e.q.$g.Xg;for(l=0;l<n.length;l++)for(var p=0;p<n[l].length;p++)if(n[l][p]==a)break a;
n=e.q.$g.Ns;for(l=0;l<n.length;l++)for(p=0;p<n[l].length;p++)if(n[l][p]==a)break a;l=null}if(l==h.ce)continue}else if(l=na(e,a),l==h.te)continue;if(!f&&(M(m,a,b,c,"REFLECT",e),l=m.tb,ra.aa(l,"WATER_EFFECTS",0),a.type==Q.nd||a.type==Q.Ne?ra.aa(l,"REFLECTION_PASS","REFL_PASS_PLANE"):ra.aa(l,"REFLECTION_PASS","REFL_PASS_CUBE"),ra.aa(l,"TEXTURE_NORM",0),!ea.oc(m)))if("DEBUG"===Ma.type())ea.Iq(m,"error.glslv","error.glslf"),ea.oc(m);else continue;m=Q.Qg(m,h);Q.Cc(a,m)}}}function U(a){V(a);var b=X(a,Q.Bb),
c=!0,d=a.q.bd;sa.la(a.q.Ma,function(e,f){f.type===Q.Jc&&(qa(f,a,b.p,d,c),c=!1)})}function O(a){sa.la(a.q.Ma,function(a,b){b.type===Q.xl&&(b.lv=1)})}function qa(a,b,c,d,e){if(0!=a.La.length){var f=a.p,h=Fa.Ub(c.n,uc);Fa.set_trans(h,f.n);Fa.copy(c.Je,f.Jp);if("SUN"===d.eg[a.rg]||"HEMI"===d.eg[a.rg]){h=vc;Aa.gR(h);for(var k=0;k<a.La.length;k++)for(var g=a.La[k].oa,m=0;m<g.length;m++){var l=g[m].Th;0==k&&0==m?Aa.Ei(l.ga,h):Aa.rr(h,l.ga)}h=Aa.FA(h,Ec);Ja.Hm(h,f.Ab,h);if(d.enable_csm){b=Ka.copy(c.Ig[a.Zu],
uc);d=wa.invert(c.Ab,ec);Ja.Hm(b,d,b);Ja.Hm(b,f.Ab,b);a=c.no[a.Zu];if(e)for(cc=0,$c=-Infinity,e=2;e<h.length;e+=3)cc=Math.min(cc,h[e]),$c=Math.max($c,h[e]);e=vc;e.max_x=b[0]+a;e.max_y=b[1]+a;e.max_z=$c;e.min_x=b[0]-a;e.min_y=b[1]-a;e.min_z=cc}else{c=e=vc;d=hd;d.set(h);h=gd/9;k=wa.identity(ec);wa.rotate(k,h,Ja.AXIS_MZ,k);m=g=-1;for(l=0;10>l;l++){var n=Aa.YH(d,Sc),p=(n.max_x-n.min_x)*(n.max_y-n.min_y);if(-1==g||p<g)g=p,m=l,Aa.Ei(n,c);Ja.Hm(d,k,d)}c=m*h;0<c&&(h=wa.identity(ec),wa.rotate(h,c,Ja.AXIS_MZ,
h),wa.multiply(h,f.Ab,f.Ab),Fa.from_mat4(f.Ab,f.Je));c=e.max_x-e.min_x;h=e.max_y-e.min_y;c&&h&&(d=Math.abs(c-h)/2,2<c/h?(e.max_y+=d,e.min_y-=d):2<h/c&&(e.max_x+=d,e.min_x-=d));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;fa(a,b.q.Ma)}ja.OO(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);ja.rj(f);Ja.Vl(f.Rc,f.Og)}else"SPOT"!==d.eg[a.rg]&&"POINT"!==d.eg[a.rg]||ja.rj(f,f.pb)}}function fa(a,b){for(var c=a.p,d=ga.bM(b,a),e=0;e<d.length;e++){var f=d[e];if(f.type==
Q.Bb||f.type==Q.Oe||f.type==Q.zc||f.type==Q.of)if(Ga.os)f.iy.set(c.Je,9*a.rg);else{var h=Fa.get_trans_view(c.Je),k=Fa.get_scale(c.Je),g=Fa.get_quat_view(c.Je);sb.set(h[0],h[1],h[2],k,fb);f.Bt.set(fb,4*a.rg);f.At.set(g,4*a.rg)}}}function W(a,b,c,d,e){for(var f=b.k,h=ba.ea(b,d).T,k=0;k<h.length;k++){var g=h[k];if("COLOR_ID"==g.type&&(a.type==Q.Le&&"COLOR_ID"==g.ub||a.type==Q.ph&&"COLOR_ID_XRAY"==g.ub)){if(!e&&(M(g,a,b,c,"COLOR_ID",d),ea.ab(g,"USE_OUTLINE",0),!ea.oc(g)))continue;g=Q.Qg(g,f);Q.Cc(a,g)}}}
function R(a,b,c,d,e){if(!d&&(e.rc&&(d=ga.Pb(c,Q.qh))&&T(e,d,b),!ea.oc(e)))if("DEBUG"===Ma.type())ea.Iq(e,"error.glslv","error.glslf"),ea.oc(e);else return;b=Q.Qg(e,b);Q.Cc(a,b);F(c,a,e);L(e)}function ha(a,b){H(a,b);for(var c=0;c<a.se.length;c++)a.se[c].parent==a&&ha(a.se[c],b)}function H(a,b){a.k.hide=b;if(ba.is_lamp(a))for(var c=0;c<a.G.length;c++)for(var d=a.G[c],e=ca(d.mb,Ra),f=0;f<e.length;f++){var h=e[f],k=a.k,g=a.$a,m=d.Nk,l=g.ll&&!k.hide?1:0;h.cp[4*m+3]=l;l=g.nl&&!k.hide?1:0;h.bp[4*m+3]=l;
h.ra=!0}}function ma(a,b){for(var c=ca(b,Ra),d=a.$a,e=a.k,f=ba.ea(a,b),h=Fa.get_trans_view(e.n),e=Fa.get_quat_view(e.n),k=0;k<c.length;k++){var g=c[k],m=g,l=a.k,n=a.$a,p=f.Nk,t=Fa.get_trans_view(a.k.n),la=n.ho;m.gw.set(n.direction,3*p);fb[0]=t[0];fb[1]=t[1];fb[2]=t[2];fb[3]=n.ll&&!l.hide?1:0;m.cp.set(fb,4*p);fb[0]=la[0];fb[1]=la[1];fb[2]=la[2];fb[3]=n.nl&&!l.hide?1:0;m.bp.set(fb,4*p);m.ra=!0;switch(d.type){case "SUN":g.SD.set(e);g.RD=d.ho;g.type===Q.Of?(g.xs=d.kC,Ka.copy(d.direction,g.Gx),ia(b,g)):
Ka.copy(d.direction,g.Gx);break;case "HEMI":case "POINT":case "SPOT":break;default:xa.error("Unknown light type: "+d.type+'".')}g=g.La;for(m=0;m<g.length;m++)for(l=g[m].oa,n=0;n<l.length;n++)p=l[n].qa,p.Mk&&ea.QO(p,a)}c=X(b,Q.Bb).p;f=f.rx;d=b.q.bd;for(k=0;k<f.length;k++)g=f[k],ja.ox(g.p,h,e),qa(g,b,c,d,!0),fa(g,b.q.Ma)}function V(a){var b=La.Gb(a,"LAMP",La.DATA_ID_ALL),b=ba.Er(b,Ga.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],e=d.k,f=Fa.Ub(e.n,uc),e=Fa.zd(e.n,Cb),
h=0;h<d.G.length;h++){var k=d.G[h],g=k.rx;if(k.mb==a)for(k=0;k<g.length;k++)ja.ox(g[k].p,f,e)}}function ia(a,b){Z.Ps(b);Qa.Tl(b);if(b.xs)for(var c=ca(a,Wa),d=0;d<c.length;d++)for(var e=c[d].La,f=0;f<e.length;f++)for(var h=e[f].oa,k=0;k<h.length;k++){var g=h[k];g.Lb&&(g=g.qa,ea.DI(g)&&Qa.hQ(g))}}function pa(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,e=0;e<d.materials.length;e++){var f=d.materials[e];-1==b.indexOf(f)&&b.push(f)}return b}function ua(a,b,c){for(var d=a.q,e=ba.ea(a.ri,a).W,
f=0;f<e.length;f++){var h=e[f];ja.rj(h,b/c);d.bd&&ja.by(h,d.bd)}d.bd&&(d.ys=!0,X(a,Q.Oe).ra=!0,X(a,Q.zc).ra=!0);var k=d.Ma;ga.XP(k,function(d,e,f){if(d.Wp){var h=d.cl*b,g=d.el*c;if(e)for(e=0;e<f.Qa.length;e++)f.Qa[e]==d&&Sa.resize(d.Xa,h,g);else switch(Sa.mm(d.Xa)&&Sa.resize(d.Xa,h,g),d=f.p,d.width=h,d.height=g,f.type){case Q.vn:ka(a,{dof_power:f.p.dof_power});break;case Q.wn:Ea(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case Q.tn:Ha(a,{bloom_blur:f.El});
break;case Q.xl:f=ga.rb(k,f,Q.Ob);h=ga.rb(k,f,Q.Ob);g=ga.rb(k,h,Q.Ob);d=ga.rb(k,g,Q.Ob);ga.jd(f,1/b,1/c);ga.jd(h,1/b,1/c);ga.jd(g,1/b,1/c);ga.jd(d,1/b,1/c);break;default:ga.jd(f,1/b,1/c)}}})}function ca(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];sa.la(a.q.Ma,function(a,b){b.type==e&&c.push(b)})}return c}function X(a,b){return ga.Pb(a.q.Ma,b)}function ka(a,b){var c=X(a,Q.vn);if(!c)return xa.error("DOF is not enabled on the scene. Check camera settings"),0;var d=c.p.Xc,e=d?ca(a,[Q.St]):[],f=a.q.Ma;
if("boolean"==typeof b.dof_on&&(c.p.dof_on=b.dof_on,d))for(var h=0;h<e.length;h++)e[h].p.dof_on=b.dof_on;if("number"==typeof b.dof_distance&&(c.p.dof_distance=b.dof_distance,d))for(h=0;h<e.length;h++)e[h].p.dof_distance=b.dof_distance;if("number"==typeof b.dof_front_start&&(c.p.dof_front_start=b.dof_front_start,d))for(h=0;h<e.length;h++)e[h].p.dof_front_start=b.dof_front_start;if("number"==typeof b.dof_front_end&&(c.p.dof_front_end=b.dof_front_end,d))for(h=0;h<e.length;h++)e[h].p.dof_front_end=b.dof_front_end;
if("number"==typeof b.dof_rear_start&&(c.p.dof_rear_start=b.dof_rear_start,d))for(h=0;h<e.length;h++)e[h].p.dof_rear_start=b.dof_rear_start;if("number"==typeof b.dof_rear_end&&(c.p.dof_rear_end=b.dof_rear_end,d))for(h=0;h<e.length;h++)e[h].p.dof_rear_end=b.dof_rear_end;"number"==typeof b.gb&&(c.p.gb=b.gb,d&&(e=ga.Gv(f,c,Q.Ob),e[0].p.gb=b.gb,e[1].p.gb=b.gb,e[0]=ga.rb(f,e[0],Q.Ob),e[0].p.gb=b.gb));if("number"==typeof b.dof_power)if(d){d=b.dof_power;c.p.dof_power=d;var d=d/2,h=c.p.width,k=c.p.height,
g=[1/h,0],m=[1/h*.5,1/k*.866],l=[-1/h*.5,1/k*.866],e=ga.Gv(f,c,Q.Ob);ga.wc(e[0],d);ga.jd(e[0],l[0],l[1]);ga.wc(e[1],d);ga.jd(e[1],m[0],m[1]);e[0]=ga.rb(f,e[0],Q.Ob);ga.wc(e[0],d);ga.jd(e[0],g[0],g[1]);c.p.fd&&(e[0]=ga.rb(f,e[0],Q.St),e[0]=ga.rb(f,e[0],Q.Ob),ga.jd(e[0],1/h,1/k),e[0]=ga.rb(f,e[0],Q.Ob),ga.jd(e[0],1/h,1/k))}else c.p.dof_power=b.dof_power,e=ga.rb(f,c,Q.Ob),f=ga.rb(f,e,Q.Ob),ga.wc(e,c.p.dof_power),ga.jd(e,1/c.p.width,1/c.p.height),ga.wc(f,c.p.dof_power),ga.jd(f,1/c.p.width,1/c.p.height)}
function Ha(a,b){var c=X(a,Q.sq),d=X(a,Q.tn);if(!c||!d)return xa.error("Bloom is not enabled on the scene"),0;"number"==typeof b.key&&(c.Pq=b.key,c.ra=!0);"number"==typeof b.edge_lum&&(c.Oq=b.edge_lum,c.ra=!0);if("number"==typeof b.blur){var e=a.q.Ma,c=ga.rb(e,d,Q.un),e=ga.rb(e,c,Q.un);d.El=b.blur;ga.wc(c,b.blur);ga.jd(c,1/d.p.width,1/d.p.height);ga.wc(e,b.blur);ga.jd(e,1/d.p.width,1/d.p.height)}}function Ea(a,b){var c=X(a,Q.wn);if(!c)return xa.error("Glow is not enabled on the scene"),null;for(var d=
a.q.Ma,e=ga.YL(d,c),f=0;f<e.length;++f){var h=e[f];if(h.type==Q.Ob&&"GLOW_MASK_LARGE"==h.ub)var k=h;if(h.type==Q.Ob&&"GLOW_MASK_SMALL"==h.ub)var g=h}e=ga.rb(d,k,Q.Ob);d=ga.rb(d,g,Q.Ob);"number"==typeof b.small_glow_mask_coeff&&(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.ra=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.ra=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,ga.wc(g,b.small_glow_mask_width),
ga.jd(g,1/c.p.width,1/c.p.height),g.ra=!0,ga.wc(d,b.small_glow_mask_width),ga.jd(d,1/c.p.width,1/c.p.height),d.ra=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,ga.wc(k,b.large_glow_mask_width),ga.jd(k,1/c.p.width,1/c.p.height),k.ra=!0,ga.wc(e,b.large_glow_mask_width),ga.jd(e,1/c.p.width,1/c.p.height),e.ra=!0)}function da(a,b,c){var d=a.q,e=d.xc;if(!e.zo)return e.Jj;var f=e.waves_height,h=e.waves_length,k=e.Jj,g=Ka.length(d.mi)||1;a=X(a,Q.Bb).time;a*=
g;var m=Lc;m[0]=20/h*(b-.25*a);m[1]=20/h*(c-.25*a);g=Ja.Kz(m);m[0]=17/h*(c+.1*a);m[1]=17/h*(b+.1*a);var m=Ja.Kz(m),g=g+m-1,l=e.dst_noise_scale0,m=e.dst_noise_scale1,n=e.dst_noise_freq0,p=e.dst_noise_freq1,ba=Lc;ba[0]=l*(b+n*a);ba[1]=l*(c+n*a);l=Ja.xx(ba);ba[0]=m*(c-p*a);ba[1]=m*(b-p*a);m=Ja.xx(ba);m*=f*l;if(e.sj)if(p=(b-e.Nm[0])/e.Om[0],ba=(e.Nm[1]+c)/e.Om[1],p+=.5,ba+=.5,1<p||0>p||1<ba||0>ba)e=m;else{var d=Ja.ZA(d.sx,e.tx,p,ba),ba=e.dir_freq,t=e.dir_noise_scale,la=e.dir_noise_freq,l=e.dir_min_noise_fac,
p=e.dst_min_fac,n=h/e.nw/Math.PI;c=[t/h*(b+la*a),t/h*(c+la*a)];b=Math.sqrt(d);e=f*Math.max(d,e.dir_min_shore_fac)*Math.sin(b/n+ba*a)*Math.max(Ja.xx(c),l);f=Math.max(b,p);e=e*(1-f)+m*f;g*=d}else e=m;return k+(e+.05*g)}function K(a,b){a.Wo&&a.type==Q.Ob&&b.Lb!=a.Lb&&(a.Lb=b.Lb);b.Lb||a.type!=Q.xl||(a.lv=0)}function Ba(a,b,c,d){var e=sa.Pa(a,b);ja.$s(e.p,c,d);e.pu=!0;sa.yj(a,b,function(b,e,f){f.pc&&f.from==c&&ga.OI(f)&&za(a,b,f.to,d)});sa.ih(a,b,function(b,e,f){f.pc&&f.from==c&&f.from==f.to&&Ba(a,b,
c,d)})}function za(a,b,c,d){a=sa.Pa(a,b).La;for(b=0;b<a.length;b++)for(var e=a[b].oa,f=0;f<e.length;f++)ea.oO(e[f].qa,d,c)}function va(a){var b=X(a,Q.qh);if(b){var c=b.p,d=a.ri.k;a=Fa.Ub(d.n,uc);var e=pd;e[0]=0;e[1]=0;e[2]=-b.Hd[2]/2;b=Fa.zd(d.n,Cb);Ka.transformQuat(e,b,e);e[0]+=a[0];e[1]+=a[1];e[2]=0;Ia.identity(b);ja.ox(c,e,b)}}function P(a,b){sa.la(a,function(c,d){if(d.type==Q.yg){d.Qa[0]&&d.gh[0]||Ja.r("Wrong MOTION_BLUR subscene");var e=d.Qa[0],f=d.gh[0];d.gh[0]=d.p.bc;sa.yj(a,c,function(b,c,
d){d.pc&&za(a,b,d.to,f)});Ba(a,c,e.from,f);za(a,c,e.to,d.gh[0]);d.gC=Math.exp(-b/d.mb_factor)}})}function Y(a){return a.q.mi}function na(a,b){if(!a.q.$g)return null;for(var c=a.q.$g.Bh,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.q.$g.$u;for(d=0;d<c.length;d++)if(c[d]==b)return d;return null}var ea=q("__batch"),Aa=q("__boundings"),ja=q("__camera"),ta=q("__config"),ya=q("__container"),Ca=q("__debug"),sa=q("__graph"),S=q("__hud"),oa=q("__input"),wa=q("__mat4"),Da=q("__nodemat"),La=q("__objects"),ba=q("__obj_util"),
la=q("__physics"),Z=q("__prerender"),rb=q("__primitives"),xa=q("__print"),Ia=q("__quat"),Qa=q("__renderer"),ga=q("__scenegraph"),Nb=q("__sfx"),ra=q("__shaders"),Q=q("__subscene"),Sa=q("__textures"),Fa=q("__tsr"),Ja=q("__util"),Ka=q("__vec3"),sb=q("__vec4"),Ma=q("__version"),Ga=ta.A,mb=ta.zh,dc=ta.nc,Na=ta.Ep,lb=[Q.qh,Q.Jc,Q.Bb,Q.zc,Q.of,Q.Ed,Q.nd,Q.Sc,Q.Ne,Q.me,Q.Le,Q.ph,Q.Oe,Q.Nf,Q.Me];a.CR=lb;var Ra=[Q.Bb,Q.zc,Q.of,Q.Ed,Q.nd,Q.Sc,Q.oi,Q.rq,Q.Of,Q.Ne,Q.me,Q.sq,Q.Oe,Q.Jc,Q.Le,Q.ph,Q.Nf],Wa=[Q.Bb,
Q.wq,Q.zc,Q.of,Q.Ed,Q.nd,Q.Sc,Q.Ne,Q.me],cb=[Q.Jc,Q.Bb,Q.zc,Q.of,Q.Ed,Q.nd,Q.Sc,Q.Ne,Q.me,Q.Le,Q.ph,Q.Oe,Q.oi,Q.Nf,Q.Me],Vb=[Q.Bb,Q.zc,Q.of,Q.Ed,Q.nd,Q.Sc,Q.Ne,Q.me],tc=null,xb=null,Oa=[],Wb=null,gd=Math.PI/2,Lc=new Float32Array(2),uc=new Float32Array(3),pd=new Float32Array(3),Cb=new Float32Array(4),fb=new Float32Array(4),ec=new Float32Array(16),Ec=new Float32Array(24),hd=new Float32Array(24),vc=Aa.Wc(),Sc=Aa.Wc(),cc=0,$c=-Infinity;a.iS=function(){return{}};a.set_active=function(a){xb=a;Nb.EO(a)};
a.$N=function(a,b){var c=a.q,d=ga.DJ(c.Ma);if(a==b){ua(a,ya.pB(),ya.oB());for(var e=0;e<d.length;e++)a.q.Zk.push(d[e])}else for(e=a.pf[0],ua(a,e.q.$h,e.q.$h),e=0;e<d.length;e++)b.q.Zk.push(d[e]);d=ca(a,cb);for(e=0;e<d.length;e++)d[e].mi.set(c.mi);for(e=0;e<c.Zk.length;e++)c.Zk[e].type==Q.Jc&&Qa.Tl(c.Zk[e])};a.Ak=function(){tc||(tc=e(Oa));return tc};a.ur=e;a.get_active=d;a.va=function(){return xb?!0:!1};a.bm=function(a){return a.ri};a.Mo=function(){return Oa};a.Hv=function(){if(1==Oa.length)return Oa;
for(var a=0;a<Oa.length;a++){var b=Oa[a].q.Ma;sa.la(b,function(b,c){for(var d=c.La,e=0;e<d.length;e++)for(var f=d[e].oa,h=0;h<f.length;h++){for(var k=f[h],g=k.qa.X,m=null,l=0;l<g.length;l++)if("SCENE"==g[l].source&&g[l].Mp==Oa[a].name&&c.type!=Q.Ut){xa.error('Texture-scene loop detected. A scene is rendered to texture "'+g[l].name+'" yet this texture belongs to the same scene.');sa.hg(Wb,Oa[a]);m=k.qa;break}m&&(m.X=[],m.dd=[],ea.gQ(m,null),ea.oc(m),Q.Cc(c,k))}})}for(var c=[],a=0;a<Oa.length;a++)if(b=
Oa[a],!b.pf.length){b=sa.hg(Wb,b);sa.MK(Wb,b);b=sa.nt(Wb,b,sa.nq);b=sa.Rx(b);sa.la(b,function(a,b){c.push(b)});break}return c};a.tH=function(a,d,e,g,la){a.pf=a.pf||[];a.na=null;var Z=a.q,S=ba.ea(a.ri,a),q=a.ri.k;Z.on=[];var F=a.world;Z.LM=e.length;Z.ei=l(e);Z.gt=c(F,Z.ei);Z.sn=I(F,Z.gt);Z.TE=B(F);if(F=!a.pf.length)a:{if("HMD"==Ga.stereo){if(S.W[0].type!=ja.od){xa.warn("Head-mounted display stereo is disabled for the non-perspective camera");Ga.stereo="NONE";F=!1;break a}if(!oa.can_use_device(oa.DEVICE_HMD)){xa.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");
Ga.stereo="NONE";F=!1;break a}}F="HMD"==Ga.stereo}Z.Ro=F;if(F=!a.pf.length)S.W[0].type!=ja.od&&"ANAGLYPH"==Ga.stereo?(xa.warn("Anaglyph stereo is disabled for the non-perspective camera"),Ga.stereo="NONE",F=!1):F="ANAGLYPH"==Ga.stereo;Z.anaglyph_use=F;Z.jH=!Z.Ro&&!Z.anaglyph_use&&k(a,la);Z.$g=v(a,d,g);Z.dI=p(a);Z.tN=y(a);Z.BI=E(a);Z.iM=u(a);Z.IN=z(a);Z.Ni=x(a);Z.dof=Ga.dof&&(0<q.dof_distance||q.Dc);Z.motion_blur=Ga.motion_blur&&a.b4w_enable_motion_blur;Z.compositing=Ga.compositing&&a.b4w_enable_color_correction;
Z.antialiasing=Ga.antialiasing&&1==Ga.tc&&"NONE"!=a.b4w_antialiasing_quality;Z.ssao=Ga.ssao&&a.b4w_enable_ssao;Z.god_rays=Ga.god_rays&&a.b4w_enable_god_rays&&Z.ei;Z.xK=Ga.kr;Z.Hr=a.b4w_glow_settings.render_glow_over_blend;Z.GP=m(a);la=r(g);Z.bC=la;Z.refractions=h(a,la);Z.bd=b(a,e,g);Z.xc=n(g);Z.xg=C(g);Z.pP=f(g);Z.shore_smoothing=w(g);Z.rc=G(a,g);Z.bJ=!Z.Ro&&!Z.anaglyph_use&&A(a,g);Z.outline=J(a,g);Z.Ih=t(a,g);switch(a.b4w_reflection_quality){case "LOW":Z.Ch=Na.lA;Z.ng=Na.AC;break;case "MEDIUM":Z.Ch=
Na.pK;Z.ng=Na.UN;break;case "HIGH":Z.Ch=Na.oK;Z.ng=Na.TN;break;default:Z.Ch=Na.lA,Z.ng=Na.AC}ya.AM()?(xa.log("%cENABLE HIDPI MODE","color: #00a"),Z.Ry="AA_QUALITY_LOW",Z.Jm=1,Ga.tc=1):1<Ga.tc?(xa.log("%cENABLE MSAA RENDERING: "+Ga.tc+"x","color: #00a"),Z.Jm=1):(Z.Ry="AA_QUALITY_"+a.b4w_antialiasing_quality,Z.Jm="MEDIUM"===a.b4w_antialiasing_quality&&Ga.quality===ta.P_ULTRA||"HIGH"===a.b4w_antialiasing_quality&&Ga.quality===ta.P_HIGH?1.33:"HIGH"===a.b4w_antialiasing_quality&&Ga.quality===ta.P_ULTRA||
"NONE"===a.b4w_antialiasing_quality&&Ga.quality===ta.P_ULTRA?2:1);e=a.pf.sort(function(a,b){return b.q.$h-a.q.$h});Z.Ma=ga.CJ(Z,S,q,e);Z.Zk=[];Z.ys=!1;Z.Cw=!1;Z.Dw=!1;Z.mi=new Float32Array(3);Oa.push(a);Wb||(Wb=sa.create());sa.H(Wb,a);for(Z=0;Z<d.length;Z++)ba.kx(d[Z],!0,a);a=ya.get_container();ya.resize(a.clientWidth,a.clientHeight,!0)};a.uH=function(a,b,c){for(var d=0;d<b.length;d++)b[d].q&&b[d].q.Kk&&(b[d].q.vg=c,a.q.on.push(b[d]))};a.Fv=function(a){return a.q.Ma};a.TA=function(a,b){sa.la(b,function(c,
d){var e=null;switch(d.type){case Q.Ob:e=ea.Uu(d.Os);break;case Q.wq:e=ea.JJ(d);break;case Q.fu:e=ea.KJ(d);break;case Q.xy:e=ea.pJ();break;case Q.oi:ga.rb(b,d,Q.zl)||ga.rb(b,d,Q.Me)||ga.rb(b,d,Q.zc)||ga.rb(b,d,Q.oi);e=ea.tJ(d.vC,d.mh,d.Zm);break;case Q.rq:ga.rb(b,d,Q.zl)||ga.rb(b,d,Q.Me)||ga.rb(b,d,Q.zc);ga.rb(b,d,Q.oi);e=ea.uJ();break;case Q.yg:e=ea.yJ();break;case Q.St:e=ea.lJ(d.Xz);break;case Q.vn:var e=ea.qJ(d),f=d.p.dof_power;if(d.p.Xc){var f=f/2,h=ga.Gv(b,d,Q.Ob);ga.wc(h[0],f);ga.wc(h[1],f);
h[0]=ga.rb(b,h[0],Q.Ob);ga.wc(h[0],f)}else{var h=ga.rb(b,d,Q.Ob),k=ga.rb(b,h,Q.Ob);ga.wc(h,f);ga.wc(k,f)}break;case Q.xl:var e=ea.zJ(),f=ga.rb(b,d,Q.Ob),h=ga.rb(b,f,Q.Ob),k=ga.rb(b,h,Q.Ob),g=ga.rb(b,k,Q.Ob);ga.wc(h,d.vu);ga.wc(f,d.vu);ga.wc(g,d.rv*d.kp);ga.wc(k,d.rv*d.kp);break;case Q.wn:e=ea.sJ();break;case Q.Tt:e=ea.nJ();break;case Q.ry:e=ea.gJ(d);break;case Q.du:case Q.uq:case Q.zn:case Q.vq:e=ea.HJ(d.type);break;case Q.pi:e=ea.LJ(d.ub);break;case Q.Of:e=ea.oJ(a,d);break;case Q.LUMINANCE:e=ea.vJ();
break;case Q.XE:e=ea.hJ();break;case Q.sq:e=ea.wJ();break;case Q.un:e=ea.jJ();break;case Q.tn:e=ga.rb(b,d,Q.un);f=ga.rb(b,e,Q.un);ga.wc(e,d.El);ga.wc(f,d.El);e=ea.kJ();break;case Q.UG:e=ea.kK();break;case Q.vl:e=ea.fJ();break;case Q.xn:e=ea.AJ()}e&&(f=Q.Qg(e,ba.Kl("NONE")),Q.Cc(d,f),F(b,d,e),L(e))})};a.append_object=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var d=a.q.Ma,e=b.k;!ga.Pb(d,Q.Jc)&&e.cd&&(e.cd=!1);e=ca(a,lb);c&&b.ml&&la.append_object(b,a);for(var f=0;f<e.length;f++){var h=
e[f],k=b,g=d,m=a,l=c;switch(h.type){case Q.Bb:aa(h,k,g,"OPAQUE",m,l);break;case Q.zc:aa(h,k,g,"BLEND",m,l);break;case Q.of:aa(h,k,g,"XRAY",m,l);break;case Q.Ed:aa(h,k,g,"GLOW",m,l);break;case Q.nd:case Q.Sc:N(h,k,g,!1,m,l);break;case Q.Ne:case Q.me:N(h,k,g,!0,m,l);break;case Q.Oe:for(var n=ba.ea(k,m).T,p=0;p<n.length;p++){var t=n[p];if("SHADOW"==t.type&&"RECEIVE"==t.ub&&t.cd){if(!l&&(M(t,h,k,g,"SHADOW",m),!ea.oc(t)))continue;var r=Q.Qg(t,k.k);Q.Cc(h,r);F(g,h,t);L(t)}}break;case Q.Jc:n=!1;p=k.k;k=
ba.ea(k,m).T;t=ga.Pb(g,Q.qh);for(r=0;r<k.length;r++){var Z=k[r];if("SHADOW"==Z.type&&"CAST"==Z.ub){n=!0;if(!l){var u=h.Cs;ea.ab(Z,"NUM_LIGHTS",u);ea.ab(Z,"NUM_LFACTORS",0==u%2?u/2:Math.floor(u/2)+1);ra.aa(Z.tb,"SHADOW_USAGE","SHADOW_CASTING");Z.rc&&t&&T(Z,t,p);ea.ab(Z,"SHADOW_TEX_RES",ra.F(m.q.bd.csm_resolution));if(!ea.oc(Z))continue}Z=Q.Qg(Z,p);Q.Cc(h,Z)}}n&&(k=m.q.bd,l=ga.Pb(g,Q.Bb),qa(h,m,l.p,k,!0));break;case Q.Le:W(h,k,g,m,l);break;case Q.ph:W(h,k,g,m,l);break;case Q.Nf:n=k.k;p=ba.ea(k,m).T;
for(t=0;t<p.length;t++)if(r=p[t],"COLOR_ID"==r.type&&"OUTLINE"==r.ub){if(!l&&(M(r,h,k,g,"COLOR_ID",m),ea.ab(r,"USE_OUTLINE",1),!ea.oc(r)))continue;r=Q.Qg(r,n);Q.Cc(h,r)}break;case Q.qh:g=k.k;k=ba.ea(k,m).T;for(m=0;m<k.length;m++)if(n=k[m],"GRASS_MAP"==n.type){if(!l&&!ea.oc(n))if("DEBUG"===Ma.type())ea.Iq(n,"error.glslv","error.glslf"),ea.oc(n);else continue;n=Q.Qg(n,g);Q.Cc(h,n);n=h.p;Z=g.ga;p=h.Hd[0];t=h.Hd[1];r=h.Hd[2];0==p&&0==t?(p=Z.min_z,t=Z.max_z):(p=Math.min(p,Z.min_z),t=Math.max(t,Z.max_z));
Z=1E-4*(t-p);p-=Z;t+=Z;h.Hd[0]=p;h.Hd[1]=t;ja.at(n,r/2,-t,-p,r/2);ja.rj(n)}break;case Q.Me:for(n=k.k,k=ba.ea(k,m).T,m=0;m<k.length;m++)p=k[m],"DEBUG_VIEW"==p.type&&R(h,n,g,l,p)}}break;case "LAMP":ma(b,a),La.uP(a)}ba.kx(b,!0,a)};a.ey=D;a.lx=function(a){a.q.ys=!0};a.BQ=function(a,b){sa.la(b,function(b,c){if(c.type===Q.Jc){var d=Fa.Ub(a.n,uc);Fa.set_trans(d,c.p.n);Fa.copy(a.Je,c.p.Jp)}})};a.TT=fa;a.IL=function(a,b){for(var c=a.q.bd,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=ja.nK(c,b,e);
return d};a.MR=R;a.Lz=ha;a.Vn=H;a.is_hidden=function(a){return a.k.hide};a.hO=function(a){for(var b=0;b<a.G.length;b++)for(var c=ca(a.G[b].mb,lb),b=0;b<c.length;b++)for(var d=c[b].La,e=0;e<d.length;e++)for(var f=d[e].oa,h=f.length-1;0<=h;h--){var k=f[h];k.Th==a.k&&(k.qa&&ea.Wz(k.qa),f.splice(h,1))}};a.qQ=function(a,b){for(var c=a.$a,d=ba.ea(a,b).Nk,e=ca(b,Ra),f=0;f<e.length;f++){var h=e[f];h.bp.set(c.ho,4*d);h.ra=!0}};a.jn=ma;a.DQ=function(a){a=a.G;for(var b=0;b<a.length;b++)D(a[b].mb)};a.cleanup=
function(){for(var a=0;a<Oa.length;a++){var b=Oa[a];sa.la(b.q.Ma,function(a,b){if(b.type!=Q.Al){var c=b.p;Qa.iO(c.xe,c.bc,c.ue,c.width,c.height);for(var c=b.La,d=0;d<c.length;d++)for(var e=c[d].oa,f=0;f<e.length;f++){var h=e[f].qa;h&&ea.Wz(h)}}});b.q.Ma=[];b.q.Zk=[]}xb=tc=null;Oa.length=0;Wb=null};a.aC=function(a,b,c){a=ja.SK(a,a.near,a.far,null,!0);var d=rb.sL(a);a=ba.Kl("DYNAMIC");a.ga=a.K={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Da=a.da=Aa.$H();var e=a.Da.Ra;a.sa=
a.O=Aa.On([e,0,0],[0,e,0],[0,0,e],a.Da.D);c=ea.GJ(d,c);c=Q.Qg(c,a);Q.Cc(b,c)};a.LS=function(a){return[a.frame_start,a.frame_end]};a.iD=function(a,b,c){ya.iP(a,b,c);xb&&ua(xb,a,b)};a.AT=ua;a.Ex=ca;a.Ja=X;a.get_environment_colors=function(a){a=X(a,Q.Bb);var b=a.Jd,c=a.Rd,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.$f,d,e]};a.set_environment_colors=function(a,b,c,d){a=ca(a,Ra);for(var e=0;e<a.length;e++){var f=a[e];f.Jd.set(c);f.Rd.set(d);f.$f=b;f.ra=!0}};a.get_sky_params=
function(a){if(a=X(a,Q.Of)){var b={};b.color=Array(3);Ka.copy(a.Qm,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;
b.mie_distribution=a.mie_distribution;return b}return null};a.set_sky_params=function(a,b){var c=X(a,Q.Of);c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.Qm.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),
"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&
(c.mie_distribution=b.mie_distribution),c.ra=!0,c.xs=!0,ia(a,c))};a.QL=function(a){return ca(a,Wa)[0].tf[0]};a.OL=function(a){return ca(a,Wa)[0].tf[1]};a.RL=function(a){return ca(a,Wa)[0].tf[2]};a.PL=function(a){return ca(a,Wa)[0].tf[3]};a.bD=function(a,b){for(var c=ca(a,Wa),d=0;d<c.length;d++){var e=c[d];e.tf[0]=b;e.ra=!0}};a.$C=function(a,b){for(var c=ca(a,Wa),d=0;d<c.length;d++){var e=c[d];e.tf[1]=b;e.ra=!0}};a.cD=function(a,b){for(var c=ca(a,Wa),d=0;d<c.length;d++){var e=c[d];e.tf[2]=b;e.ra=!0}};
a.aD=function(a,b){for(var c=ca(a,Wa),d=0;d<c.length;d++){var e=c[d];e.tf[3]=b;e.ra=!0}};a.get_fog_color_density=function(a,b){var c=b||[],d=ca(a,Wa)[0].Yd;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=ca(a,Wa),d=0;d<c.length;d++){var e=c[d];e.Yd.set(b);e.ra=!0}};a.get_ssao_params=function(a){var b=X(a,Q.wq);a=X(a,Q.fu);if(!b)return null;var c=b.La[0].oa[0].qa,d={};d.ssao_quality=ea.gd(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=
a.ssao_blur_depth;d.uz=a.ssao_blur_discard_value;d.radius_increase=b.Vm;d.influence=b.Um;d.dist_factor=b.Tm;d.ssao_only=b.ssao_only;d.ssao_white=ea.gd(c,"SSAO_WHITE")[1];return d};a.set_ssao_params=function(a,b){var c=X(a,Q.wq),d=X(a,Q.fu);if(!c)return xa.error("SSAO is not enabled on the scene"),0;var e=c.La[0].oa[0],f=e.qa;"string"==typeof b.ssao_quality&&(ea.ab(f,"SSAO_QUALITY",b.ssao_quality),ea.oc(f),Q.Cc(c,e));"number"==typeof b.ssao_hemisphere&&(ea.ab(f,"SSAO_HEMISPHERE",b.ssao_hemisphere),
ea.oc(f),Q.Cc(c,e));"number"==typeof b.ssao_blur_depth&&(ea.ab(f,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),ea.oc(f),Q.Cc(c,e));"number"==typeof b.ssao_white&&(ea.ab(f,"SSAO_WHITE",b.ssao_white),ea.oc(f),Q.Cc(c,e));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=b.ssao_blur_discard_value);"number"==typeof b.Vm&&(c.Vm=b.Vm);"number"==typeof b.Um&&(c.Um=b.Um);"number"==typeof b.Tm&&(c.Tm=b.Tm);if("number"==typeof b.ssao_only){c=X(a,Q.Bb);c.ssao_only=b.ssao_only;for(var e=c.La,h=0;h<
e.length;h++)for(var k=e[h].oa,g=0;g<k.length;g++)f=k[g].qa,ea.ab(f,"SSAO_ONLY",b.ssao_only),ea.oc(f),Q.Cc(c,k[g])}c.ra=!0;d.ra=!0};a.get_dof_params=function(a){a=X(a,Q.vn);if(!a)return null;var b={};b.dof_distance=a.p.dof_distance;b.dof_front_start=a.p.dof_front_start;b.dof_front_end=a.p.dof_front_end;b.dof_rear_start=a.p.dof_rear_start;b.dof_rear_end=a.p.dof_rear_end;b.dof_power=a.p.dof_power;b.Xc=a.p.Xc;b.gb=a.p.gb;b.Dc=a.p.Dc;return b};a.set_dof_params=ka;a.get_god_rays_params=function(a){var b=
ca(a,[Q.oi]);a=X(a,Q.rq);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].rm;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=ea.gd(b[0].La[0].oa[0].qa,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=ca(a,[Q.oi]),d=X(a,Q.rq);if(!c||!d)return xa.error("God Rays are not enabled on the scene"),0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,
f=0;f<c.length;f++)c[f].rm=e,c[f].Ts=e/c[f].Zm/(f+1),c[f].ra=!0;if("number"==typeof b.god_rays_steps)for(var h=ra.F(b.god_rays_steps,1),e=c[0].rm,f=0;f<c.length;f++){c[f].Zm=h;c[f].Ts=e/h/(f+1);c[f].ra=!0;var k=c[f].La[0].oa[0],g=k.qa;ea.ab(g,"STEPS_PER_PASS",h);ea.oc(g);Q.Cc(c[f],k)}d.ra=!0};a.get_bloom_params=function(a){var b=X(a,Q.sq);a=X(a,Q.tn);if(!b||!a)return null;var c={};c.key=b.Pq;c.edge_lum=b.Oq;c.blur=a.El;return c};a.set_bloom_params=Ha;a.get_glow_material_params=function(a){a=X(a,Q.wn);
if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=Ea;a.get_wind_params=function(a){var b=Y(a);a=Ka.length(b);if(0==a)return null;var b=Ja.rad_to_deg(Math.atan2(b[0],-b[1])),c={};c.wind_dir=b;c.wind_strength=a;return c};a.AO=function(a){a.q.Cw=!0};a.get_water_surface_level=da;a.get_water_mat_params=
function(a,b){var c=a.q.xc,d=X(a,Q.Bb);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,d.nh&&(b.water_fog_density=d.nh[3],c=b.water_fog_color=[],c[0]=d.nh[0],c[1]=d.nh[1],c[2]=d.nh[2]))};a.set_water_params=function(a,b){var c=a.q.xc;if(!c)return xa.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&
(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&
(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.zo=b.water_dynamic);for(var d=ca(a,Vb),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.Yd&&(f.nh[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Yd&&f.nh.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.my=b.waves_height);"number"==typeof b.waves_length&&(f.ny=b.waves_length);f.ra=!0}};a.get_shore_dist=function(a,b,c){var d=
a.q.xc;if(!d.sj)return 100;var e=d.nw;a=d.Jj;var f=(b[0]-d.Nm[0])/d.Om[0],h=(d.Nm[1]+b[1])/d.Om[1],f=f+.5,h=h+.5;if(1<f||0>f||1<h||0>h)b=1;else return d=e*Ja.ZA(xb.q.sx,d.tx,f,h),b=(a-b[2])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,b){for(var c=d().ri.k,e=0;e<Oa.length;e++){var f=Oa[e],h=f.q.Ma,k=f.q;if(k.xc)var g=Fa.get_trans_view(c.n),m=g[2]-da(f,g[0],g[1]);for(g=0;g<k.on.length;g++){var l=k.on[g].q,n=l.ya,p=l.ad;if(!(f.b4w_use_nla&&l.kn||!n&&!p)&&Sa.OE(l)){var ba=Sa.LE(l),t=Sa.NE(l);n&&Ga.is_mobile_device&&
(t-=5);var la=Sa.WQ(l);ba>=la&&l.ii||ba<t?(Sa.reset_video(l.name,l.vg),p&&(l.qj=Sa.Zs(l,a))):ba>=la&&!l.ii?Sa.pause_video(l.name,l.vg):Sa.PE(l)&&(n?Sa.tE(l):(n=Sa.Zs(l,a),n!=l.qj&&(Sa.sE(l),l.Zh++),l.qj=n))}}sa.la(h,function(b,c){-1<cb.indexOf(c.type)&&(c.time=a);k.xc&&(c.Eu=m)})}for(e=0;e<Oa.length;e++)if(f=Oa[e],k=f.q,h=k.Ma,c=k.Zk,c.length)for(k.ys&&(U(f),k.ys=!1),k.Cw&&(va(f),k.Cw=!1),k.Dw&&(O(f),k.Dw=!1),k.motion_blur&&P(h,b),f=ga.Pb(h,Q.Nf),g=0;g<c.length;g++)h=c[g],Z.Ps(h),f&&K(h,f),Qa.Tl(h);
Ga.show_hud_debug_info&&S.mP(Oa,b)};a.qO=function(a){a.q.Dw=!0};a.zv=function(a){var b=[];sa.la(a.q.Ma,function(a,c){b.push(c)});return b};a.get_cam_water_depth=function(){var a=X(xb,Q.zc),b=xb;return a||b.q.xc?a.Eu:null};a.rE=function(a){sa.la(a.q.Ma,function(a,b){b.ra=!0})};a.HO=function(a,b){a.debug_view_mode=b;a.Lb=b!=Ca.DV_NONE;a.yb=b==Ca.DV_TRANSPARENT_WIREFRAME;a.ra=!0;for(var c=d(),e=0;e<Vb.length;e++){var f=X(c,Vb[e]);f&&(f.jv=b==Ca.DV_RENDER_TIME)}};a.GO=function(a,b){a.debug_colors_seed=
b;a.ra=!0};a.$O=function(a,b){a.qA=b;a.ra=!0};a.gP=function(a,b){for(var c=a.La,d=0;d<c.length;d++)for(var e=c[d].oa,f=0;f<e.length;f++){var h=e[f].qa;Ka.copy(b,h.wireframe_edge_color);h.ra=!0}};a.oE=function(a,b){var c=b.Wl,d=a.q.mi;if(c&&"WIND"==c.type&&d){var e=Fa.get_quat_view(b.k.n);Ka.transformQuat(Ja.AXIS_Z,e,d);Ka.normalize(d,d);Ka.scale(d,c.LD,d);c=ca(a,cb);for(e=0;e<c.length;e++)c[e].mi.set(d);return!0}return!1};a.ON=function(a,b,c){var d=X(a,Q.Le);if(d){var e=ya.get_canvas();ja.FO(d.p,
b,c,e.clientWidth,e.clientHeight);Z.Ps(d);d.Lb&&Qa.Tl(d);if(a=X(a,Q.ph))wa.copy(d.p.lb,a.p.lb),wa.copy(d.p.Rc,a.p.Rc),Ja.Vl(a.p.Rc,a.p.Og),Z.Ps(a),a.Lb&&Qa.Tl(a);if(d.Lb||a&&a.Lb)return Qa.$w(a?a.p.xe:d.p.xe,0,0)}else xa.error("Object Selection is not available on the scene");return null};a.set_outline_color=function(a){var b=d();if(b=X(b,Q.xl))b.Vh.set(a),b.ra=!0};a.QS=Y;a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);
return b};a.nE=function(a,b){var c=uc;Ka.negate(b,c);for(var d=0;6>d;d++){var e=a.jk[d],f=a.oo[d],h=a.p;wa.translate(Ja.jF[d],c,e);wa.multiply(h.lb,e,h.Rc);Ja.Vl(h.Rc,f)}};a.pE=function(a,b,c){Ja.TP(b,c,Ja.AXIS_Z,a.p.Xb)};a.QH=function(a,b,c){var d=a.q.bd,e=a.q.$g;c=ba.Er(c,Ga.ssao&&a.b4w_enable_ssao);if(e)for(var f=0;f<b.length;f++){var h=b[f],k=ba.ea(h,a);if(-1!=h.k.ce){var g=e.Xg,m=e.Ns,h=h.k.ce;m.length?k.Xg=m[h]:g.length&&(k.Xg=g[h])}else-1!=h.k.te&&(g=e.Bh,m=e.$u,h=h.k.te,m.length?k.Bh=m[h]:
g.length&&(k.Bh=g[h]))}for(f=0;f<c.length;f++)if(k=ba.ea(c[f],a),d)for(b=ca(a,[Q.Jc]),e=0;e<b.length;e++)f==b[e].rg&&k.rx.push(b[e])};a.marker_frame=function(a,b){return a.timeline_markers[b]};a.set_hmd_params=function(a){var b=d();if(b=X(b,Q.pi))a.distortion_coefs&&(b.lk[0]=a.distortion_coefs[0],b.lk[1]=a.distortion_coefs[1],b.ra=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=
a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.ra=!0),a.base_line_factor&&(b.lk[2]=a.base_line_factor,b.ra=!0),a.inter_lens_factor&&(b.lk[3]=a.inter_lens_factor,b.ra=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.ra=!0)};a.hC=function(b,c){for(var d=Oa,e=0;e<d.length;e++)ga.zN(a.Fv(d[e]),b,c)};a.bQ=function(a){for(var b=La.Gb(a,"LAMP",La.DATA_ID_ALL),c=ca(a,lb),d=0;d<c.length;d++)for(var e=c[d],f=e.La,h=0;h<f.length;h++)for(var k=
f[h].oa,g=0;g<k.length;g++){var m=k[g],l=m.qa;"MAIN"==l.type&&(ea.fQ(l,b,a),ea.oc(l),Q.Cc(e,m))}};a.MC=function(a){for(var b=0;b<Oa.length;b++)sa.la(Oa[b].q.Ma,function(b,c){for(var d=c.La,e=0;e<d.length;e++)for(var f=d[e].oa,h=0;h<f.length;h++){var k=f[h];k.qa==a&&Q.Cc(c,k)}})}};b4w.module.__physics=function(a,q){function e(a,b){for(var c=a.se,d=0;d<c.length;d++)c[d].mg.Zp&&b.push(c[d]),e(c[d],b)}function d(a,b,c){for(var d=a.gc.oa,e=0;e<d.length;e++)for(var f=d[e].C,h=0;h<f.re.length;h++){var k=f.re[h];"ANY"!=k.Kb&&c!=k.Kb||I(k,a,b)}}function b(a,b,c){if(L.Yr(a))switch(b){case L.sF:var d=g(a);d.gc.SE=!0;L.Z(a,L.uG,Date.now()-performance.now(),V.max_fps,V.Au?ia.LA:0);break;case L.tF:N.Zd("URANIUM:",c.slice(1));break;case L.oF:N.error(c);break;case L.pF:M.fbmsg.apply(this,
c.slice(1));break;case L.yF:var e=l(c.Y);if(e){a=c.trans;d=c.quat;b=c.Rg;var f=c.Cg,e=e.C;e.gr=c.time;W.set_sep(a,1,d,e.bv);ha.copy(b,e.Rg);ha.copy(f,e.Cg)}break;case L.vF:(a=l(c.Fu))&&W.set_sep(c.trans,1,c.quat,a.v.vp[c.Vw]);break;case L.qF:if(d=l(c[1]))a=c[4],d=d.sf.Qq[c[2]],fa.set_translation(d,c[3]),fa.set_rotation(d,a),fa.B(d);break;case L.zF:if(e=l(c[1]))e.v.speed=c[2];break;case L.kF:d=g(a);w(d,c.Xj,c.Yj,c.result,null,null,0);break;case L.mF:d=g(a);w(d,c.Xj,c.Yj,c.result,c.dk,c.coll_norm,c.coll_dist);
break;case L.lF:if(e=l(c[1]))a=e.C,a.ck&&a.ck(c[2]);break;case L.Ay:case L.wF:d=g(a);if(a=d.gc.kj[c.id])if(d=l(c.Fl),b==L.Ay)b=a.callback,b(a.id,c.hit_fract,d,c.hit_time);else{b=c.hit_fract;var f=c.hit_time,e=c.hit_pos,h=a.callback;e?h(a.id,b,d,f,e,c.hit_norm):h(a.id,b,d,f)}break;case L.xF:A(id);break;case L.uF:a=ca.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case L.rF:ua=
c[1];break;case L.nF:a=ca.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:N.error("Wrong message: "+b)}}function g(a){for(var b=0;b<ca.length;b++)if(ca[b]==a)return X[b]}function l(a){return ka[a]||null}function w(a,b,c,d,e,h,k){a=a.gc.oa;for(var g=0;g<a.length;g++)for(var m=a[g].C,n=0;n<m.re.length;n++){for(var p=m.re[n],t=p.hj,r=!1,u=0;u<t.length;u++){var v=t[u];if(v[0]===b&&v[1]===c){p.lp[u]=d;r=!0;break}}r&&(t=f(p),e&&p.wu!=b&&(r=e,u=h,v=k,r[0]+=u[0]*v,r[1]+=u[1]*
v,r[2]+=u[2]*v,u[0]*=-1,u[1]*=-1,u[2]*=-1),p.callback(t,t?p.wu==b?l(c):l(b):null,e,h,k))}}function f(a){a=a.lp;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function n(){da.body++;return da.body}function r(a){var b=Ea.indexOf(a);return-1==b?(Ea.push(a),Ea.length-1):b}function v(a,b){return{Y:a,type:b,Ug:0,bs:!1,tj:!0,ye:!1,is_character:!1,yM:!1,Yq:null,Kb:"",co:0,dS:{},re:[],ck:null,gr:0,bv:new Float32Array([0,0,0,1,0,0,0,1]),Rg:new Float32Array(3),Cg:new Float32Array(3),Tq:new Float32Array(3),
Sn:new Float32Array(4),fp:null}}function c(a,b){switch(a){case "BOX":var c=b.K;break;case "CYLINDER":c=b.Nn;break;case "CONE":c=b.Mn;break;case "SPHERE":c=b.da;break;case "CAPSULE":c=b.Ln}return c}function m(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);
"object"===typeof a.D&&(b.center=a.D);"number"===typeof a.Ra&&(b.radius=a.Ra);"number"===typeof a.height&&(b.height=a.height);return b}function p(a,b,c,d,e){var f=W.get_trans_view(a.k.n),h=W.invert(b.k.n,za),k=new Float32Array(3);W.transform_vec3(f,h,k);switch(b.v.type){case 10:b=b.He;a=a.k.K;L.Z(e,L.YF,c,k,b.NP,b.gx,(a.max_z-a.min_z)/2,d);break;case 20:L.Z(e,L.XF,c,k,a.LT)}}function y(a){return a.C&&a.C.Yq}function E(a,b,c,d,e,f,h,k,g,m){var l;da.Tb++;l=da.Tb.toString(16);var n=b.C.Y;L.Z(u(n),L.eG,
l,a,k,n,c,d,e.C.Y,f,h,g,m);b.C.Yq=l}function u(a){for(var b=0;b<X.length;b++)for(var c=X[b].gc.oa,d=0;d<c.length;d++)if(c[d].C.Y==a)return ca[b];return null}function z(a){var b=a.C;if(b=b?0===b.Ug?!0:!0===b.bs?!0:!1===b.tj?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=W.Ub(a.k.n,K),c=W.zd(a.k.n,Ba),b=b[0]!=a.C.Tq[0]||b[1]!=a.C.Tq[1]||b[2]!=a.C.Tq[2]||c[0]!=a.C.Sn[0]||c[1]!=a.C.Sn[1]||c[2]!=a.C.Sn[2]||c[3]!=a.C.Sn[3];if(b){var b=a.C,d=a.k,c=L.gB(L.tq);c.Y=b.Y;var e=W.Ub(d.n,c.trans),
d=W.zd(d.n,c.quat);ha.copy(e,b.Tq);U.copy(d,b.Sn);"DYNAMIC"==b.type&&U.identity(c.quat);L.Z(u(b.Y),L.tq)}a=a.se;for(b=0;b<a.length;b++)z(a[b])}function x(a,b,c,d,e){e=e||new Float32Array(3);a=W.get_quat_view(a.k.n);e[0]=b;e[1]=c;e[2]=d;ha.transformQuat(e,a,e)}function I(a,b,c){var d=a.hj,e=a.lp,f=a.wu,h=[],k=a.Kb;h||R.r("At least one destination required");for(var g=0;g<b.gc.oa.length;g++){var m=b.gc.oa[g];if("ANY"==k||m.C.Kb==k&&"NAVMESH"!=m.C.type)m=m.C.Y,h&&-1==h.indexOf(m)&&h.push(m)}for(b=0;b<
h.length;b++)k=h[b],f<k&&!B(d,f,k)?(d.push([f,k]),e.push(!1)):f>k&&!B(d,k,f)&&(d.push([k,f]),e.push(!1));L.Z(c,L.WF,f);L.Z(c,L.dG,d,a.Fg)}function B(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function G(a){a.C&&a.C.ck&&(a=a.C,L.Z(u(a.Y),L.qG,a.Y),a.ck=null)}function A(a){var b=t(a),c=J(a).gc;c.kj[a]&&(delete c.kj[a],c.Zw.splice(c.Zw.indexOf,1),L.Z(b,L.zG,a))}function J(a){for(var b=0;b<X.length;b++){var c=X[b];if(c.gc.kj[a])return c}return null}function t(a){for(var b=
0;b<X.length;b++)if(X[b].gc.kj[a])return ca[b];return null}function h(a,b,c){if(b.Ym){a=a.C.Y;var d=b.Ul*b.Go,e=b.Qn*b.Rn,f=-b.Wm*b.Xm*2*Math.PI/b.Rp;b.Vo&&(f*=-1);switch(b.type){case 10:L.Z(c,L.MG,a,d,e,f);break;case 20:L.Z(c,L.LG,a,d,e,f)}}}function C(a){return a.ye&&"CHASSIS"==a.He.Ae}function k(a){return a.ye&&"HULL"==a.He.Ae}function F(a){return"NAVMESH"==a.mg.pp}function D(a){return a.Ik&&"MAIN_BODY"==a.Xl.Ae}var aa=q("__config"),M=q("__debug"),L=q("__ipc"),T=q("__obj_util"),N=q("__print"),
U=q("__quat"),O=q("__scenes"),qa=q("__subscene"),fa=q("__transform"),W=q("__tsr"),R=q("__util"),ha=q("__vec3"),H=q("__version"),ma=q("__navmesh"),V=aa.C,ia=aa.A,pa=aa.pd,ua=0,ca=[],X=[],ka={},Ha=[],Ea=["ANY"],da={body:0,Tb:0,KC:0},K=new Float32Array(3);new Float32Array(4);var Ba=new Float32Array(4);new Float32Array(16);var za=W.create(),va=W.create();a.sM=function(a){a.gc={SE:!1,oa:[],kj:{},Zw:[]};var c=V.Xp;pa.prevent_caching&&(c+=H.timestamp());N.log("%cLOAD PHYSICS","color: #0a0",V.hq?"Using Separate Worker Thread,":
"Using Same Thread,","Max FPS: "+V.max_fps);N.log("%cPHYSICS PATH","color: #0a0",c);var d=L.lK(c,!V.hq);L.TH(d,b);ca.push(d);X.push(a);V.ping&&setInterval(function(){L.Z(d,L.wG,performance.now())},1E3)};a.QI=function(a){return a.gc?a.gc.SE:!0};a.cleanup=function(){for(var a=0;a<ca.length;a++)L.terminate(ca[a]);ca.length=0;X.length=0;ka={};Ha.length=0;Ea.length=0;for(var b in da)da[b]=0};a.append_object=function(a,b){a.k||R.r("No object render: "+a.name);var f;a:{for(var g=0;g<X.length;g++)if(X[g]==
b){f=ca[g];break a}f=void 0}var l=[];a.mg.Zp&&e(a,l);var t=b.gc.oa;if(C(a)||k(a)||a.is_character||D(a)||a.ml){var u=F(a),w;if(u){var q=a,z=n(),S=v(z,"NAVMESH"),x=T.ea(q,b).T;S.fp=null;for(var A=0;A<x.length;A++){var O=x[A];if("PHYSICS"==O.type){S.fp=ma.BN(O.ha);break}}w=S}else{var K=a,ba=f,la=K.k,Z=K.mg,H=Z.pp,G=n();if("CAMERA"==K.type)var B=Z.gy?Z.Wq:"BOX",da=c(B,la),ga=la.vk,J=la.nk,ga=.5,J=0;else if("EMPTY"==K.type)B="EMPTY",da=null,J=ga=0;else{var B=Z.gy?Z.Wq:"BOX",da=c(B,la),I=W.get_scale(la.n);
if(1!=I){var Q=da;switch(B){case "BOX":Q.min_x*=I;Q.max_x*=I;Q.min_y*=I;Q.max_y*=I;Q.min_z*=I;Q.max_z*=I;break;case "CYLINDER":case "CONE":case "CAPSULE":Q.height*=I;Q.Ra*=I;break;case "SPHERE":Q.Ra*=I}}ga=la.vk;J=la.nk}var M=W.get_trans_view(la.n),qa=W.get_quat_view(la.n),fa=Z.cq,ia=Z.CE,aa=Z.Ug,ha=Z.HE,V=Z.GE,pa=Z.pA,ua=Z.SC,Na=K.Kb,Ea=r(Na),Ra=Z.eo,Wa=Z.bo,cb=Z.fo,Vb=la.da.Ra,tc=m(da),xb=K.ar,Oa;var Wb=B;if(l.length){var gd=[],Lc={};Lc.quat=new Float32Array([0,0,0,1]);Lc.trans=new Float32Array(3);
Lc.worker_bounding=tc;Lc.bounding_type=Wb;gd.push(Lc);var uc=W.invert(la.n,za),pd=Ba,Cb=W.get_quat_view(la.n);U.invert(Cb,pd);for(var fb=0;fb<l.length;fb++){var ec={},Ec=l[fb],hd=Ec.mg.Wq,vc=new Float32Array(4),Sc=new Float32Array(3),cc=W.get_trans_view(Ec.k.n),$c=W.get_quat_view(Ec.k.n);W.transform_vec3(cc,uc,Sc);U.multiply(pd,$c,vc);ec.trans=Sc;ec.quat=vc;ec.bounding_type=hd;ec.worker_bounding=m(c(hd,Ec.k));gd.push(ec)}Oa=gd}else Oa=[];L.Z(ba,L.aG,G,M,qa,H,fa,ia,aa,ha,V,pa,ua,Ea,Ra,Wa,cb,B,tc,Vb,
ga,J,Oa,xb);ka[G]=K;Ha.push(K);var ad=v(G,"BOUNDING");ad.type=H;ad.Ug=aa;ad.bs=fa;ad.Kb=Na;ad.co=Ea;w=ad}var bc=w;a.C=bc;var fd={qa:null,C:bc};u||(t.push(fd),d(b,f,bc.Kb))}else for(var Tc=T.ea(a,b).T,Uc=0;Uc<Tc.length;Uc++){var Jb=Tc[Uc],wc;if(wc="PHYSICS"==Jb.type){var kd;a:{for(var xc=b.gc.oa,nc=0;nc<xc.length;nc++){var Vc=xc[nc].qa;if(Vc&&Vc.id==Jb.id){kd=!0;break a}}kd=!1}wc=!kd}if(wc)if(Jb.Ee.Ca)if(Jb.mh&&b.q.xc){var Kb=Jb,fc=b,yc=f,jb=fc.q.xc;L.Z(yc,L.jG,jb.Jj);if(Kb.cR){var Xa={};Xa.dst_noise_scale0=
Kb.dst_noise_scale0;Xa.dst_noise_scale1=Kb.dst_noise_scale1;Xa.dst_noise_freq0=Kb.dst_noise_freq0;Xa.dst_noise_freq1=Kb.dst_noise_freq1;Xa.dir_min_shore_fac=Kb.dir_min_shore_fac;Xa.dir_freq=Kb.dir_freq;Xa.dir_noise_scale=Kb.dir_noise_scale;Xa.dir_noise_freq=Kb.dir_noise_freq;Xa.dir_min_noise_fac=Kb.dir_min_noise_fac;Xa.dst_min_fac=Kb.dst_min_fac;Xa.waves_hor_fac=Kb.waves_hor_fac;var Db=jb.waves_height,ab=jb.waves_length;jb.sj?L.Z(yc,L.Ky,Xa,jb.Om[0],jb.Om[1],jb.Nm[0],jb.Nm[1],jb.nw,Db,ab,jb.tx,fc.q.sx):
L.Z(yc,L.Ky,Xa,0,0,0,0,0,Db,ab,0,null)}}else{var Fc;if(Jb.cq){var Mc=a,tb=Jb,oc=f,gc=n(),hc=tb.Ee,Lb=hc.V[0].a_position,Wc=hc.ja||null,Mb=tb.Kb,Ta=r(Mb),zc=tb.eo,bd=tb.bo,Nc=tb.fo,wb=W.get_trans_view(Mc.k.n);L.Z(oc,L.gG,gc,Lb,Wc,wb,Ta,zc,bd,Nc);var Qb=v(gc,"STATIC_MESH");Qb.bs=!0;Qb.Kb=Mb;Qb.co=Ta;Fc=Qb}else{var kb=a,db=Jb,Rb=f,cd=n(),Oc=db.Ee,ic=Oc.V[0].a_position,pc=Oc.ja||null,yb=W.get_trans_view(kb.k.n),Gc=db.vk,qc=db.nk,dd=db.Kb,Ac=r(dd);L.Z(Rb,L.iG,cd,ic,pc,yb,Gc,qc,Ac,db.eo,db.bo,db.fo);var Xb=
v(cd,"STATIC_MESH");Xb.Kb=dd;Xb.co=Ac;Fc=Xb}bc=Fc;a.C=bc;fd={qa:Jb,C:bc};t.push(fd);d(b,f,bc.Kb)}else N.error("Object "+a.name+" has collision material with no assigned vertices")}if(C(a)||k(a)){var Ua=a,nb=f,Ya=Ua.C.Y;C(Ua)?(Ua.v.type=10,L.Z(nb,L.bG,Ya,Ua.v.Hx,Ua.v.Jx,Ua.v.Ix,Ua.v.qy,Ua.v.ow)):k(Ua)&&(Ua.v.type=20,L.Z(nb,L.$F,Ya,Ua.v.rk,Ua.v.rl,Ua.v.sl));if(Ua.v.Yk){var Yb=Ua.v.Yk;switch(Ua.v.type){case 10:p(Yb[0],Ua,Ya,!0,nb);p(Yb[1],Ua,Ya,!0,nb);p(Yb[2],Ua,Ya,!1,nb);p(Yb[3],Ua,Ya,!1,nb);break;
case 20:for(var $a=0;$a<Yb.length;$a++)p(Yb[$a],Ua,Ya,!1,nb)}}h(a,a.v,f)}else if(a.is_character){var rc=f,zb=a.k,Ab=a.C,Zb=zb.K.max_z-zb.K.min_z,$b=Ab.Y,pb=a.Mz,gb=pb.bR,ub=pb.yO,Bb=pb.HP,Pa=pb.JM,Va=pb.dR,ob=R.zK(a);L.Z(rc,L.cG,$b,ob,Zb,gb,ub,Bb,Pa,Va);Ab.is_character=!0}else if(D(a)){var hb=a,Za=f,vb=hb.C.Y;L.Z(Za,L.fG,vb,hb.sf.rk,hb.sf.rl,hb.sf.sl);if(hb.sf.Qq)for(var eb=hb.sf.Qq,ac=0;ac<eb.length;ac++){var Sb=eb[ac],Ob=W.get_trans_view(Sb.k.n),Pc=W.invert(hb.k.n,za),Qc=new Float32Array(3);W.transform_vec3(Ob,
Pc,Qc);L.Z(Za,L.ZF,vb,Qc,Sb.vz)}hb.C.yM=!0}for(Uc=0;Uc<Ha.length;Uc++)if(a=Ha[Uc],a.C){var Tb=a;if(!y(Tb))for(var jc=0;jc<Tb.Rw.length;jc++){var Eb=Tb.Rw[jc],Bc=Eb.target,Fb=Eb.PN;if(Bc.C){var Rc=new Float32Array([Eb.QN,Eb.RN,Eb.SN]),kc,Hc=new Float32Array([Eb.za,Eb.Aa,Eb.Ba]);kc=R.euler_to_quat(Hc,new Float32Array(4));var qb=W.identity(za),qb=W.set_trans(Rc,qb),qb=W.set_quat(kc,qb),Ic=W.multiply(Tb.k.n,qb,za),lc=W.invert(Bc.k.n,va),Gb=W.multiply(lc,Ic,lc),Hb=W.get_trans_view(Gb),Cc=W.get_quat_view(Gb),
ib=Eb,bb={};bb.use_limit_x=ib.OQ;bb.use_limit_y=ib.PQ;bb.use_limit_z=ib.QQ;bb.use_angular_limit_x=ib.KQ;bb.use_angular_limit_y=ib.LQ;bb.use_angular_limit_z=ib.MQ;bb.limit_max_x=ib.TM;bb.limit_min_x=ib.WM;bb.limit_max_y=ib.UM;bb.limit_min_y=ib.XM;bb.limit_max_z=ib.VM;bb.limit_min_z=ib.YM;bb.limit_angle_max_x=ib.NM;bb.limit_angle_min_x=ib.QM;bb.limit_angle_max_y=ib.OM;bb.limit_angle_min_y=ib.RM;bb.limit_angle_max_z=ib.PM;bb.limit_angle_min_z=ib.SM;E(Fb,Tb,Rc,kc,Bc,Hb,Cc,bb,null,null)}}}};a.ZK=l;a.update=
function(a,b){for(var c=0;c<ca.length;c++){var d=ca[c],e=a;d&&L.IB(d)&&L.Z(d,L.NG,e,b);for(var f=0;f<Ha.length;f++){var h=Ha[f],k=h.C;if(k.tj&&k.gr){var g=L.IB(d)?e-k.gr:performance.now()/1E3-k.gr,g=Math.min(g,10/V.max_fps),g=g-1/V.max_fps;ia.CN&&(g=0);var m=za;W.uM(k.bv,g,k.Rg,k.Cg,za);fa.set_tsr(h,m);fa.B(h);z(h);if(h.v)for(var k=h,g=k.v.Yk,m=k.k.n,l=za,n=0;n<g.length;n++){var p=g[n];W.multiply(m,k.v.vp[n],l);fa.set_tsr(p,l);fa.B(p)}h.v&&h.v.Ym&&(l=h,g=l.v,k=g.Ym)&&(n=l.v.ID,W.multiply(l.k.n,l.v.JD,
k.k.n),m=K,W.transform_dir_vec3(n,l.k.n,m),l=Ba,U.setAxisAngle(m,-g.Wm*g.Xm*2*Math.PI,l),g=W.get_quat_view(k.k.n),U.multiply(l,g,g),fa.B(k));h.v&&h.v.yx&&(l=h,g=l.v,k=g.yx)&&(n=l.v.CD,W.multiply(l.k.n,l.v.DD,k.k.n),m=K,W.transform_dir_vec3(n,l.k.n,m),l=Ba,n=Math.abs(g.speed)*g.Pp,n>g.sm&&(n=g.sm),U.setAxisAngle(m,-n,l),g=W.get_quat_view(k.k.n),U.multiply(l,g,g),U.normalize(g,g),fa.B(k));h.v&&h.v.Kx&&(m=h,k=m.v,h=k.Kx)&&(l=m.v.UD,W.multiply(m.k.n,m.v.VD,h.k.n),g=K,W.transform_dir_vec3(l,m.k.n,g),m=
Ba,U.setAxisAngle(g,-Math.abs(k.Ul)*k.so,m),k=W.get_quat_view(h.k.n),U.multiply(m,k,k),U.normalize(k,k),fa.B(h))}}L.XN(d);d=X[c];(e=d.q.xc)&&0<e.waves_height&&(d=O.Ja(d,qa.Bb),e=ha.length(d.mi)||1,L.Z(ca[c],L.KG,d.time*e))}};a.zL=function(){return X[0]};a.pause=function(){for(var a=0;a<ca.length;a++)L.Z(ca[a],L.vG)};a.resume=function(){for(var a=0;a<ca.length;a++)L.Z(ca[a],L.AG)};a.enable_simulation=function(a){(a=a.C)||R.r("No object physics");if(!a.tj){var b=a.Y,c=u(b);a.tj=!0;L.Z(c,L.tG,b)}};a.disable_simulation=
function(a){(a=a.C)||R.r("No object physics");if(a.tj){var b=a.Y,c=u(b);a.tj=!1;L.Z(c,L.sG,b)}};a.Ws=function(a){return Boolean(a.gc)};a.ka=function(a){return Boolean(a.C)};a.has_dynamic_physics=function(a){return(a=a.C)&&a.tj&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Ug&&0==a.bs?!0:!1};a.has_simulated_physics=function(a){return(a=a.C)&&a.tj?!0:!1};a.set_gravity=function(a,b){var c=a.C.Y;L.Z(u(c),L.JG,c,b)};a.mM=y;a.apply_constraint=E;a.clear_constraint=function(a){a=a.C;L.Z(u(body_a),L.yG,
a.Yq);a.Yq=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,h){c=W.set_sep(c,1,d,za);f=W.set_sep(f,1,h,va);W.invert(c,c);W.multiply(f,c,c);fa.get_tsr(e,f);W.multiply(f,c,c);fa.set_tsr(b,c);fa.B(b);e=W.get_trans_view(b.k.n);f=W.get_quat_view(b.k.n);a.set_transform(b,e,f)};a.set_transform=function(a,b,c){var d=a.C,e=L.gB(L.tq),f=W.Ub(a.k.n,e.trans);a=W.zd(a.k.n,e.quat);W.set_sep(f,1,a,d.bv);e.Y=d.Y;ha.copy(b,e.trans);U.copy(c,e.quat);L.Z(u(d.Y),L.tq)};a.sync_transform=z;a.apply_velocity=function(a,
b,c,d){var e=K;x(a,b,c,d,e);a=a.C.Y;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var f=Math.abs(e[0]),h=Math.abs(e[1]),k=Math.abs(e[2]);e[0]=f?e[0]/f*Math.max(f,b):0;e[1]=h?e[1]/h*Math.max(h,c):0;e[2]=k?e[2]/k*Math.max(k,d):0;L.Z(u(a),L.My,a,e[0],e[1],e[2])};a.apply_velocity_world=function(a,b,c,d){a=a.C.Y;L.Z(u(a),L.My,a,b,c,d)};a.apply_force=function(a,b,c,d,e){var f=K;e?(f[0]=b,f[1]=c,f[2]=d):x(a,b,c,d,f);a=a.C.Y;L.Z(u(a),L.kG,a,f[0],f[1],f[2])};a.apply_torque=function(a,b,c,d){var e=K;x(a,b,c,d,
e);a=a.C.Y;L.Z(u(a),L.mG,a,e[0],e[1],e[2])};a.set_character_move_dir=function(a,b,c){a=a.C.Y;L.Z(u(a),L.DG,a,b,c)};a.set_character_move_type=function(a,b){var c=a.C.Y;L.Z(u(c),L.EG,c,b)};a.set_character_walk_velocity=function(a,b){var c=a.C.Y;L.Z(u(c),L.IG,c,b)};a.set_character_run_velocity=function(a,b){var c=a.C.Y;L.Z(u(c),L.GG,c,b)};a.set_character_fly_velocity=function(a,b){var c=a.C.Y;L.Z(u(c),L.BG,c,b)};a.character_jump=function(a){a=a.C.Y;L.Z(u(a),L.oG,a)};a.character_rotation_inc=function(a,
b,c){a=a.C.Y;L.Z(u(a),L.pG,a,b,c)};a.set_character_rotation=function(a,b,c){a=a.C.Y;L.Z(u(a),L.FG,a,b,c)};a.set_character_rotation_h=function(a,b){var c=a.C.Y;L.Z(u(c),L.CG,c,b)};a.set_character_rotation_v=function(a,b){var c=a.C.Y;L.Z(u(c),L.HG,c,b)};a.append_collision_test=function(a,b,c,d){var e=a.C;if(!e.fp){for(var f=e.Y,h=0;h<e.re.length;h++)if(a=e.re[h],a.Kb==b&&a.callback==c)return;a={wu:f,Fg:d||!1,Kb:b,callback:c,hj:[],lp:[]};e.re.push(a);b=u(f);I(a,g(b),b)}};a.remove_collision_test=function(a,
b,c){a=a.C;for(var d=u(a.Y),e=g(d),h=0;h<a.re.length;h++){var k=a.re[h];if(k.Kb==b&&k.callback==c){if(f(k)){var m=ha.set(0,0,0,K);k.callback(!1,null,m,m,0)}a.re.splice(h,1);h--;for(var m=d,k=k.hj,l=e.gc.oa,n=0;n<l.length;n++)for(var p=l[n].C,t=0;t<p.re.length;t++)for(var r=p.re[t],v=0;v<r.hj.length;v++)for(var w=r.hj[v],ba=0;ba<k.length;ba++){var la=k[ba];w[0]==la[0]&&w[1]==la[1]&&(k.splice(ba,1),ba--)}k.length&&L.Z(m,L.Ly,k)}}};a.apply_collision_impulse_test=function(a,b){a.C&&a.C.ck&&G(a);var c=
a.C;L.Z(u(c.Y),L.lG,c.Y);c.ck=b};a.clear_collision_impulse_test=G;a.append_ray_test=function(a,b,c,d,e,f,h,k,m){var l;da.KC++;l=da.KC;a={id:l,Y:a?a.C.Y:0,from:new Float32Array(b),to:new Float32Array(c),Kb:d,co:r(d),gz:f,nI:h,Fg:k,Vr:m,callback:e};b=u(a.Y)||ca[0];c=g(b).gc;l=a.id;c.kj[l]=a;c.Zw.push(a);L.Z(b,L.hG,a.id,a.Y,a.from,a.to,a.co,a.gz,a.nI,a.Fg,a.Vr);return l};a.remove_ray_test=A;a.change_ray_test_from_to=function(a,b,c){var d=t(a),e=J(a).gc.kj[a];e&&!e.gz&&(e.from.set(b),e.to.set(c),L.Z(d,
L.nG,a,b,c))};a.JB=function(a){return J(a).gc.kj[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.v;c.Ul=b;h(a,c,u(a.C.Y))};a.vehicle_steer=function(a,b){var c=a.v;c.Wm=b;h(a,c,u(a.C.Y))};a.vehicle_brake=function(a,b){var c=a.v;c.Qn=b;h(a,c,u(a.C.Y))};a.is_vehicle_chassis=C;a.is_vehicle_hull=k;a.cT=F;a.xM=function(a){if(!a.ye)return!1;a=a.He.Ae;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.wM=function(a){return a.ye?"BOB"==a.He.Ae?!0:!1:
!1};a.zM=function(a){return a.Ik?"BOB"==a.Xl.Ae?!0:!1:!1};a.LB=function(a){return a.ye&&"STEERING_WHEEL"==a.He.Ae?!0:!1};a.KB=function(a){return a.ye&&"SPEEDOMETER"==a.He.Ae?!0:!1};a.MB=function(a){return a.ye&&"TACHOMETER"==a.He.Ae?!0:!1};a.get_vehicle_speed=function(a){return a.v.speed};a.fR=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.is_character=function(a){return a.is_character};
a.bT=D;a.SL=function(){return ua};a.uK=function(){for(var a=0;a<ca.length;a++)L.Z(ca[a],L.rG)};a.remove_object=function(a){if("BOUNDING"==a.C.type){var b=Ha.indexOf(a);-1==b&&N.error("Object "+a.name+" doesn't have bounding physics");delete ka[c];Ha.splice(b,1)}for(var c=a.C.Y,b=u(c),d=g(b),e=c,h=d.gc.oa,k=[],m=0;m<h.length;m++)for(var l=h[m].C,n=0;n<l.re.length;n++)for(var p=l.re[n],t=0;t<p.hj.length;t++){var r=p.hj[t],v=p.lp[t];if(r[0]==e||r[1]==e)p.hj.splice(t,1),p.lp.splice(t,1),t--,v&&!f(p)&&
(v=ha.set(0,0,0,K),p.callback(!1,null,v,v,0)),k.push(r)}k.length&&L.Z(b,L.Ly,k);a.C&&a.C.ck&&G(a);a=d.gc.oa;for(d=0;d<a.length;d++)a[d].C.Y==c&&(a.splice(d,1),d--);L.Z(b,L.xG,c)}};b4w.module.__data=function(a,q){function e(a,b){Ja[b.id]=null;Ka[b.id]=null}function d(a,b,c,d){a instanceof ArrayBuffer&&(a=da.rB(a,d));d=a.width;a=a.height;Ca.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(sb)&&c&&Ca.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){(d=b.Ng)||Ia.r("Nothing requested");X.enqueue([{id:d,type:X.AT_JSON,url:d}],function(d,f,h,k){if(d){Ca.log("%cLOAD METADATA","color: #616",k);f=Ia.KD(d.b4w_format_version);
switch(Ia.IE(f,ra.Qk)){case -1:f[0]<ra.Qk[0]?Ia.r("JSON version is too old relative to B4W engine: "+Ia.Hj(f)+", required: "+Ia.Hj(ra.Qk)+". Reexport scene with the latest B4W addon to fix it."):Ca.warn("JSON version is a bit old relative to B4W engine: "+Ia.Hj(f)+", required: "+Ia.Hj(ra.Qk)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>ra.Qk[0]?Ia.r("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
Ca.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ra.jw=f;for(var g in d)a[g]=d[g];b.zb&&(Ma=wa.ur(a.scenes));(d=a.binaries[0].binfile)?b.pz=d:(va.ft(b,"load_binaries"),va.ft(b,"prepare_bindata"));ra.is_mobile_device||va.ft(b,"mobile_media_start");ra.antialiasing&&ra.smaa||va.ft(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)g=a.b4w_export_errors[d],(b.zb&&"PRIMARY"==g.type||
"ALL"==g.type)&&Ca.PK(g.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)g=a.b4w_export_warnings[d],(b.zb&&"PRIMARY"==g.type||"ALL"==g.type)&&Ca.QK(g.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");e(b,c)}else va.Sy(b)},null,function(a){f(b,c,a)})}function g(a,b,c,d,e,h){(d=V(b.Ng)+b.pz)||Ia.r("Binary data is missing");X.enqueue([{id:d,type:X.AT_ARRAYBUFFER,
url:d}],function(d,h,k,g){d?(Ca.log("%cLOAD BINARY","color: #616",g),a.bin_data=d,d=f(d),h=Ia.KD(a.b4w_format_version),d[0]!=h[0]&&Ia.r("BIN version does not match to JSON version: "+Ia.Hj(d)+", required: "+Ia.Hj(ra.Qk)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=h[1]&&Ca.warn("BIN version does not match to JSON version: "+ +Ia.Hj(d)+", required: "+Ia.Hj(ra.Qk)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):va.Sy(b)},null,function(a){h(b,c,a)})}function l(a,
b,c,d,e){La.Rz()&&e(b,c)}function w(a,b,c,d,e){d=a.bin_data;var h=a.binaries[0],k=a.objects,g=a.meshes;a=a.actions;var m=Ia.JI();f(d);for(var l=["indices"],p=["position","texcoord","texcoord2","shade_tangs"],ba=["normal","tangent"],t=["group"],la=["color"],r=0;r<g.length;r++)for(var u=g[r].submeshes,Z=0;Z<u.length;Z++){for(var v in u[Z]){var w=u[Z][v][1];if(-1!=l.indexOf(v)){var S=u[Z][v][0]*Ia.zy+h["int"]+12,q=u[Z],F=v,z=d;if(m)var y=new Uint32Array(z,S,w);else for(var y=new Uint32Array(w),z=new DataView(z),
x=0;x<w;x++)y[x]=z.getUint32(S+x*Ia.zy,!0);q[F]=y}else if(-1!=p.indexOf(v))S=u[Z][v][0]*Ia.ni+h["float"]+12,u[Z][v]=n(d,S,w,m);else if(-1!=ba.indexOf(v)){S=u[Z][v][0]*Ia.yn+h["short"]+12;q=u[Z];F=v;z=d;y=new Float32Array(w);z=new DataView(z);for(x=0;x<w;x++)y[x]=z.getInt16(S+x*Ia.yn,!0)/32767;q[F]=y}else if(-1!=t.indexOf(v)){S=u[Z][v][0]*Ia.yn+h.ushort+12;q=u[Z];F=v;z=d;y=new Float32Array(w);z=new DataView(z);for(x=0;x<w;x++)y[x]=z.getUint16(S+x*Ia.yn,!0)/65535;q[F]=y}else if(-1!=la.indexOf(v)){S=
u[Z][v][0]*Ia.Rt+h.uchar+12;q=u[Z];F=v;z=d;y=new Float32Array(w);z=new DataView(z);for(x=0;x<w;x++)y[x]=z.getUint8(S+x*Ia.Rt,!0)/255;q[F]=y}}w=u[Z];if(g[r].b4w_shape_keys.length)for(S=w.base_length,q=w.normal.length/S/3,w.tbn_quat=Ia.gen_tbn_quats(w.normal.subarray(0,3*S),w.tangent.subarray(0,4*S),new Float32Array(w.normal.length/3*4)),F=1;F<q;F++)for(z=F*S,y=0;y<S;y++){var C=w.normal.subarray(3*y,3*(y+1)),x=Qa.add(w.normal.subarray(3*(z+y),3*(z+y+1)),C,mb);if(w.tangent.length){var A=w.tangent.subarray(4*
y,4*(y+1)),D=ga.add(w.tangent.subarray(4*(z+y),4*(z+y+1)),A,dc),C=Ia.mB(C,A,Na),x=Ia.mB(x,D,lb);sa.invert(C,Na);x=sa.multiply(x,C,Na)}else x=sa.rotationTo(C,x,Na);w.tbn_quat.set(x,4*(z+y))}else w.tbn_quat=Ia.gen_tbn_quats(w.normal,w.tangent)}for(v=0;v<k.length;v++)for(g=k[v].particle_systems,l=0;l<g.length;l++)p=g[l],p.transforms=n(d,p.transforms[0]*Ia.ni+h["float"]+12,p.transforms[1],m);for(k=0;k<a.length;k++){v=a[k];g=v.fcurves;l=v.frame_range;ba=l[0];t=l[1];la=ca.DL(ba,t);l=null;0>la&&(la=0);var u=
r=!1,wa;for(wa in g)r|=-1<wa.indexOf("rotation_euler"),u|=-1<wa.indexOf("rotation_quaternion");p=[];for(wa in g)if(r&&u&&-1<wa.indexOf("rotation_euler"))delete g[wa];else{var Z=g[wa],O;for(O in Z)w=Z[O],S=n(d,h["float"]+w.bin_data_pos[0]*Ia.ni+12,w.bin_data_pos[1],m),q=new Float32Array(la),null===l&&(l=new Int8Array(la)),ca.LH(w,S,q,l,ba,t),w.Pe=q;-1<wa.indexOf("rotation_euler")&&(ca.WK(g[wa]),p.push(wa))}for(ba=0;ba<p.length;ba++)t=p[ba],la=t.replace("euler","quaternion"),g[la]=g[t],delete g[t];
v.aH=l}e(b,c)}function f(a){new Uint8Array(a,0,4);var b=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];return[b,a]}function n(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+e*Ia.ni,!0)}return d}function r(a,b,c,d,e){var f=a.cameras,h=a.groups,k=a.materials,g=a.meshes,l=a.node_groups,n=a.objects,ba=a.particles,t=a.scenes,r=a.speakers,w=a.lamps,q=a.textures,F=a.worlds;l||(Ca.warn('"node_groups" datablock undefined. reexport main scene.'),
l=a.node_groups=[]);for(var z="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),y={},x=0;x<z.length;x++)for(var C=a[z[x]],A=0;A<C.length;A++){var D=C[A];y[D.uuid]=D}for(var O=0;O<t.length;O++){for(var ga=t[O],K=ga.objects,oa=0;oa<K.length;oa++)G(K,oa,y);ga.camera&&G(ga,"camera",y);ga.world&&G(ga,"world",y)}for(O=0;O<h.length;O++)for(var E=h[O].objects,oa=0;oa<E.length;oa++)G(E,oa,y);for(O=0;O<n.length;O++){var H=
n[O];H.dupli_group&&G(H,"dupli_group",y);H.parent&&G(H,"parent",y);H.dg_parent&&G(H,"dg_parent",y);if(H.animation_data){var L=H.animation_data;L.action&&G(L,"action",y);if(L.nla_tracks)for(oa=0;oa<L.nla_tracks.length;oa++)for(var xa=L.nla_tracks[oa],da=0;da<xa.strips.length;da++)xa.strips[da].action&&G(xa.strips[da],"action",y)}switch(H.type){case "MESH":H.data||Ia.r("mesh not found for object "+H.name);G(H,"data",y);for(var T=!1,N=H.modifiers,oa=0;oa<N.length;oa++){var J=N[oa];"ARMATURE"==J.type?
(T&&Ca.warn('Object "'+H.name+'" has more than one armature modifiers. Only the first one will be used.'),T=!0,G(J,"object",y)):"CURVE"==J.type&&G(J,"object",y)}var I=H.particle_systems;if(I)for(oa=0;oa<I.length;oa++)G(I[oa],"settings",y);break;case "ARMATURE":G(H,"data",y);for(var rb=H.pose.bones,qa=H.data.bones,oa=0;oa<rb.length;oa++){var Qa=rb[oa];Qa.bone=qa[Qa.bone];var U=Qa.constraints;if(U)for(da=0;da<U.length;da++){var ta=U[da];ta.target&&G(ta,"target",y)}for(var W=Qa.parent_recursive,da=0;da<
W.length;da++)W[da]=rb[W[da]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":G(H,"data",y)}if(U=H.constraints)for(oa=0;oa<U.length;oa++)ta=U[oa],ta.target&&G(ta,"target",y);var Ba=H.lod_levels;if(Ba)for(oa=0;oa<Ba.length;oa++){var fa=Ba[oa];fa.object&&G(fa,"object",y)}}for(O=0;O<g.length;O++)for(var R=g[O].materials,oa=0;oa<R.length;oa++)G(R,oa,y);for(O=0;O<k.length;O++){for(var La=k[O],Nb=La.texture_slots,oa=0;oa<Nb.length;oa++)G(Nb[oa],"texture",y);var Fa=La.node_tree;Fa&&B(Fa,y)}for(O=
0;O<l.length;O++)(Fa=l[O].node_tree)&&B(Fa,y);for(O=0;O<q.length;O++){var ia=q[O],sa=ia.type;"IMAGE"!=sa&&"ENVIRONMENT_MAP"!=sa||G(ia,"image",y)}for(O=0;O<f.length;O++){var aa=f[O];aa.dof_object&&G(aa,"dof_object",y)}for(O=0;O<r.length;O++){var ha=r[O];ha.sound&&G(ha,"sound",y);if(ha.animation_data&&(L=ha.animation_data,L.action&&G(L,"action",y),L.nla_tracks))for(oa=0;oa<L.nla_tracks.length;oa++)for(xa=L.nla_tracks[oa],da=0;da<xa.strips.length;da++)xa.strips[da].action&&G(xa.strips[da],"action",y)}for(O=
0;O<ba.length;O++){for(var P=ba[O],Nb=P.texture_slots,oa=0;oa<Nb.length;oa++)G(Nb[oa],"texture",y);P.dupli_group&&G(P,"dupli_group",y);P.dupli_object&&G(P,"dupli_object",y)}for(O=0;O<w.length;O++){var X=w[O];if(X.animation_data&&(L=X.animation_data,L.action&&G(L,"action",y),L.nla_tracks))for(oa=0;oa<L.nla_tracks.length;oa++)for(xa=L.nla_tracks[oa],da=0;da<xa.strips.length;da++)xa.strips[da].action&&G(xa.strips[da],"action",y)}for(O=0;O<F.length;O++){var Ja=F[O];if(Nb=Ja.texture_slots)for(oa=0;oa<
Nb.length;oa++)G(Nb[oa],"texture",y);if(Ja.animation_data&&(L=Ja.animation_data,L.action&&G(L,"action",y),L.nla_tracks))for(oa=0;oa<L.nla_tracks.length;oa++)for(xa=L.nla_tracks[oa],da=0;da<xa.strips.length;da++)xa.strips[da].action&&G(xa.strips[da],"action",y)}S.FI(a);var ma=a.materials;if((Q.dv||Q.Rs)&&ra.vE)for(var V=0;V<ma.length;V++){for(var sb=ma[V],za=sb.texture_slots,pa=0;pa<za.length;pa++){var ua=za[pa],Y=ua.texture;if("IMAGE"==Y.type||"ENVIRONMENT_MAP"==Y.type){var ka=Y.image;ka.Uc||(-1<
ka.filepath.indexOf(".dds")?ka.Uc=!0:(ka.Uc=!Y.b4w_disable_compression&&!ua.use_map_normal&&"ENVIRONMENT_MAP"!=Y.type&&!Y.b4w_shore_dist_map&&"MOVIE"!=ka.source,u(ka)))}}var va=sb.node_tree;if(va)for(var Ga=va.nodes,pa=0;pa<Ga.length;pa++){var cb=Ga[pa];if("TEXTURE"==cb.type){var ea=cb.texture;if(ea&&(ka=ea.image)&&!ka.Uc){var Na;if(Na=!ea.b4w_disable_compression&&"MOVIE"!=ka.source&&"ENVIRONMENT_MAP"!=ea.type){var Ea;a:{for(var na=cb.outputs,Aa=0;Aa<na.length;Aa++){var Ra=na[Aa];if(Ra.is_linked&&
"Normal"==Ra.identifier){Ea=!0;break a}}Ea=!1}Na=!Ea}ka.Uc=Na;u(ka)}}else"TEX_IMAGE"==cb.type?(ka=cb.image)&&!ka.Uc&&(ka.Uc="MOVIE"!=ka.source,u(ka)):"TEX_ENVIRONMENT"==cb.type&&(ka=cb.image)&&!ka.Uc&&(ka.Uc=!1,u(ka))}}else for(var Ha=a.images,mb=0;mb<Ha.length;mb++){var lb=Ha[mb];lb.Uc=Boolean("FILE"==lb.source&&-1<lb.filepath.indexOf(".dds")&&".dds"==ra.jo)}for(var Vb=a.textures,Wa=b.zb?a.scenes[0].b4w_anisotropic_filtering:Ma.b4w_anisotropic_filtering,Oa=0;Oa<Vb.length;Oa++)b.zb||"SCENE"!=Vb[Oa].b4w_source_type||
(Vb[Oa].b4w_source_id=""),la.hK(Vb[Oa],Wa,a.scenes,b.id);for(var dc={},xb=a.objects,eb=0;eb<xb.length;eb++){var ac=xb[eb];if("MESH"===ac.type&&!ac.particle_systems.length)for(var Sb=ac.data,Ob=Sb.name,Pc=Sb.submeshes,Qc=Sb.materials,Tb=0;Tb<Pc.length;Tb++)0!==Pc[Tb].base_length||dc[Ob]||(Qc[Tb]&&Ca.warn('material "'+Qc[Tb].name+'" is not assigned to any face (object "'+ac.name+'").'),dc[Ob]=!0)}for(var jc=a.meshes,Eb=0;Eb<jc.length;Eb++){var Bc=jc[Eb];Bc.materials.length||Bc.uv_textures.length&&Ca.warn('mesh "'+
Bc.name+'" has a UV map but has no exported material.')}a.materials.push(S.xJ());for(var Fb=a.meshes,Rc=Ia.keysearch("name","DEFAULT",a.materials),kc=0;kc<Fb.length;kc++){var Hc=Fb[kc];0==Hc.materials.length&&Hc.materials.push(Rc)}for(var qb=a.actions,Ic=b.id,lc=0;lc<qb.length;lc++){var Gb=qb[lc];Gb.bH=Ic;ca.lH(Gb)}for(var Hb=a.scenes,Cc=0;Cc<Hb.length;Cc++){for(var ib=Hb[Cc],bb=[],mc=[],Jc=Hb[Cc].objects,Ib=0;Ib<Jc.length;Ib++){var Xc=Jc[Ib];M(Jc,Xc,null,bb,mc);var Yc=Xc.dupli_group;if(Yc)for(var ed=
Yc.objects,Pb=0;Pb<ed.length;Pb++)M(ed,ed[Pb],Xc,bb,mc)}for(Ib=0;Ib<mc.length;Ib++)for(var jd=mc[Ib],qd=[ib],ld=0;ld<qd.length;ld++){for(var rd=qd[ld].objects,sd=0;sd<rd.length;sd++){var xd=rd[sd].dupli_group;if(xd){var yd=xd.objects,sc=yd.indexOf(jd);-1<sc&&yd.splice(sc,1)}}var sc=rd.indexOf(jd);-1<sc&&rd.splice(sc,1)}for(Ib=0;Ib<bb.length;Ib++)Ia.HH(bb[Ib][0],bb[Ib][1])}!b.zb&&1<a.scenes.length&&(a.scenes=[wa.ur(a.scenes)],Ca.warn("loading data contains multiple scenes.","Only the first one will be loaded."));
var md=b.zb?Ma:wa.ur(a.scenes);Z.NO(Ma.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(Ma),1),a.scenes.unshift(Ma));for(var td=0;td<a.scenes.length;td++){var Dc=a.scenes[td];Dc.q={};Dc.Qy=Dc==md;Dc.dH=b.zb;Sa.enabled&&Dc.b4w_enable_physics&&(b.zb||!ya.Ws(Ma)&&Dc==wa.ur(a))&&ya.sM(Dc)}for(var Zc=0;Zc<a.scenes.length;Zc++){for(var nd=a.scenes[Zc],ud=v(nd),vd=0;vd<ud.length;vd++){var Kc=ud[vd];ja.GI(Kc,nd,a)&&(Kc.Vc||(Kc.Vc=[]),Kc.Vc.push(b.zb?nd:Ma))}for(var Qd=ud,Cd=0;Cd<Qd.length;Cd++){var zd=
Qd[Cd];if(zd.Vc&&"WORLD"!=zd.type)for(var Rd=zd.particle_systems,Dd=0;Dd<Rd.length;Dd++){var Ad=Rd[Dd].settings;if("HAIR"==Ad.type)if("OBJECT"==Ad.render_type){var Bd=Ad.dupli_object;Bd.Vc||(Bd.Vc=zd.Vc.slice())}else if("GROUP"==Ad.render_type)for(var Sd=Ad.dupli_group,Ed=0;Ed<Sd.objects.length;Ed++)Bd=Sd.objects[Ed],Bd.Vc||(Bd.Vc=zd.Vc.slice())}}}for(var Td=a.scenes,Fd=[],Ub=0;Ub<Td.length;Ub++)m(Td[Ub].objects,0,b.zb,Fd);Ka[b.id]=[];for(Ub=0;Ub<Fd.length;Ub++)for(var Ud=Fd[Ub],od=0;od<Ud.length;od++)for(var Vd=
Ud[od],Gd=0;Gd<Vd.length;Gd++)Ka[b.id].push(Vd[Gd]);for(var Hd=a.particles,Ub=0;Ub<Hd.length;Ub++){var wd=Hd[Ub].dupli_object;wd&&(wd.Py=!0,Ka[b.id].push(wd));var Wd=Hd[Ub].dupli_group;if(Wd)for(var Xd=Wd.objects,od=0;od<Xd.length;od++)wd=Xd[od],wd.Py=!0,Ka[b.id].push(wd)}for(var Id=Ka[b.id],Ub=Id.length-1;0<=Ub;Ub--)Id[Ub].Vc||Id.splice(Ub,1);for(var Yd=Ka[b.id],Zc=0;Zc<Yd.length;Zc++)if(Kc=Yd[Zc],!b.zb&&Kc.parent&&-1<tc.indexOf(Kc.parent.type)&&(Kc.parent=""),"MESH"==Kc.type){var Jd=S.KH(Kc);Jd&&
(a.meshes.push(Jd),Kc.data=Jd)}for(var Kd=0;Kd<a.scenes.length;Kd++){var Zd=a.scenes[Kd],Ld=Zd.world;Ld.Vc||(Ld.Vc=[]);Ld.Vc.push(b.zb?Zd:Ma)}for(var Md=0;Md<a.scenes.length;Md++){var Nd=a.scenes[Md];if(Nd.b4w_use_logic_editor){var $d=v(Nd);S.PH($d,Nd)}}for(var Od=0;Od<a.scenes.length;Od++){var ae=a.scenes[Od],Pd=b.zb?ae:Ma;Boolean(p(b.id,Pd,"SPEAKER").length)&&!Pd.Bc&&Da.UH(Pd)}e(b,c)}function v(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);c(a.objects,"ALL",b);return b}function c(a,
b,d){for(var e=0;e<a.length;e++){var f=a[e];"ALL"!=b&&b!=f.type||d.push(f);(f=f.dupli_group)&&c(f.objects,b,d)}}function m(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var h=a[f],k=pa(h);e[k]=e[k]||[];(c||-1==tc.indexOf(h.type))&&-1==e[k].indexOf(h)&&e[k].push(h);(h=h.dupli_group)&&m(h.objects,b+1,c,d)}}function p(a,b,c){var d=[];a=Ka[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==c||"ALL"==c)for(var h=0;h<f.Vc.length;h++)b==f.Vc[h]&&d.push(f)}return d}function y(a,b,c,d,e){var f=
Ka[b.id],h=a.worlds;d=b.id;for(var k=0;k<f.length;k++){for(var g=f[k],m=ta.mo(g.name,g.type,g.origin_name),l=0;l<g.Vc.length;l++)ta.Gn(m,g.Vc[l]);g.Ka=m;ja.Cj(g,m);m.k.Fd=d;m.Xo=g.Py||!1}for(d=0;d<h.length;d++){k=h[d];g="%meta_world%"+k.name;g=ta.mo(g,"WORLD",g);for(m=0;m<k.Vc.length;m++)ta.Gn(g,k.Vc[m]);k.Ka=g;ja.GQ(k,g)}d=ja.get_all_objects(b.id);for(k=0;k<f.length;k++)g=f[k],m=g.Ka,Y.Cj(g,m);for(k=0;k<h.length;k++)g=h[k],Y.Cj(g,g.Ka);if(b.zb)for(h=b.id,k=0;k<a.scenes.length;k++)for(var g=a.scenes[k],
m=0,l=ja.Gb(g,"LAMP",h),n=0;n<l.length;n++)ta.ea(l[n],g).Nk=m++;for(k=0;k<f.length;k++)g=f[k],m=g.Ka,m.Xo||(ja.uQ(g,m),rb.B(m));for(a=0;a<f.length;a++)if(h=f[a],k=h.Ka,ta.is_mesh(k)&&(g=h.lod_levels.length))for(m=k,l=0;l<g;l++)if(n=h.lod_levels[l].object){n=n.Ka;n.k.Xi=k.k.Xi;m.k.Tg=h.lod_levels[l].distance;n.k.Pk=h.lod_levels[l].distance;if(h.lod_levels[l+1])n.k.Tg=h.lod_levels[l+1].distance;else{n.k.Tg=ta.bu;break}m=n}else{m.k.Tg=h.lod_levels[l].distance;break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==
a.type&&(h=a.Jq)){var h=h.k,k=a.k.vh,g=[],p;for(p in k)m=k[p],g.push(4*m.ev,4*m.xi);h.ss.push(g);h.Pm.push(a.k)}f=p=-1;a=ca.fB();for(h=0;h<d.length;h++)k=d[h],g=k.k,ta.is_mesh(k)&&g.Vi&&(k=g.gg,k>p&&(p=k),a>=k&&k>f&&(f=k));for(h=0;h<d.length;h++)k=d[h],g=k.k,ta.is_mesh(k)&&g.Vi&&(g.uk=!0,p<a?g.gg=p:g.gg<=a?g.gg=f:(Ca.warn('too many bones for "'+k.name+'" / '+g.gg+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),g.gg=p,g.uk=!1),g.uk=g.uk&&!Nb.NA);
for(p=0;p<d.length;p++)if(f=d[p],f.ye)if(a=f.He,"CHASSIS"==a.Ae){f.v={};f.v.Go=a.Go;f.v.Rn=a.Rn;f.v.Hx=a.Hx;f.v.Jx=a.Jx;f.v.Ix=a.Ix;f.v.qy=a.qy;f.v.gx=a.gx;f.v.ow=a.ow;f.v.Ul=0;f.v.Qn=1;f.v.Wm=0;f.v.speed=0;f.v.Yk=[];f.v.vp=[];f.v.Ym=null;k=(h=ta.get_dg_parent(f))?ta.Bv(h,d):d;for(h=0;h<k.length;h++)g=k[h],g.ye&&(m=g.He,ya.xM(g)&&a.name==m.name?(m=ya.fR(g.He.Ae),f.v.Yk[m]=g,f.v.vp[m]=new Float32Array(8)):ya.LB(g)&&a.name==m.name?(f.v.Ym=g,f.v.Xm=m.Xm,f.v.Rp=m.Rp,f.v.Vo=m.Vo,m=xa.invert(f.k.n,xa.create()),
g=xa.multiply(m,g.k.n,m),f.v.JD=g,m=new Float32Array([1,0,0]),xa.transform_dir_vec3(m,g,m),f.v.ID=m):ya.KB(g)&&a.name==m.name?(f.v.yx=g,f.v.Pp=m.Pp,f.v.sm=m.sm,m=xa.invert(f.k.n,xa.create()),g=xa.multiply(m,g.k.n,m),f.v.DD=g,m=new Float32Array([1,0,0]),xa.transform_dir_vec3(m,g,m),f.v.CD=m):ya.MB(g)&&a.name==m.name&&(f.v.Kx=g,f.v.so=m.so,m=xa.invert(f.k.n,xa.create()),g=xa.multiply(m,g.k.n,m),f.v.VD=g,m=new Float32Array([1,0,0]),xa.transform_dir_vec3(m,g,m),f.v.UD=m));4!=f.v.Yk.length&&Ia.r("Not enough wheels for chassis "+
f.name)}else if("HULL"==a.Ae)for(f.v={},f.v.Yk=[],f.v.vp=[],f.v.Go=a.Go,f.v.Rn=a.Rn,f.v.rk=a.rk,f.v.rl=a.rl,f.v.sl=a.sl,f.v.Ul=0,f.v.Qn=1,f.v.Wm=0,f.v.speed=0,f.v.Ym=null,k=(h=ta.get_dg_parent(f))?ta.Bv(h,d):d,h=0;h<k.length;h++)g=k[h],g.ye&&(m=g.He,ya.wM(g)&&a.name==m.name?(f.v.Yk.push(g),f.v.vp.push(new Float32Array(8))):ya.LB(g)&&a.name==m.name?(f.v.Ym=g,f.v.Xm=m.Xm,f.v.Rp=m.Rp,f.v.Vo=m.Vo,m=xa.invert(f.k.n,xa.create()),g=xa.multiply(m,g.k.n,m),f.v.JD=g,m=new Float32Array([1,0,0]),xa.transform_dir_vec3(m,
g,m),f.v.ID=m):ya.KB(g)&&a.name==m.name?(f.v.yx=g,f.v.Pp=m.Pp,f.v.sm=m.sm,m=xa.invert(f.k.n,xa.create()),g=xa.multiply(m,g.k.n,m),f.v.DD=g,m=new Float32Array([1,0,0]),xa.transform_dir_vec3(m,g,m),f.v.CD=m):ya.MB(g)&&a.name==m.name&&(f.v.Kx=g,f.v.so=m.so,m=xa.invert(f.k.n,xa.create()),g=xa.multiply(m,g.k.n,m),f.v.VD=g,m=new Float32Array([1,0,0]),xa.transform_dir_vec3(m,g,m),f.v.UD=m));for(p=0;p<d.length;p++)if(f=d[p],f.Ik&&(a=f.Xl,"MAIN_BODY"==a.Ae))for(f.sf={},f.sf.rk=a.rk,f.sf.rl=a.rl,f.sf.sl=a.sl,
f.sf.Qq=[],h=(h=ta.get_dg_parent(f))?ta.Bv(h,d):d,k=0;k<h.length;k++)g=h[k],g.Ik&&(m=g.Xl,ya.zM(g)&&a.name==m.name&&(f.sf.Qq.push(g),g.vz=g.Xl.TD));e(b,c)}function E(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];f.ri=f.camera.Ka}for(d=0;d<a.scenes.length;d++){var f=b.zb?a.scenes[d]:Ma,h=b.zb?ja.Gb(f,"LAMP",b.id):ja.Gb(f,"LAMP",0),k=ja.Gb(f,"ALL",b.id),g=p(b.id,f,"MESH"),m=p(b.id,f,"EMPTY");p(b.id,f,"WORLD");b.zb&&wa.tH(f,k,h,g,m);for(var k=!1,l=0;l<m.length;l++)for(var n=m[l].Ka,ba=
n.G,t=0;t<ba.length;t++){var la=ba[t].mb,r=wa.oE(la,n);f.name==la.name&&(k=k||r)}b.zb&&f.q.xc&&!k&&Ca.warn('Scene "'+f.name+'" has water but has no wind. Using default settings.');m=[];wa.set_active(f);ka.xL(f,g,h,m);l=p(b.id,f,"LINE");ka.wL(f,l);n=wa.Fv(f);if(b.zb){k=f.q.gt;l=f.world;if(k.OC||k.procedural_skydome)ba=l.Ka,ka.yH(f,k,ba),ka.Su(ba,n,f);wa.TA(f,n);(k=f.q.sn)&&k.bq&&ka.pH(f,l.Ka)}for(l=0;l<g.length;l++)ka.Su(g[l].Ka,n,f);for(l=0;l<m.length;l++)ka.Su(m[l],n,f),ja.FN(m[l]);k=ja.Gb(f,"ALL",
b.id);wa.QH(f,k,h);for(l=0;l<k.length;l++)n=k[l],n.k.je&&ja.update_boundings(n),ta.MI(n)&&(n.jC=!0)}wa.uH(Ma,a.textures,b.id);b.zb&&Ma.q.on.length&&(b.Rv=!0);e(b,c)}function u(a){a.Uc?(a.Cq=ra.jo,a.filepath="dds"==ra.jo?a.filepath+".dds":X.Sm(a.filepath)[0]+".pvr"):a.Cq=""}function z(a,b,c,d,e){d=a.groups;for(var f=a.objects,h={},k={},g={},m={},l=0;l<d.length;l++){var n=d[l];h[n.uuid]=n;g[n.uuid]=n}for(l=0;l<f.length;l++)n=f[l],k[n.uuid]=n,m[n.uuid]=n;a=a.scenes;for(l=0;l<a.length;l++)x(a[l].objects,
null,m,g,null);for(var p in g)p in h||d.push(g[p]);for(p in m)p in k||f.push(m[p]);e(b,c)}function x(a,b,c,d,e){for(var f=[],h=0;h<a.length;h++){var k=a[h],g=c[k.uuid];if(k=g.proxy){b&&-1==f.indexOf(k.uuid)&&f.push(k.uuid);for(var m=c[k.uuid],l=m.constraints,k=0;k<l.length;k++){var n=Ia.yh(l[k]);n.name+="_CLONE";g.constraints.push(n)}"b4w_proxy_inherit_anim"in g&&!g.b4w_proxy_inherit_anim||(g.animation_data&&(m.animation_data=Ia.yh(g.animation_data)),m.b4w_use_default_animation=g.b4w_use_default_animation,
m.b4w_auto_skel_anim=g.b4w_auto_skel_anim,m.b4w_anim_behavior=g.b4w_anim_behavior,m.b4w_cyclic_animation=g.b4w_cyclic_animation)}}for(h=0;h<f.length;h++)g=Ia.XL(a,f[h]),-1<g&&a.splice(g,1);f={};if(b)for(h=0;h<a.length;h++)k=a[h],g=c[k.uuid],l=Ia.yh(g),m="origin_name"in g?g.origin_name:g.name,l.name=ta.SA(b.name,m),l.origin_name=m,l.dg_parent={uuid:b.uuid},I(l),c[l.uuid]=l,f[k.uuid]=l.uuid,k.uuid=l.uuid,e&&e[g.uuid]&&(l.b4w_cluster_data=e[g.uuid]);for(h=0;h<a.length;h++)k=a[h],g=c[k.uuid],g.dupli_group&&
(k=g.dupli_group,e=d[k.uuid],l=Ia.yh(e),l.name=Ia.Vp(e.name+"_CLONE"),l.uuid=P.wB("Group"+l.name),d[l.uuid]=l,k.uuid=l.uuid,x(l.objects,g,c,d,g.b4w_cluster_data));if(b)for(h=0;h<a.length;h++){k=a[h];g=c[k.uuid];g.parent&&g.parent.uuid in f?g.parent.uuid=f[g.parent.uuid]:g.parent&&(Ca.warn("Object's \""+g.name+'" parent is not in dupli group. Disabling parenting.'),g.parent=null);l=g.constraints;for(k=0;k<l.length;k++)b=l[k],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=g.pose)for(d=
b.bones,k=0;k<d.length;k++)if(e=d[k].constraints)for(l=0;l<e.length;l++)b=e[l],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=g.modifiers;for(k=0;k<b.length;k++)d=b[k],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((g=g.lod_levels)&&g.length)for(k=0;k<g.length;k++)b=g[k],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var p in f)Ga[p]=f[p]}function I(a){a.uuid=P.wB("Object"+a.name)}function B(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=
c[d];"TEXTURE"==e.type&&e.texture&&G(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in Ga&&(e.lamp.uuid=Ga[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&G(e,"node_group",b);"TEX_IMAGE"!=e.type&&"TEX_ENVIRONMENT"!=e.type||!e.image||G(e,"image",b);"BSDF_GLOSSY"==e.type&&(a.cH=!0)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];A(f,"from_node",c);A(f,"to_node",c);J(f,"from_socket",f.from_node.outputs);J(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&
G(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&G(e.strips[f],"action",b)}function G(a,b,c){(c=c[a[b].uuid])||Ca.error("Dangling link found:",b,a);a[b]=c}function A(a,b,c){c=Ia.keysearch("name",a[b].name,c);a[b]=c}function J(a,b,c){c=Ia.keysearch("identifier",a[b].identifier,c);a[b]=c}function t(a,b,c,e,f,h){e=V(b.Ng);for(var k=[],g={},m=la.XA(),l=0;l<m.length;l++){var n=m[l],p=n.Ri;if(p){var ba=Ia.ip(e+n.Qi),t=n.gm;
if("FILE"===t){var t=n.fm?X.AT_ARRAYBUFFER:X.AT_IMAGE_ELEMENT,r=X.Sm(ba),u=r[1].toLowerCase();if(!X.LI(u)){Ca.error("image ",n.Dk," has unsupported format.");continue}Q.sw&&ra.use_min50&&("dds"==r[1]?(ba=X.Sm(r[0]),ba=ba[0]+".min50."+ba[1]+".dds"):ba=r[0]+".min50."+r[1])}else if("MOVIE"===t)if(ra.Hp)r=X.Sm(ba),ba=r[0]+".altconv.seq",t=X.lq;else{r=X.Sm(ba);u=r[1].toLowerCase();t=Da.detect_video_container(u);if(""==t){Ca.error("failed to load video file (unsupported format)",ba);continue}ba=t!=u?r[0]+
".altconv."+t:r[0]+"."+r[1];t=X.mq}else{Ca.error('Image "'+n.Dk+'" has unsupported format "'+t+'".');continue}r=!1;p in g?t in g[p]?r=!0:g[p][t]=[]:(g[p]={},t in g[p]||(g[p][t]=[]));g[p][t].push(n);r||k.push({id:p,type:t,url:ba})}}if(k.length){var Z=0;X.enqueue(k,function(e,f,m,l){if(e){f=g[f][m];for(var n=0;n<f.length;n++){var p=f[n],t=p.Qi;if(m==X.lq)p.Fp=e.bg,la.yt(p,e.images,"",t,b.id);else if(la.yt(p,e,p.Ck,t,b.id),"ENVIRONMENT_MAP"==p.source)for(p=0;p<a.scenes.length;p++)wa.ey(a.scenes[p])}m==
X.mq||m==X.lq?(m==X.mq?(m=e.videoWidth,e=e.videoHeight):(m=e.images[0].width,e=e.images[0].height),Ca.log("%cLOAD VIDEO "+m+"x"+e,"color: #"+(2048<m||2048<e?"a00":1024<m||1024<e?"aa0":"0a0"),l),-1==l.indexOf(sb)&&Ca.warn("video",l,"is not from app root.")):d(e,l,!0,f[0].Ck)}l=++Z/k.length;h(b,c,l)},function(){Ca.log("%cLOADED ALL IMAGES","color: #0a0");f(b,c)})}else f(b,c)}function h(a,b,c,d,e){a=wa.Hv();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var h=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&
(h=!1);Y.zQ(f,h,b.id)}}e(b,c)}function C(a,b,c,d,e,f){a=V(b.Ng);var h=[],g={};d=ja.get_all_objects(b.id);for(var m=0;m<d.length;m++){var l=d[m];if(k(l)){var n=l.S.ji;"BACKGROUND_MUSIC"==Da.Iv(l)?(n=Ia.xv(),b.Pv=!0):"NONE"!=Da.Iv(l)&&ra.Tv&&(b.Sv=!0);if(!(n in g)){g[n]=[];var p=Ia.ip(a+l.S.Ng);switch(Da.BD(l)){case Da.Qt:var t=X.AT_AUDIOBUFFER;break;case Da.uy:t=X.AT_AUDIO_ELEMENT}var ba=X.Sm(p),la=ba[1].toLowerCase(),r=Da.detect_audio_container(la);""!=r?(p=r!=la?ba[0]+".altconv."+r:ba[0]+"."+ba[1],
h.push({id:n,type:t,url:p})):Ca.error("failed to load audio file (unsupported format)",p)}g[n].push(l)}}if(h.length){var u=0;X.enqueue(h,function(a,d,e,k){if(a)for(Ca.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(sb)&&Ca.warn("sound",k,"is not from app root."),d=g[d],e=0;e<d.length;e++)Da.EQ(d[e],a);a=++u/h.length;f(b,c,a)},function(){Ca.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)})}else e(b,c)}function k(a){return ta.is_speaker(a)&&Da.BD(a)!=Da.vy}function F(a,b,c){a=ja.Gb(a,"SPEAKER",b);
for(b=0;b<a.length;b++){var d=a[b];ta.is_speaker(d)&&(Da.vM(d)||c)&&Da.play_def(d)}}function D(a,b){for(var c=a.q.on,d=0;d<c.length;d++){var e=c[d].q;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=e.vg||(la.reset_video(e.name,b),la.play_video(e.name,b))}}function aa(a,b,c,d,e){Y.start();Ca.log("%cSTART NLA","color: #0a0");e(b,c)}function M(a,b,c,d,e){if(b.lod_levels&&b.lod_levels.length)for(var f=b.lod_levels.length,h=0;h<f;h++){var k=b.lod_levels[h],g=k.object;if(g){var m=Ia.ao(g);
m.name=b.name+"_LOD_"+String(h+1);m.b4w_cluster_data=b.b4w_cluster_data;I(m);m.lod_levels=[];c&&(m.dg_parent=c);d.push([a,m]);e.push(g);k.object=m}}}function L(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!ya.QI(a.scenes[f])){d=!1;break}d&&(e(b,c),Ca.log("%cPHYSICS READY","color: #0a0"))}function T(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.zb)var h=ya.Ws(f);else h=ya.Ws(Ma)||ya.Ws(f),f=Ma;if(Sa.enabled&&h)for(h=0;h<xb.length;h++)for(var k=ja.Gb(f,xb[h],b.id),g=0;g<k.length;g++){var m=
k[g];m.k.Fd==b.id&&(ya.append_object(m,f),b.YB&&ya.ka(m)&&ya.disable_simulation(m))}}e(b,c)}function N(a,b,c,e,f){var h={};e=[];for(var k=a.scenes,g=0;g<a.scenes.length;g++){var m=k[g];if(m.q.xc){var l=m.q.xc.sj;if(l&&"FILE"===l.source){var m=l.uuid,n=Ia.ip(V(b.Ng)+l.filepath);e.push({id:m,type:l.Uc?X.AT_ARRAYBUFFER:X.AT_IMAGE_ELEMENT,url:n});h[m]=l}}}e.length?X.enqueue(e,function(a,c,e,f){if(a){d(a,f,!0);e=[];f=la.XA();for(var g=0;g<f.length;g++){var m=f[g];m.uri===c&&e.push(m)}for(c=0;c<e.length;c++)f=
e[c],g=f.Ng,m="",l.Uc&&(m=-1!=g.indexOf(".dds")?"dds":"pvr"),la.yt(f,a,m,g,b.id);for(c=0;c<k.length;c++)if(e=k[c],e.q.xc&&(f=e.q.xc.sj,f===l)){var m=a,n=document.createElement("canvas");f=l.size[0];g=l.size[1];n.width=f;n.height=g;n=n.getContext("2d");n.drawImage(m,0,0);m=n.getImageData(0,0,f,g).data;n=new Float32Array(4);n[0]=1/16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;f*=g;for(var g=new Float32Array(f),p=0;p<f;p++)g[p]=n[1]*m[4*p+2]+n[2]*m[4*p+3];e.q.sx=g}}else for(a=h[c],c=0;c<k.length;c++)e=k[c],
f=e.q.xc.sj,f===a&&(e.q.xc.sj=null,Ca.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,c)}):f(b,c)}function U(a,b,c,e,f){e=a.scenes[0];a=[];for(var h=[ba.uq,ba.zn,ba.vq,ba.du],k=0;k<h.length;k++){var g=wa.Ja(e,h[k]);g&&a.push(g)}if(a.length){e=[];k=X.AT_IMAGE_ELEMENT;e.push({id:"SEARCH_TEXTURE",type:k,Ng:Ha.be.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:k,url:Ha.be.smaa_area_texture_path});for(k=0;k<a.length;k++)if(h=a[k],h.type==ba.zn){a=h.Qa;
for(k=0;k<a.length;k++)if(h=a[k],"u_search_tex"==h.to)var m=h.Xa;else if("u_area_tex"==h.to)var l=h.Xa;break}e.length?X.enqueue(e,function(a,c,e,f){a&&(d(a,f,!1),c="SEARCH_TEXTURE"==c?m:l,c.source="IMAGE",la.yt(c,a,-1!=f.indexOf(".dds")?1:0,f,b.id),la.mx(c,la.I,la.I))},function(){f(b,c)}):f(b,c)}else f(b,c)}function O(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];b.zb||(e=Ma);for(var f=ja.Gb(e,"LAMP",b.id),h=0;h<f.length;h++){var k=f[h];k.k.Fd==b.id&&d.ku.push({mb:e,obj:k})}f=ja.Gb(e,
"ALL",b.id);for(h=0;h<f.length;h++)k=f[h],"LAMP"!=k.type&&k.k.Fd==b.id&&(b.YB&&ta.is_mesh(k)&&wa.Vn(k,!0),d.ku.push({mb:e,obj:k}))}}function qa(a,b,c,d,e,f){var h=d.ku;e=d.pC;if(h.length){a=h[e].obj;var k=h[e].mb;e=ta.ea(a,k);wa.append_object(k,a,!1);!a.anchor||k.q.Ro||k.q.anaglyph_use||ua.append(a);d=++d.pC/h.length;h=e.Bh;if(-1!=a.k.te&&h){var g=Qa.copy(a.k.Da.D,mb);wa.nE(h,g)}h=a.Bp;if(h.length&&k.q.$g)for(k=xa.get_trans_view(a.k.n),a=xa.get_quat_view(a.k.n),e=e.Xg,g=0;g<e.length;g++)wa.pE(e[g],
k,a),ta.qE(h,e[g].p.Xb)}else d=1;f(b,c,d)}function fa(a,b,c,d,e){if(b.zb){d=wa.Ak();wa.ey(d);var f=wa.Hv();for(a=0;a<f.length;a++){var h=f[a];wa.ey(h);wa.$N(h,d)}wa.set_active(d)}else wa.rE(Ma);d=ja.get_all_objects(b.id);ja.vQ(d);for(f=0;f<d.length;f++)for(h=d[f],a=0;a<h.G.length;a++)for(var k=h.G[a].T,g=0;g<k.length;g++)null==k[g].nb&&k.splice(g--,1);e(b,c)}function W(a,b,c,d,e){if(b.zb)for(a=wa.Hv(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&na.qM(f,b.id)}e(b,c)}function R(a,b,c,d,e){if(b.zb)for(d=
0;d<a.scenes.length;d++)D(a.scenes[d],b.id),F(a.scenes[d],b.id,!1);else D(Ma,b.id),F(Ma,b.id,!1);e(b,c)}function ha(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;ra.media_auto_activation&&(b.Rv||b.Pv||b.Sv)?Ra||H(a,e,b,c):e(b,c)}function H(a,b,c,d){var e=Oa.parentElement;cb=e.style.zIndex;e.style.zIndex="999";Ra=document.createElement("div");Ra.style.position="relative";Ra.style.height="88px";Ra.style.width="88px";var f=Math.round(Oa.offsetWidth/2-44);Ra.style.top=Math.round(Oa.offsetHeight/
2-44).toString()+"px";Ra.style.left=f.toString()+"px";Ra.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
Ra.style.backgroundSize="88px";Wa=document.createElement("div");Wa.style.position="relative";Wa.style.height=Oa.offsetHeight.toString()+"px";Wa.style.width=Oa.offsetWidth.toString()+"px";Wa.style.background="rgba(0, 0, 0, 0.5)";Wa.style.zIndex="999";e.appendChild(Wa);Wa.appendChild(Ra);Ra.addEventListener("click",function(){c.Rv&&(la.play(),la.pause(),la.reset());if(c.Pv){if(c.zb)for(var e=0;e<a.scenes.length;e++)F(a.scenes[e],c.id,!0);else F(Ma,c.id,!0);Da.pause()}c.Sv&&Da.BC();ma();b(c,d)},!1)}
function ma(){if(Ra){var a=Oa.parentElement;a.style.zIndex=cb;Wa.removeChild(Ra);a.removeChild(Wa);Ra=Wa=null;cb=0}}function V(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ia(a){ca.is_animated(a)&&ca.remove(a);ea.gO(a);ja.clear_outline_anim(a);Ea.check_sensor_manifold(a)&&Ea.remove_sensor_manifold(a);ya.ka(a)&&ya.remove_object(a);wa.hO(a);ta.is_speaker(a)&&Da.wP(a);ua.is_anchor(a)&&ua.remove(a)}function pa(a){var b=ca.$A(a);return(a=b&&b.parent==a?null:a.parent||b)?1+pa(a):
0}var ua=q("__anchors"),ca=q("__animation"),X=q("__assets"),ka=q("__batch"),Ha=q("__config"),Ea=q("__controls"),da=q("__texcomp"),K=q("__debug"),Ba=q("__extensions"),za=q("__input"),va=q("__loader"),P=q("__md5"),Y=q("__nla"),na=q("__logic_nodes"),ea=q("__particles"),Aa=q("__nodemat"),ja=q("__objects"),ta=q("__obj_util"),ya=q("__physics"),Ca=q("__print"),sa=q("__quat"),S=q("__reformer"),oa=q("__renderer"),wa=q("__scenes"),Da=q("__sfx"),La=q("__shaders"),ba=q("__subscene"),la=q("__textures"),Z=q("__time"),
rb=q("__transform"),xa=q("__tsr"),Ia=q("__util"),Qa=q("__vec3"),ga=q("__vec4"),Nb=Ha.Rj,ra=Ha.A,Q=Ha.pd,Sa=Ha.C,Fa=Ha.S,Ja=null,Ka=null,sb="",Ma=null,Ga={},mb=new Float32Array(3),dc=new Float32Array(4),Na=new Float32Array(4),lb=new Float32Array(4),Ra=null,Wa=null,cb=0,Vb=!1,tc=["LAMP","CAMERA"],xb=["MESH","CAMERA","EMPTY"],Oa=null;a.is_primary_loaded=function(a){return va.is_primary_loaded(a)};a.update=function(){va.AQ(Ja)};a.hP=function(a){Oa=a};a.sQ=function(a,b){if(Ra){Wa.style.height=b.toString()+
"px";Wa.style.width=a.toString()+"px";var c=Math.round(a/2-44);Ra.style.top=Math.round(b/2-44).toString()+"px";Ra.style.left=c.toString()+"px"}};a.load=function(a,c,d,f,k){var m={load_main:{Rb:va.Mj,Zb:!1,J:[],ec:!1,fc:500,vc:!1,ic:b},duplicate_objects:{Rb:va.Sd,Zb:!1,J:["load_main"],ec:!1,fc:50,vc:!1,ic:z},load_binaries:{Rb:va.Mj,Zb:!1,J:["load_main"],ec:!1,fc:500,vc:!1,ic:g},wait_for_shaders:{Rb:va.Sd,Zb:!1,J:[],ec:!1,fc:50,vc:!0,Ai:l},prepare_bindata:{Rb:va.Sd,Zb:!1,J:["duplicate_objects","load_binaries"],
ec:!1,fc:100,vc:!1,ic:w},prepare_bpy_data:{Rb:va.Sd,Zb:!1,J:["duplicate_objects","prepare_bindata"],ec:!1,fc:100,vc:!1,ic:r},process_objects:{Rb:va.Sd,Zb:!1,J:["prepare_bpy_data"],ec:!1,fc:150,vc:!1,ic:y},process_scenes:{Rb:va.Sd,Zb:!1,J:["process_objects","wait_for_shaders"],ec:!1,fc:300,vc:!1,ic:E},load_smaa_textures:{Rb:va.Mj,Zb:!1,J:["process_scenes"],ec:!1,fc:30,vc:!0,ic:U},load_shoremap:{Rb:va.Mj,Zb:!1,J:["process_scenes"],ec:!1,fc:30,vc:!0,ic:N},load_images:{Rb:va.Mj,Zb:!0,J:["process_scenes"],
ec:!0,fc:500,vc:!1,ic:t},update_scenes_nla:{Rb:va.Sd,Zb:!1,J:["process_scenes","load_images"],ec:!1,fc:50,vc:!1,ic:h},wait_physics_workers:{Rb:va.Sd,Zb:!1,J:["load_shoremap"],ec:!1,fc:20,vc:!1,Ai:L},add_physics_objects:{Rb:va.Sd,Zb:!1,J:["wait_physics_workers"],ec:!1,fc:50,vc:!1,ic:T},add_objects:{Rb:va.Sd,Zb:!1,J:["add_physics_objects"],ec:!1,fc:600,vc:!1,ic:O,Ai:qa,Tn:fa,Un:{ku:[],pC:0}},init_logic_nodes:{Rb:va.Sd,Zb:!1,J:["update_scenes_nla","add_objects"],ec:!1,fc:50,vc:!1,ic:W},load_speakers:{Rb:va.Mj,
Zb:!0,J:["add_objects"],ec:!0,fc:100,vc:!1,ic:C},mobile_media_start:{Rb:va.Sd,Zb:!1,J:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],ec:!0,fc:5,vc:!1,ic:ha,Ai:ha},synchronize_media:{Rb:va.Sd,Zb:!0,J:["mobile_media_start"],ec:!0,fc:50,vc:!1,ic:R},start_nla:{Rb:va.Sd,Zb:!0,J:["mobile_media_start"],ec:!1,fc:5,vc:!0,ic:aa}},n=va.lB();n||(n=va.EJ(),Ja={},Ka={},Ga={});Ja[n.hh.length]={};return va.iK(m,a,c,d,e,f||Fa.fz,ra.do_not_load_resources,k)};a.unload=function(a){var b=va.lB();
if(!b||!b.hh.length||a&&!va.PP(b.hh[a]))Ca.error("Unable to unload data!");else{if(0==a)Ca.log("%cUNLOAD ALL","color: #00a"),ua.cleanup(),ca.cleanup(),Da.cleanup(),ka.cleanup(),wa.cleanup(),va.cleanup(),Ea.cleanup(),ya.cleanup(),ja.cleanup(),Ia.cleanup(),oa.cleanup(),Aa.cleanup(),La.cleanup(),Ba.cleanup(),X.cleanup(),la.cleanup(),na.cleanup(),ea.cleanup(),za.cleanup(),K.cleanup(),Ka=null,Ga={},Ja=Ma=null,Vb=!1;else{Ca.log("%cUNLOAD DATA "+a,"color: #00a");ca.eO(a);for(var b=ja.get_all_objects(ja.DATA_ID_ALL),
c=0;c<b.length;c++){var d=b[c];ta.get_object_data_id(d)!=a&&ja.Ds(d,!1,!1,!1,!1)}b=ja.get_all_objects(a);for(c=b.length-1;0<=c;c--)d=b[c],ia(d),ja.remove_object(d);b=ja.get_all_objects(ja.DATA_ID_ALL);for(c=0;c<b.length;c++)ja.Ds(b[c],!0,!0,!0,!0)}Y.cleanup(a);ma()}};a.ZN=ia;a.set_debug_resources_root=function(a){sb=a};a.activate_media=function(){Vb||ra.media_auto_activation||(la.play(),la.pause(),la.reset(),F(Ma,ja.DATA_ID_ALL,!0),Da.pause(),ra.Tv&&Da.BC(),Vb=!0)};a.reset=function(){Oa=null}};b4w.module.__batch=function(a,q){function e(a){a={type:a,ub:"",id:0,Cp:0,bk:-1,Uh:"",hr:-1,Ol:-1,po:0,Ue:0,kk:[],X:[],dd:[],lc:[],Ci:[],ki:null,Ic:{},nb:null,tb:{ug:null,Ye:null,Gi:[],ig:[],status:K.gu,eL:0,UQ:0,ez:0,ZD:0},bj:"",Kn:[],ha:null,ke:Y.Fi(),je:!1,Dh:!1,ir:!1,num_vertices:0,num_triangles:0,fs:0,gs:0,Ir:0,Po:0,Hd:new Float32Array(3),Xd:new Float32Array(16),Pf:!1,yb:!1,Na:!1,xg:!1,Jb:!1,ie:!1,ve:!1,Dd:!1,kd:!1,cd:!1,$c:!1,Qc:!1,Pc:!1,rc:!1,lr:!1,Xf:P.wl,Ke:!1,uf:!1,Or:!1,Sr:0,Pr:0,Tr:0,Ur:0,
Rr:new Float32Array(3),Qr:new Float32Array(3),Qo:!1,Qf:0,Yf:0,Kg:1,reflect_factor:0,bi:0,Np:1,parallax_scale:0,Jg:0,Bg:1,Bs:0,ep:0,Df:0,Vs:0,wd:new Float32Array(2),Nd:new Float32Array(3),fh:new Float32Array(3),Jf:new Float32Array(3),ud:new Float32Array(4),Ze:new Float32Array(4),Mk:null,om:null,$o:null,Zo:null,Oi:!1,wireframe_edge_color:na.create(),mh:!1,water_dynamic:!1,qn:!1,Lt:!1,Mt:0,Nt:0,Kt:0,Kj:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,xr:new Float32Array(2),wr:new Float32Array(2),
Eo:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),Sh:null,mj:!1,Va:null,qm:0,Pj:null,np:null,Rh:[],ff:[],ae:[],ef:[],K:null,ga:null,da:null,Da:null,sa:null,O:null,Fe:!1,rd:!0,AB:0,Am:new Float32Array(3)};a.ud[3]=1;a.Na=!0;a.qm=1;return a}function d(a){var b=e(a.type);b.ub=a.ub;b.id=a.id;b.Cp=a.Cp;b.bk=a.bk;b.Uh=a.Uh;b.hr=a.hr;b.Ol=a.Ol;b.po=a.po;b.Ue=a.Ue;b.kk=[];b.X=a.X.slice();b.dd=a.dd.slice();b.lc=a.lc.slice();b.Ci=a.Ci.slice();b.ki=Y.P(a.ki);b.Ic=
Y.P(a.Ic);b.nb=a.nb;b.tb=Y.P(a.tb);b.bj=a.bj;b.Kn=Ea.ZI(a.Kn);b.ha=a.ha;b.je=a.je;b.Dh=a.Dh;b.ir=a.ir;b.num_vertices=a.num_vertices;b.num_triangles=a.num_triangles;b.fs=a.fs;b.gs=a.gs;b.Ir=a.Ir;b.Po=a.Po;b.Hd=a.Hd;b.Xd=a.Xd;b.Pf=a.Pf;b.yb=a.yb;b.Na=a.Na;b.xg=a.xg;b.Jb=a.Jb;b.ie=a.ie;b.ve=a.ve;b.Dd=a.Dd;b.kd=a.kd;b.cd=a.cd;b.$c=a.$c;b.Qc=a.Qc;b.Pc=a.Pc;b.rc=a.rc;b.lr=a.lr;b.Xf=a.Xf;b.Ke=a.Ke;b.uf=a.uf;b.Or=a.Or;b.Sr=a.Sr;b.Pr=a.Pr;b.Tr=a.Tr;b.Ur=a.Ur;na.copy(a.Rr,b.Rr);na.copy(a.Qr,b.Qr);b.Qo=a.Qo;
b.Qf=a.Qf;b.Yf=a.Yf;b.Kg=a.Kg;b.reflect_factor=a.reflect_factor;b.bi=a.bi;b.Np=a.Np;b.parallax_scale=a.parallax_scale;b.Jg=a.Jg;b.Bg=a.Bg;b.Bs=a.Bs;b.ep=a.ep;b.Df=a.Df;b.Vs=a.Vs;b.wd[0]=a.wd[0];b.wd[1]=a.wd[1];na.copy(a.Nd,b.Nd);na.copy(a.fh,b.fh);na.copy(a.Jf,b.Jf);ea.copy(a.ud,b.ud);ea.copy(a.Ze,b.Ze);b.Mk=Y.P(a.Mk);a.om&&(b.om=new Float32Array(a.om),b.$o=new Float32Array(a.$o),b.Zo=new Float32Array(a.Zo));b.Oi=a.Oi;na.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.mh=a.mh;b.water_dynamic=
a.water_dynamic;b.qn=a.qn;b.Lt=a.Lt;b.Mt=a.Mt;b.Nt=a.Nt;b.Kt=a.Kt;b.Kj=a.Kj;b.shallow_water_col_fac=a.shallow_water_col_fac;b.shore_water_col_fac=a.shore_water_col_fac;b.foam_factor=a.foam_factor;b.xr.set(a.xr);b.wr.set(a.wr);b.Eo.set(a.Eo);na.copy(a.shallow_water_col,b.shallow_water_col);na.copy(a.shore_water_col,b.shore_water_col);b.Sh=Y.P(a.Sh);b.mj=a.mj;b.Va=Y.P(a.Va);b.qm=a.qm;a.Pj&&(b.Pj=new Float32Array(a.Pj));b.np=Y.P(a.np);b.Rh=Y.P(a.Rh);b.ff=Y.P(a.ff);b.ae=Y.P(a.ae);b.ef=Y.P(a.ef);b.K=R.Il(a.K);
b.ga=R.Il(a.ga);b.O=R.$n(a.O);b.sa=R.$n(a.sa);b.da=R.ak(a.da);b.Da=R.ak(a.Da);b.Fe=a.Fe;b.rd=a.rd;b.Am=a.Am;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.ub=a.yb?a.xg?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.ub=a.kd?"CAST":"RECEIVE";break;case "COLOR_ID":a.ub=a.xg?"COLOR_ID_XRAY":"COLOR_ID"}}function g(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],h=e.Ka.k,k=R.Wc();R.Ei(h.vi,k);var g=e.data.b4w_boundings,m=g.bc_rad,l=g.bs_rad,n=g.bs_cen,p=g.be_ax,t=g.caxis_x,
r=g.caxis_y,u=g.caxis_z,g=g.be_cen;h.Re&&(t=Math.max(Math.abs(k.max_x),Math.abs(k.min_x)),r=Math.max(Math.abs(k.max_y),Math.abs(k.min_y)),u=Math.max(Math.abs(k.max_z),Math.abs(k.min_z)),u=Math.sqrt(t*t+r*r+u*u),t=Math.sqrt(t*t+r*r),k.max_x=k.max_y=k.max_z=u,k.min_x=k.min_y=k.min_z=-u,m=t,l=u,n[0]=n[1]=n[2]=0,t=[u,0,0],r=[0,u,0],u=[0,0,u],p[0]=p[1]=p[2]=1,g[0]=g[1]=g[2]=0);R.yi(k,h.n,h.ga);f(h,m,m,k);n=R.Rq(l,Y.f32(n));R.Hl(n,h.n,h.Da);g=R.On(t,r,u,g);na.scale(g.za,p[0],g.za);na.scale(g.Aa,p[1],g.Aa);
na.scale(g.Ba,p[2],g.Ba);R.Gl(g,h.n,h.sa);h.K=k;h.da=n;h.O=g;c.push.apply(c,w(e,h,b))}return c}function l(a,b){for(var c=[],d=[],e={},f=0;f<a.length;f++){var h=a[f],k=h.Ka.k,g=R.Wc();R.Ei(k.vi,g);var m=R.yi(g,k.n),l=h.data.b4w_boundings,n=R.Rq(l.bs_rad,Y.f32(l.bs_cen)),p=R.Hl(n,k.n),t=l.be_ax,t=R.On([t[0],0,0],[0,t[1],0],[0,0,t[2]],l.be_cen),r=R.Gl(t,k.n),u=l.rbb,l=R.uO(u.rbb_c,l.caxis_x,l.caxis_y,l.caxis_z,u.rbb_s),u=R.yu(l,k.n);k.K=g;k.ga=m;k.da=n;k.Da=p;k.O=t;k.sa=r;k.qd=l;k.iz=u;g={};g.Dd=k.Dd;
g.kd=k.kd;g.cd=k.cd;g.ah=k.ah;g.Dm=k.Dm;g.nc=k.nc;g.Cm=k.Cm;g.$c=k.$c;g.Qc=k.Qc;g.Pc=k.Pc;g.te=k.te;g.ce=k.ce;g.hf=k.hf;g.Sf=k.Sf;g.Qd=k.Qd;g.fg=k.fg;g.td=k.td;g.Re=k.Re;g.Wj=k.Wj;g.Vj=k.Vj;g.rc=k.rc;g.Eh=k.Eh;g.Rl=k.Rl;g.ve=k.ve;g.bk=h.b4w_cluster_data.cluster_id;g.Tg=k.Tg;g.Pk=k.Pk;g.Xi=k.Xi;g.Hi=k.Hi;k=JSON.stringify(g);e[k]=e[k]||[];e[k].push(h)}for(var v in e){g=JSON.parse(v);delete g.bk;var h=e[v],k=ua.Kl("STATIC"),S;for(S in g)k[S]=g[S];k.Fd=a[0].Ka.k.Fd;k.Mf=0;k.wg=0;k.Wf=0;k.Vf=0;k.Rf=0;
k.hide=!1;for(f=0;f<h.length;f++)g=h[f].Ka,0==f?(R.Ei(g.k.ga,k.ga),R.Zq(g.k.Da,k.Da)):(R.rr(k.ga,g.k.ga),R.CA(k.Da,g.k.Da));k.sa=R.Se();k.O=R.Se();R.Ei(k.ga,k.K);R.Zq(k.Da,k.da);d.push({k:k,jI:h})}for(e=0;e<d.length;e++)for(f=d[e].k,v=d[e].jI,S=0;S<v.length;S++){h=v[S];k=h.Ka.k;g=w(h,f,b);m=va.create();k.Re&&!k.Pn?(n=va.get_trans_view(k.n),va.set_trans(n,m)):va.copy(k.n,m);n={};if(f.Qd||f.Re)n.au_center_pos=[m[0],m[1],m[2]];f.Qd&&(n.au_wind_bending_amp=[k.Mf],n.au_wind_bending_freq=[h.b4w_wind_bending_freq],
n.au_detail_bending_amp=[h.b4w_detail_bending_amp],n.au_detail_bending_freq=[h.b4w_detail_bending_freq],n.au_branch_bending_amp=[h.b4w_branch_bending_amp]);for(p=0;p<g.length;p++)l=g[p].k,t=g[p].Ee,r=g[p].qa,l.jm?t.cf||(l.Re?P.JP(t,m):P.ot(t,m)):("COLOR_ID"==r.type&&(g[p].k=k,r.Uh=h.uuid,J(r,k),l=L(k),M(r,l)),t=P.ot(t,m),P.IP(t,n));c.push.apply(c,g)}return c}function w(a,b,c){var d=[],f=n(c,b,!b.Hi,!1),h=L(b),g=a.data,m=g.materials,l=Array(m.length),p=Array(m.length),t=[],u=da.Pb(c,Ba.Bb),v=!1;u&&
(v=u.cp.length?!0:!1);for(var w=0;w<f.length;w++)for(var S=f[w],q=0;q<m.length;q++){var F=m[q];if(!P.vB(g,q))if("PHYSICS"==S&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)t.push(P.tv(g,q,[],b.vh,{},null));else if(!F.b4w_lens_flares||v){var z=e(S);"MAIN"==S?l[q]=z:"DEBUG_VIEW"==S&&(p[q]=z);z.bk=a.b4w_cluster_data.cluster_id;if(aa(z,F)){"SHADOW"==S&&l[q]&&(z.ie=l[q].ie);z.Xf=b.je||b.ve?P.pq:P.wl;J(z,b);for(var y=z,x=a.particle_systems,A=0;A<x.length;A++){var O=x[A].settings.b4w_vcol_from_name,wa=
x[A].settings.b4w_vcol_to_name;""!==O&&""!==wa&&(y.Ic[O]={zk:!1,src:[{name:O,zf:7}]})}"DYNAMIC"==b.type&&(z.Uh=a.uuid);M(z,h);var oa=P.tv(g,q,z.Ci,b.vh,z.Ic,z.ki);!F.use_tangent_shading||"a_shade_tangs"in oa.V[0]||(k(z,"CALC_TBN",1),C(z,"a_tbn_quat"));F.b4w_lens_flares&&(oa=ca.YN(oa));d.push({qa:z,Ee:oa,$d:[F.name],k:b,fe:[a]})}}}if(t.length){z=e("PHYSICS");z.ub="NAVMESH";z.Uh=a.uuid;M(z,h);for(var oa=P.OD(t),E=[],w=0;w<m.length;w++)E.push(m[w].name);d.push({qa:z,Ee:oa,$d:E,k:b,fe:[a]})}for(w=0;w<
p.length;w++)p[w]&&(p[w].Ol=l[w].id,M(p[w],p[w].Cp));var G=a.particle_systems;if(0<G.length&&d.length){for(var B=!1,T=!1,w=0;w<G.length;w++){var N=G[w],I=N.settings;I.use_render_emitter&&(B=!0);"HAIR"!=I.type||"OBJECT"!=I.render_type&&"GROUP"!=I.render_type&&N.transforms.length||(T=!0);if(B&&T)break}var Da=d[0].qa.Ic,qa;if(T){var U;if(1<m.length){for(var Ca={},ta=0;ta<G.length;ta++){var W=G[ta].settings;if("HAIR"==W.type&&("OBJECT"==W.render_type||"GROUP"==W.render_type)){var fa=W.b4w_vcol_from_name,
ya=W.b4w_vcol_to_name;""!==fa&&""!==ya&&(Ca[fa]=Y.P(Da[fa]))}}"a_bending_col_main"in Da&&(Ca.a_bending_col_main=Y.P(Da.a_bending_col_main));"a_bending_col_detail"in Da&&(Ca.a_bending_col_detail=Y.P(Da.a_bending_col_detail));U=P.GA(g,[],Ca)}else U=d[0].Ee;qa=U}else qa=null;for(var R=qa,La=a.Ka,ia=[],sa=a.particle_systems,ha=a.data,X=0;X<sa.length;X++){var ma=sa[X],V=ma.settings;if(V.count)if("EMITTER"==V.type){if("DYNAMIC"==b.type){var pa=e("PARTICLES");pa.da=b.da;pa.K=b.K;pa.O=b.O;pa.Da=b.Da;pa.ga=
b.ga;pa.sa=b.sa;var za,ka=ha.materials,ea=ma.settings.material-1;ea>=ka.length&&(H.warn('Wrong material used for rendering particle system "'+ma.name+'"'),ea=0);za=ka[ea];"HALO"===ma.settings.render_type&&"HALO"===za.type&&(pa.Qo=!0);r(pa,za);var ja=pa,Ea=a,nc=ma.settings;switch(nc.b4w_billboard_align){case "VIEW":k(ja,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":k(ja,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":k(ja,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":k(ja,
"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:Y.r("Wrong billboard align value")}k(ja,"BILLBOARD",0);var Vc=nc.b4w_enable_soft_particles&&ua.Pz(Ea,nc);k(ja,"SOFT_PARTICLES",0<nc.b4w_particles_softness&&Vc&&Aa.kr?1:0);k(ja,"SOFT_STRENGTH",K.F(nc.b4w_particles_softness));K.aa(ja.tb,"WORLD_SPACE","WORLD"==nc.b4w_coordinate_system?1:0);pa.ve=!0;pa.Uh=La.name+"_"+V.uuid;M(pa,h);ca.rM(pa,ma,za);var Kb=ca.rL(pa,ha,ma,La.k);ca.yQ(Kb,pa,V.count);ca.xQ(La);J(pa,La.k);ia.push({qa:pa,Ee:Kb,$d:[za.name],
k:b,fe:[a]})}}else if("HAIR"==V.type){var fc=Y.Xr(ma.seed);V.b4w_dynamic_grass&&(b.Eh=!0);var yc=Ha.Qz(Aa.jw)&&!V.b4w_initial_rand_rotation&&!V.b4w_hair_billboard,jb=4;yc&&(jb=8);if(ma.transforms.length)var Xa=ma.transforms;else for(var Db=P.yv(R,V.count,!1,fc),Xa=new Float32Array(Db.length*jb),ab=0;ab<Db.length;ab++){var Fc=.75+.5*Y.Ff(fc);Xa[ab*jb]=Db[ab][0];Xa[ab*jb+1]=Db[ab][1];Xa[ab*jb+2]=Db[ab][2];Xa[ab*jb+3]=Fc;yc&&(Xa[ab*jb+4]=1,Xa[ab*jb+5]=0,Xa[ab*jb+6]=0,Xa[ab*jb+7]=0)}var Mc=da.Pb(c,Ba.qh)?
!0:!1;if("OBJECT"==V.render_type){var tb=[n(c,V.dupli_object.Ka.k,!b.Hi,!0)],oc=D(a,b,Da,R,[V.dupli_object],tb,[Xa],V,ma,Mc,fc,!1);ia.push.apply(ia,oc)}else if("GROUP"==V.render_type){for(var gc=V.dupli_group.objects,tb=[],ab=0;ab<gc.length;ab++){var hc=n(c,gc[ab].Ka.k,!b.Hi,!0);tb.push(hc)}for(var Lb=!1,Wc=[],ab=0;ab<gc.length;ab++)Wc.push(gc[ab].Ka);if(V.use_whole_group){for(var Mb,Ta=Xa,zc=Wc,bd=yc,Nc=jb,wb={},Qb=new Float32Array([0,0,0,1]),kb=0;kb<Ta.length;kb+=Nc)for(var db=0;db<zc.length;db++){var Rb=
na.create(),cd=va.get_scale(zc[db].k.n),Oc=va.get_trans_view(zc[db].k.n);na.scale(Oc,cd,Rb);var ic=na.clone([Ta[kb],Ta[kb+1],Ta[kb+2]]);wb[db]||(wb[db]=new Float32Array(Ta.length));bd&&(wb[db][kb+4]=Qb[0]=Ta[kb+4],wb[db][kb+5]=Qb[1]=Ta[kb+5],wb[db][kb+6]=Qb[2]=Ta[kb+6],wb[db][kb+7]=Qb[3]=Ta[kb+7],Y.Ww(Qb,Qb),Y.UP(Rb,Qb,Rb));na.add(ic,Rb,ic);wb[db][kb]=ic[0];wb[db][kb+1]=ic[1];wb[db][kb+2]=ic[2];wb[db][kb+3]=Ta[kb+3]}Mb=wb;Lb=!0}else{var pc;if(V.use_group_count){for(var yb=Xa,Gc=Wc,qc=V.dupli_weights,
dd=fc,Ac=yc,Xb=jb,Ua={},nb=[],Ya=0;Ya<Gc.length;Ya++)for(var Yb=Gc[Ya],$a=Yb.Sk||Yb.name,rc=0;rc<qc.length;rc++){var zb=qc[rc];$a==zb.name&&nb.push(zb)}qc.length!=nb.length&&H.error("dupli weights match failed");for(Ya=0;Ya<yb.length;Ya+=Xb){for(var Ab,Zb=nb,$b=[0],pb=0;pb<Zb.length;pb++)$b[pb+1]=$b[pb]+Zb[pb].count;for(var gb=$b[$b.length-1]*Y.Ff(dd),ub=0,pb=0;pb<$b.length;pb++)if(gb>=$b[pb]&&gb<$b[pb+1]){ub=pb;break}Ab=ub;Ua[Ab]=Ua[Ab]||[];Ua[Ab].push(yb[Ya],yb[Ya+1],yb[Ya+2],yb[Ya+3]);Ac&&Ua[Ab].push(yb[Ya+
4],yb[Ya+5],yb[Ya+6],yb[Ya+7])}for(Ab in Ua)Ua[Ab]=new Float32Array(Ua[Ab]);pc=Ua}else{for(var Bb=Xa,Pa=fc,Va=yc,ob=jb,hb=Wc.length,Za={},vb=0;vb<Bb.length;vb+=ob){var eb=Math.floor(hb*Y.Ff(Pa));Za[eb]=Za[eb]||[];Za[eb].push(Bb[vb],Bb[vb+1],Bb[vb+2],Bb[vb+3]);Va&&Za[eb].push(Bb[vb+4],Bb[vb+5],Bb[vb+6],Bb[vb+7])}for(eb in Za)Za[eb]=new Float32Array(Za[eb]);pc=Za}Mb=pc}oc=D(a,b,Da,R,gc,tb,Mb,V,ma,Mc,fc,Lb);ia.push.apply(ia,oc)}"INSTANCE"==V.b4w_wind_bend_inheritance&&La.k.Qd&&H.warn('Emitter object "'+
La.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else Y.r("Unknown particle settings type")}B?d.push.apply(d,ia):d=ia}return d}function f(a,b,c,d){a.Nn=R.lz(b,d);a.Ln=R.jz(c,d);a.Mn=R.kz(b,d)}function n(a,b,c,d){var e=[];d||(b.ah&&da.Pb(a,Ba.Le)||b.nc&&da.Pb(a,Ba.Nf))&&e.push("COLOR_ID");c&&(e.push("MAIN"),e.push("NODES_GLOW"),da.Pb(a,Ba.Me)&&e.push("DEBUG_VIEW"),da.Pb(a,Ba.Oe)&&e.push("SHADOW"),
da.Pb(a,Ba.qh)&&e.push("GRASS_MAP"));e.push("PHYSICS");if(b.kd||b.Qc)for(a=null,b.kd&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),b.Qc&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=null!==a?Y.MH(a,b):b),b=a,a=0;a<b.length;a++)c=e.indexOf(b[a]),-1!==c&&e.splice(c,1);return e}function r(a,b){var d;switch(a.type){case "MAIN":if(b.b4w_do_not_render)d=!1;else{if(b.use_nodes&&"HALO"!=b.type)z(a,b,"MAIN");else{m(a,b);d=b.game_settings.alpha_blend;a.xg=b.b4w_render_above_all&&"OPAQUE"!=
d&&"CLIP"!=d;a.Df=b.offset_z;a.fh.set([1,1,1]);var e=b.texture_slots;ea.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.ud);if(b.b4w_lens_flares){N(a,"lens_flares.glslv","lens_flares.glslf");C(a,"a_position");C(a,"a_texcoord");var f=za.Yc(e[0],null);U(a,f)}else{N(a,"main.glslv","main_stack.glslf");b.use_shadeless||(d=pa.Tu(b.uuid,b.name,{ie:b.use_shadeless,uo:b.diffuse_shader,Op:b.specular_shader,ol:b.use_tangent_shading}),a.tb.ig=pa.Xq(d));var h=p("use_map_color_diffuse",e),
g=p("use_map_color_spec",e),l=p("use_map_normal",e),n=p("use_map_mirror",e),t=p("use_stencil",e);d=h[0];g=g[0];l=l[0];n=n[0];h=h[1];e=t[0]&&p("use_rgb_to_intensity",e)[0];if(d){switch(d.blend_type){case "MIX":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}f=za.Yc(d,null);U(a,f,"u_colormap0");a.Jg=d.diffuse_color_factor;a.Bg=d.use_map_alpha?d.alpha_factor:0;a.fh.set(d.scale)}t=d&&d==g;g&&(t||(f=za.Yc(g,null),U(a,f,"u_specmap0")),
a.bi=g.specular_color_factor);if(l&&(C(a,"a_tbn_quat"),f=za.Yc(l,null),U(a,f,"u_normalmap0"),a.Bs=l.normal_factor,f=l.texture,f.b4w_use_map_parallax&&Aa.Hs)){var r=K.F(f.b4w_parallax_steps),w=K.F(f.b4w_parallax_lod_dist);k(a,"PARALLAX",1);k(a,"PARALLAX_STEPS",r);k(a,"PARALLAX_LOD_DIST",w);a.parallax_scale=f.b4w_parallax_scale}n&&(f=za.Yc(n,null),U(a,f,"u_mirrormap"),a.ep=n.mirror_factor);if(n=d&&h&&e?1:0)f=za.Yc(h,null),U(a,f,"u_colormap1"),f=za.Yc(e,null),U(a,f,"u_stencil0");(f=d||g||l)&&a.fh.set(f.scale);
k(a,"TEXTURE_SPEC",void 0==g?0:1);k(a,"ALPHA_AS_SPEC",t?1:0);k(a,"TEXTURE_STENCIL_ALPHA_MASK",n);C(a,"a_position");C(a,"a_tbn_quat");(d||g||l)&&C(a,"a_texcoord");if(b.b4w_water){a.mh=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.yb?(H.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.qn=!1):a.qn="REFLECT"!=a.ub?b.b4w_water_shore_smoothing:!1;N(a,"water.glslv","water.glslf");n=pa.Tu(b.uuid,b.name,{ie:!1,uo:b.diffuse_shader,Op:b.specular_shader,
ol:b.use_tangent_shading});a.tb.ig=pa.Xq(n);C(a,"a_position");Aa.QE?(C(a,"a_polyindex"),a.Na=!0,na.set(0,0,0,a.wireframe_edge_color),ma.Jv()?k(a,"DEBUG_WIREFRAME",1):k(a,"DEBUG_WIREFRAME",2)):k(a,"DEBUG_WIREFRAME",0);t=b.texture_slots;n=p("use_map_normal",t);f=p("use_map_mirror",t)[0];n.length&&(r=za.Yc(n[0]),U(a,r,"u_normalmap0"),a.Kj=b.b4w_water_norm_uv_velocity);k(a,"NUM_NORMALMAPS",n.length);a.Sh=Array(n.length);for(r=0;r<n.length;r++)a.Sh[r]=new Float32Array(2),a.Sh[r].set([n[r].scale[0],n[r].scale[1]]);
f&&(r=za.Yc(f),U(a,r,"u_mirrormap"),a.ep=f.mirror_factor);f=null;if(Aa.Yl)for(r=0;r<t.length;r++){var S=t[r];if(!0===S.texture.b4w_water_foam){f=S;break}}f&&(k(a,"FOAM",1),r=za.Yc(f),U(a,r,"u_foam"),a.foam_factor=b.b4w_foam_factor,a.xr.set(f.texture.b4w_foam_uv_freq),a.wr.set(f.texture.b4w_foam_uv_magnitude),a.Eo[0]=f.scale[0],a.Eo[1]=f.scale[1]);for(r=0;r<t.length;r++)if(S=t[r],!0===S.texture.b4w_shore_dist_map){var q=S;break}q&&Aa.Gq&&(q=za.Yc(q),U(a,q,"u_shore_dist_map"),k(a,"SHORE_PARAMS",1),
q=S.texture.b4w_shore_boundings,k(a,"MAX_SHORE_DIST",K.F(S.texture.b4w_max_shore_dist)),k(a,"SHORE_MAP_SIZE_X",K.F(q[0]-q[1])),k(a,"SHORE_MAP_SIZE_Y",K.F(q[2]-q[3])),k(a,"SHORE_MAP_CENTER_X",K.F((q[0]+q[1])/2)),k(a,"SHORE_MAP_CENTER_Y",K.F((q[2]+q[3])/2)));b.b4w_generated_mesh?(k(a,"GENERATED_MESH",1),a.Lt=!0,a.Mt=b.b4w_water_num_cascads,a.Nt=b.b4w_water_subdivs,a.Kt=b.b4w_water_detailed_dist):(C(a,"a_tbn_quat"),(f||n.length)&&C(a,"a_texcoord"),k(a,"GENERATED_MESH",0));if(b.b4w_water_dynamic){var S=
K.F(b.b4w_water_dst_noise_scale0),q=K.F(b.b4w_water_dst_noise_scale1),n=K.F(b.b4w_water_dst_noise_freq0),t=K.F(b.b4w_water_dst_noise_freq1),f=K.F(b.b4w_water_dir_min_shore_fac),r=K.F(b.b4w_water_dir_freq),w=K.F(b.b4w_water_dir_noise_scale),F=K.F(b.b4w_water_dir_noise_freq),x=K.F(b.b4w_water_dir_min_noise_fac),O=K.F(b.b4w_water_dst_min_fac),D=K.F(b.b4w_water_waves_hor_fac);k(a,"DST_NOISE_SCALE_0",S);k(a,"DST_NOISE_SCALE_1",q);k(a,"DST_NOISE_FREQ_0",n);k(a,"DST_NOISE_FREQ_1",t);k(a,"DIR_MIN_SHR_FAC",
f);k(a,"DIR_FREQ",r);k(a,"DIR_NOISE_SCALE",w);k(a,"DIR_NOISE_FREQ",F);k(a,"DIR_MIN_NOISE_FAC",x);k(a,"DST_MIN_FAC",O);k(a,"WAVES_HOR_FAC",D)}E(a,b);u(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;k(a,"ABSORB",K.F(b.b4w_water_absorb_factor));k(a,"SSS_STRENGTH",K.F(b.b4w_water_sss_strength));k(a,"SSS_WIDTH",K.F(b.b4w_water_sss_width))}"HALO"===b.type&&
(N(a,"halo.glslv","halo.glslf"),v(a,b),a.Ci=["a_position"]);b.use_tangent_shading&&(k(a,"USE_TBN_SHADING",1),C(a,"a_shade_tangs"));k(a,"TEXCOORD",0);k(a,"NORMAL_TEXCOORD",0);d&&c(a,d,"TEXTURE_COLOR0_CO");h&&c(a,h,"TEXTURE_COLOR1_CO");e&&c(a,e,"TEXTURE_STENCIL_ALPHA_MASK_CO");g&&c(a,g,"TEXTURE_SPEC_CO");l&&c(a,l,"TEXTURE_NORM_CO");k(a,"SHADELESS",b.use_shadeless?1:0);a.ie=b.use_shadeless}d=b.game_settings.alpha_blend;k(a,"ALPHA","OPAQUE"===d?0:1);k(a,"ALPHA_CLIP","CLIP"===d?1:0);k(a,"DOUBLE_SIDED_LIGHTING",
b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(k(a,"VERTEX_COLOR",1),C(a,"a_color")):k(a,"VERTEX_COLOR",0);a.Qf=b.ambient;a.Kg=b.diffuse_intensity;a.Yf=b.emit;a.Jf.set(b.specular_color);a.Np=b.specular_alpha;E(a,b);u(a,b);b.b4w_wettable?k(a,"WETTABLE",1):k(a,"WETTABLE",0);y(a,b);b.b4w_refractive&&!a.yb?(H.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.mj=!1):a.mj=b.b4w_refractive;a.Vs=b.b4w_refr_bump}d=!0}break;case "NODES_GLOW":d=z(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||
b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)d=!1;else if(m(a,b),a.yb)d=!1;else{g=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==g?z(a,b,"SHADOW"):N(a,"shadow.glslv","shadow.glslf");ea.set(0,0,0,b.alpha,a.ud);C(a,"a_position");C(a,"a_tbn_quat");k(a,"ALPHA","OPAQUE"===g?0:1);a.fh.set([1,1,1]);if((d=p("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===g){switch(d.blend_type){case "MIX":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.fh.set(d.scale);
k(a,"TEXTURE_COLOR",1);C(a,"a_texcoord");if("IMAGE"==d.texture.q.source||"ENVIRONMENT_MAP"==d.texture.q.source||"CANVAS"==d.texture.q.source)g=za.Yc(d),U(a,g,"u_colormap0");"NONE"==d.texture.q.source&&(g=za.Yc(d),U(a,g,"u_colormap0"))}else k(a,"TEXTURE_COLOR",0);d=!0}break;case "PHYSICS":b.b4w_collision?(a.cq=b.b4w_use_ghost,a.Kb=b.b4w_collision_id,a.eo=b.b4w_collision_margin,a.bo=b.b4w_collision_group,a.fo=b.b4w_collision_mask,a.vk=b.physics.friction,a.nk=b.physics.elasticity,d=!0):b.b4w_water?(a.mh=
!0,a.cR=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,
d=!0):d=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===b.type)d=!1;else{m(a,b);a.Ke=!1;a.Na=!0;a.yb=!1;g=b.game_settings.alpha_blend;a.xg=b.b4w_render_above_all&&"OPAQUE"!=g&&"CLIP"!=g;b.use_nodes&&"CLIP"==g?z(a,b,"COLOR_ID"):N(a,"color_id.glslv","color_id.glslf");ea.set(0,0,0,b.alpha,a.ud);C(a,"a_position");k(a,"ALPHA","OPAQUE"===g?0:1);a.fh.set([1,1,1]);d=p("use_map_color_diffuse",b.texture_slots)[0];g="CLIP"===g?1:0;k(a,"ALPHA_CLIP",g);if(d&&g){switch(d.blend_type){case "MIX":k(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.fh.set(d.scale);k(a,"TEXTURE_COLOR",1);C(a,"a_texcoord");if("IMAGE"==d.texture.q.source||"ENVIRONMENT_MAP"==d.texture.q.source)g=za.Yc(d),U(a,g,"u_colormap0");"NONE"==d.texture.q.source&&(g=za.Yc(d),U(a,g,"u_colormap0"))}else k(a,"TEXTURE_COLOR",0);d=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?d=!1:(m(a,b),a.yb=!1,a.Ke=!1,a.Na=!0,N(a,"grass_map.glslv","grass_map.glslf"),C(a,
"a_position"),d=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,g=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.Ic.a_grass_size={zk:!0,src:[]},d?(a.Ic.a_grass_size.src.push({name:d,zf:4}),k(a,"DYNAMIC_GRASS_SIZE",1)):k(a,"DYNAMIC_GRASS_SIZE",0),a.Ic.a_grass_color={zk:!0,src:[]},g?(a.Ic.a_grass_color.src.push({name:g,zf:7}),k(a,"DYNAMIC_GRASS_COLOR",1)):k(a,"DYNAMIC_GRASS_COLOR",0),d=!0);break;case "DEBUG_VIEW":d=A(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)d=!1;else{d=
b.texture_slots;if(a.Qo)N(a,"particle_system.glslv","particle_system_stack.glslf"),k(a,"HALO_PARTICLES",1),v(a,b);else{g={ie:!1,uo:b.diffuse_shader,Op:b.specular_shader,ol:b.use_tangent_shading};if(b.use_nodes){N(a,"particle_system.glslv","particle_system.glslf");z(a,b,"PARTICLES");d=!0;break a}N(a,"particle_system.glslv","particle_system_stack.glslf");g=pa.Tu(b.uuid,b.name,g);a.tb.ig=pa.Xq(g);if(d=p("use_map_color_diffuse",d)[0]){k(a,"TEXTURE_COLOR",1);switch(d.blend_type){case "MIX":k(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":k(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Jg=d.diffuse_color_factor;a.Bg=d.use_map_alpha?d.alpha_factor:0;d=za.Yc(d);U(a,d)}}ea.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.ud);a.Qf=b.ambient;a.Kg=b.diffuse_intensity;a.Yf=b.emit;a.Jf.set(b.specular_color);a.Np=b.specular_alpha;C(a,"a_position");C(a,"a_tbn_quat");d=b.game_settings.alpha_blend;k(a,"ALPHA","OPAQUE"===d?0:1);k(a,"ALPHA_CLIP","CLIP"===d?1:0);k(a,
"PARTICLES_SHADELESS",b.use_shadeless?1:0);E(a,b);u(a,b);m(a,b);d=b.game_settings.alpha_blend;a.xg=b.b4w_render_above_all&&"OPAQUE"!=d&&"CLIP"!=d;a.Df=b.offset_z;d=!0}break;default:Y.r("Wrong batch type: "+a.type)}return d}function v(a,b){var c=b.halo;k(a,"NUM_RINGS",c.ring_count);k(a,"NUM_LINES",c.line_count);k(a,"NUM_STARS",c.star_tip_count);k(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.Sr=c.size;a.Pr=c.hardness/20;a.Rr.set(c.b4w_halo_rings_color);a.Qr.set(c.b4w_halo_lines_color);a.Tr=1/b.b4w_halo_stars_blend_height;
a.Ur=b.b4w_halo_stars_min_height;a.Or=!0}function c(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":k(a,c,"TEXTURE_COORDS_UV_ORCO");k(a,"TEXCOORD",1);break;case "NORMAL":k(a,c,"TEXTURE_COORDS_NORMAL");k(a,"NORMAL_TEXCOORD",1);break;default:k(a,c,"TEXTURE_COORDS_NONE")}}function m(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.yb=!0;a.Ke=!0;a.Na=!0;a.Pf=!1;break;case "ALPHA":a.yb=!0;a.Ke=!1;a.Na=!0;a.Pf=!1;break;case "CLIP":a.yb=!1;a.Ke=!1;a.Na=!0;a.Pf=!0;break;case "ADD":a.yb=
!0;a.Ke=!1;a.Na=!1;a.Pf=!1;break;case "OPAQUE":a.yb=!1;a.Ke=!1;a.Na=!0;a.Pf=!1;break;default:Y.r("Unknown alpha blend mode: "+d)}a.Jb=c.use_backface_culling}function p(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.q&&c.push(f)}return c}function y(a,b){var c=b.raytrace_transparency;a.Ze[0]=c.fresnel;a.Ze[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.reflect_factor=c.reflect_factor;a.Ze[2]=c.fresnel;a.Ze[3]=1-c.fresnel_factor/5}function E(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=
b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:H.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Nd[0]=b.specular_intensity;a.Nd[1]=c;a.Nd[2]=d}function u(a,b){switch(b.diffuse_shader){case "LAMBERT":a.wd[0]=0;a.wd[1]=0;break;case "OREN_NAYAR":a.wd[0]=b.roughness;a.wd[1]=0;break;case "FRESNEL":a.wd[0]=
b.diffuse_fresnel;a.wd[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.wd[0]=b.darkness;a.wd[1]=0;break;case "TOON":a.wd[0]=b.diffuse_toon_size;a.wd[1]=b.diffuse_toon_smooth;break;default:H.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.wd[0]=0,a.wd[1]=0}}function z(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var d;switch(c){case "MAIN":N(a,"main.glslv","main.glslf");d=!1;break;case "GLOW":N(a,"main.glslv","main.glslf");d=!0;break;case "SHADOW":N(a,
"shadow.glslv","shadow.glslf");d=!1;break;case "COLOR_ID":N(a,"color_id.glslv","color_id.glslf"),d=!1}var e=b.node_tree;c=pa.cJ(e,b.uuid,!1,b.name,c);if(!c.Ma)return H.error('Failed to create node graph for material "'+b.name+'", disable nodes'),G(a,b),!0;a.bj=c.id;a.Oi=!0;k(a,"NODES",1);k(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);C(a,"a_position");b.use_orco_tex_coord&&C(a,"a_orco_tex_coord");m(a,b);a.Df=b.offset_z;var f=b.game_settings.alpha_blend;d?(k(a,"ALPHA",1),k(a,"ALPHA_CLIP",
0)):(k(a,"ALPHA","OPAQUE"===f?0:1),k(a,"ALPHA_CLIP","CLIP"===f?1:0));a.xg=b.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f;a.Yf=b.emit;a.Qf=b.ambient;y(a,b);b.b4w_wettable?k(a,"WETTABLE",1):k(a,"WETTABLE",0);var h=null,g=!1;V.la(c.Ma,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var e=d.data.name,f=d.data.value;a.ki||(a.ki={});a.ki[f]=e;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":e=d.data.name;a.Ic[e]={zk:!0,
src:[{name:d.data.value}]};f=0;if("GEOMETRY_VC"==d.type)f=7;else for(var m=0;m<d.Ua.length;m++){var l="RGB".indexOf(d.Ua[m].identifier);-1<l&&(f|=1<<2-l)}a.Ic[e].src[0].zf=f;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":C(a,"a_tbn_quat");break;case "TEX_COORD_OB":k(a,"USE_MODEL_TSR_INVERSE",1);break;case "TEX_COORD_WI":k(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":d.data.value.ol&&(k(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&C(a,"a_shade_tangs"));
C(a,"a_tbn_quat");g=!0;break;case "BSDF_BEGIN":g=!0;C(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":e=d.data.name;f=d.data.value;U(a,f,e);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":k(a,"CALC_TBN_SPACE",1);C(a,"a_tbn_quat");e=d.data.name;f=d.data.value;U(a,f,e);break;case "NORMAL_MAP":C(a,"a_tbn_quat");switch(Number(d.Eb[0][1])){case pa.JF:k(a,"CALC_TBN_SPACE",1);break;case pa.IF:case pa.HF:k(a,"USE_MODEL_TSR",1)}break;case "LAMP":d.data&&(a.Mk=d.data);break;case "B4W_REFRACTION":a.yb?
a.mj=!0:(a.mj=!1,H.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));k(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":h||(h=d.data.Xa);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&d.data&&(a.np=d.data);break;case "VECT_TRANSFORM":switch(Number(d.Eb[1][1])){case pa.$G:k(a,"USE_MODEL_TSR_INVERSE",1);break;case pa.ZG:k(a,"USE_VIEW_TSR",1);break;case pa.YG:k(a,"USE_MODEL_TSR",1);break;case pa.XG:k(a,"USE_MODEL_TSR",1);k(a,"USE_VIEW_TSR",1);break;
case pa.WG:k(a,"USE_VIEW_TSR_INVERSE",1);break;case pa.VG:k(a,"USE_MODEL_TSR_INVERSE",1),k(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":k(a,"USE_MODEL_TSR",1);a.Am[1]=b.pass_index;a.Am[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":k(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":k(a,"USE_VIEW_TSR_INVERSE",1);break;case "BUMP":C(a,"a_tbn_quat"),ma.Jv()?k(a,"USE_DERIVATIVES_EXT",1):H.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+
b.name+'" material.')}});h&&U(a,h,"u_nodes_texture");g||(a.ie=!0);d=a.tb.ig=pa.Xq(c.Ma);x(e,a);e=a.ff;c=a.ef;for(f=0;f<d.length;f++){var l=d[f];switch(l.id){case "VALUE":var n=l.Is[0];if(n)for(var p=0;p<e.length;p+=2)if(e[p]==n){l.Eb.push(["VALUE_IND",e[p+1]]);break}break;case "RGB":if(n=l.Is[0])for(p=0;p<c.length;p+=2)if(c[p]==n){l.Eb.push(["RGB_IND",c[p+1]]);break}}}k(a,"NUM_VALUES",a.Rh.length);k(a,"NUM_RGBS",a.ae.length);return!0}function x(a,b){var c=[],d=[],e=[],f=[];I(a,"",c,d,e,f);b.Rh=c;
b.ff=d;b.ae=e;b.ef=f}function I(a,b,c,d,e,f){for(var h=0;h<a.nodes.length;h++){var k=a.nodes[h];if("VALUE"==k.type){var g=B(b,k.name);c.push(k.outputs[0].default_value);d.push(g,d.length/2)}else"RGB"==k.type?(g=B(b,k.name),k=k.outputs[0].default_value.slice(0,3),e.push(k[0],k[1],k[2]),f.push(g,f.length/2)):"GROUP"==k.type&&I(k.node_group.node_tree,B(b,k.name),c,d,e,f)}}function B(a,b){var c;return c=(a?a+"%join%":"")+b}function G(a,b){switch(a.type){case "SHADOW":N(a,"shadow.glslv","shadow.glslf");
break;case "COLOR_ID":N(a,"color_id.glslv","color_id.glslf");break;default:N(a,"main.glslv","main_stack.glslf")}k(a,"SHADELESS",1);C(a,"a_position");C(a,"a_tbn_quat");ea.set(1,0,1,1,a.ud);if(b){var c=b.game_settings.alpha_blend;k(a,"ALPHA","OPAQUE"===c?0:1);k(a,"ALPHA_CLIP","CLIP"===c?1:0);k(a,"VERTEX_COLOR",0);a.Df=b.offset_z;m(a,b)}return!0}function A(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;N(a,"debug_view.glslv","debug_view.glslf");C(a,"a_position");C(a,"a_tbn_quat");C(a,"a_polyindex");
a.Na=!0;na.set(0,0,0,a.wireframe_edge_color);return!0}function J(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.jm?k(a,"AU_QUALIFIER","GLSL_IN"):k(a,"AU_QUALIFIER","uniform"),k(a,"STATIC_BATCH",0)):(k(a,"AU_QUALIFIER","GLSL_IN"),k(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(ma.Jv()?k(a,"WIREFRAME_QUALITY",1):k(a,"WIREFRAME_QUALITY",0),a.Dh?(k(a,"DEBUG_SPHERE",1),a.ir?k(a,"DEBUG_SPHERE_DYNAMIC",1):k(a,"DEBUG_SPHERE_DYNAMIC",0)):k(a,"DEBUG_SPHERE",0),k(a,"ALPHA",1));b.je&&(a.je=b.je);b.Qd?(""!==b.fg?
(a.Ic.a_bending_col_main={zk:!0,src:[{name:b.fg,zf:4}]},C(a,"a_bending_col_main"),""!==b.td.dw&&""!==b.td.cw&&""!==b.td.Lw?(a.Ic.a_bending_col_detail={zk:!0,src:[{name:b.td.dw,zf:4},{name:b.td.cw,zf:2},{name:b.td.Lw,zf:1}]},C(a,"a_bending_col_detail"),C(a,"a_tbn_quat"),k(a,"DETAIL_BEND",1)):k(a,"DETAIL_BEND",0),k(a,"MAIN_BEND_COL",1)):k(a,"MAIN_BEND_COL",0),k(a,"WIND_BEND",1)):k(a,"WIND_BEND",0);b.Uj?k(a,"BEND_CENTER_ONLY",1):k(a,"BEND_CENTER_ONLY",0);k(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.Pn|0);
b.Re?k(a,"BILLBOARD",1):k(a,"BILLBOARD",0);b.Re&&b.jm?k(a,"HAIR_BILLBOARD",1):k(a,"HAIR_BILLBOARD",0);b.Vj?k(a,"BILLBOARD_SPHERICAL",1):k(a,"BILLBOARD_SPHERICAL",0);switch(b.Wj){case "RANDOM":k(a,"BILLBOARD_RANDOM",1);k(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":k(a,"BILLBOARD_RANDOM",0);k(a,"BILLBOARD_JITTERED",1);break;default:k(a,"BILLBOARD_RANDOM",0),k(a,"BILLBOARD_JITTERED",0)}b.rc&&Aa.Gq?k(a,"DYNAMIC_GRASS",1):k(a,"DYNAMIC_GRASS",0);a.rc=b.rc;"PARTICLES"!=a.type&&(a.ve=b.ve);a.Dd=b.Dd;
a.kd=b.kd;a.cd=b.cd&&!a.ie&&!(a.yb&&Aa.hv);a.$c=b.$c;a.Qc=b.Qc;a.Pc=b.Pc;a.Am[0]=b.Ls;b.Vi?(C(a,"a_influence"),k(a,"SKINNED",1),Aa.et?(k(a,"DISABLE_TANGENT_SKINNING",1),k(a,"FRAMES_BLENDING",0)):(k(a,"DISABLE_TANGENT_SKINNING",0),b.uk?k(a,"FRAMES_BLENDING",1):k(a,"FRAMES_BLENDING",0)),k(a,"MAX_BONES",b.gg)):(k(a,"SKINNED",0),k(a,"FRAMES_BLENDING",0),k(a,"DISABLE_TANGENT_SKINNING",0));b.Hc?(k(a,"VERTEX_ANIM",1),Aa.JE?k(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):k(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):
k(a,"VERTEX_ANIM",0);b.Vi&&b.Hc&&Y.r("Skinning and vertex animation are mutually exlusive");b.Rl?k(a,"DISABLE_FOG",1):k(a,"DISABLE_FOG",0)}}function t(a,b,c){if(b.length){for(var d=ua.Er(b,Aa.ssao&&c.b4w_enable_ssao),e=a.tb,f=a.Mk,k=0,g=0;g<a.tb.ig.length;g++){var m=a.tb.ig[g];if("LIGHTING_LAMP"==m.id){var l=b[k++%b.length],n=l.$a;"AREA"==n.type&&(l=b[k++%b.length],n=l.$a);var p=ua.ea(l,c);if("SPOT"==n.type||"POINT"==n.type)var t=Math.cos(n.fl/2);if("SPOT"==n.type)var r=n.Qp*(1-t);l=d.indexOf(l);
m.Eb=[["LAMP_TYPE",n.type],["LAMP_IND",p.Nk],["LAMP_SPOT_SIZE",K.F(t||.01)],["LAMP_SPOT_BLEND",K.F(r||.01)],["LAMP_LIGHT_DIST",K.F(n.distance)],["LAMP_USE_SPHERE",n.hy?1:0],["LAMP_SHADOW_MAP_IND",l]]}else if("LAMP"==m.id&&f)for(var p=m.Eb[0][1],u=0;u<b.length;u++)if(l=b[u],f[l.ji]==p){n=l.$a;if("SPOT"==n.type||"POINT"==n.type)t=Math.cos(n.fl/2);"SPOT"==n.type&&(r=n.Qp*(1-t));m.Eb.push(["LAMP_TYPE",n.type],["LAMP_SPOT_SIZE",K.F(t||.01)],["LAMP_SPOT_BLEND",K.F(r||.01)],["LAMP_LIGHT_DIST",K.F(n.distance)],
["LAMP_USE_SPHERE",n.hy?1:0])}}if(f){c=0;for(var v in f)c++;a.om=new Float32Array(3*c);a.$o=new Float32Array(3*c);a.Zo=new Float32Array(3*c);K.aa(e,"NUM_LAMP_LIGHTS",c);for(g=0;g<b.length;g++)h(a,b[g])}}}function h(a,b){if(b.ji in a.Mk){var c=a.Mk[b.ji],d=va.get_trans_view(b.k.n);a.om.set(d,3*c);a.$o.set(b.$a.direction,3*c);a.Zo.set(b.$a.ho,3*c)}}function C(a,b){var c=a.Ci;-1==c.indexOf(b)&&c.push(b);a.Ci=c.sort()}function k(a,b,c){K.aa(a.tb,b,c)}function F(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.ub?
a.ha=P.PD(b,P.wl,[]):(0<b.Wa.length&&P.KP(b,b.V[0]),a.Ee=b);else{var c=a.Xf;a.Or&&"PARTICLES"!=a.type&&(b=P.TK(b));a.Lt&&(b=X.oL(a.Mt,a.Nt,a.Kt));c=P.PD(b,c,a.Ic);a.ha=c;a.ve||a.Ke||a.je||(c.Ad=null,c.Db.length=0);c=b.V.length;a.num_vertices=b.Ca*c;var d;a:switch(a.Xf){case P.wl:case P.qq:case P.pq:d=!0;break a;default:d=!1}d?P.BM(b)?a.num_triangles=b.ja.length/3*c:a.num_triangles=b.Ca/3*c:a.num_triangles=0}}function D(a,b,c,d,f,h,g,m,l,n,p,t){var r=a.Ka,u=[],v=m.b4w_dynamic_grass;if(!n&&v)return u;
for(var w="INSTANCE"==m.b4w_wind_bend_inheritance,S="INSTANCE"==m.b4w_shadow_inheritance,q="INSTANCE"==m.b4w_reflection_inheritance,F=[],z=[],y=0;y<f.length;y++){var x=f[y].Ka.k,C=ua.Ku(b);C.Re=m.b4w_hair_billboard;C.Wj=m.b4w_hair_billboard_type;C.Vj="SPHERICAL"==m.b4w_hair_billboard_geometry;C.rc=v;C.jm=!0;w?(C.Qd=x.Qd,C.ul=x.ul,C.wg=x.wg,C.Wf=x.Wf,C.fg=x.fg,C.Vf=x.Vf,C.Rf=x.Rf,C.Mf=x.Mf,C.td=x.td,C.Uj=!1):(C.Qd=r.k.Qd,C.ul=r.k.ul,C.wg=r.k.wg,C.Wf=r.k.Wf,C.fg=r.k.fg,C.Vf=r.k.Vf,C.Rf=r.k.Rf,C.Mf=
r.k.Mf,C.td=r.k.td,C.Uj=!0);S?(C.Dd=x.Dd,C.kd=x.kd,C.cd=x.cd):(C.Dd=r.k.Dd,C.kd=r.k.kd,C.cd=r.k.cd);q?(C.$c=x.$c,C.Qc=x.Qc,C.Pc=x.Pc,C.te=x.te,C.ce=x.ce,C.hf=x.hf):(C.$c=r.k.$c,C.Qc=r.k.Qc,C.Pc=r.k.Pc,C.te=r.k.te,C.ce=r.k.ce,C.hf=r.k.hf);F.push(C);var A=g[y];A||(A=new Float32Array);t&&Y.Xr(l.seed,p);var O=new Float32Array(3),D=new Float32Array([0,0,0,1]),wa=[],oa=Ha.Qz(Aa.jw)&&!m.b4w_initial_rand_rotation&&!m.b4w_hair_billboard,K=4;oa&&(K=8);for(var E=0;E<A.length;E+=K){O[0]=A[E];O[1]=A[E+1];O[2]=
A[E+2];var G=A[E+3]*va.get_scale(x.n);if(m.b4w_initial_rand_rotation){switch(m.b4w_rotation_type){case "XYZ":var B=new Float32Array([Y.Ff(p),Y.Ff(p),Y.Ff(p)]);na.normalize(B,B);break;case "Z":B=new Float32Array([0,0,1]);break;default:Y.r("Unsupported random rotation type: "+m.b4w_rotation_type)}ka.setAxisAngle(B,m.b4w_rand_rotation_strength*(2*Math.PI*Y.Ff(p)-Math.PI),D)}else if(oa&&(D.set(A.subarray(E+4,E+8)),Y.Ww(D,D),!m.use_whole_group))if(m.use_rotation_dupli){var da=va.get_quat_view(x.n);ka.multiply(D,
da,D)}else ka.multiply(D,ta,D);var T=va.set_sep(O,G,D,va.create());wa.push(T)}z.push(wa)}for(var N={},I=0,y=0;y<f.length;y++)for(var Da=f[y].data.materials,E=0;E<Da.length;E++)Da[E].name in N?N[Da[E].name]++:(N[Da[E].name]=1,I++);for(var I=I?I:1,qa={},y=0;y<f.length;y++){var U=f[y],Ca=h[y],C=F[y],W={};C.Qd&&(W.au_wind_bending_amp=[C.Mf],W.au_wind_bending_freq=[C.wg],W.au_detail_bending_freq=[C.Wf],W.au_detail_bending_amp=[C.Vf],W.au_branch_bending_amp=[C.Rf],C.Mf=0,C.wg=0,C.Wf=0,C.Vf=0,C.Rf=0);var Ba=
L(C),wa=z[y];if(wa.length){for(var fa=U.data,Da=fa.materials,ya=Array(Da.length),R=Array(Da.length),E=0;E<Da.length;E++)if(!P.vB(fa,E))for(var La=0;La<Ca.length;La++){var ia=Ca[La],sa=e(ia),ha=Da[E];"MAIN"==ia?ya[E]=sa:"DEBUG_VIEW"==ia&&(R[E]=sa);sa.bk=a.b4w_cluster_data.cluster_id;if(aa(sa,ha)){"SHADOW"==ia&&ya[E]&&(sa.ie=ya[E].ie);sa.Xf=P.wl;J(sa,C);sa.Uh=m.uuid;"JITTERED"==m.b4w_hair_billboard_type&&(sa.fs=m.b4w_hair_billboard_jitter_amp,sa.gs=m.b4w_hair_billboard_jitter_freq);v&&(sa.Ir=m.b4w_dynamic_grass_scale_threshold);
w||(delete sa.Ic.a_bending_col_main,delete sa.Ic.a_bending_col_detail);M(sa,Ba);var ma=P.tv(fa,E,sa.Ci,b.vh,sa.Ic,sa.ki),X=r.k.n,V=!0;if(1<N[ha.name]){var ca=0,pa;for(pa in ma.V)ca++;V=ma.ja.length*wa.length*ca*N[ha.name]>2E5*I}var za=Aa.Xy&&V&&"PHYSICS"!=sa.type;if(za){sa.AB=m.use_whole_group?2:1;var ea=Y.P(ma);P.Cz(ma,ea,wa);ea.cf={fn:wa,mt:X,HD:"STATIC"==b.type,Sp:W,Xk:{},nr:v};if(C.Qd&&C.Uj){var ja=na.fromValues(0,0,0);va.transform_vec3(ja,r.k.n,ja);for(var Ea=[],Xa=0;Xa<wa.length;Xa++)Ea.push(ja[0],
ja[1],ja[2]);ea.cf.Xk.a_emitter_center={Vb:3,data:Ea}}P.Cz(ma,ma,wa);"STATIC"==b.type&&P.gI(ea.kf,X)}else{var Db=ea=P.kN(ma,W,wa),ab=wa;Db.ma.au_center_pos=new Float32Array(3*Db.Ca);for(var Fc=ab.length,Mc=Db.Ca/Fc,tb=0;tb<Fc;tb++)for(var oc=ab[tb],gc=3*Mc*tb,hc=0;hc<Mc;hc++)Db.ma.au_center_pos[gc+3*hc]=oc[0],Db.ma.au_center_pos[gc+3*hc+1]=oc[1],Db.ma.au_center_pos[gc+3*hc+2]=oc[2];ea=Db;if(C.Qd&&C.Uj){var Lb=ea,Wc=r.k.n;Lb.ma.a_emitter_center=new Float32Array(3*Lb.Ca);var Mb=na.fromValues(0,0,0);
va.transform_vec3(Mb,Wc,Mb);for(var Ta=0;Ta<Lb.Ca;Ta++)Lb.ma.a_emitter_center[3*Ta]=Mb[0],Lb.ma.a_emitter_center[3*Ta+1]=Mb[1],Lb.ma.a_emitter_center[3*Ta+2]=Mb[2];ea=Lb}}var zc=m.b4w_vcol_from_name,bd=m.b4w_vcol_to_name,Nc=sa,wb=c,Qb=!w,kb=fa,db=[];if(""!==zc&&""!==bd){var Rb,cd=bd,Oc=Nc.Ic,ic=[],pc=void 0;for(pc in Oc)for(var yb=Oc[pc].src,Gc=0,qc=0;qc<yb.length;qc++){var dd=yb[qc].zf;cd==yb[qc].name&&ic.push(pc,dd,Gc);Gc+=Y.$k(dd)}Rb=ic;if(0<Rb.length)for(var Ac=0;Ac<Rb.length;Ac+=3)db.push({Bo:zc,
pr:7,Js:Rb[Ac],Ks:Rb[Ac+1],mr:Rb[Ac+2]});else P.lM(Nc.Ci,"a_color")&&bd==kb.active_vcol_name&&db.push({Bo:zc,pr:7,Js:"a_color",Ks:7,mr:0})}Qb&&("a_bending_col_main"in wb&&db.push({Bo:"a_bending_col_main",pr:4,Js:"a_bending_col_main",Ks:4,mr:0}),"a_bending_col_detail"in wb&&db.push({Bo:"a_bending_col_detail",pr:7,Js:"a_bending_col_detail",Ks:7,mr:0}));for(var Xb=ea,Ua=wa,nb=d,Ya=db,Yb=sa.Ic,$a=za,rc=!1,zb=0;zb<Ya.length;zb++){var Ab=Ya[zb].Bo,Zb=nb.ma[Ab];if(Zb&&0<Zb.length){rc=!0;break}}if($a)var $b=
Xb.cf.Xk;if(rc){var pb,gb=r.k.K,ub=nb.V[0].a_position,Bb=Ua,Pa=qa,Va=new Float32Array(3),ob=new Float32Array(3),hb=new Uint32Array(Bb.length);if(!("verts_indices"in Pa)){Pa.wh=new Float32Array(3);Pa.uh=new Float32Array(3);Pa.jy=new Uint32Array(ub.length/3);Pa.jp=new Uint32Array(ub.length/3);Pa.wh[0]=(gb.max_x-gb.min_x)/20;Pa.wh[1]=(gb.max_y-gb.min_y)/20;Pa.wh[2]=(gb.max_z-gb.min_z)/20;Pa.uh[0]=gb.min_x;Pa.uh[1]=gb.min_y;Pa.uh[2]=gb.min_z;for(var Za=0;Za<ub.length/3;Za++){var vb=Y.trunc((ub[3*Za]-
Pa.uh[0])/Pa.wh[0]),eb=Y.trunc((ub[3*Za+1]-Pa.uh[1])/Pa.wh[1]),ac=Y.trunc((ub[3*Za+2]-Pa.uh[2])/Pa.wh[2]),vb=Y.clamp(vb,0,19),eb=Y.clamp(eb,0,19),ac=Y.clamp(ac,0,19);Pa.jy[Za]=Za;Pa.jp[Za]=ac*Math.pow(20,2)+20*eb+vb}P.AD(Pa.jp,Pa.jy,P.eu,!0);Pa.pl=new Uint32Array(Math.pow(20,3));for(Za=0;Za<Pa.jp.length;Za++)Pa.pl[Pa.jp[Za]]++;delete Pa.jp;for(Za=1;Za<Pa.pl.length;Za++)Pa.pl[Za]+=Pa.pl[Za-1]}for(var Sb=0;Sb<Bb.length;Sb++){Va[0]=Bb[Sb][0];Va[1]=Bb[Sb][1];Va[2]=Bb[Sb][2];for(var Ob=1E10,Pc=-1,Qc=Y.trunc((Va[0]-
Pa.uh[0])/Pa.wh[0]),Tb=Y.trunc((Va[1]-Pa.uh[1])/Pa.wh[1]),jc=Y.trunc((Va[2]-Pa.uh[2])/Pa.wh[2]),Qc=Y.clamp(Qc,0,19),Tb=Y.clamp(Tb,0,19),jc=Y.clamp(jc,0,19),Eb=jc*Math.pow(20,2)+20*Tb+Qc,Bc=Pa.pl[Eb],Fb=0==Eb?0:Pa.pl[Eb-1];Fb<Bc;Fb++){var Rc=Pa.jy[Fb];ob[0]=ub[3*Rc];ob[1]=ub[3*Rc+1];ob[2]=ub[3*Rc+2];na.sub(ob,Va,ob);var kc=na.sqrLen(ob);kc<=Ob&&(Ob=kc,Pc=Rc)}if(-1==Pc)for(Fb=0;Fb<ub.length/3;Fb++)ob[0]=ub[3*Fb],ob[1]=ub[3*Fb+1],ob[2]=ub[3*Fb+2],na.sub(ob,Va,ob),kc=na.sqrLen(ob),kc<=Ob&&(Ob=kc,Pc=Fb);
hb[Sb]=Pc}pb=hb;for(var Hc=Xb.Ca/Ua.length,zb=0;zb<Ya.length;zb++){var qb=Ya[zb].Js,Ic=Ya[zb].Ks,Ab=Ya[zb].Bo,lc=Ya[zb].pr,Zb=nb.ma[Ab];switch(qb){case "a_bending_col_main":var Gb=1;break;case "a_bending_col_detail":Gb=3;break;case "a_color":Gb=3;break;default:for(var Hb=Gb=0;Hb<Yb[qb].src.length;Hb++)Gb+=Y.$k(Yb[qb].src[Hb].zf)}if(Zb&&0<Zb.length){var Cc=Y.$k(lc),ib=Y.$k(Ic),bb=lc&Ic,mc=Y.RC(bb);bb!=Ic&&H.error("Wrong color extraction from "+Ab+" to "+qb+".");if($a)for($b[qb]={Vb:Gb,data:[]},Hb=
0;Hb<Ua.length;Hb++)for(Jc=pb[Hb],Ib=Jc*Cc,Pb=0;Pb<mc.length;Pb++)mc[Pb]&&(jd=Y.Km(lc,Pb),$b[qb].data.push(Zb[Ib+jd]));else{if("a_bending_col_main"==qb||"a_bending_col_detail"==qb)Xb.ma[qb]=new Float32Array(Xb.Ca*ib);for(Hb=0;Hb<Ua.length;Hb++){var Jc=pb[Hb],Ib=Jc*Cc,Xc=Hb*Hc*Gb;if(-1!=Jc)for(var Yc=0;Yc<Hc;Yc++)for(var ed=Yc*Gb,Pb=0;Pb<mc.length;Pb++)if(mc[Pb]){var jd=Y.Km(lc,Pb);Xb.ma[qb][Xc+ed+(Ya[zb].mr+Y.Km(Ic,Pb))]=Zb[Ib+jd]}}}}else Xb.ma[qb]=new Float32Array(0)}}ea=Xb;k(sa,"USE_INSTANCED_PARTCLS",
ea.cf?1:0);u.push({qa:sa,Ee:ea,$d:[ha.name],k:C,fe:[a]})}}for(E=0;E<R.length;E++)R[E]&&(R[E].Ol=ya[E].id,M(R[E],R[E].Cp))}}return u}function aa(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=pa.Oz(b));return c=c&&r(a,b)}function M(a,b){var c=null,d=null,e=a.K,f=a.O,h=a.ga,k=a.sa,g=a.ke;a.K=null;a.O=null;a.ga=null;a.sa=null;a.ke=null;for(var m=0;m<a.X.length;m++){var l=a.X[m].Vd;l&&(c||(c={}),c[m]=l,a.X[m].Vd=null);if(l=a.X[m].ya)d||(d={}),d[m]=l,a.X[m].ya=null}a.id=0;a.Cp=b;a.id=Y.Dz(a,b);a.K=e;a.O=f;a.ga=
h;a.sa=k;a.ke=g;if(c)for(var n in c)a.X[n].Vd=c[n];if(d)for(n in d)a.X[n].ya=d[n]}function L(a){var b=a.qe;a.qe=null;var c=Y.Dz(a,0);a.qe=b;return c}function T(a,b,c,d){var f=e("DEBUG_VIEW");N(f,"debug_view.glslv","debug_view.glslf");f.Dh=!0;f.Na=!0;f.Uh=b;f.ir=c;J(f,a);a=L(a);M(f,a);if(d.Fe){c?(b=d.O,va.set_trans(d.O.D,oa)):(b=d.sa,va.set_trans(b.D,oa));var h=na.create();c=X.Br(1,h);a=na.fromValues(na.length(b.za),na.length(b.Aa),na.length(b.Ba));P.WC(c,a,h);var h=na.normalize(b.za,ya),k=na.normalize(b.Aa,
Ca);b=na.normalize(b.Ba,sa);!a[0]&&a[1]&&a[2]?na.cross(k,b,h):!a[1]&&a[0]&&a[2]?na.cross(b,h,k):!a[2]&&a[0]&&a[1]&&na.cross(h,k,b);a=Y.IK(h,k,b,wa);ia.invert(a,a);a=ka.fromMat3(a,S);va.set_quat(a,oa);va.set_scale(1,oa);P.ot(c,oa)}else c?(a=d.da,c=X.Br(a.Ra,a.D)):(a=d.Da,c=X.Br(a.Ra,na.create()),va.identity(oa),va.set_trans(a.D,oa),P.ot(c,oa));f.K=R.Il(d.K);f.O=R.$n(d.O);f.da=R.ak(d.da);f.ga=R.Il(d.ga);f.sa=R.$n(d.sa);f.Da=R.ak(d.Da);P.pt(c,1,!0);c.ma.a_polyindex=P.sr(c);F(f,c);return f}function N(a,
b,c){a.tb.ug=b;a.tb.Ye=c;K.JO(a.tb)}function U(a,b,c){1==a.X.length&&0==a.dd.length&&a.dd.push("default0");c=c||"default"+String(a.X.length);-1==a.dd.indexOf(c)&&(a.X.push(b),a.dd.push(c));a.nb&&Ea.dz(a)}function O(a){a.tb||Y.r("No shaders info for batch "+a.name);a.nb=K.GL(a.tb);var b=a.tb;if(b.status===K.gu){var c=a.nb.attributes,d=a.ha.Cb,e;for(e in c)d[e]||Y.r('missing data for "'+e+'" attribute')}b.status&K.fF&&H.error("Texture limit exceeded for shader - "+b.Ye+', materials: "'+a.lc.join(", ")+
'". Maximum texture count: '+ja.pw+", actual texture count: "+b.ZD);b.status&K.eF&&H.error("Fragment uniform limit exceeded for shader - "+b.Ye+', materials: "'+a.lc.join(", ")+'". Maximum fragment uniform count: '+ja.qs+", actual fragment uniform count: "+b.eL);b.status&K.iF&&H.error("Vertex uniform limit exceeded for shader - "+b.ug+', materials: "'+a.lc.join(", ")+'". Maximum vertex uniform count: '+ja.dp+", actual vertex uniform count: "+b.UQ);b.status&K.hF&&H.error("Vertex attribute limit exceeded for shader - "+
b.ug+', materials: "'+a.lc.join(", ")+'". Maximum attribute count: '+ja.qw+", actual attribute count: "+b.ez);b.status&K.gF&&("MAIN"!=a.type||a.Oi||H.error("Varying limit exceeded for shader - "+a.tb.Ye+', materials: "'+a.lc.join(", ")+'"'),"MAIN"==a.type&&a.Oi||"NODES_GLOW"==a.type)&&(d=c=0,a.ki&&(c=Y.No(a.ki)),a.Ic&&(d=Y.No(a.Ic)),H.error("Varying limit exceeded for node shader - "+a.tb.Ye+", uv: "+c+", vc: "+d+', materials: "'+a.lc.join(", ")+'"'));b.status&K.ZE&&H.error("Shader compilation/linking error: "+
b.ug+", "+b.Ye+', materials: "'+a.lc.join(", ")+'"');return a.tb.status===K.gu?(Ea.RH(a.nb),Ea.ou(a),Ea.dz(a),!0):!1}function qa(a,b,c){a=a.G[0].T;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].uf&&-1!=a[d].lc.indexOf(b))return a[d];return null}function fa(a,b,c){a=a.G[0].T;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].uf&&-1!=a[d].lc.indexOf(b))return a[d];return null}function W(a,b){a.ud.set(b.ud);a.Kg=b.Kg;a.Jf.set(b.Jf);a.bi=b.bi;a.Nd.set(b.Nd);a.Yf=b.Yf;a.Qf=b.Qf;a.Jg=b.Jg;a.Bg=b.Bg;a.reflect_factor=
b.reflect_factor;a.Ze.set(b.Ze);a.parallax_scale=b.parallax_scale;a.shallow_water_col.set(b.shallow_water_col);a.shallow_water_col_fac=b.shallow_water_col_fac;a.shore_water_col.set(b.shore_water_col);a.shore_water_col_fac=b.shore_water_col_fac;a.foam_factor=b.foam_factor;a.Kj=b.Kj}var R=q("__boundings"),ha=q("__config"),H=q("__print"),ma=q("__extensions"),V=q("__graph"),ia=q("__mat3"),pa=q("__nodemat"),ua=q("__obj_util"),ca=q("__particles"),X=q("__primitives"),ka=q("__quat"),Ha=q("__reformer"),Ea=
q("__renderer"),da=q("__scenegraph"),K=q("__shaders"),Ba=q("__subscene"),za=q("__textures"),va=q("__tsr"),P=q("__geometry"),Y=q("__util"),na=q("__vec3"),ea=q("__vec4"),Aa=ha.A,ja=ha.zh,ta=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),ya=new Float32Array(3),Ca=new Float32Array(3),sa=new Float32Array(3),S=new Float32Array(4),oa=va.create(),wa=ia.create();a.hR=Da;var Da="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),La={};a.VH=function(a){return La[a]||null};
a.WH=function(a,b){La[a]=b};a.xL=function(a,c,d,e){for(var f=[],h=[],k=0;k<c.length;k++){var m=c[k],n=m.Ka;n.Xo||(ua.is_dynamic(n)?f.push(m):h.push(m))}var p=[];p.push.apply(p,g(f,a.q.Ma));p.push.apply(p,l(h,a.q.Ma));for(var f=[],h=[],r={},k=0;k<p.length;k++){var m=p[k].qa,n=p[k].k,u=null;if(m.id in r){var v=r[m.id],w=h[v].qa,S=h[v].k,q=null,z=null,y=m.K,x=m.O,C=m.da,A=m.ga,O=m.sa,D=m.Da;m.K=null;m.O=null;m.da=null;m.ga=null;m.sa=null;m.Da=null;var wa=w.K,oa=w.O,K=w.da,E=w.sa,H=w.ga,G=w.Da;w.K=null;
w.O=null;w.da=null;w.ga=null;w.sa=null;w.Da=null;for(var B=0;B<m.X.length;B++){var L=m.X[B].Vd;L&&(q||(q={}),q[B]=L,m.X[B].Vd=null);if(L=m.X[B].ya)z||(z={}),z[B]=L,m.X[B].ya=null}Y.MD(m,w)&&Y.MD(n,S)&&1!=m.AB&&(u=h[v]);m.K=y;m.O=x;m.da=C;m.ga=A;m.sa=O;m.Da=D;w.K=wa;w.O=oa;w.da=K;w.ga=H;w.sa=E;w.Da=G;if(q)for(B in q)m.X[B].Vd=q[B];if(z)for(B in z)m.X[B].ya=z[B];if(!u){do m.id++;while(r[m.id])}}u||(u={qa:m,k:p[k].k,fe:[],Dx:[],QD:[],$d:[]},r[m.id]=h.length,h.push(u));u.fe.push.apply(u.fe,p[k].fe);p[k].Ee&&
p[k].Ee.Ca&&(u.Dx.push(p[k].Ee),u.QD.push(p[k].fe[0].Ka.k.n));if(u.$d.length)for(B=0;B<p[k].$d.length;B++)m=p[k].$d[B],-1==u.$d.indexOf(m)&&u.$d.push(m);else u.$d=p[k].$d;P.AD(u.$d,u.Dx,P.OG,!1)}for(k=0;k<h.length;k++){r=h[k].Dx;p=h[k].QD;m=h[k].qa;n=h[k].k;if(0==r.length)B=P.bf(Y.Vp("%empty"));else if(1==r.length)B=r[0];else{u=[];for(B=0;B<r.length;B++)P.CM(r[B])||u.push(B);if(u.length<r.length)for(B=0;B<u.length;B++)P.pt(r[u[B]]);B=P.OD(r)}"PARTICLES"!=m.type&&(r=B.kf,m.K=R.Il(r.K),m.O=R.$n(r.O),
m.da=n.da.Ra<r.da.Ra?"STATIC"==n.type?R.ak(n.Da):R.ak(n.da):R.ak(r.da),"STATIC"==n.type?(m.sa=m.O,m.ga=m.K,m.Da=m.da):(n=p[0],m.sa=R.Gl(m.O,n),m.Da=R.Hl(m.da,n),m.ga=R.yi(m.K,n)),m.Fe=R.Zr(m.O,m.da));f.push({qa:m,k:h[k].k,Ee:B,$d:h[k].$d,fe:h[k].fe})}for(h=0;h<f.length;h++)if(k=f[h].qa,k.lc=f[h].$d,F(k,f[h].Ee),t(k,d,a),"STATIC"==f[h].k.type&&"COLOR_ID"!=k.type){m=Y.Vp("%meta%"+k.type+"%"+k.lc.join("%")+"%");B=ua.mo(m,"MESH");B.k=ua.Ku(f[h].k);ua.Gn(B,a);ua.Hq(B,a,k);e.push(B);p=[];for(n=0;n<f[h].fe.length;n++)m=
f[h].fe[n],m=m.Ka,R.sv(m.k.iz,p),"MAIN"==k.type&&m.ts.push(B);B.k.sa=R.br(Y.f32(p),!0);B.k.O=R.zz(B.k.sa,B.k.n);B.k.da=R.Jl(B.k.O);B.k.Da=R.Jl(B.k.sa);B.k.Fe=R.Zr(B.k.O,B.k.da)}else for(B=[],n=0;n<f[h].fe.length;n++)m=f[h].fe[n],m=m.Ka,-1==B.indexOf(m.name)&&(ua.Hq(m,a,k),B.push(m.name),m.k.Fe=R.Zr(m.k.O,m.k.da));if(Aa.debug_view){for(h=0;h<f.length;h++)if(d=f[h].k,"DYNAMIC"==d.type&&(m=f[h].fe[0].Ka,k=f[h].qa,"MAIN"==k.type)){n=ua.ea(m,a);B=n.T;p=!1;for(n=0;n<B.length;n++)B[n].Dh&&(p=!0);p||(d=T(d,
m.name,!0,k),ua.Hq(m,a,d))}for(h=0;h<e.length;h++)m=e[h],d=m.k,n=ua.ea(m,a),k=n.T[0],"MAIN"==k.type&&(d=T(d,m.name,!1,k),ua.Hq(m,a,d));for(h=0;h<f.length;h++)k=f[h].qa,"DEBUG_VIEW"==k.type&&(k.hr=h)}for(h=0;h<c.length;h++)for(n=ua.ea(c[h].Ka,a),B=n.T,n=0;n<B.length;n++)b(B[n]);for(h=0;h<e.length;h++)for(n=ua.ea(e[h],a),B=n.T,n=0;n<B.length;n++)b(B[n])};a.yH=function(a,c,f){var h=a.q.sn,g=e("MAIN");N(g,"sky.glslv","sky.glslf");if(c.procedural_skydome)k(g,"PROCEDURAL_SKYDOME",1),g.lr=!0;else{var m=
h.Rm,l=da.Pb(a.q.Ma,Ba.Of).p.bc;U(g,l,"u_sky");m&&(k(g,"WO_SKYTEX",1),m.invert&&k(g,"MTEX_NEGATIVE",1),m.BE&&k(g,"MTEX_RGBTOINT",1),k(g,"BLENDTYPE",m.sz),m.wE&&k(g,"WOMAP_BLEND",1),m.xE&&k(g,"WOMAP_HORIZ",1),m.zE&&k(g,"WOMAP_ZENUP",1),m.yE&&k(g,"WOMAP_ZENDOWN",1));h.dq&&k(g,"WO_SKYBLEND",1);h.fq&&k(g,"WO_SKYPAPER",1);h.gq&&k(g,"WO_SKYREAL",1)}c.$c&&(g.$c=!0,c.Qc&&(g.Qc=!0));g.Df=99999;C(g,"a_position");c=X.tL();F(g,c);b(g);h=ua.ea(f,a);f.k.Eh=!0;g.O=R.Se();g.sa=R.Se();g.K=R.Wc();g.ga=R.Wc();g.da=
R.Hg();g.Da=R.Hg();f=L(f.k);M(g,f);h.T.push(g);da.Pb(a.q.Ma,Ba.Me)&&(a=d(g),a.type="DEBUG_VIEW",a.ub="",A(a),k(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),c.ma.a_polyindex=P.sr(c),F(a,c),a.Ol=g.id,M(a,f),h.T.push(a))};a.Su=function(a,b,c){c=ua.ea(a,c).T;var e=[];da.Pb(b,Ba.Jc);var f=da.Pb(b,Ba.nd),h=da.Pb(b,Ba.Sc),k=da.Pb(b,Ba.Nf);b=da.Pb(b,Ba.Le);for(var g=0;g<c.length;g++){var m=c[g],l=null;"SHADOW"==m.type&&"RECEIVE"==m.ub&&m.Dd&&(l=d(m),l.ub="CAST");"MAIN"!=m.type&&"PARTICLES"!=m.type||!f&&!h||!m.$c||(l=
d(m),l.ub="REFLECT",l.mj=!1,l.Ke&&(l.Ke=!1,l.Na=!1),l.Va=m.Va);"COLOR_ID"==m.type&&k&&a.k.nc&&(b&&a.k.ah?(l=d(m),l.ub="OUTLINE"):m.ub="OUTLINE");l&&(l.uf=!0,M(l,a.k.id),e.push(l))}c.push.apply(c,e)};a.UO=f;a.eR=function(a,b,c){b?b=c*(b.max_z-b.min_z):(b=1,Y.r("No bounding box for mesh"));if(0==b)return 0;a=b*Math.tan(Y.deg_to_rad(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.XH=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.EH=
function(a,b,c){b=za.UA(b,c);U(a,b,"u_color_ramp_tex")};a.gQ=G;a.fQ=t;a.QO=h;a.cz=function(a,b){k(a,"CSM_SECTION1",0);k(a,"CSM_SECTION2",0);k(a,"CSM_SECTION3",0);k(a,"NUM_CAST_LAMPS",0);if(b){k(a,"NUM_CAST_LAMPS",b.eg.length);Aa.os&&k(a,"MAC_OS_SHADOW_HACK",1);for(var c=1;c<b.csm_num;c++)k(a,"CSM_SECTION"+String(c),1);k(a,"SHADOW_TEX_RES",K.F(b.csm_resolution));k(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);k(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else k(a,"SHADOW_TEX_RES",
0),k(a,"CSM_FADE_LAST_CASCADE",0),k(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.ab=k;a.gd=function(a,b){return K.LL(a.tb,b)};a.dQ=F;a.eQ=M;a.tI=L;a.Iq=N;a.Dl=U;a.oO=function(a,b,c){c=a.dd.indexOf(c);-1<c&&(a.X[c]=b)};a.GJ=function(a,b){var c=e("MAIN");c.yb=!0;ea.set(b[0],b[1],b[2],.5,c.ud);c.Xf=P.qq;F(c,a);N(c,"main.glslv","main_stack.glslf");k(c,"SHADELESS",1);O(c);return c};a.oc=O;a.wL=function(a,c){for(var d=0;d<c.length;d++){var f=c[d].Ka,h=e("LINE");N(h,"line.glslv","line.glslf");h.yb=!0;var k=X.vL();
F(h,k);b(h);h.K=R.Wc();h.ga=R.Wc();h.O=R.Se();h.sa=R.Se();h.Da=R.Hg();h.da=R.Hg();ua.Gn(f,a);ua.ea(f,a).T.push(h);O(h)}};a.DI=function(a){return a.nb.op.length?a.nb.Qw.u_cube_fog?!0:!1:!1};a.pJ=function(){var a=e("DEPTH_PACK");a.Jb=!0;a.Na=!1;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");O(a);return a};a.Uu=function(a){var b=e("POSTPROCESSING");N(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":k(b,
"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":k(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":k(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":k(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":k(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":k(b,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":k(b,"POST_EFFECT","POST_EFFECT_EXTEND");
break;case "FLIP_CUBEMAP_COORDS":k(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:Y.r("Wrong postprocessing effect: "+a)}b.Jb=!0;b.Na=!1;a=X.Fc();F(b,a);O(b);return b};a.JJ=function(a){var b=e("SSAO");b.Na=!1;b.Jb=!0;var c=X.Fc();F(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");k(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.GD);k(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:za.yL("SSAO_TEXTURE",a)};c={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,
164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=za.Yc(a,c);U(b,a,"u_ssao_special_tex");O(b);return b};a.KJ=function(a){var b=e("SSAO_BLUR");b.Na=!1;b.Jb=!0;var c=X.Fc();F(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");k(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);O(b);return b};a.lJ=function(a){var b=e("COC");b.Na=!1;b.Jb=!0;var c=X.Fc();
F(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");k(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":k(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":k(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":k(b,"COC_TYPE","COC_COMBINE")}O(b);return b};a.qJ=function(a){var b=e("DOF");b.Na=!1;b.Jb=!0;var c=X.Fc();F(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");a.p.Xc?k(b,"DOF_TYPE","DOF_BOKEH"):(k(b,"DOF_TYPE","DOF_SIMPLE"),k(b,"DEPTH_RGBA",1));
O(b);return b};a.zJ=function(){var a=e("OUTLINE");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");O(a);return a};a.sJ=function(){var a=e("GLOW_COMBINE");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");O(a);return a};a.tJ=function(a,b,c){var d=e("GOD_RAYS");d.Na=!1;d.Jb=!0;var f=X.nL();F(d,f);N(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");k(d,"DEPTH_RGBA",a?
1:0);k(d,"WATER_EFFECTS",b?1:0);k(d,"STEPS_PER_PASS",K.F(c,1));O(d);return d};a.uJ=function(){var a=e("GOD_RAYS_COM");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");k(a,"SAFARI_CANVAS_ALPHA_HACK",Aa.UC?1:0);O(a);return a};a.oJ=function(a,b){var c=e("SKY");c.Na=!1;c.Jb=!0;var d=X.pL();F(c,d);if(b.procedural_skydome)N(c,"skybox.glslv","proc_skybox.glslf"),k(c,"WATER_EFFECTS",1);else{N(c,"skybox.glslv","tex_skybox.glslf");if(a){d=
a.q.sn;if(d.wx){var f=za.Yc(d.wx,null);U(c,f,f.name)}d.Rm&&k(c,"WO_SKYTEX",1)}b.tD&&k(c,"MTEX_NEGATIVE",1);b.yD&&k(c,"MTEX_RGBTOINT",1);k(c,"BLENDTYPE",b.sD);b.uD&&k(c,"WOMAP_BLEND",1);b.vD&&k(c,"WOMAP_HORIZ",1);b.xD&&k(c,"WOMAP_ZENUP",1);b.wD&&k(c,"WOMAP_ZENDOWN",1);b.dq&&k(c,"WO_SKYBLEND",1);b.fq&&k(c,"WO_SKYPAPER",1);b.gq&&k(c,"WO_SKYREAL",1)}c.O=R.Se();c.sa=R.Se();c.K=R.Wc();c.ga=R.Wc();c.da=R.Hg();c.Da=R.Hg();O(c);return c};a.pH=function(a,b){var c=da.Pb(a.q.Ma,Ba.Of);c&&(c=c.La[0].oa[0].qa,
ua.ea(b,a).T.push(c))};a.gJ=function(a){var b=e("ANTIALIASING");b.Na=!1;b.Jb=!0;var c=X.Fc();F(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");Aa.HC?(k(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),k(b,"AA_QUALITY",a.OA)):k(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");O(b);return b};a.HJ=function(a){var b=e("SMAA"),c=X.Fc();F(b,c);N(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");k(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");k(b,"SMAA_PASS",a);k(b,"SMAA_PREDICATION",0);
k(b,"SMAA_REPROJECTION",0);O(b);b.Na=!1;b.Jb=!0;return b};a.nJ=function(){var a=e("COMPOSITING");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");O(a);return a};a.yJ=function(){var a=e("MOTION_BLUR");a.Jb=!0;a.Na=!1;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");O(a);return a};a.LJ=function(a){var b=e("STEREO");b.Jb=!0;b.Na=!1;var c=X.Fc();F(b,c);N(b,"postprocessing/postprocessing.glslv",
"postprocessing/stereo.glslf");k(b,"ANAGLYPH","ANAGLYPH"===a?1:0);O(b);return b};a.vJ=function(){var a=e("LUMINANCE");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");O(a);return a};a.hJ=function(){var a=e("LUMINANCE");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");O(a);return a};a.wJ=function(){var a=e("LUMINANCE_X_BLUR");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/luminance_trunced.glslv",
"postprocessing/luminance_trunced.glslf");O(a);return a};a.jJ=function(){var a=e("POSTPROCESSING");a.Jb=!0;a.Na=!1;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");O(a);return a};a.kJ=function(){var a=e("BLOOM");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");O(a);return a};a.kK=function(){var a=e("VELOCITY");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv",
"postprocessing/velocity.glslf");O(a);return a};a.fJ=function(){var a=e("ANCHOR_VISIBILITY");a.Na=!0;a.Jb=!0;a.Xf=P.yy;N(a,"anchors.glslv","anchors.glslf");var b=X.VA(1);F(a,b);k(a,"ANCHOR_NUM",1);O(a);a.Pj=new Float32Array(3);return a};a.AJ=function(){var a=e("PERFORMANCE");a.Na=!1;a.Jb=!0;var b=X.Fc();F(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");O(a);return a};a.cQ=function(a,b){var c=b.length/3;if(c!=a.Pj.length/3){var d=X.VA(c);F(a,d);k(a,"ANCHOR_NUM",c);
O(a)}a.Pj=b};a.Ev=function(a){if(!a.G.length)return null;a=a.G[0];return a.T.length?a.T[0]:null};a.Oa=qa;a.Xe=fa;a.yT=W;a.XR=function(a,b){for(var c=a.G[0].T,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.Wz=function(a){for(var b=a.X,c=0;c<b.length;c++){var d=b[c];d.rd&&za.wK(d.ib)}a.ha.rd&&P.VI(a.ha);a.rd&&a.ke.length&&Ea.YI(a);a.nb.rd&&K.XI(a.nb);a.bj&&(b=pa.hB(a.bj))&&b.Vz&&pa.WI(a.bj)};a.inherit_material=function(a,b,c,d){for(var e=["MAIN","SHADOW","COLOR_ID"],f=!1,h=0;h<e.length;h++){var k=
e[h],g=qa(a,b,k),m=qa(c,d,k);if(g&&m){var f=!0,l=fa(c,d,k);"MAIN"==k&&(W(m,g),l&&W(l,g));for(k=0;k<m.dd.length;k++){var n=m.dd[k];if(-1!==Da.indexOf(n)){var p=g.dd.indexOf(n);-1!==p&&(m.X[k]=g.X[p],l&&(n=l.dd.indexOf(n),-1!==n&&(l.X[n]=g.X[p])))}}}}f||H.error("Wrong objects for inheriting material!")};a.set_nodemat_value=function(a,b,c,d){for(var e=0;e<a.G.length;e++)for(var f=a.G[e].T,h=0;h<f.length;h++){var k=f[h];-1!=k.lc.indexOf(b)&&k.Rh&&(k.Rh[c]=d)}};a.set_nodemat_rgb=function(a,b,c,d,e,f){for(var h=
0;h<a.G.length;h++)for(var k=a.G[h].T,g=0;g<k.length;g++){var m=k[g];-1!=m.lc.indexOf(b)&&m.ae&&(m.ae[3*c]=d,m.ae[3*c+1]=e,m.ae[3*c+2]=f)}};a.get_nodemat_value=function(a,b){return a.Rh[b]};a.get_nodemat_rgb=function(a,b,c){c[0]=a.ae[3*b];c[1]=a.ae[3*b+1];c[2]=a.ae[3*b+2];return c};a.Pg=function(a,b){var c;c=b[1];for(var d=2;d<b.length;d++)c+="%join%"+b[d];for(d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null};a.cleanup=function(){La={}}};b4w.module.__nodemat=function(a,q){function e(a,b,c,k,g){var t=ta.get_active(),t=f(b,g,t.uuid);if(t in oa)return oa[t];var u={Ma:null,id:t,Vz:!0};c||(Da={},La=0);if("SHADOW"!=g&&"COLOR_ID"!=g){b=P.create();for(var w=a.nodes,S=0;S<w.length;S++)if(null==aa(b,w[S],0,k,g))return oa[t]=null,u;if(c&&-1==F(a,b,"GROUP_OUTPUT","group"))return u;S=ca(b);w=c?a.links:a.links.slice();if(!X(b,w,S))return u;if(c)return u.Ma=b,u;for(S=0;S<w.length;S++){c=w[S];for(var q=y(c.from_node,b),x=y(c.to_node,b),C=0;C<q.length;C++)for(var A=
0;A<x.length;A++){var O=q[C],D=x[A],wa=P.Pa(b,O),K=P.Pa(b,D);if(!pa(b,O,D,wa,K,c))return oa[t]=null,u}}p(b);"GLOW"==g?S=F(a,b,"B4W_GLOW_OUTPUT","material",!0):(S=F(a,b,"OUTPUT","material",!1,!0),-1==S&&(S=F(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==S&&(b=r(),S=0);E(b);a=P.nt(b,S,P.nq);d(a,k);l(a,k);v(a);z(a);h(a);m(a,k,g);Ba(a)}else k=e(a,b,c,k,"MAIN"),k=P.clone(k.Ma,function(a){var b=ya.ao(a);b.J=ya.P(a.J);b.Ua=ya.P(a.Ua);return b}),S=F(a,k,"OUTPUT","material",!1,!0),-1==S&&(S=F(a,k,"OUTPUT_MATERIAL",
"material",!1,!0)),n(k,S),a=P.nt(k,S,P.nq),v(a);u.Ma=a;return oa[t]=u}function d(a,c){var d=[];P.la(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({hp:a,node:b})});for(var e=0;e<d.length;++e){var f=d[e].hp,h=d[e].node,k=P.yk(a);P.ti(a,k,h.data.nN);var g=P.yk(a);P.ti(a,g,h.data.oN);P.Lc(a,k,g,[4,2]);for(var m={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},l=P.hm(a,f),n=[],p=[],t=[],r={},u=0;u<l;u++){var v=P.Hh(a,f,
u);v in r||(r[v]=0);var w=P.yd(a,v,f,r[v]++);n.push([v,f,w]);var S=m[w[1]];if(S)switch(S[0]){case "MATERIAL_END":p.push([v,g,[w[0],S[1]]]);break;case "LIGHTING_APPLY":t.push([v,[w[0],S[1]]])}else p.push([v,k,w])}b(a,h.data.value,k,g,t,c);for(u=0;u<n.length;u++)P.Im(a,n[u][0],n[u][1],n[u][2]);for(u=0;u<p.length;u++)P.Lc(a,p[u][0],p[u][1],p[u][2]);h=P.kg(a,f);k=[];m=[];l={};for(u=0;u<h;u++)n=P.cg(a,f,u),n in l||(l[n]=0),w=P.yd(a,f,n,l[n]++),k.push([f,n,w]),m.push([g,n,w]);for(u=0;u<k.length;u++)P.Im(a,
k[u][0],k[u][1],k[u][2]);for(u=0;u<m.length;u++)P.Lc(a,m[u][0],m[u][1],m[u][2]);P.Gf(a,f)}}function b(a,b,c,d,e,f){var h={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},k=aa(a,h,0,f,null),m=k;g(a,c,k,"E");g(a,c,k,"A");g(a,c,k,"D");k=ta.get_active();k=ea.Gb(k,"LAMP",ea.DATA_ID_ALL);if(!b.ie)for(var l,n,p,t=0;t<k.length;t++){p=k[t].$a;h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};l=aa(a,h,0,f,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=aa(a,h,0,f,null);g(a,m,n,"color");g(a,m,n,"specular");
g(a,l,n,"ldir");g(a,c,n,"normal");g(a,c,n,"D");g(a,c,n,"S");g(a,l,n,"lcolorint");g(a,c,l,"shadow_factor");m="SPECULAR_"+b.Op;h={name:m,type:m,use_tangent_shading:b.ol};m=aa(a,h,0,f,null);g(a,l,m,"ldir");g(a,l,m,"lfac");g(a,c,m,"normal");g(a,m,n,"sfactor");g(a,l,m,"norm_fac");g(a,c,m,"sp_params");m="HEMI"==p.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.uo;h={name:m,type:m,use_tangent_shading:b.ol};p=aa(a,h,0,f,null);g(a,l,p,"ldir");g(a,l,p,"lfac");g(a,c,p,"normal");g(a,l,p,"norm_fac");g(a,p,n,"lfactor");"DIFFUSE_LAMBERT"!=
m&&g(a,c,p,"dif_params");for(l=0;l<e.length;l++)P.Lc(a,e[l][0],n,e[l][1]);m=n}g(a,m,d,"color");g(a,m,d,"specular")}function g(a,b,c,d){for(var e=P.Pa(a,b),f=P.Pa(a,c),h,k=0;k<f.J.length;k++)if(d==f.J[k].identifier){h=k;break}if(void 0!==h){for(var g,k=0;k<e.Ua.length;k++)if(d==e.Ua[k].identifier){g=k;break}void 0!==g&&P.Lc(a,b,c,[g,h])}}function l(a,b){var c=[];P.la(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({hp:a,node:b})});for(var d=0;d<c.length;++d){var e=c[d].hp,f=c[d].node,h=P.yk(a);P.ti(a,
h,f.data.kI);var k=P.yk(a);P.ti(a,k,f.data.lI);P.Lc(a,h,k,[4,2]);for(var g={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["BSDF_END",3],8:["BSDF_END",4],9:["BSDF_END",5]},m=P.hm(a,e),l=[],n=[],p=[],t={},r=0;r<m;r++){var u=P.Hh(a,e,r),v=P.Pa(a,u);u in t||(t[u]=0);var S=P.yd(a,u,e,t[u]++);l.push([u,e,S]);var q=g[S[1]];if(q)switch(q[0]){case "BSDF_END":n.push([u,k,[S[0],q[1]]]);break;case "LIGHTING_APPLY":p.push([u,[S[0],q[1]]])}else n.push([u,h,S]);if("BSDF_GLOSSY"==v.type||"BSDF_DIFFUSE"==v.type||
"MIX_SHADER"==v.type){n.push([u,h,[1,1]]);n.push([u,h,[2,2]]);n.push([u,h,[3,3]]);n.push([u,h,[4,4]]);n.push([u,h,[5,5]]);n.push([u,h,[6,6]]);var F=[];P.la(a,function(a,b){"MIX_SHADER"==b.type&&F.push({hp:a,node:b})});for(S=0;S<F.length;++S)for(u=F[S].hp,v=P.hm(a,u),q=0;q<v;q++){var z=P.Hh(a,u,q),y=P.Pa(a,z),x=P.yd(a,z,u,0);0==x[1]||"BSDF_GLOSSY"!=y.type&&"BSDF_DIFFUSE"!=y.type&&"MIX_SHADER"!=y.type||(y=1==x[1]?3:9,n.push([z,u,[1,y]]),n.push([z,u,[2,y+1]]),n.push([z,u,[3,y+2]]),n.push([z,u,[4,y+3]]),
n.push([z,u,[5,y+4]]),n.push([z,u,[6,y+5]]))}}}w(a,f.data.value,h,k,p,b);for(r=0;r<l.length;r++)P.Im(a,l[r][0],l[r][1],l[r][2]);for(r=0;r<n.length;r++)P.Lc(a,n[r][0],n[r][1],n[r][2]);f=P.kg(a,e);h=[];g=[];m={};for(r=0;r<f;r++)l=P.cg(a,e,r),l in m||(m[l]=0),S=P.yd(a,e,l,m[l]++),h.push([e,l,S]),g.push([k,l,S]);for(r=0;r<h.length;r++)P.Im(a,h[r][0],h[r][1],h[r][2]);for(r=0;r<g.length;r++)P.Lc(a,g[r][0],g[r][1],g[r][2]);P.Gf(a,e)}}function w(a,b,c,d,e,f){var h={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},
k=aa(a,h,0,f,null),m=k;g(a,c,k,"E");g(a,c,k,"A");g(a,c,k,"D");for(var k=ta.get_active(),k=ea.Gb(k,"LAMP",ea.DATA_ID_ALL),l,n,p=0;p<k.length;p++){h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};l=aa(a,h,0,f,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=aa(a,h,0,f,null);g(a,m,n,"color");g(a,m,n,"specular");g(a,l,n,"ldir");g(a,c,n,"normal");g(a,c,n,"D");g(a,c,n,"S");g(a,l,n,"lcolorint");g(a,c,l,"shadow_factor");m=b.mI;h={name:m,type:m};m=aa(a,h,0,f,null);g(a,l,m,"ldir");g(a,l,m,"lfac");g(a,c,
m,"normal");g(a,l,m,"norm_fac");g(a,c,m,"bsdf_params");g(a,m,n,"lfactor");g(a,m,n,"sfactor");for(m=0;m<e.length;m++)P.Lc(a,e[m][0],n,e[m][1]);m=n}g(a,c,d,"s_color");g(a,c,d,"metalness");g(a,m,d,"color");g(a,m,d,"specular")}function f(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function n(a,b){P.Lf(a,function(c,d,e){var f=P.Pa(a,d);d==b&&"Color"==f.J[e[1]].identifier&&P.Im(a,c,d,e)})}function r(){var a=P.create(),b={data:null,
Eb:[],U:[],J:[{wa:new Float32Array([0,0,0]),identifier:"Color",Za:!1,name:"Color"},{wa:1,identifier:"Alpha",Za:!1,name:"Alpha"}],Ua:[],type:"OUTPUT",lh:[]};P.ti(a,0,b);return a}function v(a){P.la(a,function(b,d){for(var e=d.J,f=d.Ua,h=0;h<e.length;h++)c(a,e[h],b,h,1);for(h=0;h<f.length;h++)c(a,f[h],b,h,0)})}function c(a,b,c,d,e){if(b.Za){var f=!0;P.Lf(a,function(a,b,h){if(!e&&a==c&&h[0]==d||e&&b==c&&h[1]==d)f=!1});f&&(b.Za=!1)}}function m(a,b,c){var d=[];P.Lf(a,function(e,f,h){var k=P.Pa(a,e),g=P.Pa(a,
f),k=ya.is_vector(k.Ua[h[0]].wa),g=ya.is_vector(g.J[h[1]].wa);if(k!=g){var m,l={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};k&&!g?m=D("vector_to_scalar","B4W_VECTOSCAL",[l],[n]):!k&&g&&(m=D("scalar_to_vector","B4W_SCALTOVEC",[n],[l]));aa(a,m,0,b,c);d.push([e,f,a.L[a.L.length-2],h])}});for(var e=0;e<d.length;++e)P.Im(a,d[e][0],d[e][1],d[e][3]),P.Lc(a,d[e][0],d[e][2],[d[e][3][0],0]),P.Lc(a,d[e][2],d[e][1],[0,
d[e][3][1]])}function p(a){var b=[];P.la(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":P.Lf(a,function(e,f,h){var k=P.Pa(a,f);e==c&&"MATERIAL_EXT"==k.type&&"Translucency"==d.Ua[h[0]].name&&b.push(e,f,[h[0]+1,h[1]+1])})}});for(var c=0;c<b.length;c+=3)P.Lc(a,b[c],b[c+1],b[c+2])}function y(a,b){var c=[];P.la(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;ya.r("Node not found")}function E(a){var b=[];P.la(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});
for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type){var f=u(a,d);if(-1!=f){var h=P.Hh(a,f,0);P.nj(a,f,d,-1);-1!=h&&P.nj(a,h,f,-1);d=P.Pa(a,f);e.data=d.data;e.U[0]=d.U[0];P.Gf(a,f)}e.J.splice(1,1)}else if("REROUTE"==e.type){for(var f=P.Hh(a,d,0),k=P.kg(a,d),h=[],g=[],m=[],l=0;l<k;l++){var n=P.cg(a,d,l),p=g.indexOf(n),t=0<=p?m[t]:0,r=P.yd(a,d,n,t);if(r){var r=r[1],v=e.J[0].wa,r=P.Pa(a,n).J[r];switch(typeof v){case "number":if("object"==typeof r.wa)for(var w=r.wa,r=0;r<w.length;r++)w[r]=
v;else"number"==typeof r.wa&&(r.wa=v);break;case "object":if("object"==typeof r.wa)for(w=r.wa,r=0;r<w.length;r++)w[r]=v[r];else"number"==typeof r.wa&&(r.wa=.35*v[0]+.45*v[1]+.2*v[2])}}v=e.Ua;for(r=0;r<v.length;r++)v[r].wa=e.J[0].wa;-1!=p?m[p]+=1:(g.push(n),m.push(1),h.push(d,n))}if(-1!=f)for(e=P.yd(a,f,d,0)[0],l=0;l<g.length;l++)for(r=0;r<m[l];r++)k=P.yd(a,d,g[l],r)[1],P.Lc(a,f,g[l],[e,k]);for(l=0;l<h.length;l+=2)P.nj(a,h[l],h[l+1],-1)}}}function u(a,b){for(var c=a.Ia,d=0;d<c.length;d+=3)if(c[d+1]==
b&&1==c[d+2][1])return c[d];return-1}function z(a){I(a);A(a);x(a)}function x(a){var b=[],c="",d="",e={};P.la(a,function(a,f){if("GEOMETRY_UV"==f.type||"UVMAP"==f.type||"TEX_COORD_UV"==f.type){b.push(a,f);var h=f.data.value;c?c==h||d||(d=h,e[d]=0):(c=h,e[c]=0);e[h]++}});for(var f in e)if(2>e[f]){for(var h=0;h<b.length;h+=2)b[h+1].data.value==f&&b.splice(h,2);delete e[f];c==f&&(c=d,d="");d==f&&(d="")}if(!(3>b.length)){var h={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},k=
{default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};f=D("merged_uv","UV_MERGED",[],[h,k]);f.uv_layer=c;aa(a,f,0,"",void 0);var g=a.L[a.L.length-2];f=a.L[a.L.length-1];if(d){k=D("merged_uv","UV_MERGED",[],[h,k]);k.uv_layer=d;aa(a,k,0,"",void 0);var m=a.L[a.L.length-2],k=a.L[a.L.length-1]}else k=null;for(var l=-1,n=null,h=0;h<b.length;h+=2){var p=b[h],r=b[h+1];t(r,b[1])?(l=g,n=f):k&&(l=m,n=k);for(var u=[],v=P.kg(a,p),w={},S=0;S<v;S++){var q=P.cg(a,p,S);q in w||(w[q]=0);var z=
P.yd(a,p,q,w[q]++);u.push(p,q,z);z=z.splice(0,z.length);switch(r.type){case "GEOMETRY_UV":z[0]=0;n.Ua[0].Za=!0;break;case "UVMAP":case "TEX_COORD_UV":z[0]=1,n.Ua[1].Za=!0}P.Lc(a,l,q,z)}for(var S=0;S<u.length;S+=3)P.nj(a,u[S],u[S+1],0);P.Gf(a,p)}}}function I(a){var b=[];P.la(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,
c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],h=!0,k=0;k<c.length;k++){var g=c[k];if(J(f,g.Qe)){h=[];k=P.kg(a,e);for(n=0;n<k;n++){var m=P.cg(a,e,n),l=P.yd(a,e,m,0);h.push(e,m,l);P.Lc(a,g.id,m,l)}for(var n=0;n<h.length;n+=3)P.nj(a,h[n],h[n+1],0);P.Gf(a,e);h=!1;break}}h&&(g={id:e,Qe:f},c.push(g))}}function B(a){for(var b={},c=0;c<a.L.length;c+=2){var d=a.L[c];b[d]={Jn:{},FB:!1}}for(c=0;c<a.Ia.length;c+=3)b[a.Ia[c+1]].Jn[a.Ia[c]]=!0;for(d in b)G(d,b);for(d in b)b[d]=Object.keys(b[d].Jn).map(function(a){return parseInt(a)});
return b}function G(a,b){var c=b[a];if(!c.FB){var d=ya.P(c),e;for(e in c.Jn){G(e,b);var c=b[e],f;for(f in c.Jn)d.Jn[f]=!0}d.FB=!0;b[a]=d}}function A(a){var b=[];P.la(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=B(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],h=b[e+1],k=!0,g=0;g<d.length;g++){var m=d[g];if(!(3<=m.tm.length||!J(h,m.Qe)||-1<c[f].indexOf(m.id)||-1<c[m.id].indexOf(f))){for(var l=!1,n=0;n<m.tm.length;n++){var p=m.tm[n].id;if(-1<c[f].indexOf(p)||
-1<c[p].indexOf(f)){l=!0;break}}if(!l){for(var g=[],p=P.hm(a,f),t={},n=0;n<p;n++)l=P.Hh(a,f,n),l in t||(t[l]=0),k=P.yd(a,l,f,t[l]++),g.push(l,f,k);for(var p=[],t=P.kg(a,f),r={},n=0;n<t;n++)l=P.cg(a,f,n),l in r||(r[l]=0),k=P.yd(a,f,l,r[l]++),p.push(f,l,k);k=g.concat(p);for(n=0;n<k.length;n+=3)P.nj(a,k[n],k[n+1],0);P.Gf(a,f);n={id:f,Qe:h,GK:g,HK:p};m.tm.push(n);k=!1;break}}}k&&(m={id:f,Qe:h,tm:[]},d.push(m))}for(e=0;e<d.length;e++){m=d[e];c=m.tm.length;for(g=0;g<c;g++){h=m.tm[g];n=h.Qe;f=h.GK;h=h.HK;
m.Qe.J[g+1].Za=n.J[0].Za;m.Qe.J[g+1].wa=n.J[0].wa;m.Qe.Ua[2*(g+1)].Za=n.Ua[0].Za;m.Qe.Ua[2*(g+1)].wa=n.Ua[0].wa;m.Qe.Ua[2*(g+1)+1].Za=n.Ua[1].Za;m.Qe.Ua[2*(g+1)+1].wa=n.Ua[1].wa;for(n=0;n<f.length;n+=3)l=f[n],k=f[n+2],k[1]+=g+1,P.Lc(a,l,m.id,k);for(n=0;n<h.length;n+=3)l=h[n+1],k=h[n+2],k[0]+=2*(g+1),P.Lc(a,m.id,l,k);m.Qe.Eb.push(["USE_uv"+(g+2),1])}P.Gf(a,m.id);P.ti(a,m.id,m.Qe)}}}function J(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;
case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.yz==b.data.value.yz&&a.data.value.Ri==b.data.value.Ri;default:return!1}}function t(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function h(a){var b=[],c=[];P.la(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);"GEOMETRY_VW"==d.type&&c.push(a,d)});C(a,b);k(a,c)}function C(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,h=[],k=[],g=[[],
[],[]],m=P.kg(a,d),l=0;l<m;l++){var n=P.cg(a,d,l);if("SEPRGB"!=P.Pa(a,n).type){f=!1;break}h.push(d,n);for(var p={},t=P.kg(a,n),f=0;f<t;f++){var r=P.cg(a,n,f);r in p||(p[r]=0);var u=P.yd(a,n,r,p[r]++);h.push(n,r);g[u[0]].push(d,r,u)}k.push(n);f=!0}if(f){for(l=d=m=0;l<g.length;l++)g[l].length&&(m++,d|=1<<2-l);if(m){e.type+=m;e.Ua=[];for(l=0;l<g.length;l++)if(g[l].length)for(e.Ua.push({wa:0,identifier:"RGB"[l],Za:!0,name:"RGB"[l]}),f=0;f<g[l].length;f+=3)g[l][f+2][0]=ya.Km(d,l);for(l=0;l<h.length;l+=
2)P.nj(a,h[l],h[l+1],0);for(l=0;l<k.length;l++)P.Gf(a,k[l]);for(l=0;l<g.length;l++)for(f=0;f<g[l].length;f+=3)P.Lc(a,g[l][f],g[l][f+1],g[l][f+2])}}}}function k(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=!0,f=[],h=P.kg(a,d),k=0;k<h;k++){var g=P.cg(a,d,k);if("B4W_REFLECT"==P.Pa(a,g).type){var m=P.yd(a,d,g,0),l=P.yd(a,d,g,1);m&&1==m[1]||l&&1==l[1]?e=!1:f.push(d,g)}else e=!1}for(k=0;k<f.length;k+=2)h=a,m=f[k],g=f[k+1],l=P.Pa(h,g),l.type+="_WORLD",P.nj(h,m,g,0),l.J.splice(0,1),m=P.Hh(h,g,0),m!=
P.cu&&(P.yd(h,m,g,0)[1]=0);e&&P.Gf(a,d)}}function F(a,b,c,d,e,f){a=a.nodes;for(var h=null,k=0;k<a.length;k++){var g=a[k];e?"GROUP"==g.type&&g.node_tree_name==c&&(h=g):g.type==c&&(h=g)}return h?y(h,b)[0]:(f||Aa.error('No "'+c+'" node in node '+d),-1)}function D(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function aa(a,b,c,d,e){var f=b.name,h=b.type,k=[],g=[],m=[],l=[],n=null,p=[];switch(h){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":g=
ma(b);m=V(b);Aa.warn(h+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":g=ma(b);m=V(b);break;case "MIX_SHADER":g.push(W(b,"Fac"));var t=W(b,"Shader"),m=t.Za;g.push(t);(t=W(b,"Shader_001"))||(t=W(b,"Shader.001"));var r=t.Za;g.push(t);g.push(H("d_color1","d_color1",[0,0,0],m));g.push(H("d_roughness1","d_roughness1",0,m));g.push(H("s_color1","s_color1",[0,0,0],m));g.push(H("s_roughness1","s_roughness1",0,m));g.push(H("metalness1","metalness1",0,m));g.push(H("normal1","normal1",
[0,0,0],m));g.push(H("d_color2","d_color2",[0,0,0],r));g.push(H("d_roughness2","d_roughness2",0,r));g.push(H("s_color2","s_color2",[0,0,0],r));g.push(H("s_roughness2","s_roughness2",0,r));g.push(H("metalness2","metalness2",0,r));g.push(H("normal2","normal2",[0,0,0],r));m=R(b,"Shader");t=m.Za;m=[m,H("d_color","d_color",[0,0,0],t),H("d_roughness","d_roughness",0,t),H("s_color","s_color",[0,0,0],t),H("s_roughness","s_roughness",0,t),H("metalness","metalness",0,t),H("normal","normal",[0,0,0],t)];break;
case "OBJECT_INFO":var g=ma(b),m=[],t=R(b,"Location"),r=R(b,"Object Index"),u=R(b,"Material Index"),v=R(b,"Random");m.push(t);m.push(r);m.push(u);m.push(v);p.push(["USE_LOCATION_OUT",t.Za|0]);p.push(["USE_OBJ_IND_OUT",r.Za|0]);p.push(["USE_MAT_IND_OUT",u.Za|0]);p.push(["USE_RANDOM_OUT",v.Za|0]);break;case "UVMAP":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(n=N("param_"+h+"_a"),r=N("param_"+h+"_v"),k.push(ia(n)),k.push(ia(r)),l.push(ia(r)),n={name:n,value:t});m=V(b);break;case "UV_MERGED":n=N("param_UV_MERGED_a");
r=N("param_UV_MERGED_v");k.push(ia(n));k.push(ia(r));m.push(R(b,"UV_geom"));m.push(R(b,"UV_cycles"));l.push(ia(r));n={name:n,value:b.uv_layer};break;case "CAMERA":g=[];m=V(b);break;case "COMBRGB":case "COMBHSV":g=ma(b);m=V(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==h?(za(b,0,0)&&p.push(["READ_R",1]),za(b,1,0)&&p.push(["READ_G",1]),za(b,2,0)&&p.push(["READ_B",1]),za(b,3,0)&&p.push(["READ_A",1])):(za(b,0,-1)&&p.push(["READ_R",1]),za(b,1,-1)&&p.push(["READ_G",1]),za(b,2,-1)&&p.push(["READ_B",
1]));g=ma(b);m=V(b);n={value:b};break;case "PARTICLE_INFO":g=ma(b);m=V(b);for(t=0;t<b.outputs.length;t++){var r=b.outputs[t],v=r.identifier,w=ia("v_param_PART_INFO_"+v.replace(" ",""));if(r.is_linked)switch(v){case "Size":p.push(["PART_INFO_SIZE",ja.F(1)]);break;case "Age":p.push(["PART_INFO_AGE",ja.F(1)]);break;case "Lifetime":p.push(["PART_INFO_LT",ja.F(1)]);break;case "Location":p.push(["PART_INFO_LOC",ja.F(1)]);break;case "Index":n=u=ia("a_param_PART_INFO_"+r.identifier.replace(" ",""));p.push(["PART_INFO_IND",
ja.F(1)]);break;case "Velocity":p.push(["PART_INFO_VEL",ja.F(1)]);break;case "Angular Velocity":p.push(["PART_INFO_A_VEL",ja.F(1)])}"Age"!=v&&"Lifetime"!=v&&"Size"!=v&&(k.push(w),l.push(w))}u&&k.push(u);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!U(b))return!0;h=O(b,c);if(!h)return Aa.error("Geometry output is not supported"),null;switch(h){case "GEOMETRY_UV":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(n=N("param_GEOMETRY_UV_a"),r=N("param_GEOMETRY_UV_v"),k.push(ia(n)),k.push(ia(r)),l.push(ia(r)),
n={name:n,value:t});m.push(R(b,"UV"));break;case "GEOMETRY_VC":(t=b.color_layer)||(h="EMPTY_VC");"EMPTY_VC"!=h&&(n=N("param_GEOMETRY_VC_a"),r=N("param_GEOMETRY_VC_v"),k.push(ia(n)),k.push(ia(r)),l.push(ia(r)),n={name:n,value:t});m.push(R(b,"Vertex Color"));break;case "GEOMETRY_NO":m.push(R(b,"Normal"));break;case "GEOMETRY_TRN":h="GEOMETRY_NO";m.push(R(b,"True Normal"));Aa.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":m.push(R(b,"Front/Back"));break;case "GEOMETRY_VW":m.push(R(b,
"View"));break;case "GEOMETRY_GL":m.push(R(b,"Global")||R(b,"Position"));break;case "GEOMETRY_LO":m.push(R(b,"Local"));break;case "GEOMETRY_OR":t=N("param_GEOMETRY_OR_v");k.push(ia(t));m.push(R(b,"Orco"));l.push(ia(t));break;case "GEOMETRY_IN":m.push(R(b,"Incoming"));break;case "GEOMETRY_BF":m.push(R(b,"Backfacing"))}break;case "TEX_COORD":if(!U(b))return!0;h=qa(b,c);switch(h){case "TEX_COORD_UV":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(n=N("param_TEX_COORD_UV_a"),r=N("param_TEX_COORD_UV_v"),
k.push(ia(n)),k.push(ia(r)),l.push(ia(r)),n={name:n,value:b.uv_layer});m.push(R(b,"UV"));break;case "TEX_COORD_NO":m.push(R(b,"Normal"));break;case "TEX_COORD_GE":t=N("param_TEX_COORD_GE_v");k.push(ia(t));m.push(R(b,"Generated"));l.push(ia(t));break;case "TEX_COORD_OB":m.push(R(b,"Object"));break;case "TEX_COORD_CA":m.push(R(b,"Camera"));break;case "TEX_COORD_WI":m.push(R(b,"Window"));break;case "TEX_COORD_RE":m.push(R(b,"Reflection"))}break;case "GROUP":r=b.node_tree_name;switch(r){case "B4W_LINEAR_TO_SRGB":if(!M(b,
[1],[1])){n=L(b,d,e);break}h="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!M(b,[1],[1])){n=L(b,d,e);break}h="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!M(b,[1],[1])){n=L(b,d,e);break}h="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!M(b,[1,1],[1])){n=L(b,d,e);break}h="B4W_REFLECT";break;case "B4W_REFRACTION":if(!M(b,[1,0],[1])){n=L(b,d,e);break}h="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!M(b,[1,1,0,0,0],[1])){n=L(b,d,e);break}h="B4W_PARALLAX";t=N("temp_texture");
l.push(ia(t));break;case "B4W_CLAMP":if(!M(b,[1],[1])){n=L(b,d,e);break}h="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!M(b,[0,0,0,0,0],[0])){n=L(b,d,e);break}h="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!M(b,[],[0])){n=L(b,d,e);break}h="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!M(b,[0,0,0],[0])){n=L(b,d,e);break}h="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":h="B4W_GLOW_OUTPUT";break;default:n=L(b,d,e)}g=ma(b);m=V(b);"B4W_TRANSLUCENCY"==r&&(t=H("TranslucencyParams","TranslucencyParams",[0,0,0,
0]),t.Za=m[0].Za,m.push(t));break;case "LAMP":n=b.lamp;if(!n)return Aa.error("There is no lamp in node: "+b.name),null;m.push(R(b,"Color"));m.push(R(b,"Light Vector"));m.push(R(b,"Distance"));m.push(R(b,"Visibility Factor"));n.uuid in Da?p.push(["LAMP_INDEX",String(Da[n.uuid])]):(Da[n.uuid]=La,p.push(["LAMP_INDEX",String(La++)]));n=Da;break;case "LIGHTING_AMBIENT":g=[H("E","E",[0,0,0],!0),H("A","A",[0,0,0],!0),H("D","D",[0,0,0],!0)];m=[H("color","color",[0,0,0],!0),H("specular","specular",[0,0,0],
!0)];break;case "LIGHTING_BEGIN":m=[H("E","E",[0,0,0],!0),H("A","A",[0,0,0],!0),H("D","D",[0,0,0],!0),H("S","S",[0,0,0],!0),H("normal","normal",[0,0,0],!0),H("dif_params","dif_params",[0,0],!0),H("sp_params","sp_params",[0,0],!0),H("shadow_factor","shadow_factor",0,!0),H("translucency_color","translucency_color",0,!0),H("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":g=[H("color","color",[0,0,0],!0),H("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":g=
[H("shadow_factor","shadow_factor",0,!0)];m=[H("ldir","ldir",[0,0,0],!0),H("lfac","lfac",[0,0],!0),H("lcolorint","lcolorint",[0,0,0],!0),H("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":g=[H("ldir","ldir",[0,0,0],!0),H("lfac","lfac",[0,0],!0),H("normal","normal",[0,0,0],!0),H("norm_fac","norm_fac",0,!0)];m=[H("lfactor","lfactor",0,!0)];p.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":g=
[H("ldir","ldir",[0,0,0],!0),H("lfac","lfac",[0,0],!0),H("normal","normal",[0,0,0],!0),H("norm_fac","norm_fac",0,!0),H("dif_params","dif_params",[0,0],!0)];m=[H("lfactor","lfactor",0,!0)];p.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":g=[H("ldir","ldir",[0,0,0],!0),H("lfac","lfac",[0,0],!0),H("normal","normal",[0,0,0],!0),H("norm_fac","norm_fac",0,!0),H("sp_params","sp_params",[0,0],!0)];m=[H("sfactor","sfactor",0,
!0)];p.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":g=[H("ldir","ldir",[0,0,0],!0),H("lfac","lfac",[0,0],!0),H("normal","normal",[0,0,0],!0),H("norm_fac","norm_fac",0,!0),H("sp_params","sp_params",[0,0],!0)];m=[H("sfactor","sfactor",0,!0)];p.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":g=[H("ldir","ldir",[0,0,0],!0),H("lfac","lfac",[0,0],!0),H("normal","normal",[0,0,0],!0),H("norm_fac","norm_fac",0,!0),
H("bsdf_params","bsdf_params",[0,0,0,0],!0)];m=[H("lfactor","lfactor",0,!0),H("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":g=[H("color","color",[0,0,0,0],!0),H("specular","specular",[0,0,0],!0),H("lfactor","lfactor",0,!0),H("sfactor","sfactor",0,!0),H("ldir","ldir",[0,0,0],!0),H("normal","normal",[0,0,0],!0),H("translucency_params","translucency_params",[0,0,0,0],!0),H("D","D",[0,0,0],!0),H("S","S",[0,0,0],!0),H("lcolorint","lcolorint",[0,0,0],!0),H("translucency_color","translucency_color",
0,!0)];m=[H("color","color",[0,0,0,0],!0),H("specular","specular",[0,0,0],!0)];break;case "NORMAL":g=ma(b);m=V(b);t=R(b,"Normal");l.push(ia(N("param_NORMAL_Normal"),t.wa,3));break;case "MAPPING":t=b.vector_type;h="MAPPING";g.push(W(b,"Vector"));m.push(R(b,"Vector"));var r=ya.f32(b.rotation),u=ya.f32(b.scale),v=ya.f32(b.translation),w=Y.create(),S=ya.OK(r);"TEXTURE"==t&&(u[0]=u[0]||1,u[1]=u[1]||1,u[2]=u[2]||1);var q=new Float32Array([u[0],0,0,0,u[1],0,0,0,u[2]]);Y.multiply(S,q,w);w=ya.mN(w,na.create());
switch(t){case "POINT":w[12]=v[0];w[13]=v[1];w[14]=v[2];break;case "TEXTURE":w[12]=v[0];w[13]=v[1];w[14]=v[2];w=na.invert(w,w);break;case "NORMAL":na.invert(w,w),na.transpose(w,w)}switch(t){case "NORMAL":p.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":p.push(["MAPPING_TRS_MATRIX_DEF",1]);p.push(["MAPPING_TRS_MATRIX",ja.F(w,16)]);break;case "POINT":0!==Ca.length(r)?(p.push(["MAPPING_TRS_MATRIX_DEF",1]),p.push(["MAPPING_TRS_MATRIX",ja.F(w,16)])):(0!==Ca.length(u)&&(p.push(["MAPPING_SCALE_DEF",1]),p.push(["MAPPING_SCALE",
ja.F(u,3)])),0!==Ca.length(v)&&(p.push(["MAPPING_TRANS_DEF",1]),p.push(["MAPPING_TRANS",ja.F(v,3)])));break;case "VECTOR":0!==Ca.length(r)?(p.push(["MAPPING_TRS_MATRIX_DEF",1]),p.push(["MAPPING_TRS_MATRIX",ja.F(w,16)])):0!==Ca.length(u)&&(p.push(["MAPPING_SCALE_DEF",1]),p.push(["MAPPING_SCALE",ja.F(u,3)]))}b.use_min&&(p.push(["MAPPING_MIN_CLIP_DEF",1]),p.push(["MAPPING_MIN_CLIP",ja.F(b.min,3)]));b.use_max&&(p.push(["MAPPING_MAX_CLIP_DEF",1]),p.push(["MAPPING_MAX_CLIP",ja.F(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":n=
[];t=[];r=[];u=[H("E","E",[0,0,0],!0),H("A","A",[0,0,0],!0),H("D","D",[0,0,0],!0),H("S","S",[0,0,0],!0),H("normal","normal",[0,0,0],!0),H("dif_params","dif_params",[0,0],!0),H("sp_params","sp_params",[0,0],!0),H("shadow_factor","shadow_factor",0,!0)];v=[H("color","color",[0,0,0],!0),H("specular","specular",[0,0,0],!0),H("normal","normal",[0,0,0],!0)];w=[R(b,"Color"),R(b,"Alpha"),R(b,"Normal")];S=[];q=W(b,"Color");q.wa.splice(3);r.push(q);g.push(q);q=W(b,"Spec");q.wa.splice(3);r.push(q);g.push(q);
(q=W(b,"DiffuseIntensity"))||(q=W(b,"Refl"));q.wa=b.diffuse_intensity;r.push(q);g.push(q);var z=W(b,"Normal");z.wa.splice(3);r.push(z);g.push(z);"MATERIAL_EXT"==h?((q=W(b,"Emit"))||(q=H("Emit","Emit",0)),r.push(q),g.push(q),(q=W(b,"Translucency"))?(q.wa=0,q.name="Translucency",q.identifier="Translucency"):q=H("Translucency","Translucency",0),g.push(q),(q=W(b,"Translucency"))?(q.wa=[0,0,0,0],q.name="TranslucencyParams",q.identifier="TranslucencyParams"):q=H("TranslucencyParams","TranslucencyParams",
[0,0,0,0]),g.push(q),m=W(b,"Reflectivity"),q=W(b,"Ray Mirror"),m?(q=m,m="Reflectivity"):q?m="Ray Mirror":(q=m,m="Reflectivity"),q||(q=H(m,m,0)),g.push(q),v.push(q),(q=W(b,"SpecTra"))||(q=H("SpecTra","SpecTra",0)),g.push(q),v.push(q),(q=W(b,"Alpha"))||(q=H("Alpha","Alpha",b.alpha)),g.push(q),v.push(q),w.push(R(b,"Diffuse")),w.push(R(b,"Spec")),n.push(["MATERIAL_EXT",1]),t.push(["MATERIAL_EXT",1])):(r.push(H("emit_intensity","emit_intensity",0)),v.push(H("reflect_factor","reflect_factor",0)),v.push(H("specular_alpha",
"specular_alpha",0)),v.push(H("alpha_in","alpha_in",0)),w.push(H("diffuse_out","diffuse_out",0)),w.push(H("spec_out","spec_out",0)),n.push(["MATERIAL_EXT",0]),t.push(["MATERIAL_EXT",0]));S.push(ia(N("param_MATERIAL_alpha"),b.alpha));S.push(ia(N("param_MATERIAL_spec_alpha"),b.specular_alpha));m=w;n.push(["USE_MATERIAL_NORMAL",z.Za|0]);b.use_diffuse&&(n.push(["USE_MATERIAL_DIFFUSE",1]),t.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&t.push(["USE_MATERIAL_SPECULAR",1]);var q=[],F=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":z=
b.specular_hardness;break;case "WARDISO":z=b.specular_slope;break;case "TOON":z=b.specular_toon_size;F=b.specular_toon_smooth;break;case "BLINN":z=b.specular_ior;F=b.specular_hardness;break;default:Aa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),z=b.specular_hardness}var y,x;switch(b.diffuse_shader){case "LAMBERT":x=y=0;break;case "OREN_NAYAR":y=b.roughness;x=0;break;case "FRESNEL":y=b.diffuse_fresnel;x=b.diffuse_fresnel_factor;break;case "MINNAERT":y=
b.darkness;x=0;break;case "TOON":y=b.diffuse_toon_size;x=b.diffuse_toon_smooth;break;default:Aa.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),x=y=0}q.push(ia(N("param_MATERIAL_diffuse"),[y,x],2));q.push(ia(N("param_MATERIAL_spec"),[b.specular_intensity,z,F],3));n.push(["SHADELESS_MAT",b.use_shadeless?1:0]);z={name:b.name,value:{Op:b.specular_shader,uo:b.diffuse_shader,ie:b.use_shadeless,ol:b.use_tangent_shading}};n={name:b.name,value:{Op:b.specular_shader,
uo:b.diffuse_shader,ie:b.use_shadeless,ol:b.use_tangent_shading},nN:{name:"material_begin",type:"MATERIAL_BEGIN",J:r,Ua:u,U:q,data:z,Eb:n,lh:[]},oN:{name:"material_end",type:"MATERIAL_END",J:v,Ua:w,U:S,data:z,Eb:t,lh:[]}};break;case "BSDF_DIFFUSE":g=ma(b);p.push(["USE_NORMAL_IN",g[2].Za|0]);m=R(b,"BSDF");t=m.Za;m=[m,H("d_color","d_color",[0,0,0],t),H("d_roughness","d_roughness",0,t),H("s_color","s_color",[0,0,0],t),H("s_roughness","s_roughness",0,t),H("metalness","metalness",0,t),H("normal","normal",
[0,0,0],t)];break;case "BSDF_GLOSSY":g=ma(b);p.push(["USE_NORMAL_IN",g[2].Za|0]);m=R(b,"BSDF");t=m.Za;m=[m,H("d_color","d_color",[0,0,0],t),H("d_roughness","d_roughness",0,t),H("s_color","s_color",[0,0,0],t),H("s_roughness","s_roughness",0,t),H("metalness","metalness",1,t),H("normal","normal",[0,0,0],t)];break;case "MATH":switch(b.operation){case "ADD":h="MATH_ADD";break;case "SUBTRACT":h="MATH_SUBTRACT";break;case "MULTIPLY":h="MATH_MULTIPLY";break;case "DIVIDE":h="MATH_DIVIDE";break;case "SINE":h=
"MATH_SINE";break;case "COSINE":h="MATH_COSINE";break;case "TANGENT":h="MATH_TANGENT";break;case "ARCSINE":h="MATH_ARCSINE";break;case "ARCCOSINE":h="MATH_ARCCOSINE";break;case "ARCTANGENT":h="MATH_ARCTANGENT";break;case "POWER":h="MATH_POWER";break;case "LOGARITHM":h="MATH_LOGARITHM";break;case "MINIMUM":h="MATH_MINIMUM";break;case "MAXIMUM":h="MATH_MAXIMUM";break;case "ROUND":h="MATH_ROUND";break;case "LESS_THAN":h="MATH_LESS_THAN";break;case "GREATER_THAN":h="MATH_GREATER_THAN";break;case "MODULO":h=
"MATH_MODULO";break;case "ABSOLUTE":h="MATH_ABSOLUTE";break;default:return Aa.error("Unsupported MATH operation: "+b.operation),null}p.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);g=ma(b);m=V(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":h="MIX_RGB_MIX";break;case "ADD":h="MIX_RGB_ADD";break;case "MULTIPLY":h="MIX_RGB_MULTIPLY";break;case "SUBTRACT":h="MIX_RGB_SUBTRACT";break;case "SCREEN":h="MIX_RGB_SCREEN";break;case "DIVIDE":h="MIX_RGB_DIVIDE";break;case "DIFFERENCE":h="MIX_RGB_DIFFERENCE";
break;case "DARKEN":h="MIX_RGB_DARKEN";break;case "LIGHTEN":h="MIX_RGB_LIGHTEN";break;case "OVERLAY":h="MIX_RGB_OVERLAY";break;case "DODGE":h="MIX_RGB_DODGE";break;case "BURN":h="MIX_RGB_BURN";break;case "HUE":h="MIX_RGB_HUE";break;case "SATURATION":h="MIX_RGB_SATURATION";break;case "VALUE":h="MIX_RGB_VALUE";break;case "COLOR":h="MIX_RGB_COLOR";break;case "SOFT_LIGHT":h="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":h="MIX_RGB_LINEAR_LIGHT";break;default:return Aa.error("Unsupported MIX_RGB blend type: "+
b.blend_type),null}p.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);g=ma(b);m=V(b);break;case "OUTPUT":g=ma(b);m=[];break;case "OUTPUT_MATERIAL":ma(b);g=W(b,"Surface");m=g.Za;n=[g,H("d_color","d_color",[0,0,0],m),H("d_roughness","d_roughness",0,m),H("s_color","s_color",[0,0,0],m),H("s_roughness","s_roughness",0,m),H("metalness","metalness",0,m),H("normal","normal",[0,0,0],m)];t=[H("E","E",[0,0,0],!0),H("A","A",[0,0,0],!0),H("D","D",[0,0,0],!0),H("S","S",[0,0,0],!0),H("normal","normal",[0,0,0],!0),
H("bsdf_params","bsdf_params",[0,0,0,0],!0),H("shadow_factor","shadow_factor",0,!0),H("s_color","s_color",[0,0,0],!0),H("metalness","metalness",[0,0,0],!0)];r=[H("color","color",[0,0,0],!0),H("specular","specular",[0,0,0],!0),H("normal","normal",[0,0,0],!0),H("s_color","s_color",[0,0,0],!0),H("metalness","metalness",[0,0,0],!0)];u=[];g=n;m=u;n={name:b.name,value:{mI:"BSDF_COMPUTE"},kI:{name:"bsdf_begin",type:"BSDF_BEGIN",J:n,Ua:t,U:[],data:null,Eb:[],lh:[]},lI:{name:"bsdf_end",type:"BSDF_END",J:r,
Ua:u,U:[],data:null,Eb:[],lh:[]}};break;case "RGB":t=b.name;t={name:"-1",value:t};l.push(t);m.push(R(b,"Color"));break;case "SEPRGB":case "SEPHSV":g=ma(b);m=V(b);break;case "TEX_ENVIRONMENT":(u=b.image)?(h="TEXTURE_ENVIRONMENT","NONE"==b.color_space?p.push(["NON_COLOR",1]):p.push(["NON_COLOR",0]),g.push(W(b,"Vector")),m.push(R(b,"Color")),t=N("param_TEXTURE_texture"),l.push(ia(t)),n=sa.gA(b.name,128),n.Ri=u.uuid,n.Qi=u.filepath,n.gm=u.source,n.Dk=u.name,n.fm=u.Uc,n.source="ENVIRONMENT_MAP",u.Uc&&
(n.Ck=u.Cq),n={name:t,value:n}):h="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(u=b.image){h="TEXTURE_COLOR";"NONE"==b.color_space?p.push(["NON_COLOR",1]):p.push(["NON_COLOR",0]);p.push(["CONVERT_UV",0]);for(n=0;4>n;++n)n?(q=H("Vector"+n,"Vector"+n,[0,0,0],!1),t=H("Color"+n,"Color"+n,[0,0,0],!1),r=H("Alpha"+n,"Alpha"+n,0,!1)):(q=W(b,"Vector"),t=R(b,"Color"),r=R(b,"Alpha")),g.push(q),m.push(t),m.push(r);t=N("param_TEXTURE_texture");l.push(ia(t));n=sa.Ll(b.name,sa.qi,!1);n.repeat="REPEAT"==b.extension;
n.Ri=u.uuid;n.Qi=u.filepath;n.gm=u.source;n.Dk=u.name;n.fm=u.Uc;n.source="IMAGE";u.Uc&&(n.Ck=u.Cq);n={name:t,value:n}}else h="TEXTURE_EMPTY";break;case "TEXTURE":h=fa(b);if("TEXTURE_EMPTY"==h)m.push(R(b,"Color")),m.push(R(b,"Normal")),m.push(R(b,"Value"));else if("TEXTURE_ENVIRONMENT"==h)g.push(W(b,"Vector")),m.push(R(b,"Color")),m.push(R(b,"Value"));else{if("TEXTURE_NORMAL"==h&&"ENVIRONMENT_MAP"==b.texture.type)return Aa.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==
h&&(n=!1,(u=b.texture.image)&&"Non-Color"==u.colorspace_settings_name&&(n=!0),p.push(["NON_COLOR",Number(n)]),p.push(["CONVERT_UV",1]));for(n=0;4>n;++n)n?(q=H("Vector"+n,"Vector"+n,[0,0,0],!1),"TEXTURE_COLOR"==h&&(t=H("Color"+n,"Color"+n,[0,0,0],!1),r=H("Value"+n,"Value"+n,0,!1)),"TEXTURE_NORMAL"==h&&(t=H("Normal"+n,"Normal"+n,[0,0,0],!1),r=H("Value"+n,"Value"+n,0,!1))):(q=W(b,"Vector"),"TEXTURE_COLOR"==h&&(t=R(b,"Color"),r=R(b,"Value")),"TEXTURE_NORMAL"==h&&(t=R(b,"Normal"),r=R(b,"Value"))),g.push(q),
m.push(t),m.push(r)}t=N("param_TEXTURE_texture");l.push(ia(t));n=b.texture?b.texture.q:null;n={name:t,value:n};break;case "VALTORGB":g=ma(b);m=V(b);n={value:b};t=b.color_ramp.interpolation;"CONSTANT"!=t&&"LINEAR"!=t&&Aa.warn("Color Ramp node is not fully supported.");break;case "VALUE":h="VALUE";t=b.name;t={name:"-1",value:t};l.push(t);m.push(R(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":h="VECT_MATH_ADD";break;case "SUBTRACT":h="VECT_MATH_SUBTRACT";break;case "AVERAGE":h="VECT_MATH_AVERAGE";
break;case "DOT_PRODUCT":h="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":h="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":h="VECT_MATH_NORMALIZE";break;default:return Aa.error("Unsupported VECT_MATH operation: "+b.operation),null}g=ma(b);m=V(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":p.push(["VECTOR_TYPE",ja.F(0)]);break;case "VECTOR":p.push(["VECTOR_TYPE",ja.F(1)]);break;case "NORMAL":p.push(["VECTOR_TYPE",ja.F(2)]);break;default:return Aa.error("Unsupported VECT_TRANSFORM vector_type: "+
b.vector_type),null}g=b.convert_from;m=b.convert_to;t=0;if("WORLD"==g)if("WORLD"==m)t=0;else if("OBJECT"==m)t=1;else if("CAMERA"==m)t=2;else return Aa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==g)if("WORLD"==m)t=3;else if("OBJECT"==m)t=4;else if("CAMERA"==m)t=5;else return Aa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==g)if("WORLD"==m)t=6;else if("OBJECT"==m)t=7;else if("CAMERA"==m)t=8;else return Aa.error("Unsupported VECT_TRANSFORM convert_to: "+
b.convert_to),null;else return Aa.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),null;p.push(["CONVERT_TYPE",ja.F(t)]);g=ma(b);m=V(b);break;case "NORMAL_MAP":t=0;switch(b.space){case "TANGENT":t=0;break;case "OBJECT":t=1;break;case "WORLD":t=2;break;case "BLENDER_OBJECT":t=3;break;case "BLENDER_WORLD":t=4;break;default:return Aa.error("Unsupported NORMAL_MAP space: "+b.space),null}p.push(["SPACE",ja.F(t)]);g.push(W(b,"Strength"));g.push(W(b,"Color"));m.push(R(b,"Normal"));break;
case "FRESNEL":z=W(b,"Normal");g.push(W(b,"IOR"));g.push(z);m.push(R(b,"Fac"));p.push(["USE_FRESNEL_NORMAL",z.Za|0]);break;case "LAYER_WEIGHT":z=W(b,"Normal");g.push(W(b,"Blend"));g.push(z);m=V(b);p.push(["USE_NORMAL_IN",z.Za|0]);break;case "BUMP":z=W(b,"Normal"),p.push(["INVERT",b.invert?1:0]),p.push(["USE_NORMAL_IN",z.Za|0]),ma(b),V(b);default:g=ma(b),m=V(b)}h={name:f,type:h,lh:k,J:g,Ua:m,U:l,data:n,Eb:p};f=P.yk(a);P.ti(a,P.yk(a),h);if(!(h="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=
b.type)){a:{h=b.outputs;for(l=k=0;l<h.length;l++)if(h[l].is_linked&&k++>c){h=!0;break a}h=!1}h=!h}return h||null!=aa(a,b,++c,d,e)?f:null}function M(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,h=0;h<b.length;h++){var k=d[h],g=b[h];if(!k||k.default_value instanceof Array!=g)return Aa.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(h=0;h<c.length;h++)if(b=e[h],d=c[h],!b||b.default_value instanceof Array!=d)return Aa.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function L(a,b,c){var d=a.node_group.node_tree,f={},h;for(h in d)if("links"==h||"nodes"==h){f[h]=[];for(var k=0;k<d[h].length;k++){f[h][k]={};for(var g in d[h][k])if("links"==h){f[h][k][g]={};for(var m in d[h][k][g])f[h][k][g][m]=T(d[h][k][g][m])}else f[h][k][g]=T(d[h][k][g])}}else f[h]=T(d[h]);d=a.node_tree_name;if("B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d)h=D("Group input","GROUP_INPUT",[],a.inputs),k=D("Group output",
"GROUP_OUTPUT",a.outputs,[]),g=null,g="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d&&(ba.quality==va.P_LOW||ba.KA)?{from_node:h,from_socket:h.outputs[1],to_node:k,to_socket:k.inputs[0]}:{from_node:h,from_socket:h.outputs[0],to_node:k,to_socket:k.inputs[0]},f.nodes=[h,k],f.links=[g];d=a.name;h=f.nodes;k=f.links;for(g=0;g<h.length;g++)h[g].name=ua(h[g].type,d,h[g].name);for(g=0;g<k.length;g++)k[g].from_node.name=ua(k[g].from_node.type,d,k[g].from_node.name),k[g].to_node.name=ua(k[g].to_node.type,d,k[g].to_node.name);
return{DN:e(f,a.node_group.uuid,!0,b,c).Ma,EN:f.links}}function T(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?ya.ao(a):a}function N(a){S[a]||(S[a]=0);var b=a+"_"+S[a],b=b.replace(/ /g,"_").replace(/\//g,"_");S[a]++;return b}function U(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function O(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function qa(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function fa(a){if(!a.texture||!a.texture.q)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var h=b[f];if(h.is_linked)switch(h.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:ya.r("Unknown texture output")}}if(c)return d&&
Aa.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function W(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return ha(e)}return null}function R(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return ha(e)}return null}function ha(a){var b=
a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=ya.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,Za:d,wa:a}}function H(a,b,c,d){return{name:a,identifier:b,Za:d,wa:c}}function ma(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=ha(a.inputs[c]);d.wa.length&&d.wa.splice(3);b.push(d)}return b}function V(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=ha(a.outputs[c]);b.push(d)}return b}function ia(a,b,c){b=null===b||void 0===b?null:ja.F(b,c);return{name:a,value:b}}function pa(a,b,c,d,
e,f){var h=[],k=f.from_socket.identifier;f=f.to_socket.identifier;var g=d.Ua;for(d=0;d<g.length;d++)if(g[d].identifier==k){h.push(d);break}e=e.J;for(d=0;d<e.length;d++)if(e[d].identifier==f){h.push(d);break}2==h.length&&P.Lc(a,b,c,h);return!0}function ua(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function ca(a){var b=[];P.la(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function X(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.DN,f=c[d].data.EN;
if(!e)return!1;P.la(e,function(b,c){P.ti(a,P.yk(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);K(c[d],b,a)}return!0}function ka(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function Ha(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],h=null,k=0;k<b.length;k++)if(f.from_socket.identifier==b[k].to_socket.identifier){h=b[k];break}h?(f.from_node=h.from_node,f.from_socket=
h.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function Ea(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function da(a,b,c,d){for(var e=0;e<d.length;e++){for(var f=d[e],h,k=0;k<c.J.length;k++)if(f.from_socket.identifier==c.J[k].identifier){h=c.J[k].wa;break}for(var k=f,g=b,m=h,l=y(k.to_node,g),n=0;n<l.length;n++)for(var p=P.Pa(g,l[n]),t=0;t<p.J.length;t++){var r=p.J[t];if(r.identifier==k.to_socket.identifier){p=
r.wa instanceof Object?0:1;if((m instanceof Object?0:1)==p)r.wa=m;else switch(p){case 0:r=r.wa;r[0]=r[1]=r[2]=m;break;case 1:r.wa=(m[0]+m[1]+m[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function K(a,b,c){for(var d=a.name,e=[],f=[],h=[],k=[],g=0;g<b.length;g++){var m=b[g];ka(m.from_node,d,m,e,h,k);ka(m.to_node,d,m,f,h,k)}f=Ha(b,f,h);e=Ha(b,k,e);Ea(b,f);da(b,c,a,f);if(e.length){var l;P.la(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(l=b)});da(b,c,l,e)}}function Ba(a){var b=
[],c=[];P.la(a,function(a,d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,e=a=null,f=b.length+c.length;if(b.length){a=sa.mJ(b,sa.YE);for(var h=0;h<b.length;h++)b[h].Eb.push(["NODE_TEX_ROW",ja.F((d+.5)/f)]),d++}if(c.length)for(e=sa.jK(c,sa.wy),h=0;h<c.length;h++)c[h].Eb.push(["NODE_TEX_ROW",ja.F((d+.5)/f)]),d++;h=null;a&&e?(h=new Uint8Array(a.length+e.length),h.set(a),h.set(e,a.length)):h=a?a:e;a=h?sa.UA(h,sa.wy):null;for(h=0;h<b.length;h++)b[h].data.Xa=
a;for(h=0;h<c.length;h++)c[h].data.Xa=a}function za(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var va=q("__config");q("__debug");var P=q("__graph"),Y=q("__mat3"),na=q("__mat4"),ea=q("__objects"),Aa=q("__print"),ja=q("__shaders"),ta=q("__scenes"),ya=q("__util"),Ca=q("__vec3"),sa=q("__textures"),S={},oa={},wa={},Da={},La=0;new Float32Array(4);var ba=va.A;a.JR=0;a.$G=1;a.ZG=2;a.YG=3;a.IR=4;a.XG=5;a.WG=6;a.VG=7;a.HR=8;a.JF=
0;a.IF=1;a.BR=2;a.HF=3;a.AR=4;a.hB=function(a){return oa[a]};a.WI=function(a){delete oa[a]};a.cJ=e;a.Tu=function(a,c,d){var e=ta.get_active();a=f(a,"MAIN",e.uuid);if(a in wa)return wa[a];var e=P.create(),h={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},k=aa(e,h,0,c,null),h={name:"LIGHTING_END",type:"LIGHTING_END"},h=aa(e,h,0,c,null);b(e,d,k,h,[[k,[8,10]],[k,[9,6]]],c);v(e);return wa[a]=e};a.Xq=function(a){var b=[],c={};S={};var d=P.Rx(a);P.la(d,function(a,d){var e;e=[];for(var f=[],h=[],k=[],g=[],
m=[],l=0;l<d.J.length;l++){var n=d.J[l];if(n.Za)e.push(null),f.push(null);else{e.push(N("in_"+d.type+"_"+n.identifier.replace(/\./g,"")));var p=ja.F(n.wa,0);ba.px&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==n.identifier||"Color2"==n.identifier||"Fac"==n.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==n.identifier||"Value_001"==n.identifier||"Value.001"==n.identifier)||0<=d.type.indexOf("VECT_MATH_")&&("Vector_001"==n.identifier||"Vector.001"==n.identifier)||0<=d.type.indexOf("LIGHTING_APPLY")||
0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(n=p,n=n.replace(/(,)/g,"$1 "),n=n.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),n=n.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),p=n=n.replace(/\s+/g,""));f.push(p)}}for(l=0;l<d.Ua.length;l++)n=d.Ua[l],n.Za?h.push(null):h.push(N("out_"+d.type+"_"+n.identifier.replace(/\./g,"")));for(l=0;l<d.U.length;l++)n=d.U[l],k.push(n.name),g.push(n.value);for(l=0;l<d.lh.length;l++)m.push(d.lh[l].name);e={id:d.type,J:e,
Uv:f,Ua:h,U:k,Is:g,lh:m,Eb:JSON.parse(JSON.stringify(d.Eb))};b.push(e);c[a]=e});P.Lf(d,function(a,b,e){var f=P.Pa(d,a);P.Pa(d,b);var h=f.Ua[e[0]];a=c[a].Ua;b=c[b].J;f=a[e[0]]||N("out_"+f.type+"_"+h.identifier.replace(/\./g,""));a[e[0]]=f;b[e[1]]=f});return b};a.Oz=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.cleanup=function(){for(var a in oa)delete oa[a];for(a in wa)delete wa[a];
for(var b in Da)delete Da[b];La=0}};b4w.module.__animation=function(a,q){function e(a,b){var c=a.ba[b];c&&c.vv&&c.Co&&(c.Co=!1,c.vv(a,b))}function d(a,b,c){c=a.ba[c];c.type=30;var d=b.pa,e=b.Sa-d+1;c.start=d;c.length=e;c.Te=d;c.th=b.name;for(e=d=0;e<a.Hc.length;e++){var f=a.Hc[e];if(f==b)break;else d+=f.Sa-f.pa+1}c.DE=d}function b(a,b){a.type=50;a.th=b.name;a.start=b.pa;a.length=b.Sa-a.start;b.cyclic||(a.length+=b.fw)}function g(a){return a.replace(/_B4W_BAKED$/,"")}function l(a,b){return{ym:a,action:b}}function w(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.q.type&&b.push(l(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var e=a[d];if(e.node_group){var f=e.node_group.node_tree;if(f){var h=c.slice();h.push(e.name);w(f,b,h)}}}}function f(a){return W.is_mesh(a)&&a.k.Hc?!0:!1}function n(a,b,c){var d=a.ba;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.Te=b,v(a,0,c,!0))}else if(e=d[c])e.Te=b,v(a,0,c,!0)}function r(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function v(a,b,c,d){x(a,b,c,d);e(a,c);a.k.sh&&(G(a,
b),B(a,b))}function c(a,b,c,d){var e=c.frame_range;if(e[0]>e[1])return H.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;var f=c.q,h=a.ba[d];h.th=c.name;h.ju=e;h.Vy=f.zC;h.Ty=f.nz;h.xh.set(f.xh);h.start=e[0];h.length=e[1]-e[0];h.Te=e[0];switch(f.type){case 10:if(W.is_armature(a)){h.type=10;var k=m(a,b,c);if(!k){for(var k=a.k.qe,e=[],g=[],l=c.q.Hw,n=0;n<l;n++){for(var t in k){var r=k[t],v=r.ut,w=c.q.xu[t];w?ka.copy(w.subarray(8*n,8*n+8),v):ka.identity(v);r.vt=!1}r=
A(k);e.push(r.trans);g.push(r.sb)}k={trans:e,sb:g};p(a,b,c,k)}h.trans=k.trans;h.sb=k.sb;b=k;h=a.k;k=h.Pm;e=a.ba[d];t=e.ux;a:{g=h.dt;for(l=0;l<g.length;l+=2)if(c==g[l]){g=g[l+1];break a}g=null}if(g)e.ux=g;else{for(e=0;e<k.length;e++){g=k[e].vh;l=[];n=[];r=b.trans;v=b.sb;for(w=0;w<r.length;w++){var q=J(r[w],v[w],g);l.push(q.trans);n.push(q.sb)}t.push({trans:l,sb:n})}h.dt.push(c,t)}h.sh&&(c=h.gn,d>c[1]?(b=c[1],c[1]=d,c[0]=b):d>c[0]&&d<c[1]&&(c[0]=d),y(a))}break;case 40:W.is_speaker(a)&&(h.volume=f.U.volume||
null,h.pitch=f.U.pitch||null,h.type=40);break;case 70:W.is_lamp(a)&&(h.color=f.U.color||null,h.Ve=f.U.energy||null,h.type=70);break;case 60:if("MESH"==a.type){h.type=60;t=m(a,b,c);if(!t){t=[];e=[];g=[];l=[];n=[];r=c.q;v=b?b[0]:null;for(k in r.U){w=b;q=k.match(/"(.*?)"/)[1];if(w&&1<w.length){for(var z=w[1],F=2;F<w.length;F++)z=z+"%join%"+w[F];z+="%join%"+q}else z=q;w=z;for(q=0;q<a.G.length;q++)for(z=a.G[q].T,F=0;F<z.length;F++){var x=z[F];if(!v||-1!=x.lc.indexOf(v)){var C=x.ef,O=u(k,w,r,e,t,x.ff),
C=u(k,w,r,l,g,C);(O||C)&&n.push(x)}}}t={RQ:t,values:e,sO:g,tO:l,As:n};p(a,b,c,t)}h.ff=t.RQ;h.mC=t.values;h.ef=t.sO;h.lC=t.tO;h.As=t.As}break;case 20:if(k=f.U.tsr){h.type=20;t=m(a,b,c);if(!t){t=c.q.Hw;e=[];g=[];for(l=0;l<t;l++)e.push(k.subarray(8*l,8*l+4)),g.push(k.subarray(8*l+4,8*l+8));t={trans:e,sb:g};p(a,b,c,t)}h.trans=t.trans;h.sb=t.sb;R.zm(a)&&R.FQ(a,h.trans[0],h.sb[0])}else return H.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:W.is_world(a)&&
(h.Ve=f.U["light_settings.environment_energy"]||null,h.Jd=f.U.horizon_color||null,h.Rd=f.U.zenith_color||null,h.Fo=f.U["mist_settings.intensity"]||null,h.fog_depth=f.U["mist_settings.depth"]||null,h.fog_start=f.U["mist_settings.start"]||null,h.fog_height=f.U["mist_settings.height"]||null,h.JA=f.U.b4w_fog_color||null,h.type=80)}W.is_armature(a)&&10!=f.type&&E(a,d);return!0}function m(a,b,c){a=a.Eq;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==a[d]&&b==a[d+1])return a[d+2];return null}
function p(a,b,c,d){a.Eq.push(c,b?b.join("%join%"):null,d)}function y(a){var b=a.k.gn;if(-1!=b[0]&&-1!=b[1]){var c=a.ba;a=c[b[1]].Te;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.Te;d=Math.floor(a);b.Te=d+e}}function E(a,b){var c=a.k.gn,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.ba;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function u(a,b,c,d,e,f){if(!f)return!1;for(var h=!1,k=0;k<f.length;k+=2)b==f[k]&&(e.push(f[k+1]),d.push(new Float32Array(c.U[a])),h=!0);return h}
function z(a){a=a.q;for(var b in a.U)if(-1!=b.indexOf("nodes"))return!0;return!1}function x(a,b,c,d){if((c=a.ba[c])&&null!=c.type&&(c.play||d)){var e=a.k,f=c.Te,h=c.start,k=c.length,f=f+c.speed*b*ca.Zc(),g=c.type,m=c.speed;if(0<=m&&f>=h+k||0>m&&f<h)switch(d||(c.Co=!0),c.behavior){case 10:f=0<=m?(f-h)%k+h:h+k-1E-6;break;case 20:f=0<=m?h:h+k-1E-6;c.play=!1;break;case 30:f=0<=m?h+k-1E-6:h,c.play=!1}c.Te=f;switch(g){case 10:if(!e.sh){d=I(c);b=d[0];var l=d[1];d=d[2];e.Ld=c.sb[b];e.ee=c.sb[l];e.Pd=c.trans[b];
e.he=c.trans[l];e.we=d;d=e.Pm;c=c.ux;for(var n=0;n<d.length;n++){var p=d[n],t=c[n];p.Ld=t.sb[b];p.ee=t.sb[l];p.Pd=t.trans[b];p.he=t.trans[l];p.we=e.we}X.B(a)}break;case 20:d=I(c);var e=za,l=d[0],n=d[1],p=d[2],t=c.trans,r=t[l][1],f=t[l][2],h=t[n][1],k=t[n][2];e[0]=(1-p)*t[l][0]+p*t[n][0];e[1]=(1-p)*r+p*h;e[2]=(1-p)*f+p*k;l=P;f=d[0];n=d[1];p=d[2];t=c.sb;r=Y;r[0]=t[f][0];r[1]=t[f][1];r[2]=t[f][2];r[3]=t[f][3];f=na;f[0]=t[n][0];f[1]=t[n][1];f[2]=t[n][2];f[3]=t[n][3];ma.slerp(r,f,p,l);n=d[2];p=c.trans;
d=(1-n)*p[d[0]][3]+n*p[d[1]][3];a.parent&&a.Ms&&(n=ea,ka.set_sep(e,d,l,n),ka.multiply(a.Ms,n,n),ka.Ub(n,e),ka.zd(n,l),d=ka.get_scale(n));c.Zx&&(n=va,X.get_translation(a,n),Ha.smooth_v(e,n,b,c.Zx,e));c.Xw&&(n=Y,X.get_rotation(a,n),Ha.zD(l,n,b,c.Xw,l));f=c.xh;f[0]&&X.set_translation_rel(a,e);f[1]&&X.set_rotation_rel(a,l);f[2]&&X.set_scale_rel(a,d);X.B(a);ha.sync_transform(a);break;case 30:d=c.Te-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=
--a,d=1);c=c.DE;Ba[0]=a+c;Ba[1]=b+c;Ba[2]=d;d=Ba;e.Ct=d[0];e.Dt=d[2];break;case 40:d=I(c);b=d[0];e=d[1];d=d[2];c.volume&&pa.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&pa.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:b=10==c.behavior?(f-h)/ca.Zc():f/ca.Zc();R.cP(a,c.th,b);break;case 60:d=I(c);b=d[0];e=d[1];d=d[2];t=c.mC;r=c.ff;a=c.lC;l=c.ef;n=c.As;for(c=0;c<r.length;c++)for(f=t[c],p=r[c],h=(1-d)*f[b]+d*f[e],f=0;f<n.length;f++)n[f].Rh[p]=h;for(c=0;c<l.length;c++)for(t=a[c],p=l[c],
t=Ea.lerp(t.subarray(3*b,3*b+3),t.subarray(3*e,3*e+3),d,za),f=0;f<n.length;f++)n[f].ae[3*p]=t[0],n[f].ae[3*p+1]=t[1],n[f].ae[3*p+2]=t[2];break;case 70:d=I(c);b=d[0];e=d[1];d=d[2];f=c.xh;(k=c.Ve)&&f[0]&&fa.set_light_energy(a.$a,(1-d)*k[b]+d*k[e]);(c=c.color)&&f[1]&&(za[0]=(1-d)*c[3*b]+d*c[3*e],za[1]=(1-d)*c[3*b+1]+d*c[3*e+1],za[2]=(1-d)*c[3*b+2]+d*c[3*e+2],fa.set_light_color(a.$a,za));h=a.G;for(c=0;c<h.length;c++)ia.qQ(a,h[c].mb);break;case 80:d=I(c);b=d[0];e=d[1];d=d[2];f=c.xh;h=a.G;m=ia.Ja(h[0].mb,
ua.Bb);k=c.Ve;k=f[0]?(1-d)*k[b]+d*k[e]:m.Ve;g=c.Jd;f[1]?(za[0]=(1-d)*g[3*b]+d*g[3*e],za[1]=(1-d)*g[3*b+1]+d*g[3*e+1],za[2]=(1-d)*g[3*b+2]+d*g[3*e+2],g=za):g=m.Jd;var u=c.Rd;f[2]?(va[0]=(1-d)*u[3*b]+d*u[3*e],va[1]=(1-d)*u[3*b+1]+d*u[3*e+1],va[2]=(1-d)*u[3*b+2]+d*u[3*e+2],m=va):m=m.Rd;u=c.Fo;f[3]&&(l=(1-d)*u[b]+d*u[e]);u=c.fog_depth;f[4]&&(n=(1-d)*u[b]+d*u[e]);u=c.fog_start;f[5]&&(p=(1-d)*u[b]+d*u[e]);u=c.fog_height;f[6]&&(t=(1-d)*u[b]+d*u[e]);c=c.JA;f[7]&&(P[0]=(1-d)*c[3*b]+d*c[3*e],P[1]=(1-d)*c[3*
b+1]+d*c[3*e+1],P[2]=(1-d)*c[3*b+2]+d*c[3*e+2],r=P);for(c=0;c<h.length;c++)b=a.G[c].mb,(f[0]||f[1]||f[2])&&ia.set_environment_colors(b,k,g,m),f[3]&&ia.bD(b,l),f[4]&&ia.$C(b,n),f[5]&&ia.cD(b,p),f[6]&&ia.aD(b,t),f[7]&&ia.set_fog_color_density(b,r);break;default:Ha.r("Unknown animation type:"+g)}}}function I(a){var b=a.ju[0],c=a.ju[1]-b,b=a.Te-b;0>b&&(b=0);b>=c&&(b=c);b/=a.Vy;c=Math.floor(b);a=a.Ty[c]?b-c:0;b=Math.ceil(c+a);Ba[0]=c;Ba[1]=b;Ba[2]=a;return Ba}function B(a,b){var c=a.k,d=c.Dg,e=c.gn,f=
e[0],e=e[1];if(-1!=e){if(-1!=f){var h=a.ba[f];if(h.play||0==b){var k=I(h),g=k[0],m=k[1];c.we=k[2];var k=h.sb[g],l=h.sb[m],g=h.trans[g],m=h.trans[m]}else d=1}else d=1;e=a.ba[e];if(e.play||0==b){var f=I(e),n=f[0],p=f[1];c.we=f[2]}else if(-1!=f&&h.play)d=0;else return;f=e.sb[n];h=e.sb[p];n=e.trans[n];p=e.trans[p];if(1==d)c.Ld.set(f),c.ee.set(h),c.Pd.set(n),c.he.set(p);else if(0==d)c.Ld.set(k),c.ee.set(l),c.Pd.set(g),c.he.set(m);else{for(e=0;e<k.length;e+=4){for(var t=P,r=Y,u=0;4>u;u++)t[u]=k[e+u],r[u]=
f[e+u];ma.slerp(t,r,d,t);for(u=0;4>u;u++)c.Ld[e+u]=t[u];for(u=0;4>u;u++)t[u]=l[e+u],r[u]=h[e+u];ma.slerp(t,r,d,t);for(u=0;4>u;u++)c.ee[e+u]=t[u]}Ha.qz(g,n,d,c.Pd);Ha.qz(m,p,d,c.he)}X.B(a);O.CQ(a)}}function G(a,b){var c=a.k,d=c.Dg,e=c.En;if(0!=e){var d=c.Dn-d,f=e*b;Ha.sign(d)==Ha.sign(e)&&Math.abs(f)<Math.abs(d)?c.Dg+=f:(c.Dg=c.Dn,c.En=0)}}function A(a){var b=[],c=[],d=new Float32Array(4),e=new Float32Array(4),f;for(f in a){var h=a[f],k=d,g=e,m=h.Vq,l=m[m.length-1],n=l.ay;l.vt||ka.identity(n);for(l=
m.length-1;0<=l;l--){var p=m[l],t=p.ay;if(p.vt)n=t;else{var r=p.zj,u=p.ut;ka.invert(r,ea);ka.multiply(u,ea,ea);ka.multiply(r,ea,ea);ka.multiply(n,ea,t);n=t;p.vt=!0}}m=p.ay;k[0]=m[0];k[1]=m[1];k[2]=m[2];k[3]=m[3];g[0]=m[4];g[1]=m[5];g[2]=m[6];g[3]=m[7];ma.normalize(g,g);h=h.xi;for(k=0;4>k;k++)g=4*h+k,b[g]=d[k],c[g]=e[k]}return{trans:b,sb:c}}function J(a,b,c){var d=[],e=[];new Float32Array(4);new Float32Array(4);for(var f in c)for(var h=c[f],k=h.xi,h=h.ev,g=0;4>g;g++){var m=4*h+g,l=4*k+g;d[m]=a[l];
e[m]=b[l]}d=new Float32Array(d);e=new Float32Array(e);return{trans:d,sb:e}}function t(a){var b=a.q,c;if(b.xu)c=10;else if(b.U)if("volume"in b.U||"pitch"in b.U)c=40;else if(z(a))c=60;else{var d;a:{if(a.q.U){d=a.fcurves;for(var e in d)if("color"==e&&!d[e][3]){d=!0;break a}if("energy"==e){d=!0;break a}}d=!1}if(d)c=70;else if(d=a.q.U,"light_settings.environment_energy"in d||"horizon_color"in d||"zenith_color"in d||"mist_settings.intensity"in d||"mist_settings.depth"in d||"mist_settings.start"in d||"mist_settings.height"in
d||"b4w_fog_color"in d)c=80;else{a:{if(a.q.U)for(c in a=a.fcurves,a)if("location"==c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}else c=0;b.type=c}function z(a){if(a=a.q.U)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;return!1}function h(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function C(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function k(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=
b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function F(a,b,c,d,e,f,h){var k=a+(b-a)/2,g=D(k,d,e,f,h)-c;return.02>Math.abs(g)?k:0<g?F(a,k,c,d,e,f,h):F(k,b,c,d,e,f,h)}function D(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function aa(a,
b){var c={type:null,th:null,ju:null,Vy:0,Ty:null,xh:new Int8Array(8),sb:null,trans:null,ux:[],play:!1,behavior:20,Te:0,start:0,length:0,Zx:0,Xw:0,Co:!1,DE:null,speed:1,volume:null,pitch:null,color:null,Ve:null,Rd:null,Jd:null,Fo:null,fog_depth:null,fog_start:null,fog_height:null,JA:null,mC:[],ff:[],lC:[],ef:[],As:null};if(!a.ba.length)for(var d=0;8>d;d++)a.ba.push(null);a.ba[b]=c;-1==Aa.indexOf(a)&&Aa.push(a)}function M(a,b){X.B(a);ha.sync_transform(a);v(a,0,b,!0)}function L(a,e,f,h){h=h||0;if(W.is_mesh(a)){var k=
T(a,f);if(k)return aa(a,h),d(a,k,h),M(a,h),!0;if((k=N(a,f))&&"EMITTER"==k.Gs){aa(a,h);e=k.name;f=h;for(var k=a.G,g=0;g<k.length;g++)for(var m=k[g].T,l=0;l<m.length;l++){var n=m[l].Va;n&&n.name==e&&b(a.ba[f],n)}M(a,h);return!0}}if(k=Ha.keysearch("name",f,ja)||Ha.keysearch("name",f+"_B4W_BAKED",ja)){aa(a,h);if(c(a,e,k,h))return M(a,h),!0;a.ba[h]=null}H.error('Unsupported object: "'+a.name+'" or animation name: "'+f+'"');return!1}function T(a,b){for(var c=0;c<a.Hc.length;c++){var d=a.Hc[c];if(d.name===
b)return d}return null}function N(a,b){for(var c=a.G,d=0;d<c.length;d++)for(var e=c[d].T,f=0;f<e.length;f++){var h=e[f].Va;if(h&&h.name===b)return h}return null}function U(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var O=q("__armature"),qa=q("__config"),fa=q("__lights"),W=q("__obj_util"),R=q("__particles"),ha=q("__physics"),H=q("__print"),ma=q("__quat"),V=q("__reformer"),ia=q("__scenes"),pa=q("__sfx"),ua=q("__subscene"),ca=q("__time"),
X=q("__transform"),ka=q("__tsr"),Ha=q("__util"),Ea=q("__vec3"),da=qa.Rj,K=qa.zh;a.AF=1E-6;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.VF=70;a.UF=80;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var Ba=Array(3),za=new Float32Array(3),va=new Float32Array(3),
P=new Float32Array(4),Y=new Float32Array(4),na=new Float32Array(4),ea=ka.create();new Float32Array(16);var Aa=[],ja=[];a.fB=function(){return Ha.trunc((K.dp-50)/4)};a.frame_to_sec=function(a){return a/ca.Zc()};a.update=function(a){for(var b=0;b<Aa.length;b++){for(var c=Aa[b],d=0;8>d;d++)x(c,a,d);c.k.sh&&(G(c,a),B(c,a))}for(b=0;b<Aa.length;b++)for(c=Aa[b],d=0;8>d&&c.ba.length;d++)e(c,d)};a.AL=function(){return ja};a.get_anim_names=function(a){var b=[];if(f(a))for(var c=0;c<a.Hc.length;c++)b.push(a.Hc[c].name);
for(var d=[],c=0;c<ja.length;c++){var e=ja[c],h=e.q;20==h.type?d.push(e):60==e.q.type&&"MESH"==a.type?d.push(e):10==h.type&&"ARMATURE"==a.type?d.push(e):40==h.type&&"SPEAKER"==a.type?d.push(e):80==h.type&&"WORLD"==a.type&&d.push(e)}for(c=0;c<d.length;c++)b.push(g(d[c].name));if(R.zm(a)&&R.qC(a))for(a=a.G,c=0;c<a.length;c++)for(d=a[c].T,e=0;e<d.length;e++)(h=d[e].Va)&&b.push(h.name);return b};a.ND=g;a.get_anim_type=function(a,b){var c=a.ba[b];return c?c.type:0};a.apply_def=function(a){for(var e=0,
h=a.G,k=0;k<h.length;k++)for(var g=h[k].T,m=0;m<g.length;m++){var l=g[m].Va;l&&"EMITTER"==l.Gs&&!g[m].uf&&(aa(a,e),b(a.ba[e],l),M(a,e),a.ba[e].behavior=l.cyclic?10:a.Qj,e++)}h=a.Uf.slice();for(k=0;k<h.length;k++)m=h[k],g=m.ym,m=m.action,aa(a,e),c(a,g,m,e)?(M(a,e),a.ba[e].behavior=a.Qj,e++):a.ba[e]=null;f(a)&&(aa(a,e),d(a,a.Hc[0],e),M(a,e),a.ba[e].behavior=a.Qj)};a.nu=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:Ha.r("Wrong animation behavior")}};
a.EL=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],e=d.node_tree;e&&w(e,b,[d.name])}return b};a.zB=l;a.play=function(a,b,c){r(a.ba,c,function(a){a.play=!0;a.vv=b?b:null;a.Co=!1});a.k.sh&&y(a)};a.stop=function(a,b){r(a.ba,b,function(a){a.play=!1;a.vv=null;a.Co=!1})};a.is_play=function(a,b){var c=a.ba;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.set_frame=n;a.set_first_frame=function(a,b){b=b||0;r(a.ba,b,function(c){n(a,
c.start,b)})};a.cB=function(a,b){var c=a.ba[b];return c&&c.Te?c.Te:0};a.is_cyclic=function(a,b){var c=a.ba[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){r(a.ba,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.ba[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,d){r(a.ba,d,function(a){a.Zx=b||0;a.Xw=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.ba[c]=null;else a.ba[b]=null;a.k.sh&&E(a,b)};a.tQ=v;a.sC=function(a){if("ARMATURE"==
a.type||a.Jq||"WORLD"==a.type)return!0;for(var b=0;b<a.Uf.length;b++){var c=a.Uf[b].action.q.type;if(20==c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return R.zm(a)&&R.qC(a)||"MESH"==a.type&&a.Hc.length?!0:!1};a.xz=function(a,b){if("ARMATURE"==b.type||U(a)||"WORLD"==b.type)return!0;for(var c=0;c<b.Uf.length;c++){var d=b.Uf[c].action.q.type;if(20==d||10==d||40==d&&"SPEAKER"==b.type||60==d&&"MESH"==b.type)return!0}return R.iI(a)&&R.hI(a)||"MESH"==b.type&&
a.data.b4w_vertex_anim.length?!0:!1};a.is_animated=function(a){return Boolean(a.ba.length)};a.rI=A;a.UK=J;a.lH=function(a){function b(a,c){for(var d=0;d<c;d++){var e=a.subarray(8*d+4,8*d+8);ma.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function d(a,b,c,h,k){if(-1<c.search(e)){a=b;c=c.split('"')[1];var g=f}else 8==k?(c="tsr",g=f):g=1<k?new Float32Array(k):0;if(!a[c]){k=
a;b=c;if("object"==typeof g&&g.length)for(var m=g.length,l=new Float32Array(h*m),n=0;n<h;n++)for(var p=0;p<m;p++)l[n*m+p]=g[p];else if("number"==typeof g)for(l=new Float32Array(h),n=0;n<h;n++)l[n]=g;else Ha.r("Wrong storage default value");k[b]=l}return a[c]}var e=new RegExp(/pose.bones\[\".+\"\]/g),f=ka.create(),g=a.q={type:0,Hw:0,zC:0,U:null,xu:null,nz:null,xh:new Int8Array(8)};g.zC=1/da.tk;var m=a.fcurves,l={},n={},p=0,r;for(r in m){var u=m[r],v;for(v in u){var w=u[v],q=w.Pe;V.CI(w,a);w=w.num_channels;
p||(p=q.length);for(var w=d(l,n,r,p,w),z=w.length/p,F=c(r,v|0),y=0;y<p;y++)w[y*z+F]=q[y]}}if(Ha.No(l)){for(var x in l)"tsr"==x&&b(l[x],p);g.U=l}if(Ha.No(n)){for(var A in n)b(n[A],p);g.xu=n}g.Hw=p;g.nz=a.aH;"tsr"in l&&h(m,g.xh);("color"in l||"energy"in l)&&C(m,g.xh);("light_settings.environment_energy"in l||"horizon_color"in l||"zenith_color"in l||"mist_settings.intensity"in l||"mist_settings.depth"in l||"mist_settings.start"in l||"mist_settings.height"in l||"b4w_fog_color"in l)&&k(m,g.xh);t(a);ja.push(a)};
a.DL=function(a,b){return(b-a)*da.tk+1};a.LH=function(a,b,c,d,e,f){var h=new Float32Array(2),k=new Float32Array(2),g=new Float32Array(2),m=new Float32Array(2),l=b[1],n=b[2],p=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var t=0,r=0,u=null;e<=f;e++)if(e<l)for(var v=0;v<da.tk;v++)c[t++]=n;else if(e>p)for(v=0;v<da.tk;v++)c[t++]=a;else{var w=b[r],q=3;0===w&&(q+=2);0===u&&(q+=2);var z=2===w?0:1;if(b[r+1]==b[r+q+1])u=w,r+=q;else{v=0;e==b[r+1]&&(z&&(d[t]=1),c[t]=b[r+2],t++,v++);if(e==p)for(;v<
da.tk;v++)c[t++]=a;else for(h[0]=b[r+1],h[1]=b[r+2],0!==w?(k[0]=0,k[1]=0):0===u?(k[0]=b[r+5],k[1]=b[r+6]):(k[0]=b[r+3],k[1]=b[r+4]),0!==w?(g[0]=0,g[1]=0):(g[0]=b[r+q+3],g[1]=b[r+q+4]),m[0]=b[r+q+1],m[1]=b[r+q+2];v<da.tk;v++){var y=e+v/da.tk;switch(w){case 0:var x=h,C=k,A=g,O=m,K=[],B=[],E=void 0,H=void 0,G=void 0,E=void 0;K[0]=x[0]-C[0];K[1]=x[1]-C[1];B[0]=O[0]-A[0];B[1]=O[1]-A[1];G=O[0]-x[0];E=Math.abs(K[0]);H=Math.abs(B[0]);0!=E+H&&E+H>G&&(E=G/(E+H),C[0]=x[0]-E*K[0],C[1]=x[1]-E*K[1],A[0]=O[0]-E*
B[0],A[1]=O[1]-E*B[1]);z&&(d[t]=1);c[t]=D(F(0,1,y,h[0],k[0],g[0],m[0]),h[1],k[1],g[1],m[1]);t++;break;case 1:z&&(d[t]=1);x=h[0];C=h[1];A=(m[1]-C)/(m[0]-x);c[t]=A*y+(C-A*x);t++;break;case 2:z&&(d[t]=1);c[t]=b[r+2];t++;break;default:Ha.r("Unknown keyframe interpolation mode: "+w)}}e+1==b[r+q+1]&&(u=w,r+=q)}}};a.apply=L;a.IH=function(a,b,d,e){e=e||0;var f=Ha.keysearch("uuid",d,ja);if(f){aa(a,e);if(c(a,b,f,e)){M(a,e);return}a.ba[e]=null}H.error('Unsupported object: "'+a.name+'" or animation uuid: "'+
d+'"')};a.EE=function(a,b){var c=Ha.keysearch("name",b,ja)||Ha.keysearch("name",b+"_B4W_BAKED",ja);if(c){if(0==c.q.type)return!1}else if(!(N(a,b)||W.is_mesh(a)&&T(a,b)))return!1;return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.ba,d=0;d<c.length;d++){var e=c[d];if(e&&g(e.th)==g(b))return d}return-1};a.BL=function(a,b){var c=a.ba[b];return c&&c.th?g(c.th):null};a.remove=function(a){a.ba.length=0;a=Aa.indexOf(a);-1!=a&&Aa.splice(a,1)};a.eO=function(a){for(var b=ja.length-1;0<=b;b--)ja[b].bH==
a&&ja.splice(b,1)};a.apply_to_first_empty_slot=function(a,b){if(!a.ba.length)return L(a,b,0)?0:-1;for(var c=0;c<a.ba.length;c++)if(!a.ba[c])return L(a,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.k.En=(b-a.k.Dg)/c;a.k.Dn=b};a.set_speed=function(a,b,c){r(a.ba,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.ba[b].speed};a.get_anim_start_frame=function(a,b){return a.ba[b].start};a.get_anim_length=function(a,b){return a.ba[b].length};a.cleanup=function(){Aa.length=0;ja.length=0};a.WK=
function(a){var b=(a[0]||a[1]||a[2]).Pe.length,c=P,d=za,e=Boolean(a[0]);e||(a[0]={Pe:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={Pe:new Float32Array(b),num_channels:8});var h=Boolean(a[2]);h||(a[2]={Pe:new Float32Array(b),num_channels:8});a[3]={Pe:new Float32Array(b),num_channels:8};for(var k=0;k<b;k++)d[0]=e?a[0].Pe[k]:0,d[1]=f?a[1].Pe[k]:0,d[2]=h?a[2].Pe[k]:0,Ha.euler_to_quat(d,c),a[0].Pe[k]=c[3],a[1].Pe[k]=c[0],a[2].Pe[k]=c[1],a[3].Pe[k]=c[2]};a.$A=U;a.oP=function(a,b){for(var c=
7,d=0,e=0;e<ja.length;e++){var f=ja[e];if(f.name==b){d=f.q.type;break}}0==d&&(T(a,b)?d=30:(e=N(a,b))&&"EMITTER"==e.Gs&&(d=50));for(e=0;8>e;e++)if(f=a.ba[e]){if(f.type==d)return e}else e<c&&(c=e);return c}};b4w.module.__time=function(a,q){function e(){return-1!==d.Rj.yr?d.Rj.yr:r}var d=q("__config");q("__print");var b=0,g=0,l=[],w=0,f=0,n=[],r=-1;a.gD=function(a){b=a;g=performance.now();for(a=0;a<l.length;a++){var c=l[a];b>c.pv&&(l.splice(a,1),a--,c.callback())}for(a=0;a<n.length;a++){var c=n[a],d=1-(c.pv-b)/c.duration,d=Math.min(d,1);c.callback(c.from+d*(c.to-c.from));1==d&&(n.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,c){var d;w++;d=w;l.push({id:d,callback:a,pv:b+
(performance.now()-g+c)/1E3});return d};a.clear_timeout=function(a){for(var b=0;b<l.length;b++)if(l[b].id==a){l.splice(b,1);break}};a.clear_animation=function(a){for(var b=n.length;b--;)if(n[b].id==a){n.splice(b,1);break}};a.animate=function(a,c,d,e){d/=1E3;var g;f++;g=f;n.push({id:g,callback:e,from:a,to:c,pv:b+d,duration:d});e(a);return g};a.reset=function(){g=b=0;l.length=0;f=w=n.length=0};a.Zc=e;a.NO=function(a){r=a};a.get_frame=function(a){return a*e()}};b4w.module.__transform=function(a,q){function e(a,b){c.wf(a)?z.set_trans(b,c.vf(a)):z.set_trans(b,a.k.n)}function d(a,b){var d=a.k;if(c.wf(a)){z.set_quat(b,d.n);var e=c.Cr(a),e=z.invert(e,J);z.multiply(e,d.n,c.vf(a))}else z.set_quat(b,d.n)}function b(a,b){c.wf(a)?z.set_quat(b,c.vf(a)):z.set_quat(b,a.k.n)}function g(a,b){z.zd(a.k.n,b);return b}function l(a,b){c.wf(a)?z.zd(c.vf(a),b):z.zd(a.k.n,b);return b}function w(a,b){c.wf(a)?z.copy(b,c.vf(a)):z.copy(b,a.k.n)}function f(a,b){c.wf(a)?z.copy(c.vf(a),
b):z.copy(a.k.n,b);return b}function n(a){var b=a.k,d=a.G,e=a.type;"CAMERA"==e&&v.cy(a);c.oQ(a,h);"CAMERA"==e&&v.lQ(a);var f=z.Ub(b.n,B),g=z.zd(b.n,A);r.yi(b.K,b.n,b.ga);r.Hl(b.da,b.n,b.Da);if(b.Yp)for(var l=0;l<d.length;l++)for(var t=d[l].T,w=0;w<t.length;w++){var q=t[w];r.yi(q.K,b.n,q.ga);r.Hl(q.da,b.n,q.Da);q.Fe&&r.Gl(q.O,b.n,q.sa)}else b.Fe&&r.Gl(b.O,b.n,b.sa);switch(e){case "MESH":a.jC&&z.invert(a.k.n,a.k.Pt);if(t=a.Jq)z.invert(t.k.n,J),z.multiply(J,b.n,J),z.gM(J,b.In),z.zd(J,b.Hn);b.Ho=!0;break;
case "CAMERA":for(l=0;l<d.length;l++)v.mQ(a,d[l]);break;case "SPEAKER":u.yP(a,h,C);break;case "LAMP":m.rQ(a)}for(l=0;l<d.length;l++)if(w=d[l],w.Yr){t=w.mb;q=t.q;switch(e){case "MESH":b.Dd&&E.lx(t);q=w.Bh;null!=b.te&&q&&E.nE(q,f);break;case "EMPTY":p.pQ(a);break;case "CAMERA":E.AO(t);if(q.bd){q.bd.enable_csm&&E.lx(t);var G=y.ea(a,t).W[0];E.BQ(G,q.Ma)}E.get_active()==t&&E.bm(t)==a&&u.$M(t,f,g,h,C);break;case "LAMP":E.jn(a,t)}q=w.Xg;G=a.Bp;if(G.length)for(w=0;w<q.length;w++){var I=q[w].p;E.pE(q[w],f,
g);y.qE(G,I.Xb);v.fP(I,E.bm(t));x.Vl(I.Rc,I.Og)}}b=a.se;for(l=0;l<b.length;l++)n(b[l]);a=a.Pu;for(l=0;l<a.length;l++)b=a[l],t=b[0],c.iQ(t,b[1])}var r=q("__boundings"),v=q("__camera"),c=q("__constraints"),m=q("__lights"),p=q("__objects"),y=q("__obj_util"),E=q("__scenes"),u=q("__sfx"),z=q("__tsr"),x=q("__util"),I=q("__vec3"),B=new Float32Array(3),G=new Float32Array(3),A=new Float32Array(4);new Float32Array(9);var J=z.create(),t=z.create(),h=0,C=0;a.SPACE_WORLD=0;a.SPACE_LOCAL=1;a.update=function(a){h=
a;C++};a.set_translation=function(a,b){var d=a.k;if(c.wf(a)){z.set_trans(b,d.n);var e=c.Cr(a),e=z.invert(e,J);z.multiply(e,d.n,c.vf(a))}else z.set_trans(b,d.n)};a.set_translation_rel=e;a.get_translation=function(a,b){z.Ub(a.k.n,b);return b};a.get_translation_rel=function(a,b){c.wf(a)?z.Ub(c.vf(a),b):z.Ub(a.k.n,b);return b};a.set_rotation=d;a.set_rotation_rel=b;a.get_rotation=g;a.get_rotation_rel=l;a.set_rotation_euler=function(a,b){var c=x.euler_to_quat(b,A);d(a,c)};a.set_rotation_euler_rel=function(a,
c){var d=x.euler_to_quat(c,A);b(a,d)};a.get_rotation_euler=function(a,b){g(a,A);return b=x.quat_to_euler(euler,b)};a.get_rotation_euler_rel=function(a,b){l(a,A);return b=x.quat_to_euler(euler,b)};a.set_scale=function(a,b){var d=a.k;if(c.wf(a)){var d=c.vf(a),e=z.get_scale(c.Cr(a));z.set_scale(b/e,d)}else z.set_scale(b,d.n)};a.set_scale_rel=function(a,b){var d=a.k;c.wf(a)?z.set_scale(b,c.vf(a)):z.set_scale(b,d.n)};a.get_scale=function(a){return z.get_scale(a.k.n)};a.get_scale_rel=function(a){return c.wf(a)?
z.get_scale(c.vf(a)):z.get_scale(a.k.n)};a.set_tsr=function(a,b){z.copy(b,a.k.n);if(c.wf(a)){var d=c.Cr(a),d=z.invert(d,J);z.multiply(d,a.k.n,c.vf(a))}};a.set_tsr_rel=w;a.get_tsr=function(a,b){return z.copy(a.k.n,b)};a.get_tsr_rel=f;a.get_object_size=function(a){var b=a.k;a=b.vi;var c=z.get_scale(b.n),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.get_object_center=function(a,b,c){b?(a=a.k,I.copy(a.Da.D,c)):(a=a.k,b=a.vi,c[0]=(b.max_x+b.min_x)/
2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/2,z.transform_vec3(c,a.n,c));return c};a.move_local=function(a,b,c,d){var h=f(a,J),g=B;g[0]=b;g[1]=c;g[2]=d;z.transform_vec3(g,h,g);e(a,g)};a.hx=function(a,b){var c=f(a,J),d=z.set_quat(b,z.identity(t));z.multiply(c,d,d);w(a,d)};a.B=n;a.distance=function(a,b){var c=z.Ub(a.k.n,B),d=z.Ub(b.k.n,G);return I.dist(c,d)};a.Bm=function(a,b){var c=z.Ub(a.k.n,B);return I.dist(c,b)};a.get_object_bounding_box=function(a){return{max_x:a.k.ga.max_x,min_x:a.k.ga.min_x,
max_y:a.k.ga.max_y,min_y:a.k.ga.min_y,max_z:a.k.ga.max_z,min_z:a.k.ga.min_z}}};b4w.module.__tsr=function(a,q){function e(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function d(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function g(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3];return d}function l(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function w(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],m=b[4],l=b[5],h=b[6];
b=b[7];var n=a[0]*g,k=a[1]*g,p=a[2]*g;a=b*n+l*p-h*k;var g=b*k+h*n-m*p,r=b*p+m*k-l*n,n=-m*n-l*k-h*p;c[0]=a*b+n*-m+g*-h-r*-l;c[1]=g*b+n*-l+r*-m-a*-h;c[2]=r*b+n*-h+a*-l-g*-m;c[0]+=d;c[1]+=e;c[2]+=f;return c}var f=q("__mat4"),n=q("__quat"),r=q("__util"),v=q("__vec3"),c=Math.sin(-Math.PI/4),m=-c,p=new Float32Array(3),y=new Float32Array(4);new Float32Array(4);var E=new Float32Array(16);a.create=e;a.clone=function(a){var c=e();b(a,c);return c};a.from_values=function(a,b,c,d,f,g,m,l){var n=e();n[0]=a;n[1]=
b;n[2]=c;n[3]=d;n[4]=f;n[5]=g;n[6]=m;n[7]=l;return n};a.hk=d;a.bS=function(a){var c=d();b(a,c);return c};a.zS=function(a,b,c,e,f,g,m,l){var n=d();n[0]=a;n[1]=b;n[2]=c;n[3]=e;n[4]=f;n[5]=g;n[6]=m;n[7]=l;return n};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.set_sep=g;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set_scale=function(a,b){b[3]=a;return b};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];
return b};a.set_quat=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.get_trans_view=function(a){return a.subarray(0,3)};a.Ub=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.get_scale=function(a){return a[3]};a.gM=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.get_quat_view=function(a){return a.subarray(4,8)};a.zd=l;a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],f=a[2];y[0]=a[4];y[1]=a[5];y[2]=a[6];y[3]=a[7];n.invert(y,y);var g=y[0],m=y[1],
l=y[2],h=y[3],d=d*c,e=e*c,p=f*c,f=h*d+m*p-l*e,k=h*e+l*d-g*p,r=h*p+g*e-m*d,d=-g*d-m*e-l*p;b[0]=-(f*h+d*-g+k*-l-r*-m);b[1]=-(k*h+d*-m+r*-g-f*-l);b[2]=-(r*h+d*-l+f*-m-k*-g);b[3]=c;b[4]=g;b[5]=m;b[6]=l;b[7]=h;return b};a.to_mat4=function(a,b){var c=a[3];f.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,b){var c=r.dC(a,p),d=r.cC(a),e=r.matrix_to_quat(a,y);g(c,d,e,b);return b};a.multiply=function(a,b,c){w(b,a,c);c[3]=a[3]*b[3];var d=
a[4],e=a[5],f=a[6];a=a[7];var g=b[4],m=b[5],l=b[6];b=b[7];c[4]=d*b+a*g+e*l-f*m;c[5]=e*b+a*m+f*g-d*l;c[6]=f*b+a*l+d*m-e*g;c[7]=a*b-d*g-e*m-f*l;return c};a.VP=function(a,b,c){var d=b[3];b=f.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),E);for(var e=0;12>e;e++)b[e]*=d;f.multiply(b,a,c);return c};a.transform_vec3=w;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],f=a[1]-b[1],g=a[2]-b[2];a=b[4];var m=b[5],l=b[6];b=b[7];var h=a*a+m*m+l*l+b*b,h=h?1/h:0;a=-a*h;m=-m*h;l=-l*h;b*=h;var h=
b*e+m*g-l*f,n=b*f+l*e-a*g,k=b*g+a*f-m*e,e=-a*e-m*f-l*g;c[0]=h*b+e*-a+n*-l-k*-m;c[1]=n*b+e*-m+k*-a-h*-l;c[2]=k*b+e*-l+h*-m-n*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[0],g=b[1],m=b[2],l=b[3],h=b[4],n=b[5],k=b[6];b=b[7];for(var p=0;p<e;p+=3){var r=a[p]*l,w=a[p+1]*l,v=a[p+2]*l,q=b*r+n*v-k*w,y=b*w+k*r-h*v,E=b*v+h*w-n*r,r=-h*r-n*w-k*v;c[d+p]=q*b+r*-h+y*-k-E*-n;c[d+p+1]=y*b+r*-n+E*-h-q*-k;c[d+p+2]=E*b+r*-k+q*-n-y*-h;c[d+p]+=f;c[d+p+1]+=g;c[d+
p+2]+=m}return c};a.transform_dir_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],m=b[5],l=b[6];b=b[7];for(var h=0;h<e;h+=3){var n=a[h]*f,k=a[h+1]*f,p=a[h+2]*f,r=b*n+m*p-l*k,w=b*k+l*n-g*p,v=b*p+g*k-m*n,n=-g*n-m*k-l*p;c[d+h]=r*b+n*-g+w*-l-v*-m;c[d+h+1]=w*b+n*-m+v*-g-r*-l;c[d+h+2]=v*b+n*-l+r*-m-w*-g}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],f=b[5],g=b[6];b=b[7];var m=a[0]*d,l=a[1]*d,h=a[2]*d;a=b*m+f*h-g*l;var d=b*l+g*m-e*h,n=b*h+e*l-f*m,m=-e*m-f*l-g*h;c[0]=a*b+
m*-e+d*-g-n*-f;c[1]=d*b+m*-f+n*-e-a*-g;c[2]=n*b+m*-g+a*-f-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],m=b[5],l=b[6];b=b[7];for(var h=0;h<e;h+=4){var n=a[h]*f,k=a[h+1]*f,p=a[h+2]*f,r=b*n+m*p-l*k,w=b*k+l*n-g*p,v=b*p+g*k-m*n,n=-g*n-m*k-l*p;c[d+h]=r*b+n*-g+w*-l-v*-m;c[d+h+1]=w*b+n*-m+v*-g-r*-l;c[d+h+2]=v*b+n*-l+r*-m-w*-g;c[d+h+3]=a[h+3]}return c};a.WP=function(a,b,c){b=l(b,y);n.multiply(b,a,c)};a.iE=function(a,b,c,d){d=d||0;b=l(b,y);r.JC(a,b,c,d)};a.translate=
function(a,b,c){var d=a[3],e=a[4],f=a[5],g=a[6],m=a[7],l=b[0]*d,h=b[1]*d,n=b[2]*d;b=m*l+f*n-g*h;var d=m*h+g*l-e*n,k=m*n+e*h-f*l,l=-e*l-f*h-g*n;c[0]=a[0]+b*m+l*-e+d*-g-k*-f;c[1]=a[1]+d*m+l*-f+k*-e-b*-g;c[2]=a[2]+k*m+l*-g+b*-f-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=function(a,b,c,d){v.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var e=a[3];d[3]=e+c*(b[3]-e);n.slerp(a.subarray(4,8),b.subarray(4,8),c,d.subarray(4,8));return d};a.rS=function(a,b,c,d){var e=
a.subarray(0,3),f=b.subarray(0,3),g=d.subarray(0,3);g[0]=f[0]*(c+1)-e[0]*c;g[1]=f[1]*(c+1)-e[1]*c;g[2]=f[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);e=d.subarray(4,8);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+1)-a[2]*c;e[3]=b[3]*(c+1)-a[3]*c;n.normalize(e,e);return d};a.uM=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var f=d[1];d=d[2];var g=a[4],m=a[5],l=a[6],h=a[7];e[4]=.5*(c*h+f*l-d*m);e[5]=.5*(f*h+d*g-c*
l);e[6]=.5*(d*h+c*m-f*g);e[7]=.5*(-c*g-f*m-d*l);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];f=e[7];a=a*a+b*b+c*c+f*f;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)};a.NT=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var d=a[4],e=a[5],f=a[6],g=a[7];b[4]=d*m+g*c;b[5]=e*m+f*c;b[6]=f*m-e*c;b[7]=g*m-d*c};a.MT=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__util=function(a,q){function e(a){return 0<a?1:0>a?-1:0}function d(a,b,c){var d=a[0],e=a[1];a=a[2];var f=Math.cos(d/2),h=Math.cos(e/2),k=Math.cos(a/2),g=Math.sin(d/2),e=Math.sin(e/2),m=Math.sin(a/2);if(-1<T.indexOf(b))var l=Math.cos((d+a)/2),n=Math.sin((d+a)/2),p=Math.cos((d-a)/2),t=Math.sin((d-a)/2),r=Math.cos((a-d)/2),w=Math.sin((a-d)/2);switch(b){case na:c[0]=h*n;c[1]=e*p;c[2]=e*t;c[3]=h*l;break;case ea:c[0]=e*t;c[1]=h*n;c[2]=e*p;c[3]=h*l;break;case Aa:c[0]=e*p;c[1]=e*t;c[2]=h*n;c[3]=
h*l;break;case 3:c[0]=h*n;c[1]=e*w;c[2]=e*r;c[3]=h*l;break;case ja:c[0]=e*r;c[1]=h*n;c[2]=e*w;c[3]=h*l;break;case ta:c[0]=e*w;c[1]=e*r;c[2]=h*n;c[3]=h*l;break;case 6:c[0]=g*h*k+f*e*m;c[1]=f*e*k-g*h*m;c[2]=f*h*m+g*e*k;c[3]=f*h*k-g*e*m;break;case 7:c[0]=f*h*m+g*e*k;c[1]=g*h*k+f*e*m;c[2]=f*e*k-g*h*m;c[3]=f*h*k-g*e*m;break;case 8:c[0]=f*e*k-g*h*m;c[1]=f*h*m+g*e*k;c[2]=g*h*k+f*e*m;c[3]=f*h*k-g*e*m;break;case 9:c[0]=g*h*k-f*e*m;c[1]=f*h*m-g*e*k;c[2]=f*e*k+g*h*m;c[3]=f*h*k+g*e*m;break;case 10:c[0]=f*e*k+
g*h*m;c[1]=g*h*k-f*e*m;c[2]=f*h*m-g*e*k;c[3]=f*h*k+g*e*m;break;case 11:c[0]=f*h*m-g*e*k,c[1]=f*e*k+g*h*m,c[2]=g*h*k-f*e*m,c[3]=f*h*k+g*e*m}return c}function b(a,b,c){var d=a[0],e=a[1],f=a[2];a=a[3];switch(b){case na:c[0]=Math.atan2(d*e+f*a,e*a-d*f);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*e-f*a,d*f+e*a);break;case ea:c[0]=Math.atan2(d*a+e*f,f*a-d*e);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(e*f-d*a,d*e+f*a);break;case Aa:c[0]=Math.atan2(d*f+e*a,d*a-e*f);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=
Math.atan2(d*f-e*a,d*a+e*f);break;case 3:c[0]=Math.atan2(d*f-e*a,d*e+f*a);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*f+e*a,f*a-d*e);break;case ja:c[0]=Math.atan2(d*e-f*a,d*a+e*f);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(d*e+f*a,d*a-e*f);break;case ta:c[0]=Math.atan2(e*f-d*a,d*f+e*a);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*a+e*f,e*a-d*f);break;case 6:c[0]=Math.atan2(2*(d*a-e*f),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*f+e*a));c[2]=Math.atan2(2*(f*a-d*e),1-2*(e*e+f*f));break;case 7:b=d*
e+f*a;.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=2*Math.atan2(d,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=-2*Math.atan2(d,a)):(c[0]=Math.atan2(2*(e*a-d*f),1-2*(e*e+f*f)),c[1]=Math.asin(2*(d*e+f*a)),c[2]=Math.atan2(2*(d*a-e*f),1-2*(d*d+f*f)));break;case 8:c[0]=Math.atan2(2*(f*a-d*e),1-2*(d*d+f*f));c[1]=Math.asin(2*(d*a+e*f));c[2]=Math.atan2(2*(e*a-d*f),1-2*(d*d+e*e));break;case 9:c[0]=Math.atan2(2*(d*a+e*f),1-2*(d*d+f*f));c[1]=Math.asin(2*(f*a-d*e));c[2]=Math.atan2(2*(d*f+e*a),1-2*(e*e+f*f));break;case 10:c[0]=
Math.atan2(2*(d*f+e*a),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*a-e*f));c[2]=Math.atan2(2*(d*e+f*a),1-2*(d*d+f*f));break;case 11:b=e*a-d*f,.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=-2*Math.atan2(f,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=2*Math.atan2(f,a)):(c[0]=Math.atan2(2*(d*e+f*a),1-2*(e*e+f*f)),c[1]=Math.asin(2*(e*a-d*f)),c[2]=Math.atan2(2*(d*a+e*f),1-2*(d*d+e*e)))}return c}function g(a,b,c){var d=b.length,e=N;e[0]=a[0];e[1]=a[1];e[2]=a[2];D.normalize(e,e);d?(a=ma,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=
b[3],b=D.cross(a,e,qa),D.normalize(b,b),D.cross(e,b,a),d=V,d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=e[0],d[4]=e[1],d[5]=e[2],d[6]=b[0],d[7]=b[1],d[8]=b[2],F.fromMat3(d,c),c[3]=0<c[3]?c[3]+1E-6:c[3]-1E-6,(0<c[3]&&0>a[3]||0>c[3]&&0<a[3])&&F.scale(c,-1,c),F.normalize(c,c)):F.rotationTo(Ba,e,c);return c}function l(a,b){b||(b=new Float32Array(4));J.fromMat4(a,V);var c=V[0],d=V[3],e=V[6],f=V[1],h=V[4],k=V[7],g=V[2],m=V[5],l=V[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+h*h+k*k)||1,g=Math.sqrt(g*g+m*m+l*l)||
1;V[0]/=c;V[3]/=c;V[6]/=c;V[1]/=f;V[4]/=f;V[7]/=f;V[2]/=g;V[5]/=g;V[8]/=g;F.fromMat3(V,b);F.normalize(b,b);return b}function w(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function f(a,b){var c=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var d in a)c=f(a[d],c);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(d=0;d<a.length;d++)c=
n(a[d],c);break;case Array:for(d=0;d<a.length;d++)c=f(a[d],c);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:c=n(0,c);break;default:u("Wrong object constructor")}else c=n(0,c);return c;case "number":return n(a,c);case "boolean":return n(a|0,c);case "string":return r(a,c);case "function":case "undefined":return n(0,c)}}function n(a,b){var c=b;ca[0]=a;c=(c<<5)-c+X[0];c&=c;c=(c<<5)-c+X[1];return c&c}function r(a,b){for(var c=
b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function v(a){return(34*a+1)*a%289}function c(a){return a-Math.floor(a)}function m(a){return p((34*a+5)*a)}function p(a){return a-289*Math.floor(a/289)}function y(a){return a-7*Math.floor(a/7)}function E(a,b,c){a<b&&(a=b);a>c&&(a=c);return a}function u(a){a&&C.error.apply(C,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function z(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function x(a){return z(a,0,2*Math.PI)}function I(a,b){if(a&&b){var c=a instanceof Array;if(c!=b instanceof Array)return!1;var d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(d!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!B(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var e in a)if(!B(a[e],b[e]))return!1;for(e in b)if(!(e in a))return!1}return!0}return!(a||b)}function B(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return I(a,b);default:return!0}}function G(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?
c.push(e):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function A(){var a=[{}];a.length=0;return a}var J=q("__mat3"),t=q("__mat4"),h=q("__math"),C=q("__print"),k=q("__tsr"),F=q("__quat"),D=q("__vec3"),aa=q("__vec4"),M=0,L={},T=[na,ea,Aa,ja,ta],N=new Float32Array(3),U=new Float32Array(3),O=new Float32Array(3),qa=new Float32Array(3),fa=new Float32Array(3),W=new Float32Array(3),R=new Float32Array(3),ha=new Float32Array(3),H=new Float32Array(4),ma=new Float32Array(4),V=new Float32Array(9),
ia=new Float32Array(16),pa=new Float32Array(16),ua=F.create(),ca=new Float64Array(1),X=new Uint32Array(ca.buffer),ka=new Float32Array([0,0,0]),Ha=new Float32Array([0,0,0,1]),Ea=new Float32Array([0,0,0,1,0,0,0,1]),da=new Float32Array([1,1,1]),K=new Float32Array([1,0,0]),Ba=new Float32Array([0,1,0]),za=new Float32Array([0,0,1]),va=new Float32Array([-1,0,0]),P=new Float32Array([0,-1,0]),Y=new Float32Array([0,0,-1]),na=0,ea=1,Aa=2,ja=4,ta=5,ya=Math.floor(44488.07041494893),Ca=[new Float32Array([0,0,-1,
0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.Oy=ka;a.yl=Ha;a.DR=Ea;a.hu=da;a.AXIS_X=K;a.AXIS_Y=Ba;a.AXIS_Z=za;a.AXIS_MX=va;a.AXIS_MY=P;a.AXIS_MZ=Y;a.XYX=na;a.YZY=ea;a.ZXZ=Aa;a.XZX=3;a.YXY=ja;a.ZYZ=ta;a.XYZ=6;a.YZX=7;a.ZXY=8;a.XZY=9;a.YXZ=10;a.ZYX=
11;a.jF=Ca;a.Rt=1;a.yn=2;a.ni=4;a.zy=4;a.yf=function(a){return"undefined"!=typeof a};a.keyfind=function(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var h=c[f];h[a]==b&&d.push(h)}return d};a.f32=function(a){return new Float32Array(a)};a.bL=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.ZP=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.JI=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,
!0)};a.MH=function(a,b){var c=[],d={},e=b.length,f,h;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)h=a[f],h in d&&c.push(h);return c};a.sign=e;a.fT=function(a,b,c){for(var d=c.length,e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.dT=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var h=e[f];if(h[a]==b&&h[c]==d)return h}return null};a.XL=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==
b)return c;return-1};a.HH=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.$R=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.SP=function(a,b,c,d){d||(d=new Float32Array(16));t.identity(d);d[12]=a;d[13]=b;d[14]=c};var sa=1;a.bO=function(){sa=(69069*sa+5)%Math.pow(2,32);return Math.round(sa/65536)%32768/32767};a.FP=function(a){sa=a};a.Ff=function(a){var b=a[0]%ya*48271-3399*Math.floor(a[0]/ya);a[0]=0<b?b:b+2147483647;
return(a[0]-1)/2147483646};a.Xr=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){var c=N;c[0]=a[2];c[1]=a[1];c[2]=a[0];d(c,11,b);return b};a.ordered_angles_to_quat=d;a.quat_to_ordered_angles=b;a.OK=function(a){var b=J.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),h=Math.sin(a[1]);a=Math.sin(a[2]);var k=c*e,g=c*a,m=f*e,l=f*a;b[0]=d*e;b[1]=d*a;b[2]=-h;b[3]=h*m-g;b[4]=h*l+k;b[5]=d*f;b[6]=h*k+l;b[7]=h*g-m;b[8]=d*c;return b};a.quat_to_euler=
function(a,c){var d=b(a,11,N);c[0]=d[2];c[1]=d[1];c[2]=d[0];return c};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));D.transformQuat(b,a,c);return c};a.dir_to_quat=function(a,b,c){c||(c=new Float32Array(4));a=D.normalize(a,N);var d=D.dot(b,a);a=D.cross(b,a,O);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.TP=function(a,b,c,d){d||(d=new Float32Array(4));D.transformQuat(c,b,d);d[3]=-D.dot(a,d)};a.zK=function(a){var b=k.get_quat_view(a.k.n),
c=N;switch(a.type){case "CAMERA":c[0]=0;c[1]=-1;c[2]=0;D.transformQuat(c,b,c);O[0]=0;O[1]=0;O[2]=-1;break;case "MESH":c[0]=0;c[1]=0;c[2]=1;D.transformQuat(c,b,c);O[0]=0;O[1]=0;O[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,D.transformQuat(c,b,c),O[0]=0,O[1]=1,O[2]=0}c[1]=0;D.normalize(c,c);a=D.dot(c,O);return Math.acos(a)*(0<-c[0]*O[2]?-1:1)};a.qz=function(a,b,c,d){if(0!=c){d=d||[];for(var e=0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.aQ=function(){M++;return M.toString(10)};a.Vp=function(a){L[a]||
(L[a]=0);var b=a+L[a];L[a]++;return b};a.Tf=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};a.gen_tbn_quats=function(a,b,c){b=b||A();var d=b.length,e=a.length/3;c=c||new Float32Array(4*e);for(var f=0;f<e;++f){var h=N;h[0]=a[3*f];h[1]=a[3*f+1];h[2]=a[3*f+2];var k;d?(k=ma,k[0]=b[4*f],k[1]=b[4*f+1],k[2]=b[4*f+2],k[3]=b[4*f+3]):k=b;g(h,k,c.subarray(4*f,4*(f+1)))}return c};a.mB=g;a.yh=function(a){return JSON.parse(JSON.stringify(a))};a.P=function(b){if(!(b instanceof Object))return b;
var c;c=b.constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c=new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.P(b[d]);break;default:for(d in c=new c,b)c[d]=a.P(b[d])}return c};a.ao=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[c]=
new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.matrix_to_quat=l;a.dC=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.cC=function(a){H[0]=.577350269189626;H[1]=.577350269189626;H[2]=.577350269189626;H[3]=0;aa.transformMat4(H,a,H);return aa.length(H)};a.Vl=function(a,b){var c=b.left,d=b.right,e=b.top,f=b.bottom,h=b.near,k=b.far;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=
a[7]-a[4];d[2]=a[11]-a[8];d[3]=a[15]-a[12];e[0]=a[3]-a[1];e[1]=a[7]-a[5];e[2]=a[11]-a[9];e[3]=a[15]-a[13];f[0]=a[3]+a[1];f[1]=a[7]+a[5];f[2]=a[11]+a[9];f[3]=a[15]+a[13];h[0]=a[3]+a[2];h[1]=a[7]+a[6];h[2]=a[11]+a[10];h[3]=a[15]+a[14];k[0]=a[3]-a[2];k[1]=a[7]-a[6];k[2]=a[11]-a[10];k[3]=a[15]-a[14];w(c);w(d);w(e);w(f);w(h);w(k)};a.AP=function(a,b,c){return c<-h.point_plane_dist(a,b.near)||c<-h.point_plane_dist(a,b.left)||c<-h.point_plane_dist(a,b.right)||c<-h.point_plane_dist(a,b.top)||c<-h.point_plane_dist(a,
b.bottom)||c<-h.point_plane_dist(a,b.far)?!0:!1};a.JK=function(a,b,c,d,e){var f=D.dot(c,b.far),k=D.dot(d,b.far),g=D.dot(e,b.far),f=Math.sqrt(f*f+k*k+g*g);if(f<-h.point_plane_dist(a,b.near)||f<-h.point_plane_dist(a,b.far))return!0;f=D.dot(c,b.left);k=D.dot(d,b.left);g=D.dot(e,b.left);if(Math.sqrt(f*f+k*k+g*g)<-h.point_plane_dist(a,b.left))return!0;f=D.dot(c,b.right);k=D.dot(d,b.right);g=D.dot(e,b.right);if(Math.sqrt(f*f+k*k+g*g)<-h.point_plane_dist(a,b.right))return!0;f=D.dot(c,b.top);k=D.dot(d,b.top);
g=D.dot(e,b.top);if(Math.sqrt(f*f+k*k+g*g)<-h.point_plane_dist(a,b.top))return!0;f=D.dot(c,b.bottom);k=D.dot(d,b.bottom);g=D.dot(e,b.bottom);return Math.sqrt(f*f+k*k+g*g)<-h.point_plane_dist(a,b.bottom)?!0:!1};a.Hm=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var h=a[f],k=a[f+1],g=a[f+2];c[d+f]=b[0]*h+b[4]*k+b[8]*g+b[12];c[d+f+1]=b[1]*h+b[5]*k+b[9]*g+b[13];c[d+f+2]=b[2]*h+b[6]*k+b[10]*g+b[14]}};a.UT=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var h=a[f],k=a[f+1],g=a[f+
2];c[d+f]=b[0]*h+b[4]*k+b[8]*g;c[d+f+1]=b[1]*h+b[5]*k+b[9]*g;c[d+f+2]=b[2]*h+b[6]*k+b[10]*g}return c};a.JC=function(a,b,c,d){d=d||0;for(var e=a.length,f=0;f<e;f+=4){ua[0]=a[f];ua[1]=a[f+1];ua[2]=a[f+2];ua[3]=a[f+3];var h=0<ua[3];F.multiply(b,ua,ua);(h&&0>ua[3]||!h&&0<ua[3])&&aa.scale(ua,-1,ua);c[d+f]=ua[0];c[d+f+1]=ua[1];c[d+f+2]=ua[2];c[d+f+3]=ua[3]}};a.SQ=function(a,b,c){c||(c=new Float32Array(3));H[0]=a[0];H[1]=a[1];H[2]=a[2];H[3]=0;aa.transformMat4(H,b,H);c[0]=H[0];c[1]=H[1];c[2]=H[2]};a.tS=function(a,
b){var c=a.length;c||u("flatten(): Wrong or empty array");var d=a[0].length;d||u("flatten(): Wrong or empty subarray");b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.TQ=function(a){for(var b=[],c=0;c<a.length;c+=3){var d=new Float32Array([a[c],a[c+1],a[c+2]]);b[c/3]=d}return b};a.Nq=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.Nq(b,c,d,f-1):b[f]<c?a.Nq(b,c,f+1,e):f};a.Bi=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=
b[c])return!1;return!0};a.cS=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.wT=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.VP=function(a,b,c,d,e){e||(e=new Float32Array(16));b=t.fromRotationTranslation(c,d,ia);t.multiply(b,a,e);return e};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=t.fromRotationTranslation(c,d,ia);1!==b&&(d=t.identity(pa),b=D.set(b,
b,b,N),t.scale(d,b,d),t.multiply(c,d,c));D.transformMat4(a,c,e);return e};a.PT=function(a,b,c,d,e){e||(e=new Float32Array(4));b=t.fromRotationTranslation(c,d,ia);aa.transformMat4(a,b,e);return e};a.YS=function(a,b,c,d,e){e||(e=new Float32Array(3));b=t.fromRotationTranslation(c,d,ia);t.invert(b,b);D.transformMat4(a,b,e);return e};a.OT=function(a,b,c){c||(c=new Float32Array(16));t.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.mT=function(b,c,d){a.dC(b,c);c[3]=a.cC(b);l(b,
d)};a.NR=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.vO=function(a,b,c,d){d||(d=new Float32Array(3));var e=N;D.subtract(b,a,e);D.transformQuat(e,c,e);D.subtract(b,e,d)};a.qL=function(){var a=N;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),h=new Float32Array(16);t.lookAt(a,[-1,0,0],[0,-1,0],b);t.scale(b,[-1,1,1],b);t.scale(b,[-1,1,-1],c);t.lookAt(a,[0,-1,0],[0,0,-1],
d);t.scale(d,[1,1,-1],d);t.scale(d,[1,-1,-1],e);t.lookAt(a,[0,0,-1],[0,-1,0],f);t.scale(f,[-1,1,1],f);t.scale(f,[-1,1,-1],h);return[b,c,d,e,f,h]};a.uL=function(){var a=N;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),h=new Float32Array(16);t.lookAt(a,[1,0,0],[0,-1,0],b);t.scale(b,[-1,1,-1],c);t.lookAt(a,[0,1,0],[0,0,1],d);t.scale(d,[1,-1,-1],e);t.lookAt(a,[0,0,1],[0,-1,0],f);t.scale(f,[-1,1,-1],h);return[b,
c,d,e,f,h]};a.Dz=function(a,b){return f(a,b)};a.hash_code=f;a.US=r;a.mN=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?
NaN:a|0};a.deg_to_rad=function(a){return a*Math.PI/180};a.rad_to_deg=function(a){return 180*a/Math.PI};a.xx=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],d=Math.floor(a[0]+b),e=Math.floor(a[1]+b),f=.211324865405187*d+.211324865405187*e,b=a[0]-d+f;a=a[1]-e+f;var h=b>a?1:0,k=1-h,f=b+.211324865405187-h,g=a+.211324865405187-k,m=b+-.577350269189626,l=a+-.577350269189626,d=d%289,e=e%289,n=v(v(e)+d),k=v(v(e+k)+d+h),p=v(v(e+1)+d+1),d=Math.max(.5-(b*b+a*a),0),e=Math.max(.5-(f*f+g*g),0),h=Math.max(.5-
(m*m+l*l),0),t=2*c(.024390243902439*n)-1,r=2*c(.024390243902439*k)-1,w=2*c(.024390243902439*p)-1,n=Math.abs(t)-.5,k=Math.abs(r)-.5,p=Math.abs(w)-.5,t=t-Math.floor(t+.5),r=r-Math.floor(r+.5),w=w-Math.floor(w+.5),d=d*d*d*d*(1.79284291400159-.85373472095314*(t*t+n*n)),e=e*e*e*e*(1.79284291400159-.85373472095314*(r*r+k*k)),h=h*h*h*h*(1.79284291400159-.85373472095314*(w*w+p*p));return 130*(d*(t*b+n*a)+e*(r*f+k*g)+h*(w*m+p*l))};a.Kz=function(a){var b=1/7,d=b/2,e=p(Math.floor(a[0])),f=p(Math.floor(a[1])),
h=c(a[0]);a=c(a[1]);var k=h-.5,g=h-1.5,h=a-.5;a-=1.5;var l=m(e),n=m(e+1),t=l,e=n,l=m(l+f),n=m(n+f),t=m(t+f+1),e=m(e+f+1),f=k+.7*(y(l)*b+d),r=g+.7*(y(n)*b+d),k=k+.7*(y(t)*b+d),g=g+.7*(y(e)*b+d),l=h+.7*(y(Math.floor(l*b))*b+d),h=h+.7*(y(Math.floor(n*b))*b+d),t=a+.7*(y(Math.floor(t*b))*b+d),b=a+.7*(y(Math.floor(e*b))*b+d);return Math.min(f*f+l*l,r*r+h*h,k*k+t*t,g*g+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=D.transformQuat(b,a,N);b=c[0];var f=c[1];c=c[2];var h=V;h[0]=f*f+c*
c;h[1]=-f*b;h[2]=-c*b;h[3]=-b*f;h[4]=b*b+c*c;h[5]=-c*f;h[6]=-b*c;h[7]=-f*c;h[8]=b*b+f*f;D.transformMat3(a,h,a);D.normalize(a,a);F.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c=H,d=ma,c=F.setAxisAngle([0,0,1],Math.PI,F.create()),d=F.setAxisAngle([1,0,0],Math.PI/2,F.create());F.multiply(c,d,c);F.multiply(a,c,b);return b};a.cleanup=function(){M=0;L={}};a.clamp=E;a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,b,
c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.zD=function(a,b,c,d,e){e||(e=new Float32Array(a.length));F.slerp(a,b,Math.exp(-c/d),e)};a.Yv=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=J.fromQuat(a,V),d=N;d[0]=c[6];
d[1]=c[7];d[2]=c[8];d=D.cross(za,d,d);D.normalize(d,d);var e=c[4];!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);O[0]=c[0];O[1]=c[1];O[2]=c[2];D.normalize(O,O);c=ma;F.rotationTo(O,d,c);F.multiply(c,a,a)};a.ZA=function(a,b,c,d){c=c*b-.5;var e=d*b-.5;d=c-Math.floor(c);var f=e-Math.floor(e);c=Math.floor(c);var e=Math.floor(e),h=b-1,k=a[e*b+c],g=a[e*b+Math.min(c+1,h)],m=a[Math.min(e+1,h)*b+c];a=a[Math.min(e+1,h)*b+Math.min(c+1,h)];return(k*(1-d)+g*d)*(1-f)+(m*(1-d)+a*d)*f};a.$k=function(a){for(var b=0,c=0;3>c;c++)0<
(a&1<<c)&&b++;return b};a.RC=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.Km=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.xv=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.No=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*
a.length);return a[b]};a.horizontal_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=0;D.normalize(c,c)};a.UP=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],h=b[1],k=b[2];b=b[3];var g=h*a-k*e,m=k*d-f*a,l=f*e-h*d,n=h*l-k*m,k=k*g-f*l,f=f*m-h*g;c[0]=d+2*g*b+2*n;c[1]=e+2*m*b+2*k;c[2]=a+2*l*b+2*f};a.assert=function(a){a||u("Assertion failed")};a.r=u;a.angle_wrap_periodic=z;a.angle_wrap_0_2pi=x;a.Dv=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.MD=function(a,
b){for(var c in a){var d=!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=e==f;break;case "object":d=I(e,f)}if(!d)return!1}return!0};a.Ww=function(a,b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.RA=function(a){a+=1;132651<a&&C.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d){H.set(a);H[3]=b;a=ma;N[0]=c[3];N[1]=c[4];N[2]=c[5];a.set(N);
a[3]=0;a=aa.dot(H,a);if(0==a)return null;b=ma;D.copy(c,N);b.set(N);b[3]=1;a=-aa.dot(H,b)/a;d[0]=c[0]+a*c[3];d[1]=c[1]+a*c[4];d[2]=c[2]+a*c[5];return d};a.cM=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],h=b[1]-a[1],k=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=h*a-b*k;d[1]=f*b-e*a;d[2]=e*k-h*f;return d};a.eS=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.jx=function(a,b,c){var d=N,e=D.dot(a,b);-.9999999>e?(D.cross(K,a,d),1E-6>D.length(d)&&D.cross(Ba,a,d),D.normalize(d,d),F.setAxisAngle(d,
Math.PI,c)):(D.cross(a,b,d),c.set(d),c[3]=1+e,F.normalize(c,c));return c};a.$j=function(a,b,c){if(b==c)return c-a;a=x(a);b=x(b);c=x(c);b=2*Math.PI-b;c=x(c+b);a=x(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=E(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.NH=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.kS=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;
return b};a.IE=function(a,b){for(var c=Math.max(a.length,b.length),d=0;d<c;d++){var f=e((d>=a.length?0:a[d])-(d>=b.length?0:b[d]));if(f)return f}return 0};a.Hj=function(a){return a.join(".")};a.KD=function(a){return a.split(".").map(function(a){return a|0})};a.FD=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.hw=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.ip=function(a){var b=a.split("://",2);return 1<
b.length?(b[1]=G(b[1]),b.join("://")):G(a)};a.Xn=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.IK=function(a,b,c,d){d[0]=a[0];d[1]=b[0];d[2]=c[0];d[3]=a[1];d[4]=b[1];d[5]=c[1];d[6]=a[2];d[7]=b[2];d[8]=c[2];return d};a.Fi=A;a.Do=function(a){a=Math.round(32767.5*(a+1)-32768);return E(a?a:0,-32768,32767)};a.DT=function(a){return E((a+32768)/32767.5-1,-1,1)};a.YP=function(a){return E(Math.round(255*a),0,255)};a.RT=function(a){return E(a/255,0,1)};a.BK=function(a,b,c,d){var e=D.subtract(c,
b,N),f=D.subtract(d,c,U),h=D.subtract(b,d,O);b=D.subtract(a,b,qa);c=D.subtract(a,c,fa);a=D.subtract(a,d,W);d=D.cross(e,f,R);if(0<=D.dot(D.cross(d,e,ha),b)&&0<=D.dot(D.cross(d,f,ha),c)&&0<=D.dot(D.cross(d,h,ha),a))return h=D.length(d),f=D.dot(d,b),Math.abs(f/h);e=D.scale(e,E(D.dot(e,b)/D.length(e),0,1),ha);b=D.length(D.subtract(b,e,ha));f=D.scale(f,E(D.dot(f,c)/D.length(f),0,1),ha);f=D.length(D.subtract(c,f,ha));h=D.scale(h,E(D.dot(h,a)/D.length(h),0,1),ha);h=D.length(D.subtract(a,h,ha));return Math.min(Math.min(b,
f),h)}};b4w.module.__sfx=function(a,q){function e(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return x.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;x.warn("deprecated WebAudio implementation");return null}x.warn("WebAudio is not supported");return null}function d(a,c,d){var e=a.S;if("NONE"!=e.behavior){var h=e.loop,k=e.pitch;if(e.src&&(h||0<=d)){e.ru=Math.floor(5E4*Math.random());var g=M.currentTime+c,g=
Math.max(0,g);e.Ce=g;e.state=20;var m=L.Bc;"POSITIONAL"==e.behavior&&"none"==m.wo&&(e.behavior="BACKGROUND_SOUND");b(a,L.Bc);if("POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior){c=M.createBufferSource();c.buffer=e.src;c.playbackRate.value=k;if(h){e.Mb&&e.Mb.disconnect();e.ld&&e.ld.disconnect();c.loop=!0;c.loopStart=e.$B;if(c.loopEnd=e.ns)d=M.createBufferSource(),d.buffer=e.src,d.playbackRate.value=k,e.ld=d,d.connect(e.hd);c.start(g);e.duration=0}else h=c.buffer?c.buffer.duration:0,d>h?(h=
g+d+e.We,c.loop=!0,c.start(g),c.stop(h),e.duration=d):(c.loop=!1,c.start(g),e.duration=h);c.connect(e.hd);e.Mb=c;l(e);w(e);f(e)}else"BACKGROUND_MUSIC"==e.behavior&&(B.clear_timeout(e.su),B.clear_timeout(e.tu),d=function(){var b=a.S,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.Mb=b.Mb||M.createMediaElementSource(c),b.Mb.connect(b.hd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():e.su=B.set_timeout(d,1E3*c),e.duration=h?0:u(a));n(e,g)}}}function b(a,b){var c=a.S;if(!c.hd){var d=G.get_trans_view(a.k.n),
e=G.get_quat_view(a.k.n);if(h.vs){var f=M.createBiquadFilter();f.type="peaking"}else f=null;var k=M.createGain();switch(c.behavior){case "POSITIONAL":var g=M.createPanner();"string"!=typeof g.panningModel?(g.panningModel=g.EQUALPOWER,g.distanceModel=g.INVERSE_DISTANCE):(g.panningModel="equalpower",g.distanceModel=b.wo);g.setPosition(d[0],d[1],d[2]);J.copy(d,c.aw);d=C;A.quat_to_dir(e,A.AXIS_MZ,d);g.setOrientation(d[0],d[1],d[2]);g.refDistance=c.dist_ref;g.maxDistance=c.dist_max;g.rolloffFactor=c.attenuation;
g.coneInnerAngle=c.aA;g.coneOuterAngle=c.bA;g.coneOuterGain=c.cA;var m=M.createGain();m.gain.value=E(c);f?(g.connect(f),f.connect(m)):g.connect(m);m.connect(k);c.hd=g;if(c.ql){var l=M.createGain();k.connect(l);l.connect(b.hd)}else l=null,k.connect(b.hd);break;case "BACKGROUND_SOUND":g=null;m=M.createGain();m.gain.value=E(c);f?(c.hd=f,f.connect(m)):c.hd=m;m.connect(k);c.ql?(l=M.createGain(),k.connect(l),l.connect(b.hd)):(l=null,k.connect(b.hd));break;case "BACKGROUND_MUSIC":l=g=null,m=M.createGain(),
m.gain.value=E(c),f?(c.hd=f,f.connect(m)):c.hd=m,m.connect(k),k.connect(b.hd)}c.Mw=g;c.ag=f;c.am=m;c.Ji=k;c.Yw=l}}function g(a){var b=a.S,c=b.duration,b=b.delay+b.uA*Math.random();d(a,b,c)}function l(a){var b=a.ld||a.Mb;A.yf(b.onended)&&(b.onended=function(){a.state=50})}function w(a){a.ql&&a.Yw.gain.cancelScheduledValues(a.Ce);a.Gm&&(a.Mb.playbackRate.cancelScheduledValues(a.Ce),a.ld&&a.ld.playbackRate.cancelScheduledValues(a.Ce));a.jq=a.Ce}function f(a){if(a.ql||a.Gm){var b=a.Yw,c=a.Mb,d=c.buffer?
c.buffer.duration:0;if(d){var e=a.Ce;N[0]=a.ru;for(var f=0;5>f;){var h=a.pitch+a.Gm*A.Ff(N);if(e>=a.jq){if(a.ql){var k=1-A.clamp(a.ql,0,1)*Math.random();b.gain.setValueAtTime(k,e)}a.Gm&&(c.playbackRate.setValueAtTime(h,e),a.ld&&a.ld.playbackRate.setValueAtTime(h,e));f++}e+=d/h}a.jq=e-.001}}}function n(a,b){if(a.qk||a.We){var c=a.Ji;c.gain.cancelScheduledValues(b);a.qk?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.qk)):c.gain.setValueAtTime(1,b);a.We&&!a.loop&&(c.gain.setValueAtTime(1,
b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.We))}}function r(a){"SPEAKER"!=a.type&&A.r("Wrong object type");var b=a.S;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.Ji,d=M.currentTime;b.We&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.We));"BACKGROUND_MUSIC"==b.behavior?b.src&&(B.clear_timeout(b.su),B.clear_timeout(b.tu),b.tu=B.set_timeout(function(){var b=a.S.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.We)):(c=b.Mb,
b.duration<c.buffer.duration?b.We&&20==b.state?c.stop(d+b.We):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.Ce=0,b.Ow=0,b.zu=0);b.state=30}}function v(a){a=a.S;if(20==a.state){var b=M.currentTime;a.Ow=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(a.zu=b>a.Ce?c(a,b):0,a.Mb.onended=function(){},a.Mb.stop(0),a.Mb.disconnect(),w(a));a.state=40}}function c(a,b){N[0]=a.ru;for(var c=a.Mb.buffer.duration,d=a.Ce,e;d<b;)e=a.pitch+a.Gm*A.Ff(N),d+=c/e;return(c/e-(d-b))*e}function m(a){var b=
a.S;if(40==b.state){var c=M.currentTime;b.Ce+=c-b.Ow;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.S;var d=M.createBufferSource();d.loop=a.Mb.loop;d.loopStart=a.Mb.loopStart;d.loopEnd=a.Mb.loopEnd;d.buffer=a.Mb.buffer;d.playbackRate.value=a.Mb.playbackRate.value;d.connect(a.hd);a.Mb=d;a.ld&&(d=M.createBufferSource(),d.loop=a.ld.loop,d.buffer=a.ld.buffer,d.playbackRate.value=a.ld.playbackRate.value,d.connect(a.hd),a.ld=d);b.jq=c;c=b.Mb;l(b);c.start(b.Ce,b.zu);f(b)}n(b,b.Ce);b.state=20}}function p(a,
b,c){var d=1,d=b.CK;if(0<d){var e=b.zP;if(0!=J.dot(a.Et,a.Et)||0!=J.dot(b.Ok,b.Ok)){var f=J.subtract(a.aw,b.Sg,C),h=J.length(f);b=J.dot(f,b.Ok)/h;f=J.dot(f,a.Et)/h;f=-f;h=e/d;b=Math.min(-b,h);f=Math.min(f,h);d=(e-d*b)/(e-d*f);isFinite(d)||(d=0);d=Math.min(d,16);d=Math.max(d,.125);d=A.smooth(d,a.TB,c,.3);a.Mb.playbackRate.value=d;a.TB=d}}}function y(a){a=a.S;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function E(a){return a.muted?0:a.volume}function u(a){a=a.S;return(a=a.src)?
a.duration:0}var z=q("__config"),x=q("__print"),I=q("__quat"),B=q("__time"),G=q("__tsr"),A=q("__util"),J=q("__vec3"),t=z.A,h=z.S,C=new Float32Array(3),k=new Float32Array(3);new Float32Array(3);var F=I.create(),D=[],aa=[],M=null,L=null,T=[],N=[1],U=null;a.vy=10;a.Qt=20;a.uy=30;a.FJ=function(){return{ji:-1,Ng:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,aA:360,bA:360,cA:1,autoplay:!1,cyclic:!1,loop:!1,$B:0,ns:0,delay:0,uA:0,ql:0,Gm:0,qk:0,We:0,Ce:0,Ow:0,zu:0,duration:0,
jq:0,ru:1,src:null,state:10,aw:new Float32Array(3),Et:new Float32Array(3),qr:!1,TB:1,su:-1,tu:-1,mk:0,hd:null,Mb:null,ld:null,Mw:null,ag:null,am:null,Ji:null,Yw:null,Bj:0}};a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(D.push("ogg"),D.push("ogv"),D.push("oga")),""!=a.canPlayType("audio/mpeg")&&D.push("mp3"),""!=a.canPlayType("audio/mp4")&&(D.push("mp4"),D.push("m4v"),D.push("m4a")),""!=a.canPlayType("audio/webm")&&
D.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(aa.push("ogv"),aa.push("ogg"),aa.push("oga")),""!=b.canPlayType("video/mp4")&&(aa.push("m4v"),aa.push("mp4")),""!=b.canPlayType("video/webm")&&aa.push("webm"),""!=b.canPlayType("video/mpeg")&&aa.push("mp3"))};a.UH=function(a){h.oy&&!M&&(M=e())&&x.log("%cINIT WEBAUDIO: "+M.sampleRate+"Hz","color: #00a");if(M){var b={Sg:new Float32Array(3),Ok:new Float32Array(3),Bj:0},c=M.createGain(),d=M.createGain();b.am=c;b.Ji=d;c.connect(d);d.connect(M.destination);
if(a.b4w_enable_dynamic_compressor){var d=M.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;d.threshold.value=f.threshold;d.knee.value=f.knee;d.ratio.value=f.ratio;d.attack.value=f.attack;d.release.value=f.release;d.connect(c);b.lo=d;b.hd=d}else b.lo=null,b.hd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.wo="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.wo="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.wo="exponential";break;case "NONE":b.wo=
"none";break;default:A.r("Wrong audio distance model")}b.CK=a.audio_doppler_factor;b.zP=a.audio_doppler_speed;b.muted=!1;b.volume=a.audio_volume;c.gain.value=E(b);b.mk=0}else b=null;a.Bc=b};a.EO=function(a){L=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<D.indexOf(a)?a:-1<D.indexOf("m4a")?"m4a":-1<D.indexOf("oga")?"oga":""};a.detect_video_container=function(a){a||(a="webm");return-1<aa.indexOf(a)?a:-1<aa.indexOf("m4v")?"m4v":-1<aa.indexOf("webm")?"webm":""};a.Cj=function(a,b){var c=
a.data,d=b.S;d.ji=a.data.sound.uuid;d.Ng=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=M?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var e;M?(window.MediaElementAudioSourceNode?e=!0:(x.warn("MediaElementAudioSourceNode not found"),e=!1),e=e&&!t.Tz?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:A.r("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.qr=c.b4w_enable_doppler;d.muted=c.muted;d.volume=c.volume;
d.pitch=c.pitch;d.attenuation=c.attenuation;d.dist_ref=c.distance_reference;d.dist_max=c.distance_max||1E4;d.aA=c.cone_angle_inner;d.bA=c.cone_angle_outer;d.cA=c.cone_volume_outer;d.autoplay=c.b4w_auto_play;d.cyclic=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.$B=c.b4w_loop_start;d.ns=c.b4w_loop_end;d.delay=c.b4w_delay;d.uA=c.b4w_delay_random;d.ql=c.b4w_volume_random;d.Gm=c.b4w_pitch_random;d.qk=c.b4w_fade_in;d.We=c.b4w_fade_out;T.push(b)};a.BD=function(b){"SPEAKER"!=b.type&&A.r("Wrong object type");switch(b.S.behavior){case "POSITIONAL":return a.Qt;
case "BACKGROUND_SOUND":return a.Qt;case "BACKGROUND_MUSIC":return a.uy;case "NONE":return a.vy;default:A.r("Wrong speaker behavior")}};a.EQ=function(a,b){var c=a.S;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:A.r("Wrong speaker behavior")}};a.BC=function(){var a=M.createBufferSource();a.buffer=M.createBuffer(1,22050,22050);a.connect(M.destination);a.start(0)};a.vK=function(a,b,c){M?M.decodeAudioData(a,b,c):c()};a.wP=
function(a){r(a);a.S=null;T.splice(T.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<T.length;a++){var b=T[a].S;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():(b.Mb&&b.Mb.disconnect(),b.ld&&b.ld.disconnect())}L&&L.Bc&&(a=L.Bc,a.Sg[0]=0,a.Sg[1]=0,a.Sg[2]=0,a.Ok[0]=0,a.Ok[1]=0,a.Ok[2]=0);L=null;T.splice(0);U=null};a.update=function(a){if(M&&0!=T.length){for(var b=0;b<T.length;b++){var c=T[b],d=c.S,e=d.Mb,h=M.currentTime;!d.loop&&20==d.state&&d.duration&&d.Ce+d.duration<h&&("BACKGROUND_MUSIC"==
d.behavior||e&&!A.yf(e.onended))&&(d.state=50);d.cyclic&&50==d.state&&g(c);20==d.state&&3>d.jq-h&&f(d)}U&&U.ai.length&&(-1==U.pc||a>U.Wy+U.zA[U.pc])&&(b=U,-1<b.pc&&r(b.ai[b.pc]),-1==b.pc&&b.random?c=Math.round(Math.random()*(b.ai.length-1)):b.random?(c=1+Math.round(Math.random()*(b.ai.length-2)),c=(b.pc+c)%b.ai.length):c=(b.pc+1)%b.ai.length,g(b.ai[c]),b.pc=c,b.Wy=a)}};a.play=d;a.play_def=g;a.stop=r;a.is_playing=function(a){return 20==a.S.state};a.vP=v;a.xP=m;a.loop_stop=function(a,b){var c=a.S,d=
c.ld;if(y(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&d){var e=M.currentTime+b;c.Mb.stop(e);d.start(e,c.ns)}};a.playrate=function(a,b){var c=a.S;c.pitch=b;!y(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.Mb.playbackRate.value=b,c.ld&&(c.ld.playbackRate.value=b),w(c),f(c))};a.get_playrate=function(a){return a.S.pitch};a.cyclic=function(a,b){a.S.cyclic=Boolean(b)};a.vM=function(a){return a.S.autoplay};a.is_cyclic=function(a){return a.S.cyclic};a.$M=function(a,
b,c,d,e){if(a=a.Bc){var f=C;f[0]=0;f[1]=0;f[2]=-1;J.transformQuat(f,c,f);k[0]=0;k[1]=1;k[2]=0;J.transformQuat(k,c,k);c=M.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(f[0],f[1],f[2],k[0],k[1],k[2]);if(d&&a.Bj!=e){if(a.listener_stride)a.listener_stride=!1,J.copy(b,a.Sg);else for(c=a.Ok,c[0]=(b[0]-a.Sg[0])/d,c[1]=(b[1]-a.Sg[1])/d,c[2]=(b[2]-a.Sg[2])/d,J.copy(b,a.Sg),b=0;b<T.length;b++)c=T[b],f=c.S,y(c)&&"POSITIONAL"==f.behavior&&f.qr&&p(f,a,d);a.Bj=e}else J.copy(b,a.Sg)}};a.listener_stride=
function(){var a=L.Bc;a&&(a.listener_stride=!0)};a.yP=function(a,b,c){var d=a.S;if(y(a)&&"POSITIONAL"==d.behavior){var e=G.Ub(a.k.n,C);a=G.zd(a.k.n,F);var f=d.Mw;f.setPosition(e[0],e[1],e[2]);A.quat_to_dir(a,A.AXIS_MZ,k);f.setOrientation(k[0],k[1],k[2]);d.qr&&(a=d.aw,b&&d.Bj!=c?(d.hl?(J.copy(e,a),d.hl=!1):(f=d.Et,f[0]=(e[0]-a[0])/b,f[1]=(e[1]-a[1])/b,f[2]=(e[2]-a[2])/b,J.copy(e,a),p(d,L.Bc,b)),d.Bj=c):J.copy(e,a))}};a.speaker_stride=function(a){var b=a.S;y(a)&&"POSITIONAL"==b.behavior&&b.qr&&(b.hl=
!0)};a.Iv=function(a){return a.S.behavior};a.check_active_speakers=function(){for(var a=0;a<T.length;a++)if(y(T[a]))return!0;return!1};a.WO=function(a){var b=L.Bc;b&&(b.volume=a,M&&(b.am.gain.value=E(b)))};a.$L=function(){var a=L.Bc;return a?a.volume:0};a.set_volume=function(a,b){var c=a.S;c.volume=b;y(a)&&(c.am.gain.value=E(c))};a.get_volume=function(a){return a.S.volume};a.mute=function(a,b){a.S.muted=Boolean(b);y(a)&&(a.S.am.gain.value=E(a.S))};a.is_muted=function(a){return a.S.muted};a.AN=function(a){var b=
L.Bc;b&&(b.muted=Boolean(a),M&&(b.am.gain.value=E(b)))};a.DM=function(){var a=L.Bc;return a?a.muted:!1};a.get_speaker_objects=function(){return T};a.pause=function(){for(var a=0;a<T.length;a++)v(T[a])};a.resume=function(){for(var a=0;a<T.length;a++)m(T[a])};a.set_compressor_params=function(a,b){if(a.Bc&&a.Bc.lo){var c=a.Bc.lo;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=function(a){if(!a.Bc||!a.Bc.lo)return null;
a=a.Bc.lo;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(y(a)){a=a.S;var d=a.Ji,e=M.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.mk=c}};a.unduck=function(a){if(y(a)){a=a.S;var b=a.Ji,c=M.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.mk);a.mk=0}};a.FK=function(a,b){if(M){var c=L.Bc,d=c.Ji,e=M.currentTime;d.gain.setValueAtTime(d.gain.value,
e);d.gain.linearRampToValueAtTime(a,e+b);c.mk=b}};a.$P=function(){if(M){var a=L.Bc,b=a.Ji,c=M.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.mk);a.mk=0}};a.apply_playlist=function(a,b,c){U={pc:-1,Wy:0,random:c,ai:[],zA:[]};for(c=0;c<a.length;c++){var d=a[c],e=u(d);0==e?x.warn("Ignoring speaker with zero duration: "+d.name):(r(d),d.S.cyclic=!1,U.ai.push(d),U.zA.push(e+b))}};a.get_duration=u;a.clear_playlist=function(){if(U)for(var a=U.ai,b=0;b<a.length;b++)r(a[b]);
U=null};a.get_positional_params=function(a){return(a=a.S)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.S;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.Mw;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=a.S;c&&c.ag&&(c.ag.frequency.value=b.freq,c.ag.Q.value=
b.Q,c.ag.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.S)&&a.ag?{freq:a.ag.frequency.value,Q:a.ag.Q.value,gain:a.ag.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.S;if(!a||!a.ag)return null;a.ag.getFrequencyResponse(b,c,d)};a.reset=function(){D.length=0;aa.length=0;M=null}};b4w.module.__input=function(a,q){function e(a){var b=T.detect_mobile();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function d(a,b){if(!e(a))return null;var c={type:a,og:!1,Ef:[],jg:[],Nh:[],Bd:[],Oh:[],Ph:[],Yo:[],PB:[],Kh:[],hi:[],gi:[],fi:[],element:b,Yg:!0,Ib:[],ws:new Float32Array(2),yN:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),rn:null,oh:null,nf:null,orientation:qa.create(),position:W.create(),
Fh:new Float32Array(4),Gh:new Float32Array(4),Jh:0,ui:0,oj:0,tl:0,Pi:0,wi:0,wk:[],Li:[0,0,0,0,0,0,0,0,0,0,0,0],PA:[0,0,0,0,0,0,0,0,0,0,0,0],Ar:[]};c.Fh[0]=c.Fh[1]=c.Fh[2]=c.Fh[3]=45;c.Gh[0]=c.Gh[1]=c.Gh[2]=c.Gh[3]=45;30==a||40==a||50==a?(c.og=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.Yg=!1)):10==a?c.og=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ha.is_mobile_device?l(c,H.webvr):(g(c),c.og=!0));return c}function b(b,c){10==b||20==b?c=window:c||
(c=40==b?document:N.get_container());for(var e=0;e<Ea.length;e++)if(Ea[e].type==b&&Ea[e].element==c)return Ea[e];e=d(b,c);60!=b&&70!=b&&80!=b&&90!=b||e.Ar.push(a.GMPD_BUTTON_0,a.GMPD_BUTTON_1,a.GMPD_BUTTON_2,a.GMPD_BUTTON_3,a.GMPD_BUTTON_4,a.GMPD_BUTTON_5,a.GMPD_BUTTON_6,a.GMPD_BUTTON_7,a.GMPD_BUTTON_8,a.GMPD_BUTTON_9,a.GMPD_BUTTON_10,a.GMPD_BUTTON_11,a.GMPD_BUTTON_12,a.GMPD_BUTTON_13,a.GMPD_BUTTON_14,a.GMPD_BUTTON_15,a.GMPD_BUTTON_16,a.GMPD_BUTTON_17,a.GMPD_BUTTON_18,a.GMPD_BUTTON_19,a.GMPD_BUTTON_20,
a.GMPD_BUTTON_21,a.GMPD_BUTTON_22,a.GMPD_BUTTON_23,a.GMPD_BUTTON_24,a.GMPD_BUTTON_25,a.GMPD_AXIS_0,a.GMPD_AXIS_1,a.GMPD_AXIS_2,a.GMPD_AXIS_3,a.GMPD_AXIS_4,a.GMPD_AXIS_5,a.GMPD_AXIS_6,a.GMPD_AXIS_7,a.GMPD_AXIS_8,a.GMPD_AXIS_9,a.GMPD_AXIS_10,a.GMPD_AXIS_11);e&&Ea.push(e);return e}function g(a){var b=H.nonwebvr;a.tl=b.tl;a.Pi=b.Pi;a.wi=b.wi;l(a,b);a.Jh=b.Jh;a.ui=b.ui;a.oj=b.oj;f(a)}function l(a,b){a.distortion_coefs[0]=b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=
b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function w(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function f(a){var b=a.ui-a.wi,c=a.Pi-b,d=a.Jh/2,e=(a.tl-a.Jh)/2,b=fa.rad_to_deg(Math.atan(b/a.oj)),c=fa.rad_to_deg(Math.atan(c/a.oj)),d=fa.rad_to_deg(Math.atan(d/a.oj)),e=fa.rad_to_deg(Math.atan(e/a.oj));c&&(a.Fh[0]=a.Gh[0]=
Math.min(c,60));d&&(a.Fh[1]=a.Gh[3]=Math.min(d,60));b&&(a.Fh[2]=a.Gh[2]=Math.min(b,60));e&&(a.Fh[3]=a.Gh[1]=Math.min(e,60))}function n(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.rn=d;a.oh=c}function r(a,b,c){switch(a.type){case 20:var d=a.nf||a.rn;d?(b=d.getEyeParameters(b),b=b.fieldOfView||
b.currentFieldOfView,a=a.distortion_coefs,d=w(a,Math.tan(fa.deg_to_rad(b.downDegrees))),fa.rad_to_deg(Math.atan(d)),d=w(a,Math.tan(fa.deg_to_rad(b.upDegrees))),fa.rad_to_deg(Math.atan(d)),d=w(a,Math.tan(fa.deg_to_rad(b.leftDegrees))),fa.rad_to_deg(Math.atan(d)),a=w(a,Math.tan(fa.deg_to_rad(b.rightDegrees))),fa.rad_to_deg(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.Fh:a.Gh,R.copy(b,c));break;default:O.error("fov is undefined for device: ",
a.type)}return c}function v(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ha.is_mobile_device?1:0:2;case 23:var c=a.nf||a.rn;if(c){var d=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.nf?c.offset[0]-d.offset[0]:c.eyeTranslation.x-d.eyeTranslation.x}return a.Jh}}function c(a,b){if(a.nf){var c=a.nf,d=c.capabilities,c=c.getPose();d.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],
a.orientation[3]=c.orientation[3]);d.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=-c.position[2],a.position[2]=c.position[1])}else 1<b-pa&&(pa=b,navigator.getVRDisplays?a.nf||navigator.getVRDisplays().then(function(b){0<b.length&&(a.nf=b[0],a.og=!0)},function(){O.Ec("WebVR displays are not found.");a.og=!1}):navigator.getVRDevices?a.rn||ua||navigator.getVRDevices().then(function(b){n(a,b);b.length&&(a.og=!0);ua=!0},function(){O.Ec("WebVR devices are not found.");a.og=!1;ua=
!0}):ha.is_mobile_device||O.Ec("HMD isn't supported."))}function m(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.wk[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.Li[c]=a.axes[c]}}function p(a){for(var b=0;b<a.wk;b++)a.wk[b]=0;for(b=0;b<a.Li.length;b++)a.PA[b]=a.Li[b],a.Li[b]=0}function y(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function E(a){return null===a}function u(a,b,c,d){switch(b){case 120:c&&y(a.Ef,c);if(d||a.jg.every(E)&&a.Ef.every(E))a.Ef.length=0,a.jg.length=0,b=a.Ib.indexOf(131),
0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("deviceorientation",x,!1));break;case 130:c&&y(a.jg,c);if(d||a.jg.every(E)&&a.Ef.every(E))a.Ef.length=0,a.jg.length=0,b=a.Ib.indexOf(131),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("deviceorientation",x,!1));break;case 40:c&&y(a.Nh,c);if(d||a.Nh.every(E))a.Nh.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("mousedown",A,!1));break;case 30:c&&y(a.Bd,c);if(d||a.Bd.every(E))a.Bd.length=0,b=a.Ib.indexOf(b),
0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("mousemove",B,!1));break;case 31:c&&y(a.Bd,c);if(d||a.Bd.every(E))a.Bd.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("mousemove",G,!1));break;case 50:c&&y(a.Oh,c);if(d||a.Oh.every(E)){a.Oh.length=0;b=a.Ib.indexOf(b);0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("mouseout",J,!1),a.element.removeEventListener("mouseup",t,!1));break}break;case 60:c&&y(a.Ph,c);if(d||a.Ph.every(E))a.Ph.length=0,b=a.Ib.indexOf(b),
0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("wheel",h,!1));break;case 80:c&&y(a.Yo,c);if(d||a.Yo.every(E))a.Yo.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("keydown",C,!1));break;case 70:c&&y(a.Kh,c);if(d||a.Kh.every(E))a.Kh.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("keyup",k,!1));break;case 90:c&&y(a.hi,c);if(d||a.hi.every(E))a.hi.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("touchstart",
F,!1));break;case 100:c&&y(a.gi,c);if(d||a.gi.every(E))a.gi.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("touchmove",D,!1));break;case 110:if(c&&y(a.fi,c),d||a.fi.every(E))a.fi.length=0,b=a.Ib.indexOf(b),0<=b&&(a.Ib.splice(b,1),a.element.removeEventListener("touchend",aa,!1))}}function z(a,b){fa.ordered_angles_to_quat(a,fa.ZXY,b);var c="orientation"in window?fa.deg_to_rad(window.orientation):"orientation"in window.screen?fa.deg_to_rad(window.screen.orientation.angle):
0,c=qa.setAxisAngle(fa.AXIS_MZ,c,V);qa.multiply(b,c,b);return b}function x(a){var c=ia;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=fa.deg_to_rad(a.alpha),c[1]=fa.deg_to_rad(a.beta),c[2]=fa.deg_to_rad(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.jg.length;d++){var e=a.jg[d];e&&(W.copy(c,X),e(X))}if(a.Ef.length)for(c=z(c,ma),d=0;d<a.Ef.length;d++)if(e=a.Ef[d])qa.copy(c,ka),e(ka);for(d=0;d<a.Ef.length;d++)a.Ef[d]||a.Ef.splice(d,1);for(d=0;d<a.jg.length;d++)a.jg[d]||a.jg.splice(d,
1)}function I(a,b){switch(a.type){case 30:a.ws[0]=b.clientX,a.ws[1]=b.clientY,a.yN=b.which}}function B(a){if(!Ha||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);I(c,a);for(var d=0;d<c.Bd.length;d++){var e=c.Bd[d];e&&(ca[0]=a.clientX,ca[1]=a.clientY,e(ca))}c.Yg&&a.preventDefault();for(d=0;d<c.Bd.length;d++)c.Bd[d]||c.Bd.splice(d,1)}}function G(a){if(!Ha||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=
b(30,a.currentTarget);I(c,a);for(var d=0;d<c.Bd.length;d++){var e=c.Bd[d];if(e){if("number"==typeof a.movementX)var f=a.movementX,h=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,h=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,h=a.mozMovementY):h=f=0;ca[0]=f;ca[1]=h;e(ca)}}c.Yg&&a.preventDefault();for(d=0;d<c.Bd.length;d++)c.Bd[d]||c.Bd.splice(d,1)}}function A(a){if(!Ha||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=
b(30,a.currentTarget);I(c,a);for(var d=0;d<c.Nh.length;d++){var e=c.Nh[d];e&&e(a.which)}c.Yg&&a.preventDefault();for(d=0;d<c.Nh.length;d++)c.Nh[d]||c.Nh.splice(d,1)}}function J(a){N.EB(a.relatedTarget)||t(a)}function t(a){if(!Ha||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);I(c,a);for(var d=0;d<c.Oh.length;d++){var e=c.Oh[d];e&&e(a.which)}c.Yg&&a.preventDefault();for(d=0;d<c.Oh.length;d++)c.Oh[d]||c.Oh.splice(d,1)}}function h(a){for(var c=
b(30,a.currentTarget),d=0;d<c.Ph.length;d++){var e=c.Ph[d];e&&e(-a.deltaY)}c.Yg&&a.preventDefault();for(d=0;d<c.Ph.length;d++)c.Ph[d]||c.Ph.splice(d,1)}function C(a){for(var c=b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.PB:c.Yo,e=0;e<d.length;e++){var f=d[e];f?f(a.keyCode):d.splice(e--,1)}c.Yg&&a.preventDefault()}function k(a){for(var c=b(40,a.currentTarget),d=0;d<c.Kh.length;d++){var e=c.Kh[d];e&&e(a.keyCode)}c.Yg&&a.preventDefault();for(d=0;d<c.Kh.length;d++)c.Kh[d]||c.Kh.splice(d,
1)}function F(a){for(var c=b(50,a.currentTarget),d=0;d<c.hi.length;d++){var e=c.hi[d];e&&e(a.targetTouches)}for(d=0;d<c.hi.length;d++)c.hi[d]||c.hi.splice(d,1)}function D(a){for(var c=b(50,a.currentTarget),d=0;d<c.gi.length;d++){var e=c.gi[d];e&&e(a.targetTouches)}c.Yg&&a.preventDefault();for(d=0;d<c.gi.length;d++)c.gi[d]||c.gi.splice(d,1)}function aa(a){for(var c=b(50,a.currentTarget),d=0;d<c.fi.length;d++){var e=c.fi[d];e&&e(a.targetTouches)}for(d=0;d<c.fi.length;d++)c.fi[d]||c.fi.splice(d,1)}function M(a){switch(a){case 0:a=
60;break;case 1:a=70;break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function L(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var d=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof d&&d.apply(c)}var T=q("__compat"),N=q("__container"),U=q("__config"),O=q("__print"),qa=q("__quat"),fa=q("__util"),W=q("__vec3"),R=q("__vec4"),ha=U.A,H=U.pM;a.DEVICE_GYRO=10;a.DEVICE_HMD=20;a.DEVICE_MOUSE=30;a.DEVICE_KEYBOARD=40;a.DEVICE_TOUCH=50;a.oq=60;a.Xt=70;a.Yt=80;a.Zt=90;a.HMD_WEBVR_DESKTOP=0;a.HMD_WEBVR_MOBILE=1;a.HMD_NON_WEBVR=2;a.HMD_WEBVR1=
3;a.HMD_WEBVR_TYPE=0;a.HMD_ORIENTATION_QUAT=10;a.HMD_POSITION=20;a.cF=21;a.dF=22;a.HMD_EYE_DISTANCE=23;a.HMD_DISTORTION=24;a.HMD_BASELINE_DIST=25;a.HMD_SCREEN_LENSE_DIST=26;a.HMD_SCREEN_WIDTH=27;a.HMD_SCREEN_HEIGHT=28;a.HMD_BEVEL_SIZE=29;a.MOUSE_LOCATION=30;a.Cy=31;a.MOUSE_DOWN_WHICH=40;a.MOUSE_UP_WHICH=50;a.MOUSE_WHEEL=60;a.KEYBOARD_UP=70;a.KEYBOARD_DOWN=80;a.By=81;a.TOUCH_START=90;a.TOUCH_MOVE=100;a.TOUCH_END=110;a.GYRO_ORIENTATION_QUAT=120;a.GYRO_ORIENTATION_ANGLES=130;a.GMPD_BUTTON_0=300;a.GMPD_BUTTON_1=
301;a.GMPD_BUTTON_2=302;a.GMPD_BUTTON_3=303;a.GMPD_BUTTON_4=304;a.GMPD_BUTTON_5=305;a.GMPD_BUTTON_6=306;a.GMPD_BUTTON_7=307;a.GMPD_BUTTON_8=308;a.GMPD_BUTTON_9=309;a.GMPD_BUTTON_10=310;a.GMPD_BUTTON_11=311;a.GMPD_BUTTON_12=312;a.GMPD_BUTTON_13=313;a.GMPD_BUTTON_14=314;a.GMPD_BUTTON_15=315;a.GMPD_BUTTON_16=316;a.GMPD_BUTTON_17=317;a.GMPD_BUTTON_18=318;a.GMPD_BUTTON_19=319;a.GMPD_BUTTON_20=320;a.GMPD_BUTTON_21=321;a.GMPD_BUTTON_22=322;a.GMPD_BUTTON_23=323;a.GMPD_BUTTON_24=324;a.GMPD_BUTTON_25=325;a.GMPD_AXIS_0=
326;a.GMPD_AXIS_1=327;a.GMPD_AXIS_2=328;a.GMPD_AXIS_3=329;a.GMPD_AXIS_4=330;a.GMPD_AXIS_5=331;a.GMPD_AXIS_6=332;a.GMPD_AXIS_7=333;a.GMPD_AXIS_8=334;a.GMPD_AXIS_9=335;a.GMPD_AXIS_10=336;a.GMPD_AXIS_11=337;var ma=qa.create(),V=qa.create(),ia=W.create(),pa=-Infinity,ua=!1,ca=new Float32Array(2);W.create();var X=W.create(),ka=qa.create(),Ha="ontouchstart"in document.documentElement,Ea=[];a.can_use_device=e;a.get_device_by_type_element=b;a.switch_prevent_default=function(a,b){a.Yg=b};a.reset_device=function(a){switch(a.type){case 20:if(a.og)if(a.nf)a.nf.resetPose();
else if(a.oh)for(var b=0;b<a.oh.length;b++)a.oh[b].resetSensor();break;default:O.error("reset_device() is undefined for device: ",a.type)}};a.get_vector_param=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:W.copy(fa.yl,c);if(a.nf)c[0]=a.orientation[0],c[1]=a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.oh)for(b=0;b<a.oh.length;b++){var d=a.oh[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,
c[2]=d.orientation.z,c[3]=d.orientation.w)}qa.normalize(c,c);a=qa.setAxisAngle(fa.AXIS_X,Math.PI/2,V);qa.multiply(a,c,c);break a;default:O.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:W.copy(fa.hu,c);if(a.nf)c[0]=a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.oh)for(b=0;b<a.oh.length;b++)d=a.oh[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=-d.position.z,c[2]=d.position.y);
break a;default:O.error("position is undefined for device: ",a.type)}return c;case 21:return r(a,"left",c);case 22:return r(a,"right",c);case 30:case 31:return c[0]=a.ws[0],c[1]=a.ws[1],c}};a.get_value_param=v;a.set_config=function(a,b,c){switch(a.type){case 20:if(3===v(a,0))break;switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.Jh=c;f(a);break;case 25:a.ui=c;f(a);break;case 26:a.oj=c;f(a);break;case 27:a.tl=c;f(a);break;case 28:a.Pi=c;f(a);break;case 29:a.wi=
c,f(a)}break;case 60:case 70:case 80:case 90:a.Ar[b]=c}};a.VL=function(a,b){var c=b-300;return c<a.wk.length?a.wk[a.Ar[c]-300]:!1};a.UL=function(a,b){return b-326<a.Li.length?a.Li[a.Ar[b-300]-326]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],d=0;d<Ea.length;d++){var e=Ea[d];switch(e.type){case 60:p(e);m(b[0],e);break;case 70:p(e);m(b[1],e);break;case 80:p(e);m(b[2],e);break;case 90:p(e);m(b[3],e);break;case 20:c(e,
a)}}};a.attach_param_cb=function(a,b,c){switch(b){case 120:a.Ef.push(c);b=131;break;case 130:a.jg.push(c);b=131;break;case 40:a.Nh.push(c);break;case 30:case 31:a.Bd.push(c);break;case 50:a.Oh.push(c);break;case 60:a.Ph.push(c);break;case 80:a.Yo.push(c);break;case 81:a.PB.push(c);b=80;break;case 70:a.Kh.push(c);break;case 90:a.hi.push(c);break;case 100:a.gi.push(c);break;case 110:a.fi.push(c)}if(-1==a.Ib.indexOf(b)&&(a.Ib.push(b),a.og))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||
a.element.addEventListener("mousedown",A,!1);break;case 30:a.element.addEventListener("mousemove",B,!1);break;case 31:a.element.addEventListener("mousemove",G,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",t,!1),a.element.addEventListener("mouseup",t,!1));break;case 60:a.element.addEventListener("wheel",h,!1);break;case 80:a.element.addEventListener("keydown",C,!1);break;case 70:a.element.addEventListener("keyup",k,!1);break;
case 90:a.element.addEventListener("touchstart",F,!1);break;case 100:a.element.addEventListener("touchmove",D,!1);break;case 110:a.element.addEventListener("touchend",aa,!1);break;case 131:a.element.addEventListener("deviceorientation",x,!1)}};a.detach_param_cb=function(a,b,c){u(a,b,c,!1)};a.kM=z;a.cleanup=function(){for(var a=0;a<Ea.length;a++)for(var b=Ea[a],c=0;c<b.Ib.length;c++)u(b,b.Ib[c],null,!0);Ea.length=0};a.get_pressed_gmpd_btn=function(a){a=b(M(a));for(var c=0;c<a.wk.length;c++)if(a.wk[c])return c+
300;return-1};a.get_moved_gmpd_axis=function(a){a=b(M(a));for(var c=0;c<a.Li.length;c++)if(a.PA[c]-a.Li[c])return c+326;return-1};a.eB=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.qB=function(){var a=b(20);return a&&a.nf};a.gH=function(a){a.element.addEventListener("mousedown",function(){a.value||L(a)},!1)}};b4w.module.__vec3=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new q(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new q(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,e){var l=new q(3);l[0]=a;l[1]=b;l[2]=e;return l};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,e,l){l[0]=a;l[1]=b;l[2]=e;return l};a.add=function(a,b,e){e[0]=a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];
return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],
b[2]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;return e};a.scaleAndAdd=function(a,b,e,l){l[0]=a[0]+b[0]*e;l[1]=a[1]+b[1]*e;l[2]=a[2]+b[2]*e;return l};a.distance=function(a,b){var e=b[0]-a[0],l=b[1]-a[1],w=b[2]-a[2];return Math.sqrt(e*e+l*l+w*w)};a.dist=a.distance;a.squaredDistance=function(a,b){var e=b[0]-a[0],l=b[1]-a[1],w=b[2]-a[2];return e*e+l*l+w*w};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],e=a[1];a=a[2];return b*b+e*e+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var e=a[0],l=a[1],w=a[2],e=e*e+l*l+w*w;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,e){var l=a[0],w=a[1];a=a[2];var f=b[0],n=b[1];b=b[2];
e[0]=w*b-a*n;e[1]=a*f-l*b;e[2]=l*n-w*f;return e};a.lerp=function(a,b,e,l){var w=a[0],f=a[1];a=a[2];l[0]=w+e*(b[0]-w);l[1]=f+e*(b[1]-f);l[2]=a+e*(b[2]-a);return l};a.VS=function(a,b,e,l,w,f){var n=w*w,r=n*(2*w-3)+1,v=n*(w-2)+w,c=n*(w-1);w=n*(3-2*w);f[0]=a[0]*r+b[0]*v+e[0]*c+l[0]*w;f[1]=a[1]*r+b[1]*v+e[1]*c+l[1]*w;f[2]=a[2]*r+b[2]*v+e[2]*c+l[2]*w;return f};a.mz=function(a,b,e,l,w,f){var n=1-w,r=n*n,v=w*w,c=r*n,r=3*w*r,n=3*v*n;w*=v;f[0]=a[0]*c+b[0]*r+e[0]*n+l[0]*w;f[1]=a[1]*c+b[1]*r+e[1]*n+l[1]*w;f[2]=
a[2]*c+b[2]*r+e[2]*n+l[2]*w;return f};a.random=function(a,b){a=a||1;var g=2*e()*Math.PI,l=2*e()-1,w=Math.sqrt(1-l*l)*a;b[0]=Math.cos(g)*w;b[1]=Math.sin(g)*w;b[2]=l*a;return b};a.transformMat4=function(a,b,e){var l=a[0],w=a[1];a=a[2];var f=b[3]*l+b[7]*w+b[11]*a+b[15],f=f||1;e[0]=(b[0]*l+b[4]*w+b[8]*a+b[12])/f;e[1]=(b[1]*l+b[5]*w+b[9]*a+b[13])/f;e[2]=(b[2]*l+b[6]*w+b[10]*a+b[14])/f;return e};a.transformMat3=function(a,b,e){var l=a[0],w=a[1];a=a[2];e[0]=l*b[0]+w*b[3]+a*b[6];e[1]=l*b[1]+w*b[4]+a*b[7];
e[2]=l*b[2]+w*b[5]+a*b[8];return e};a.transformQuat=function(a,b,e){var l=a[0],w=a[1],f=a[2];a=b[0];var n=b[1],r=b[2];b=b[3];var v=b*l+n*f-r*w,c=b*w+r*l-a*f,m=b*f+a*w-n*l,l=-a*l-n*w-r*f;e[0]=v*b+l*-a+c*-r-m*-n;e[1]=c*b+l*-n+m*-a-v*-r;e[2]=m*b+l*-r+v*-n-c*-a;return e};a.rotateX=function(a,b,e,l){var w=[],f=[];w[0]=a[0]-b[0];w[1]=a[1]-b[1];w[2]=a[2]-b[2];f[0]=w[0];f[1]=w[1]*Math.cos(e)-w[2]*Math.sin(e);f[2]=w[1]*Math.sin(e)+w[2]*Math.cos(e);l[0]=f[0]+b[0];l[1]=f[1]+b[1];l[2]=f[2]+b[2];return l};a.rotateY=
function(a,b,e,l){var w=[],f=[];w[0]=a[0]-b[0];w[1]=a[1]-b[1];w[2]=a[2]-b[2];f[0]=w[2]*Math.sin(e)+w[0]*Math.cos(e);f[1]=w[1];f[2]=w[2]*Math.cos(e)-w[0]*Math.sin(e);l[0]=f[0]+b[0];l[1]=f[1]+b[1];l[2]=f[2]+b[2];return l};a.rotateZ=function(a,b,e,l){var w=[],f=[];w[0]=a[0]-b[0];w[1]=a[1]-b[1];w[2]=a[2]-b[2];f[0]=w[0]*Math.cos(e)-w[1]*Math.sin(e);f[1]=w[0]*Math.sin(e)+w[1]*Math.cos(e);f[2]=w[2];l[0]=f[0]+b[0];l[1]=f[1]+b[1];l[2]=f[2]+b[2];return l};a.forEach=function(){var d=a.create();return function(a,
e,l,w,f,n){e||(e=3);l||(l=0);for(w=w?Math.min(w*e+l,a.length):a.length;l<w;l+=e)d[0]=a[l],d[1]=a[l+1],d[2]=a[l+2],f(d,n,d),a[l]=d[0],a[l+1]=d[1],a[l+2]=d[2];return a}}();a.LR=function(d,b){var e=a.fromValues(d[0],d[1],d[2]),l=a.fromValues(b[0],b[1],b[2]);a.normalize(e,e);a.normalize(l,l);e=a.dot(e,l);return 1<e?0:Math.acos(e)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new q(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new q(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,e,l){var w=new q(4);w[0]=a;w[1]=b;w[2]=e;w[3]=l;return w};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,e,l,w){w[0]=a;w[1]=b;w[2]=e;w[3]=l;return w};a.add=function(a,b,e){e[0]=
a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];e[3]=a[3]+b[3];return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];e[3]=a[3]-b[3];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];e[3]=a[3]*b[3];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];e[3]=a[3]/b[3];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);e[3]=
Math.min(a[3],b[3]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);e[3]=Math.max(a[3],b[3]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;e[3]=a[3]*b;return e};a.scaleAndAdd=function(a,b,e,l){l[0]=a[0]+b[0]*e;l[1]=a[1]+b[1]*e;l[2]=a[2]+b[2]*e;l[3]=a[3]+b[3]*e;return l};a.distance=function(a,b){var e=b[0]-a[0],l=b[1]-a[1],w=b[2]-a[2],f=b[3]-a[3];return Math.sqrt(e*e+l*l+w*w+f*f)};a.dist=a.distance;a.squaredDistance=
function(a,b){var e=b[0]-a[0],l=b[1]-a[1],w=b[2]-a[2],f=b[3]-a[3];return e*e+l*l+w*w+f*f};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1],l=a[2];a=a[3];return Math.sqrt(b*b+e*e+l*l+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],e=a[1],l=a[2];a=a[3];return b*b+e*e+l*l+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var e=a[0],l=a[1],w=a[2],f=a[3],n=e*e+l*l+w*w+f*f;0<n&&(n=1/Math.sqrt(n),b[0]=e*n,b[1]=l*n,b[2]=w*n,b[3]=f*n);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,e,l){var w=a[0],f=a[1],n=a[2];a=a[3];l[0]=w+e*(b[0]-w);l[1]=f+e*(b[1]-f);l[2]=n+e*(b[2]-n);l[3]=a+e*(b[3]-a);return l};a.random=function(d,b){d=d||1;b[0]=e();b[1]=e();b[2]=e();b[3]=e();a.normalize(b,b);a.scale(b,d,b);return b};a.transformMat4=function(a,b,e){var l=a[0],w=a[1],f=
a[2];a=a[3];e[0]=b[0]*l+b[4]*w+b[8]*f+b[12]*a;e[1]=b[1]*l+b[5]*w+b[9]*f+b[13]*a;e[2]=b[2]*l+b[6]*w+b[10]*f+b[14]*a;e[3]=b[3]*l+b[7]*w+b[11]*f+b[15]*a;return e};a.transformQuat=function(a,b,e){var l=a[0],w=a[1],f=a[2],n=b[0],r=b[1],v=b[2];b=b[3];var c=b*l+r*f-v*w,m=b*w+v*l-n*f,p=b*f+n*w-r*l,l=-n*l-r*w-v*f;e[0]=c*b+l*-n+m*-v-p*-r;e[1]=m*b+l*-r+p*-n-c*-v;e[2]=p*b+l*-v+c*-r-m*-n;e[3]=a[3];return e};a.forEach=function(){var d=a.create();return function(a,e,l,w,f,n){e||(e=4);l||(l=0);for(w=w?Math.min(w*
e+l,a.length):a.length;l<w;l+=e)d[0]=a[l],d[1]=a[l+1],d[2]=a[l+2],d[3]=a[l+3],f(d,n,d),a[l]=d[0],a[l+1]=d[1],a[l+2]=d[2],a[l+3]=d[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,q){var e=q("__vec3"),d=q("__vec4"),b=q("__mat3"),g="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new g(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=e.create(),d=e.fromValues(1,0,0),f=e.fromValues(0,1,0);return function(g,r,v){var c=e.dot(g,r);if(-.9999999>c)return e.cross(d,g,b),1E-6>e.length(b)&&e.cross(f,g,b),e.normalize(b,b),a.setAxisAngle(b,Math.PI,v),v;if(.9999999<c)return v[0]=0,v[1]=0,v[2]=0,v[3]=1,v;e.cross(g,
r,b);v[0]=b[0];v[1]=b[1];v[2]=b[2];v[3]=1+c;return a.normalize(v,v)}}();a.setAxes=function(){var d=b.create();return function(b,e,g,r){d[0]=e[0];d[3]=e[1];d[6]=e[2];d[1]=g[0];d[4]=g[1];d[7]=g[2];d[2]=-b[0];d[5]=-b[1];d[8]=-b[2];return a.normalize(a.fromMat3(d,r),r)}}();a.clone=d.clone;a.fromValues=d.fromValues;a.copy=d.copy;a.set=d.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,d){b*=.5;var e=Math.sin(b);d[0]=e*a[0];d[1]=e*a[1];d[2]=e*a[2];d[3]=Math.cos(b);
return d};a.add=d.add;a.multiply=function(a,b,d){var e=a[0],g=a[1],v=a[2];a=a[3];var c=b[0],m=b[1],p=b[2];b=b[3];d[0]=e*b+a*c+g*p-v*m;d[1]=g*b+a*m+v*c-e*p;d[2]=v*b+a*p+e*m-g*c;d[3]=a*b-e*c-g*m-v*p;return d};a.mul=a.multiply;a.scale=d.scale;a.rotateX=function(a,b,d){b*=.5;var e=a[0],g=a[1],v=a[2];a=a[3];var c=Math.sin(b);b=Math.cos(b);d[0]=e*b+a*c;d[1]=g*b+v*c;d[2]=v*b-g*c;d[3]=a*b-e*c;return d};a.rotateY=function(a,b,d){b*=.5;var e=a[0],g=a[1],v=a[2];a=a[3];var c=Math.sin(b);b=Math.cos(b);d[0]=e*
b-v*c;d[1]=g*b+a*c;d[2]=v*b+e*c;d[3]=a*b-g*c;return d};a.rotateZ=function(a,b,d){b*=.5;var e=a[0],g=a[1],v=a[2];a=a[3];var c=Math.sin(b);b=Math.cos(b);d[0]=e*b+g*c;d[1]=g*b-e*c;d[2]=v*b+a*c;d[3]=a*b-v*c;return d};a.calculateW=function(a,b){var d=a[0],e=a[1],g=a[2];b[0]=d;b[1]=e;b[2]=g;b[3]=Math.sqrt(Math.abs(1-d*d-e*e-g*g));return b};a.dot=d.dot;a.lerp=d.lerp;a.slerp=function(a,b,d,e){var g=a[0],v=a[1],c=a[2];a=a[3];var m=b[0],p=b[1],q=b[2];b=b[3];var E,u,z;u=g*m+v*p+c*q+a*b;0>u&&(u=-u,m=-m,p=-p,
q=-q,b=-b);1E-6<1-u?(E=Math.acos(u),z=Math.sin(E),u=Math.sin((1-d)*E)/z,d=Math.sin(d*E)/z):u=1-d;e[0]=u*g+d*m;e[1]=u*v+d*p;e[2]=u*c+d*q;e[3]=u*a+d*b;return e};a.IT=function(){var b=a.create(),d=a.create();return function(e,g,r,v,c,m){a.slerp(e,v,c,b);a.slerp(g,r,c,d);a.slerp(b,d,2*c*(1-c),m);return m}}();a.invert=function(a,b){var d=a[0],e=a[1],g=a[2],v=a[3],c=d*d+e*e+g*g+v*v,c=c?1/c:0;b[0]=-d*c;b[1]=-e*c;b[2]=-g*c;b[3]=v*c;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=d.length;a.len=a.length;a.squaredLength=d.squaredLength;a.sqrLen=a.squaredLength;a.normalize=d.normalize;a.fromMat3=function(a,b){var d=a[0]+a[4]+a[8];if(0<d)d=Math.sqrt(d+1),b[3]=.5*d,d=.5/d,b[0]=(a[5]-a[7])*d,b[1]=(a[6]-a[2])*d,b[2]=(a[1]-a[3])*d;else{var e=0;a[4]>a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var g=(e+1)%3,v=(e+2)%3,d=Math.sqrt(a[3*e+e]-a[3*g+g]-a[3*v+v]+1);b[e]=.5*d;d=.5/d;b[3]=(a[3*g+v]-a[3*v+g])*d;b[g]=(a[3*g+e]+a[3*e+g])*d;b[v]=(a[3*v+e]+a[3*e+v])*d}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new q(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[4];d[4]=a[5];d[5]=a[6];d[6]=a[8];d[7]=a[9];d[8]=a[10];return d};a.clone=function(a){var d=new q(9);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.copy=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=
a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],g=a[2],l=a[5];d[1]=a[3];d[2]=a[6];d[3]=b;d[5]=a[7];d[6]=g;d[7]=l}else d[0]=a[0],d[1]=a[3],d[2]=a[6],d[3]=a[1],d[4]=a[4],d[5]=a[7],d[6]=a[2],d[7]=a[5],d[8]=a[8];return d};a.invert=function(a,d){var b=a[0],g=a[1],l=a[2],w=a[3],f=a[4],n=a[5],r=a[6],v=a[7],c=a[8],m=c*f-n*v,p=-c*w+n*r,q=
v*w-f*r,E=b*m+g*p+l*q;if(!E)return null;E=1/E;d[0]=m*E;d[1]=(-c*g+l*v)*E;d[2]=(n*g-l*f)*E;d[3]=p*E;d[4]=(c*b-l*r)*E;d[5]=(-n*b+l*w)*E;d[6]=q*E;d[7]=(-v*b+g*r)*E;d[8]=(f*b-g*w)*E;return d};a.adjoint=function(a,d){var b=a[0],g=a[1],l=a[2],w=a[3],f=a[4],n=a[5],r=a[6],v=a[7],c=a[8];d[0]=f*c-n*v;d[1]=l*v-g*c;d[2]=g*n-l*f;d[3]=n*r-w*c;d[4]=b*c-l*r;d[5]=l*w-b*n;d[6]=w*v-f*r;d[7]=g*r-b*v;d[8]=b*f-g*w;return d};a.determinant=function(a){var d=a[3],b=a[4],g=a[5],l=a[6],w=a[7],f=a[8];return a[0]*(f*b-g*w)+a[1]*
(-f*d+g*l)+a[2]*(w*d-b*l)};a.multiply=function(a,d,b){var g=a[0],l=a[1],w=a[2],f=a[3],n=a[4],r=a[5],v=a[6],c=a[7];a=a[8];var m=d[0],p=d[1],q=d[2],E=d[3],u=d[4],z=d[5],x=d[6],I=d[7];d=d[8];b[0]=m*g+p*f+q*v;b[1]=m*l+p*n+q*c;b[2]=m*w+p*r+q*a;b[3]=E*g+u*f+z*v;b[4]=E*l+u*n+z*c;b[5]=E*w+u*r+z*a;b[6]=x*g+I*f+d*v;b[7]=x*l+I*n+d*c;b[8]=x*w+I*r+d*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var g=a[0],l=a[1],q=a[2],f=a[3],n=a[4],r=a[5],v=a[6],c=a[7];a=a[8];var m=d[0];d=d[1];b[0]=g;b[1]=l;b[2]=q;
b[3]=f;b[4]=n;b[5]=r;b[6]=m*g+d*f+v;b[7]=m*l+d*n+c;b[8]=m*q+d*r+a;return b};a.rotate=function(a,d,b){var g=a[0],l=a[1],q=a[2],f=a[3],n=a[4],r=a[5],v=a[6],c=a[7];a=a[8];var m=Math.sin(d);d=Math.cos(d);b[0]=d*g+m*f;b[1]=d*l+m*n;b[2]=d*q+m*r;b[3]=d*f-m*g;b[4]=d*n-m*l;b[5]=d*r-m*q;b[6]=v;b[7]=c;b[8]=a;return b};a.scale=function(a,d,b){var g=d[0];d=d[1];b[0]=g*a[0];b[1]=g*a[1];b[2]=g*a[2];b[3]=d*a[3];b[4]=d*a[4];b[5]=d*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.kL=function(a,d){d[0]=1;d[1]=0;d[2]=
0;d[3]=0;d[4]=1;d[5]=0;d[6]=a[0];d[7]=a[1];d[8]=1;return d};a.iL=function(a,d){var b=Math.sin(a),g=Math.cos(a);d[0]=g;d[1]=b;d[2]=0;d[3]=-b;d[4]=g;d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.jL=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=a[1];d[5]=0;d[6]=0;d[7]=0;d[8]=1;return d};a.fromMat2d=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=0;d[3]=a[2];d[4]=a[3];d[5]=0;d[6]=a[4];d[7]=a[5];d[8]=1;return d};a.fromQuat=function(a,d){var b=a[0],g=a[1],l=a[2],q=a[3],f=b+b,n=g+g,r=l+l,b=b*f,v=g*f,g=g*n,c=l*f,m=
l*n,l=l*r,f=q*f,n=q*n,q=q*r;d[0]=1-g-l;d[3]=v-q;d[6]=c+n;d[1]=v+q;d[4]=1-b-l;d[7]=m-f;d[2]=c-n;d[5]=m+f;d[8]=1-b-g;return d};a.normalFromMat4=function(a,d){var b=a[0],g=a[1],l=a[2],q=a[3],f=a[4],n=a[5],r=a[6],v=a[7],c=a[8],m=a[9],p=a[10],y=a[11],E=a[12],u=a[13],z=a[14],x=a[15],I=b*n-g*f,B=b*r-l*f,G=b*v-q*f,A=g*r-l*n,J=g*v-q*n,t=l*v-q*r,h=c*u-m*E,C=c*z-p*E,c=c*x-y*E,k=m*z-p*u,m=m*x-y*u,p=p*x-y*z,y=I*p-B*m+G*k+A*c-J*C+t*h;if(!y)return null;y=1/y;d[0]=(n*p-r*m+v*k)*y;d[1]=(r*c-f*p-v*C)*y;d[2]=(f*m-n*
c+v*h)*y;d[3]=(l*m-g*p-q*k)*y;d[4]=(b*p-l*c+q*C)*y;d[5]=(g*c-b*m-q*h)*y;d[6]=(u*t-z*J+x*A)*y;d[7]=(z*G-E*t-x*B)*y;d[8]=(E*J-u*G+x*I)*y;return d};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.hL=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new q(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var d=new q(16);d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.copy=function(a,d){d[0]=a[0];
d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=a[15];return d};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,d){if(d===a){var b=a[1],g=a[2],l=a[3],q=a[6],f=a[7],n=a[11];d[1]=a[4];d[2]=a[8];d[3]=a[12];d[4]=b;d[6]=a[9];d[7]=a[13];d[8]=g;d[9]=q;d[11]=a[14];d[12]=l;d[13]=
f;d[14]=n}else d[0]=a[0],d[1]=a[4],d[2]=a[8],d[3]=a[12],d[4]=a[1],d[5]=a[5],d[6]=a[9],d[7]=a[13],d[8]=a[2],d[9]=a[6],d[10]=a[10],d[11]=a[14],d[12]=a[3],d[13]=a[7],d[14]=a[11],d[15]=a[15];return d};a.invert=function(a,d){var b=a[0],g=a[1],l=a[2],q=a[3],f=a[4],n=a[5],r=a[6],v=a[7],c=a[8],m=a[9],p=a[10],y=a[11],E=a[12],u=a[13],z=a[14],x=a[15],I=b*n-g*f,B=b*r-l*f,G=b*v-q*f,A=g*r-l*n,J=g*v-q*n,t=l*v-q*r,h=c*u-m*E,C=c*z-p*E,k=c*x-y*E,F=m*z-p*u,D=m*x-y*u,aa=p*x-y*z,M=I*aa-B*D+G*F+A*k-J*C+t*h;if(!M)return null;
M=1/M;d[0]=(n*aa-r*D+v*F)*M;d[1]=(l*D-g*aa-q*F)*M;d[2]=(u*t-z*J+x*A)*M;d[3]=(p*J-m*t-y*A)*M;d[4]=(r*k-f*aa-v*C)*M;d[5]=(b*aa-l*k+q*C)*M;d[6]=(z*G-E*t-x*B)*M;d[7]=(c*t-p*G+y*B)*M;d[8]=(f*D-n*k+v*h)*M;d[9]=(g*k-b*D-q*h)*M;d[10]=(E*J-u*G+x*I)*M;d[11]=(m*G-c*J-y*I)*M;d[12]=(n*C-f*F-r*h)*M;d[13]=(b*F-g*C+l*h)*M;d[14]=(u*B-E*A-z*I)*M;d[15]=(c*A-m*B+p*I)*M;return d};a.adjoint=function(a,d){var b=a[0],g=a[1],l=a[2],q=a[3],f=a[4],n=a[5],r=a[6],v=a[7],c=a[8],m=a[9],p=a[10],y=a[11],E=a[12],u=a[13],z=a[14],x=
a[15];d[0]=n*(p*x-y*z)-m*(r*x-v*z)+u*(r*y-v*p);d[1]=-(g*(p*x-y*z)-m*(l*x-q*z)+u*(l*y-q*p));d[2]=g*(r*x-v*z)-n*(l*x-q*z)+u*(l*v-q*r);d[3]=-(g*(r*y-v*p)-n*(l*y-q*p)+m*(l*v-q*r));d[4]=-(f*(p*x-y*z)-c*(r*x-v*z)+E*(r*y-v*p));d[5]=b*(p*x-y*z)-c*(l*x-q*z)+E*(l*y-q*p);d[6]=-(b*(r*x-v*z)-f*(l*x-q*z)+E*(l*v-q*r));d[7]=b*(r*y-v*p)-f*(l*y-q*p)+c*(l*v-q*r);d[8]=f*(m*x-y*u)-c*(n*x-v*u)+E*(n*y-v*m);d[9]=-(b*(m*x-y*u)-c*(g*x-q*u)+E*(g*y-q*m));d[10]=b*(n*x-v*u)-f*(g*x-q*u)+E*(g*v-q*n);d[11]=-(b*(n*y-v*m)-f*(g*y-q*
m)+c*(g*v-q*n));d[12]=-(f*(m*z-p*u)-c*(n*z-r*u)+E*(n*p-r*m));d[13]=b*(m*z-p*u)-c*(g*z-l*u)+E*(g*p-l*m);d[14]=-(b*(n*z-r*u)-f*(g*z-l*u)+E*(g*r-l*n));d[15]=b*(n*p-r*m)-f*(g*p-l*m)+c*(g*r-l*n);return d};a.determinant=function(a){var d=a[0],b=a[1],g=a[2],l=a[3],q=a[4],f=a[5],n=a[6],r=a[7],v=a[8],c=a[9],m=a[10],p=a[11],y=a[12],E=a[13],u=a[14];a=a[15];return(d*f-b*q)*(m*a-p*u)-(d*n-g*q)*(c*a-p*E)+(d*r-l*q)*(c*u-m*E)+(b*n-g*f)*(v*a-p*y)-(b*r-l*f)*(v*u-m*y)+(g*r-l*n)*(v*E-c*y)};a.multiply=function(a,d,b){var g=
a[0],l=a[1],q=a[2],f=a[3],n=a[4],r=a[5],v=a[6],c=a[7],m=a[8],p=a[9],y=a[10],E=a[11],u=a[12],z=a[13],x=a[14];a=a[15];var I=d[0],B=d[1],G=d[2],A=d[3];b[0]=I*g+B*n+G*m+A*u;b[1]=I*l+B*r+G*p+A*z;b[2]=I*q+B*v+G*y+A*x;b[3]=I*f+B*c+G*E+A*a;I=d[4];B=d[5];G=d[6];A=d[7];b[4]=I*g+B*n+G*m+A*u;b[5]=I*l+B*r+G*p+A*z;b[6]=I*q+B*v+G*y+A*x;b[7]=I*f+B*c+G*E+A*a;I=d[8];B=d[9];G=d[10];A=d[11];b[8]=I*g+B*n+G*m+A*u;b[9]=I*l+B*r+G*p+A*z;b[10]=I*q+B*v+G*y+A*x;b[11]=I*f+B*c+G*E+A*a;I=d[12];B=d[13];G=d[14];A=d[15];b[12]=I*g+
B*n+G*m+A*u;b[13]=I*l+B*r+G*p+A*z;b[14]=I*q+B*v+G*y+A*x;b[15]=I*f+B*c+G*E+A*a;return b};a.mul=a.multiply;a.translate=function(a,d,b){var g=d[0],l=d[1];d=d[2];var q,f,n,r,v,c,m,p,y,E,u,z;a===b?(b[12]=a[0]*g+a[4]*l+a[8]*d+a[12],b[13]=a[1]*g+a[5]*l+a[9]*d+a[13],b[14]=a[2]*g+a[6]*l+a[10]*d+a[14],b[15]=a[3]*g+a[7]*l+a[11]*d+a[15]):(q=a[0],f=a[1],n=a[2],r=a[3],v=a[4],c=a[5],m=a[6],p=a[7],y=a[8],E=a[9],u=a[10],z=a[11],b[0]=q,b[1]=f,b[2]=n,b[3]=r,b[4]=v,b[5]=c,b[6]=m,b[7]=p,b[8]=y,b[9]=E,b[10]=u,b[11]=z,
b[12]=q*g+v*l+y*d+a[12],b[13]=f*g+c*l+E*d+a[13],b[14]=n*g+m*l+u*d+a[14],b[15]=r*g+p*l+z*d+a[15]);return b};a.scale=function(a,d,b){var g=d[0],l=d[1];d=d[2];b[0]=a[0]*g;b[1]=a[1]*g;b[2]=a[2]*g;b[3]=a[3]*g;b[4]=a[4]*l;b[5]=a[5]*l;b[6]=a[6]*l;b[7]=a[7]*l;b[8]=a[8]*d;b[9]=a[9]*d;b[10]=a[10]*d;b[11]=a[11]*d;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,d,b,g){var l=b[0],q=b[1];b=b[2];var f=Math.sqrt(l*l+q*q+b*b),n,r,v,c,m,p,y,E,u,z,x,I,B,G,A,J,t,h,C,k;if(1E-7>Math.abs(f))return null;
f=1/f;l*=f;q*=f;b*=f;n=Math.sin(d);r=Math.cos(d);v=1-r;d=a[0];f=a[1];c=a[2];m=a[3];p=a[4];y=a[5];E=a[6];u=a[7];z=a[8];x=a[9];I=a[10];B=a[11];G=l*l*v+r;A=q*l*v+b*n;J=b*l*v-q*n;t=l*q*v-b*n;h=q*q*v+r;C=b*q*v+l*n;k=l*b*v+q*n;l=q*b*v-l*n;q=b*b*v+r;g[0]=d*G+p*A+z*J;g[1]=f*G+y*A+x*J;g[2]=c*G+E*A+I*J;g[3]=m*G+u*A+B*J;g[4]=d*t+p*h+z*C;g[5]=f*t+y*h+x*C;g[6]=c*t+E*h+I*C;g[7]=m*t+u*h+B*C;g[8]=d*k+p*l+z*q;g[9]=f*k+y*l+x*q;g[10]=c*k+E*l+I*q;g[11]=m*k+u*l+B*q;a!==g&&(g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]);
return g};a.rotateX=function(a,d,b){var g=Math.sin(d);d=Math.cos(d);var l=a[4],q=a[5],f=a[6],n=a[7],r=a[8],v=a[9],c=a[10],m=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=l*d+r*g;b[5]=q*d+v*g;b[6]=f*d+c*g;b[7]=n*d+m*g;b[8]=r*d-l*g;b[9]=v*d-q*g;b[10]=c*d-f*g;b[11]=m*d-n*g;return b};a.rotateY=function(a,d,b){var g=Math.sin(d);d=Math.cos(d);var l=a[0],q=a[1],f=a[2],n=a[3],r=a[8],v=a[9],c=a[10],m=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=l*d-r*g;b[1]=q*d-v*g;b[2]=f*d-c*g;b[3]=n*d-m*g;b[8]=l*g+r*d;b[9]=q*g+v*d;b[10]=f*g+c*d;b[11]=n*g+m*d;return b};a.rotateZ=function(a,d,b){var g=Math.sin(d);d=Math.cos(d);var l=a[0],q=a[1],f=a[2],n=a[3],r=a[4],v=a[5],c=a[6],m=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=l*d+r*g;b[1]=q*d+v*g;b[2]=f*d+c*g;b[3]=n*d+m*g;b[4]=r*d-l*g;b[5]=v*d-q*g;b[6]=c*d-f*g;b[7]=m*d-n*g;return b};
a.kL=function(a,d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=a[0];d[13]=a[1];d[14]=a[2];d[15]=1;return d};a.jL=function(a,d){d[0]=a[0];d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a[1];d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=a[2];d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.iL=function(a,d,b){var g=d[0],l=d[1];d=d[2];var q=Math.sqrt(g*g+l*l+d*d),f;if(1E-7>Math.abs(q))return null;q=1/q;g*=q;l*=q;d*=q;q=Math.sin(a);a=Math.cos(a);f=1-a;b[0]=g*g*f+a;b[1]=l*g*f+d*
q;b[2]=d*g*f-l*q;b[3]=0;b[4]=g*l*f-d*q;b[5]=l*l*f+a;b[6]=d*l*f+g*q;b[7]=0;b[8]=g*d*f+l*q;b[9]=l*d*f-g*q;b[10]=d*d*f+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.wS=function(a,d){var b=Math.sin(a),g=Math.cos(a);d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=g;d[6]=b;d[7]=0;d[8]=0;d[9]=-b;d[10]=g;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.xS=function(a,d){var b=Math.sin(a),g=Math.cos(a);d[0]=g;d[1]=0;d[2]=-b;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=b;d[9]=0;d[10]=g;d[11]=0;d[12]=0;d[13]=0;
d[14]=0;d[15]=1;return d};a.yS=function(a,d){var b=Math.sin(a),g=Math.cos(a);d[0]=g;d[1]=b;d[2]=0;d[3]=0;d[4]=-b;d[5]=g;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.fromRotationTranslation=function(a,d,b){var g=a[0],l=a[1],q=a[2],f=a[3],n=g+g,r=l+l,v=q+q;a=g*n;var c=g*r,g=g*v,m=l*r,l=l*v,q=q*v,n=f*n,r=f*r,f=f*v;b[0]=1-(m+q);b[1]=c+f;b[2]=g-r;b[3]=0;b[4]=c-f;b[5]=1-(a+q);b[6]=l+n;b[7]=0;b[8]=g+r;b[9]=l-n;b[10]=1-(a+m);b[11]=0;b[12]=d[0];b[13]=d[1];b[14]=d[2];
b[15]=1;return b};a.uS=function(a,d,b,g){var l=a[0],q=a[1],f=a[2],n=a[3],r=l+l,v=q+q,c=f+f;a=l*r;var m=l*v,l=l*c,p=q*v,q=q*c,f=f*c,r=n*r,v=n*v,n=n*c,c=b[0],y=b[1];b=b[2];g[0]=(1-(p+f))*c;g[1]=(m+n)*c;g[2]=(l-v)*c;g[3]=0;g[4]=(m-n)*y;g[5]=(1-(a+f))*y;g[6]=(q+r)*y;g[7]=0;g[8]=(l+v)*b;g[9]=(q-r)*b;g[10]=(1-(a+p))*b;g[11]=0;g[12]=d[0];g[13]=d[1];g[14]=d[2];g[15]=1;return g};a.vS=function(a,d,b,g,l){var q=a[0],f=a[1],n=a[2],r=a[3],v=q+q,c=f+f,m=n+n;a=q*v;var p=q*c,q=q*m,y=f*c,f=f*m,n=n*m,v=r*v,c=r*c,r=
r*m,m=b[0],E=b[1];b=b[2];var u=g[0],z=g[1];g=g[2];l[0]=(1-(y+n))*m;l[1]=(p+r)*m;l[2]=(q-c)*m;l[3]=0;l[4]=(p-r)*E;l[5]=(1-(a+n))*E;l[6]=(f+v)*E;l[7]=0;l[8]=(q+c)*b;l[9]=(f-v)*b;l[10]=(1-(a+y))*b;l[11]=0;l[12]=d[0]+u-(l[0]*u+l[4]*z+l[8]*g);l[13]=d[1]+z-(l[1]*u+l[5]*z+l[9]*g);l[14]=d[2]+g-(l[2]*u+l[6]*z+l[10]*g);l[15]=1;return l};a.fromQuat=function(a,d){var b=a[0],g=a[1],l=a[2],q=a[3],f=b+b,n=g+g,r=l+l,b=b*f,v=g*f,g=g*n,c=l*f,m=l*n,l=l*r,f=q*f,n=q*n,q=q*r;d[0]=1-g-l;d[1]=v+q;d[2]=c-n;d[3]=0;d[4]=v-
q;d[5]=1-b-l;d[6]=m+f;d[7]=0;d[8]=c+n;d[9]=m-f;d[10]=1-b-g;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return d};a.frustum=function(a,d,b,g,l,q,f){var n=1/(d-a),r=1/(g-b),v=1/(l-q);f[0]=2*l*n;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=2*l*r;f[6]=0;f[7]=0;f[8]=(d+a)*n;f[9]=(g+b)*r;f[10]=(q+l)*v;f[11]=-1;f[12]=0;f[13]=0;f[14]=q*l*2*v;f[15]=0;return f};a.perspective=function(a,d,b,g,l){a=1/Math.tan(a/2);var q=1/(b-g);l[0]=a/d;l[1]=0;l[2]=0;l[3]=0;l[4]=0;l[5]=a;l[6]=0;l[7]=0;l[8]=0;l[9]=0;l[10]=(g+b)*q;l[11]=-1;l[12]=
0;l[13]=0;l[14]=2*g*b*q;l[15]=0;return l};a.tT=function(a,d,b,g){var l=Math.tan(a.upDegrees*Math.PI/180),q=Math.tan(a.downDegrees*Math.PI/180),f=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var n=2/(f+a),r=2/(l+q);g[0]=n;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=r;g[6]=0;g[7]=0;g[8]=-((f-a)*n*.5);g[9]=(l-q)*r*.5;g[10]=b/(d-b);g[11]=-1;g[12]=0;g[13]=0;g[14]=b*d/(d-b);g[15]=0;return g};a.ortho=function(a,d,b,g,l,q,f){var n=1/(a-d),r=1/(b-g),v=1/(l-q);f[0]=-2*n;f[1]=0;f[2]=0;f[3]=
0;f[4]=0;f[5]=-2*r;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=2*v;f[11]=0;f[12]=(a+d)*n;f[13]=(g+b)*r;f[14]=(q+l)*v;f[15]=1;return f};a.lookAt=function(e,d,b,g){var l,q,f,n,r,v,c,m,p=e[0],y=e[1];e=e[2];f=b[0];n=b[1];q=b[2];c=d[0];b=d[1];l=d[2];if(1E-7>Math.abs(p-c)&&1E-7>Math.abs(y-b)&&1E-7>Math.abs(e-l))return a.identity(g);d=p-c;b=y-b;c=e-l;m=1/Math.sqrt(d*d+b*b+c*c);d*=m;b*=m;c*=m;l=n*c-q*b;q=q*d-f*c;f=f*b-n*d;(m=Math.sqrt(l*l+q*q+f*f))?(m=1/m,l*=m,q*=m,f*=m):f=q=l=0;n=b*f-c*q;r=c*l-d*f;v=d*q-b*l;(m=Math.sqrt(n*
n+r*r+v*v))?(m=1/m,n*=m,r*=m,v*=m):v=r=n=0;g[0]=l;g[1]=n;g[2]=d;g[3]=0;g[4]=q;g[5]=r;g[6]=b;g[7]=0;g[8]=f;g[9]=v;g[10]=c;g[11]=0;g[12]=-(l*p+q*y+f*e);g[13]=-(n*p+r*y+v*e);g[14]=-(d*p+b*y+c*e);g[15]=1;return g};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.hL=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function q(a,f){var l=a[0],r=a[1],q=a[2],c=a[3],l=d(l,r,q,c,f[0],7,-680876936),c=d(c,l,r,q,f[1],12,-389564586),q=d(q,c,l,r,f[2],17,606105819),r=d(r,q,c,l,f[3],22,-1044525330),l=d(l,r,q,c,f[4],7,-176418897),c=d(c,l,r,q,f[5],12,1200080426),q=d(q,c,l,r,f[6],17,-1473231341),r=d(r,q,c,l,f[7],22,-45705983),l=d(l,r,q,c,f[8],7,1770035416),c=d(c,l,r,q,f[9],12,-1958414417),q=d(q,c,l,r,f[10],17,-42063),r=d(r,q,c,l,f[11],22,-1990404162),l=d(l,r,q,c,f[12],7,1804603682),c=d(c,l,r,q,
f[13],12,-40341101),q=d(q,c,l,r,f[14],17,-1502002290),r=d(r,q,c,l,f[15],22,1236535329),l=b(l,r,q,c,f[1],5,-165796510),c=b(c,l,r,q,f[6],9,-1069501632),q=b(q,c,l,r,f[11],14,643717713),r=b(r,q,c,l,f[0],20,-373897302),l=b(l,r,q,c,f[5],5,-701558691),c=b(c,l,r,q,f[10],9,38016083),q=b(q,c,l,r,f[15],14,-660478335),r=b(r,q,c,l,f[4],20,-405537848),l=b(l,r,q,c,f[9],5,568446438),c=b(c,l,r,q,f[14],9,-1019803690),q=b(q,c,l,r,f[3],14,-187363961),r=b(r,q,c,l,f[8],20,1163531501),l=b(l,r,q,c,f[13],5,-1444681467),c=
b(c,l,r,q,f[2],9,-51403784),q=b(q,c,l,r,f[7],14,1735328473),r=b(r,q,c,l,f[12],20,-1926607734),l=e(r^q^c,l,r,f[5],4,-378558),c=e(l^r^q,c,l,f[8],11,-2022574463),q=e(c^l^r,q,c,f[11],16,1839030562),r=e(q^c^l,r,q,f[14],23,-35309556),l=e(r^q^c,l,r,f[1],4,-1530992060),c=e(l^r^q,c,l,f[4],11,1272893353),q=e(c^l^r,q,c,f[7],16,-155497632),r=e(q^c^l,r,q,f[10],23,-1094730640),l=e(r^q^c,l,r,f[13],4,681279174),c=e(l^r^q,c,l,f[0],11,-358537222),q=e(c^l^r,q,c,f[3],16,-722521979),r=e(q^c^l,r,q,f[6],23,76029189),l=
e(r^q^c,l,r,f[9],4,-640364487),c=e(l^r^q,c,l,f[12],11,-421815835),q=e(c^l^r,q,c,f[15],16,530742520),r=e(q^c^l,r,q,f[2],23,-995338651),l=g(l,r,q,c,f[0],6,-198630844),c=g(c,l,r,q,f[7],10,1126891415),q=g(q,c,l,r,f[14],15,-1416354905),r=g(r,q,c,l,f[5],21,-57434055),l=g(l,r,q,c,f[12],6,1700485571),c=g(c,l,r,q,f[3],10,-1894986606),q=g(q,c,l,r,f[10],15,-1051523),r=g(r,q,c,l,f[1],21,-2054922799),l=g(l,r,q,c,f[8],6,1873313359),c=g(c,l,r,q,f[15],10,-30611744),q=g(q,c,l,r,f[6],15,-1560198380),r=g(r,q,c,l,f[13],
21,1309151649),l=g(l,r,q,c,f[4],6,-145523070),c=g(c,l,r,q,f[11],10,-1120210379),q=g(q,c,l,r,f[2],15,718787259),r=g(r,q,c,l,f[9],21,-343485551);a[0]=l+a[0]&4294967295;a[1]=r+a[1]&4294967295;a[2]=q+a[2]&4294967295;a[3]=c+a[3]&4294967295}function e(a,b,d,e,g,c){b=(b+a&4294967295)+(e+c&4294967295)&4294967295;return(b<<g|b>>>32-g)+d&4294967295}function d(a,b,d,g,l,c,m){return e(b&d|~b&g,a,b,l,c,m)}function b(a,b,d,g,l,c,m){return e(b&g|d&~g,a,b,l,c,m)}function g(a,b,d,g,l,c,m){return e(d^(b|~g),a,b,l,
c,m)}var l="0123456789abcdef".split("");a.wB=function(a){var b=a,d=b.length;a=[1732584193,-271733879,-1732584194,271733878];var e;for(e=64;e<=b.length;e+=64){for(var g=b.substring(e-64,e),c=[],m=void 0,m=0;64>m;m+=4)c[m>>2]=g.charCodeAt(m)+(g.charCodeAt(m+1)<<8)+(g.charCodeAt(m+2)<<16)+(g.charCodeAt(m+3)<<24);q(a,c)}b=b.substring(e-64);g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<b.length;e++)g[e>>2]|=b.charCodeAt(e)<<(e%4<<3);g[e>>2]|=128<<(e%4<<3);if(55<e)for(q(a,g),e=0;16>e;e++)g[e]=0;g[14]=8*
d;q(a,g);for(b=0;b<a.length;b++){d=a[b];e="";for(g=0;4>g;g++)e+=l[d>>8*g+4&15]+l[d>>8*g&15];a[b]=e}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; GLSL_IN float a_index ; void main ( ) { gl_Position = u_view_proj_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 c ; GLSL_IN vec4 d ; GLSL_IN vec3 e ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 j ; GLSL_IN vec4 k ; GLSL_IN vec4 l ; GLSL_IN vec4 m ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3",
"o",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 u = normalize ( u_camera_eye_frag - c ) ; vec3 v ; vec3 A ; vec3 B ; vec4 C ; float D ; E ( u , v , A , B , C , D ) ; float F = D ;".split(" ")}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float F = ( GLSL_TEXTURE ( u_sampler , n ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float G = u_alpha_factor * F ; G += ( 1.0 - step ( 0.0 , G ) ) ; F = mix ( G , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float F = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],
h:{a:"grp",d:[{a:"txt",b:"if ( F < 0.5 ) discard ; F = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_OUTLINE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"CAUSTICS",
b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",
b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",
o:"scale_texcoord.glslv"},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",
"ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","o",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 c ; GLSL_OUT vec4 d ; GLSL_OUT vec3 e ;".split(" ")},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","i",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]}]}}]},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 H = u_view_tsr ; vec3 I = a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:"vec3 L = J ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 M = J ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 N = sign ( a_tbn_quat [ 3 ] ) * cross ( L , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 M = vec3 ( 0.0 ) ; vec3 N = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 L = vec3 ( 0.0 ) ; vec3 M = vec3 ( 0.0 ) ; vec3 N = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","O","=","u_model_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = normalize ( P ( u_model_tsr , L ) ) ; vec3 R = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , Q ) ; vec3 S = cross ( Q , R ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","S","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 S = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"I = mix ( I , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 T = J ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; L = mix ( L , T , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = J ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 V = sign ( a_tbn_quat_next [ 3 ] ) * cross ( T , U ) ; M = mix ( M , U , u_va_frame_factor ) ; N = mix ( N , V , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"W(I,M,N,L);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","X","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 X = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 Z = Y ( O , X ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"O = _ ( u_camera_eye , Z , H , O ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"O = ac ( u_camera_eye , Z , H ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"O = ad ( u_wind , u_time , u_jitter_amp , u_jitter_freq , Z , O ) ;".split(" ")}]}}]},{a:"txt",b:"ae ah = af ( I - X , X , vec3 ( 0.0 ) , S , vec3 ( 0.0 ) , vec3 ( 0.0 ) , O ) ; ah . X = Z ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"ae ah = af ( I , X , vec3 ( 0.0 ) , S , vec3 ( 0.0 ) , vec3 ( 0.0 ) , O ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ai ( ah . I , ah . X , L , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aj = J ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aj = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"ai ( ah . I , ah . X , aj , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"n = ak ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"c = ah . I ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"e = ah . L ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float al = ( dot ( cross ( ah . L , ah . M ) , ah . N ) < 0.0 ) ? - 1.0 : 1.0 ; f = vec4 ( ah . M , al ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"o = ah . am ;".split(" ")}]}}]},{a:"txt",b:"d = vec4 ( Y ( H , ah . I ) , 1.0 ) ; vec4 an = u_proj_matrix * d ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"an . xy += u_subpixel_jitter * an . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = ao ( an ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"i = - d . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["E","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( Y ( H , ah . I ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 ap ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float aq = 1.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"const vec3 as = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 as = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const vec3 at = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 au = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 av = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 aw = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 ax = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float aC ( ) { float ay = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 az = sign ( ap - vec3 ( 0.02 * aq ) ) ; if ( az . x < 0.0 || az . y < 0.0 || az . z < 0.0 ) ay = 0.0 ;".split(" ")}]}},{a:"elif",g:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aA = fwidth ( ap ) ; vec3 aB = smoothstep ( vec3 ( 0.0 ) , aA * aq , ap ) ; ay = min ( min ( aB . x , aB . y ) , aB . z ) ; ay = clamp ( ay , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","ay",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aD = vec3 ( 0.0 ) ; float F = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"vec3 az = sign ( ap - vec3 ( 0.02 * aq ) ) ; if ( az . x < 0.0 || az . y < 0.0 || az . z < 0.0 ) { aD = as ; F = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float ay = aC ( ) ; aD = vec3 ( mix ( u_wireframe_edge_color , av , ay ) ) ; F = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float ay = aC ( ) ; aD = u_wireframe_edge_color ; F = mix ( 1.0 , 0.0 , ay ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float ay = aC ( ) ; if ( gl_FrontFacing ) aD = mix ( u_wireframe_edge_color , at , ay ) ; else aD = mix ( u_wireframe_edge_color , au , ay ) ; F = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aE = u_cluster_id + u_debug_colors_seed + 2.0 ; aD = vec3 ( fract ( aE * 19.73 ) , fract ( aE * 6.34 ) , fract ( aE * 1.56 ) ) ; F = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aE = u_batch_debug_id_color + u_debug_colors_seed ; aD = vec3 ( fract ( aE * 19.73 ) , fract ( aE * 6.34 ) , fract ( aE * 1.56 ) ) ; F = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aF ; if ( u_debug_render_time_threshold > 0.0 ) aF = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aF = 1.0 ; float aG = clamp ( 2.0 * aF , 0.0 , 1.0 ) ; float aH = clamp ( 2.0 * aF - 1.0 , 0.0 , 1.0 ) ; float aI = aF ; aD = mix ( aw , ax , vec3 ( aG , aH , aI ) ) ; F = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aJ","(","aD",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aK ( aD , F ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aD , F ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",
o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",
g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","ap",";"]},{a:"cond",d:[{a:"if",
g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"include",o:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) ap = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) ap = vec3 ( 0.0 , 0.0 , 1.0 ) ; else ap = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",d:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 O = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"O = aL ( u_model_tsr , O ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","O","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 H = u_view_tsr ; vec3 I = a_position ; vec3 L = J ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEBUG_SPHERE"],h:{a:"grp",d:[{a:"txt",b:"ae ah = af ( I , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , O ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"I = mix ( I , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",
d:[{a:"txt",b:"vec3 M = vec3 ( 0.0 ) ; vec3 N = vec3 ( 0.0 ) ; W ( I , M , N , L ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","X","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = a_part_ts . xyz ; I = Y ( O , I ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 X = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"ae ah = aM ( I , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , X , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , H ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 Z = Y ( O , X ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION",
"STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"O = _ ( u_camera_eye , Z , H , O ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"O = ac ( u_camera_eye , Z , H ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aN = Z ; O = ad ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aN , O ) ;".split(" ")}]}}]},
{a:"txt",b:"ae ah = af ( I - X , X , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , O ) ; ah . X = Z ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ae ah = af ( I , X , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , O ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"ai ( ah . I , ah . X , L , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( Y ( H , ah . I ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aO ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aP",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","aP",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aP , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],
h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aP ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec4","aP",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aP",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","aP",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 H = u_view_tsr ; mat3 O = u_model_tsr ;".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 Z = Y ( O , vec3 ( 0.0 ) ) ; mat3 O = ac ( u_camera_eye , Z , H ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"O = ad ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , O ) ;".split(" ")}]}}]},{a:"txt",b:"ae ah = af ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , O ) ; ah . X = Z ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ae ah = af ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , O ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 an = u_proj_matrix * vec4 ( Y ( H , ah . I ) , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:"aP = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["aP","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",d:[{a:"txt",b:["aP","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","an",";","}"]}]};a["halo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aQ",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 n ; GLSL_IN float aR ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",o:"color_util.glslf"},{a:"include",o:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aT = aS ( ) ; vec3 aD = aT . rgb ; float az = aT . a ; aJ ( aD ) ; aK ( aD , az ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aD , az ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",o:"std.glsl"},
{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 n ; GLSL_OUT float aR ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","aQ",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 H = u_view_tsr ; mat3 O = u_model_tsr ; vec3 I = Y ( O , a_position ) ; n = a_halo_bb_vertex * 2.0 - 1.0 ; aR = a_random_vals ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"mat3 aV = aU ( I , H ) ; mat3 aW = H ; aW [ 0 ] [ 0 ] = 0.0 ; aW [ 0 ] [ 1 ] = 0.0 ; aW [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 aV = aU ( I , H ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 aX = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 aY = vec3 ( aX [ 0 ] , 0.0 , aX [ 1 ] ) ; vec3 aZ = Y ( aV , aY ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"vec4 an = u_proj_matrix * vec4 ( Y ( aW , aZ ) , 1.0 ) ; an . z = 0.99999 * an . w ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"aQ = vec4 ( aZ , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 an = u_proj_matrix * vec4 ( Y ( H , aZ ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","an",";","}"]}]};a["lens_flares.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aD = GLSL_TEXTURE ( u_sampler , n ) ; aJ ( aD . rgb ) ; aK ( aD . rgb , aD . a ) ; GLSL_OUT_FRAG_COLOR = aD ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 n ; void main ( ) { n = a_texcoord ; vec3 a_ = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 an = u_proj_matrix * vec4 ( P ( u_view_tsr , a_ ) , 0.0 ) ; an . x /= an . w ; an . y /= an . w ; an += 99999.0 * step ( an . z , 0.0 ) ; an += 100.0 * ( step ( 1.0 , abs ( an . x ) ) + step ( 1.0 , abs ( an . y ) ) ) ; an . x = a_lf_dist * an . x ; an . y = a_lf_dist * an . y ; float bc = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bd = vec2 ( a_lf_bb_vertex . x / bc , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float be = 1.9 ; bd *= ( 1.0 + be * length ( an . xy ) ) ; } gl_Position = vec4 ( an . xy + bd , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aD = u_diffuse_color . xyz ; float F = u_diffuse_color . a ; aJ ( aD ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aK ( aD , F ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aD , F ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 H = u_view_tsr ; mat3 O = u_model_tsr ; ae ah = af ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , O ) ; vec4 bf = u_proj_matrix * vec4 ( Y ( H , ah . I ) , 1.0 ) ; bf . xyz /= bf . w ; vec4 bh = u_proj_matrix * vec4 ( Y ( H , ah . I + ah . L ) , 1.0 ) ; bh . xyz /= bh . w ; float bc = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bi = ( bh - bf ) . xy ; bi . x *= bc ; float bj = M_PI / 2.0 ; mat2 bk = mat2 ( cos ( bj ) , sin ( bj ) , - sin ( bj ) , cos ( bj ) ) ; bi = bk * bi ; bi = normalize ( bi ) ; vec2 bl = ( u_line_width / u_height ) * vec2 ( 1.0 / bc , 1.0 ) ; gl_Position = vec4 ( bf . xy + bi . xy * bl / 2.0 , bf . z , 1.0 ) ; gl_Position *= bf . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",
o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 c ; GLSL_IN vec3 e ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","j",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","m",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"nodes.glslf"},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"float bm = length ( d ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bn = c . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 u = normalize ( u_camera_eye_frag - c ) ; vec3 v ; vec3 A ; vec3 B ; vec4 C ; float D ; E ( u , v , A , B , C , D ) ; vec3 aD = v ; float F = D ; vec3 L = B ; vec4 bo = C ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",
b:"aD = max ( aD - sqrt ( 0.01 * - min ( bn , 0.0 ) ) , 0.5 * aD ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bp ( aD , bn , u_time , bo , L , u_sun_direction , u_sun_intensity , u_sun_quaternion , c , bm ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( F < 0.5 ) discard ; F = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["F","=","1.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bq ( aD , bm , u , bn ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bq ( aD , bm , u , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bs = GLSL_TEXTURE_PROJ ( u_shadow_mask , h ) . a ; aD = vec3 ( bs ) ;".split(" ")}]}}]},
{a:"txt",b:"aD = max ( vec3 ( 0.0 ) , aD ) ; aJ ( aD ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aK ( aD , F ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aD , F ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",i:9}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 c ; GLSL_OUT vec3 e ;".split(" ")},{a:"cond",
d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bt",";"]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bu",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","j",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],
h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},
{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","bv","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 bv = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","H","=","u_view_tsr",";"]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 O = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"O = aL ( u_model_tsr , O ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","O","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","I","=","a_position",";"]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:14}],h:{a:"grp",d:[{a:"txt",b:"vec3 bw = J ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"NODES",{a:"logic_negative_expr",i:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:["vec3","L","=","bw",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 L = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 M = J ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 N = sign ( a_tbn_quat [ 3 ] ) * cross ( L , M ) ;".split(" ")}]}},{a:"elif",g:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bx = Y ( O , I ) ; vec3 Q = normalize ( P ( O , bw ) ) ; vec3 u = bx - u_camera_eye ; vec3 N = cross ( u , Q ) ; vec3 M = cross ( Q , N ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 M = vec3 ( 0.0 ) ; vec3 N = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = normalize ( P ( O , bw ) ) ; vec3 R = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , Q ) ; vec3 S = cross ( Q , R ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","S","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 S = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"I = mix ( I , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",i:10}],h:{a:"grp",d:[{a:"txt",b:"vec3 by = J ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:"L = mix ( L , by , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 U = J ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 V = sign ( a_tbn_quat_next [ 3 ] ) * cross ( by , U ) ; M = mix ( M , U , u_va_frame_factor ) ; N = mix ( N , V , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"W(I,M,N,L);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","X","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = a_part_ts . xyz ; I = Y ( O , I ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",d:[{a:"txt",b:"vec3 X = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"ae ah = aM ( I , M , S , N , L , X , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , H ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 Z = Y ( O , X ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"I = ( bv * vec4 ( I , 1.0 ) ) . xyz ; X = ( bv * vec4 ( X , 1.0 ) ) . xyz ; Z = ( bv * vec4 ( Z , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"O = _ ( u_camera_eye , Z , H , O ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"O = ac ( u_camera_eye , Z , H ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 aN = Z ; O = ad ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aN , O ) ;".split(" ")}]}}]},{a:"txt",b:"ae ah = af ( I - X , X , M , S , N , L , O ) ; ah . X = Z ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ae ah = af ( I , X , M , S , N , L , O ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float al = ( dot ( cross ( ah . L , ah . M ) , ah . N ) < 0.0 ) ? - 1.0 : 1.0 ; f = vec4 ( ah . M , al ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:"o = ah . am ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"ai ( ah . I , ah . X , L , bv ) ;".split(" ")}]}}]},{a:"txt",b:"c = ah . I ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"e = ah . L ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bt = u_camera_eye - ah . I ;".split(" ")},{a:"cond",d:[{a:"if",
g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"n = ak ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"bu = ah . aD ;".split(" ")}]}},{a:"elif",g:["VERTEX_COLOR"],h:{a:"grp",d:[{a:"txt",b:["bu","=","a_color",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bz = bv * vec4 ( ah . I , 1.0 ) ; bz . xyz = Y ( H , bz . xyz ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 bz = vec4 ( Y ( H , ah . I ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",
i:6}],h:{a:"grp",d:[{a:"txt",b:["d","=","bz",";"]}]}}]},{a:"txt",b:"vec4 an = u_proj_matrix * bz ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"an . xy += u_subpixel_jitter * an . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"h = ao ( an ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bA ( ah . I , ah . L ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"i = - bz . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["E","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","an",";","}"]}]};
a["main_stack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",
c:"REFLECTION_PASS",b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",
c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},
{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",
d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"include",o:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",g:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 c ; GLSL_IN vec3 e ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},
"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bt",";"]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","bu",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec4","j",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","m",";"]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},
{a:"include",o:"mirror.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"include",o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"lighting_nodes.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float bm = length ( d ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bn = c . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:["vec2","bB","=","n",
";"]}]}}]},{a:"txt",b:"vec3 bC = normalize ( e ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bC = bC ; else bC = - bC ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"vec3 N = cross ( bC , f . xyz ) * f . w ; N = normalize ( N ) ; vec3 M = cross ( N , bC ) * f . w ; mat3 bD = mat3 ( M , N , bC ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["mat3","H","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"vec2 bE = normalize ( P ( H , e ) ) . st ; bE = bE * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( bm < PARALLAX_LOD_DIST ) { float bF = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bm ) , 0.0 , 1.0 ) ; float bG = u_parallax_scale * bF ; vec3 bH = normalize ( bt * bD ) ; float bI = 1.0 / PARALLAX_STEPS ; vec2 bJ = bH . xy * bG / ( PARALLAX_STEPS * bH . z ) ; float bK = 1.0 ; float bL ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec2","bM","=","bE",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bM","=","bB",";"]}]}}]},{a:"txt",b:"bL = GLSL_TEXTURE ( u_normalmap0 , bM ) . a ; for ( float bN = 1.0 ; bN <= PARALLAX_STEPS ; bN ++ ) { if ( bL < bK ) { bK -= bI ; bM -= bJ ; bL = GLSL_TEXTURE ( u_normalmap0 , bM ) . a ; } } vec2 bO = bM + bJ ; float bP = GLSL_TEXTURE ( u_normalmap0 , bO ) . a - ( bK + bI ) ; float bQ = bL - bK ; float bR = bQ / ( bQ - bP ) ; bM = bR * bO + ( 1.0 - bR ) * bM ;".split(" ")},
{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bB += bM - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bM",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE += bM - bB ;".split(" ")}]}}]},{a:"txt",b:["bB","=","bM",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","bS",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bS = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bS = GLSL_TEXTURE ( u_normalmap0 , bB ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bT = bS . rgb - 0.5 ; bT = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bT , u_normal_factor ) ; vec3 L = bD * bT ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","L",
"=","bC",";"]}]}}]},{a:"txt",b:"L = normalize ( L ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD"],h:{a:"grp",d:[{a:"txt",b:"bE = normalize ( P ( H , L ) ) . st ; bE = bE * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 u = normalize ( bt ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 bU = bu ; bV ( bU ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bW = vec4 ( bU , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bW","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","bX","=","1.0",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bY = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 bY = GLSL_TEXTURE ( u_colormap0 , bB ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV ( bY . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",d:[{a:"txt",b:["vec4","bZ",";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bZ = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bZ = GLSL_TEXTURE ( u_colormap1 , bB ) ;".split(" ")}]}}]},
{a:"txt",b:"bV ( bZ . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 b_ = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 b_ = GLSL_TEXTURE ( u_stencil0 , bB ) ;".split(" ")}]}}]},{a:"txt",b:"bY = mix ( bY , bZ , b_ . r ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"bW . rgb = mix ( bW . rgb , bY . rgb , u_diffuse_color_factor ) ; float G = u_alpha_factor * bY . a ; G += ( 1.0 - step ( 0.0 , G ) ) ; bW . a = mix ( G , 1.0 , u_diffuse_color . a ) ; bX = bY . a ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bW . rgb *= mix ( vec3 ( 1.0 ) , bY . rgb , u_diffuse_color_factor ) ; bW . a = bY . a ; bX = bY . a ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADELESS"],h:{a:"grp",
d:[{a:"txt",b:"vec3 aD = bW . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ca = u_diffuse_intensity * bW . rgb ; vec3 cc = u_environment_energy * cb ( L ) ; vec3 cd = u_ambient * cc ; vec4 bo = ce ( ca ) ; vec3 cf = u_emit * bW . rgb ; vec3 cg = u_specular_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_SPEC"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_AS_SPEC"],h:{a:"grp",d:[{a:"txt",b:"vec3 ch = vec3 ( bX ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 ch = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 ch = GLSL_TEXTURE ( u_specmap0 , bB ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bV ( ch . rgb ) ; cg = mix ( cg , ch , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float ci = u_specular_params [ 0 ] ; vec2 cj = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 ck = ci * cg ; vec3 aD ; vec3 cl ; cm ( cf , cd , ca , ck , c , L , u , cj , u_diffuse_params , bo , 0.0 , vec4 ( 0.0 ) , aD , cl ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cn ( aD , u , L , u_reflect_factor , H ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cn ( aD , u , L , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"cn ( aD , u , L , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["aD","+=","cl",";"]}]}}]},{a:"txt",b:"float F = bW . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WETTABLE"],h:{a:"grp",d:[{a:"txt",b:"aD = max ( aD - sqrt ( 0.01 * - min ( bn , 0.0 ) ) , 0.5 * aD ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CAUSTICS"],h:{a:"grp",d:[{a:"txt",b:"bp ( aD , bn , u_time , bo , L , u_sun_direction , u_sun_intensity , u_sun_quaternion , c , bm ) ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( F < 0.5 ) discard ; F = 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"float t = max ( max ( cl . r , cl . g ) , cl . b ) * u_specular_alpha ; F = bW . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["F","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],
h:{a:"grp",d:[{a:"txt",b:"vec2 co = - ( P ( H , L ) ) . xy ; aD = mix ( cp ( h , co * u_refr_bump ) , aD , F ) ; F = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"bq ( aD , bm , u , bn ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"bq ( aD , bm , u , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float bs = GLSL_TEXTURE_PROJ ( u_shadow_mask , h ) . a ; aD = vec3 ( bs ) ;".split(" ")}]}}]},{a:"txt",b:["aJ","(","aD",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aK ( aD , F ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aD , F ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","c",";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 e ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 u = normalize ( u_camera_eye_frag - c ) ; vec3 v ; vec3 A ; vec3 B ; vec4 C ; float D ; E ( u , v , A , B , C , D ) ; vec3 aD = v ; float F = D ;".split(" ")},
{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( F < 0.5 ) discard ; F = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["F","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bq ( aD , length ( d ) , u , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float cq = - d . z / u_view_max_depth ; vec4 cr = GLSL_TEXTURE_PROJ ( u_scene_depth , h ) ; float ct = cs ( cr ) ; float cu = ct - cq ; float cv = u_view_max_depth / SOFT_STRENGTH * cu ; F = F * min ( cv , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aJ","(","aD",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aK ( aD , F ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aD , F ) ; }".split(" ")}]};a["particle_system.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",
b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",
b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","cw",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bu",";"]}]}}]},{a:"cond",d:[{a:"if",
g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","f",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","c",";"]},
{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","bt",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT",
"vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","e",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","aR",";"]}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"particles.glslv"},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"include",o:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cz ( vec2 cx , vec2 cy ) { return ( atan ( cy . y , cy . x ) - atan ( cx . y , cx . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat4","bv","=","u_view_refl_matrix",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 bv = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 H = u_view_tsr ; cA pp ; pp = cB ( ) ; float cC ; mat3 aV = cD ( ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 cE = ( bv * vec4 ( pp . I , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cE = pp . I ;".split(" ")}]}}]},
{a:"txt",b:"vec3 L = J ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cC = pp . bj ; aV = aU ( cE , H ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cC = cz ( vec2 ( EPSILON , 1.0 ) , vec2 ( L . x , - L . y ) ) + pp . bj ; aV [ 0 ] = cE ; vec4 cG = cF ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aV = cH ( cG , aV ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cC = pp . bj ; aV [ 0 ] = cE ; vec4 cI = cF ( UP_VECTOR , M_PI / 2.0 ) ; aV = cH ( cI , aV ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cC = pp . bj ; aV [ 0 ] = cE ; } vec3 aY = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cJ * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cJ * u_p_size ) ; float cK = a_p_data [ 2 ] ; float cL = u_p_tilt * u_p_tilt_rand * ( 2.0 * cK - 1.0 ) ; float cM = ( cL + u_p_tilt ) * M_PI ; vec4 cN = cF ( TOWARD_VECTOR , cM + cC ) ; vec3 aZ = Y ( aV , J ( cN , aY ) ) ; vec4 bz = vec4 ( Y ( H , aZ ) , 1.0 ) ; vec4 an = u_proj_matrix * bz ;".split(" ")},
{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["aR","=","cK",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 M = J ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 N = sign ( a_tbn_quat [ 3 ] ) * cross ( L , M ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 M = vec3 ( 0.0 ) ; vec3 N = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 cO = cD ( ) ; cN = cF ( TOWARD_VECTOR , cC ) ; cO = cH ( cN , cO ) ; ae ah = af ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , M , vec3 ( 0.0 ) , N , vec3 ( 0.0 ) , aL ( aV , cO ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",i:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float al = ( dot ( cross ( L , ah . M ) , ah . N ) < 0.0 ) ? - 1.0 : 1.0 ; f = vec4 ( ah . M , al ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:["e","=","L",";"]}]}}]},{a:"txt",b:"E ( pp . I , pp . cP , pp . cQ , pp . cR , pp . cJ , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["n","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"n = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"cw = pp . F ;".split(" ")}]}}]},{a:"txt",b:"bu = pp . aD ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"h = ao ( an ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["d","=","bz",";"]}]}}]},{a:"txt",b:"gl_Position = an ; c = aZ ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bt = u_camera_eye - aZ ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",
d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},
{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","c",";"]},{a:"cond",d:[{a:"if",g:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","cw",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bu",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN",
"vec3","bt",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","aR",";"]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","aQ",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"txt",
b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",o:"lighting_nodes.glslf"},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"include",o:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",
{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 u = normalize ( bt ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["HALO_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"vec4 aT = aS ( ) ; vec3 aD = aT . rgb * bu ; float cS = 0.9 * length ( n ) ; float cT = smoothstep ( u_p_alpha_start , u_p_alpha_end , cS ) ; float F = aT . a * ( 1.0 - cT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","bW","=","u_diffuse_color",
";"]},{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"vec4 bY = GLSL_TEXTURE ( u_sampler , n ) ; bV ( bY . rgb ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bW . rgb = mix ( bW . rgb , bY . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bW . rgb *= mix ( vec3 ( 1.0 ) , bY . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bW . a = bY . a ;".split(" ")}]}}]},{a:"txt",b:"bW . rgb *= bu ;".split(" ")},{a:"cond",d:[{a:"if",g:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 ca = u_diffuse_intensity * bW . rgb ; vec3 cf = u_emit * bW . rgb ; vec3 L = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 cc = u_environment_energy * cb ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 cc = u_environment_energy * cb ( L ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cd = u_ambient * cc ; float ci = u_specular_params [ 0 ] ; vec2 cj = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 ck = ci * u_specular_color ; vec3 aD ; vec3 cl ; cm ( cf , cd , ca , ck , c , L , u , cj , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aD , cl ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aD = bW . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float F = bW . a * cw ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["ALPHA_CLIP"],h:{a:"grp",d:[{a:"txt",b:"if ( F < 0.5 ) discard ; F = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["F","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"bq ( aD , length ( d ) , u , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES"],h:{a:"grp",d:[{a:"txt",b:"float cq = - d . z / u_view_max_depth ; vec4 cr = GLSL_TEXTURE_PROJ ( u_scene_depth , h ) ; float ct = cs ( cr ) ; float cu = ct - cq ; float cv = u_view_max_depth / SOFT_STRENGTH * cu ; F = F * min ( cv , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aJ","(","aD",")",";"]},{a:"cond",d:[{a:"if",g:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aK ( aD , F ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aD , F ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cV = 0.99 ; const float cW = 1.8 ; const int cX = 8 ; float db ( vec3 I , vec3 a_ ) { float a = dot ( a_ , a_ ) ; float b = 2.0 * dot ( a_ , I ) ; float cY = dot ( I , I ) - 1.0 ; float cZ = b * b - 4.0 * a * cY ; float c_ = sqrt ( cZ ) ; float q = ( - b - c_ ) / 2.0 ; float da = cY / q ; return da ; } float dd ( float F , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float cY = 1.0 + F * F ; float dc = pow ( 1.0 + g * g - 2.0 * g * F , 1.5 ) ; dc = max ( dc , 0.00001 ) ; return ( a / b ) * ( cY / dc ) ; } float di ( vec3 I , vec3 a_ , float de ) { float df = dot ( a_ , - I ) ; if ( df < 0.0 ) { return 1.0 ; } vec3 dg = I + df * a_ ; if ( length ( dg ) < de ) { return 0.0 ; } else if ( length ( dg ) >= de ) { vec3 cy = normalize ( dg ) * de - I ; float dh = acos ( dot ( normalize ( cy ) , a_ ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dh * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dj ( float az , vec3 aD , float ay ) { return aD - aD * pow ( u_sky_color , vec3 ( ay / az ) ) ; } void main ( ) { vec3 dk = normalize ( cU ) ; vec3 dl = u_sun_direction ; float F = dot ( dk , dl ) ; float dm = dd ( F , - 0.01 ) * u_rayleigh_brightness * dl . z ; float dn = dd ( F - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dl . z ) ; float dp = smoothstep ( 0.0 , 100.0 , dd ( F , 0.9995 ) ) * u_spot_brightness ; vec3 dq = vec3 ( 0.0 , 0.0 , cV ) ; float dr = db ( dq , dk ) ; float ds = dr / float ( cX ) ; float dt = di ( dq , dk , cV - 0.3 ) ; vec3 du = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dv = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bN = 0 ; bN < cX ; bN ++ ) { float dw = ds * float ( bN ) ; vec3 I = dq + dk * dw ; float dx = di ( I , dl , cV - 0.2 ) ; float dy = db ( I , dl ) ; vec3 dz = dj ( dy , vec3 ( cW ) , u_scatter_strength ) * dx ; du += dj ( sqrt ( dw ) , u_sky_color * dz , u_rayleigh_strength ) ; dv += dj ( dw , dz , u_mie_strength ) ; } du = du * dt * pow ( dr , u_rayleigh_collection_power ) / float ( cX ) ; dv = ( dv * dt * pow ( dr , u_mie_collection_power ) ) / float ( cX ) ; vec3 aD = vec3 ( dp * dv + dn * dv + dm * du ) ; aJ ( aD ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aD , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_DERIVATIVES_EXT"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_VIEW_TSR",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_VIEW_TSR_INVERSE"],
h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_MODEL_TSR_INVERSE"],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_LAMP"],
h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_VALUE"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_RGB"],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",d:[{a:"if",g:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_OBJECT_INFO"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 c ; GLSL_IN vec3 e ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","f",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","j",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["GLSL_IN","vec4","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"shadow.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NODES"],h:{a:"grp",d:[{a:"txt",b:"vec3 u = normalize ( u_camera_eye_frag - c ) ; vec3 v ; vec3 A ; vec3 B ; vec4 C ; float D ; E ( u , v , A , B , C , D ) ; float F = D ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float F = ( GLSL_TEXTURE ( u_colormap0 , n ) ) . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"float G = u_alpha_factor * F ; G += ( 1.0 - step ( 0.0 , G ) ) ; F = mix ( G , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float F = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( F < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dA ( d . z ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( f . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 c ; GLSL_OUT vec3 e ;".split(" ")},{a:"cond",d:[{a:"if",
g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","f",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","d",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","j",";"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","l",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:["GLSL_OUT","vec4","m",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","i",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",
d:[{a:"if",g:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],
h:{a:"grp",d:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",o:"dynamic_grass.glslv"},{a:"include",o:"shadow.glslv"},{a:"include",o:"skin.glslv"},{a:"include",o:"wind_bending.glslv"},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 H = u_view_tsr ; vec3 I = a_position ;".split(" ")},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:13}],h:{a:"grp",d:[{a:"txt",b:"vec3 bw = J ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 L = bw ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 L = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 M = J ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 N = sign ( a_tbn_quat [ 3 ] ) * cross ( L , M ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 M = vec3 ( 0.0 ) ; vec3 N = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["VERTEX_ANIM"],h:{a:"grp",d:[{a:"txt",b:"I = mix ( I , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 T = J ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; L = mix ( L , T , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 U = J ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 V = sign ( a_tbn_quat_next [ 3 ] ) * cross ( T , U ) ; M = mix ( M , U , u_va_frame_factor ) ; N = mix ( N , V , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"txt",b:"W(I,M,N,L);".split("")}]}}]},{a:"cond",d:[{a:"if",g:["USE_INSTANCED_PARTCLS"],h:{a:"grp",d:[{a:"txt",b:"mat3 O = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["STATIC_BATCH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"O = aL ( u_model_tsr , O ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",
d:[{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["mat3","O","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","X","=","au_center_pos",";"]}]}},{a:"elif",g:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 X = a_part_ts . xyz ; I = Y ( O , I ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 X = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["CALC_TBN"],h:{a:"grp",d:[{a:"txt",b:"vec3 Q = normalize ( P ( O , bw ) ) ; vec3 R = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , Q ) ; vec3 S = cross ( Q , R ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","S","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 S = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",
g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"txt",b:"ae ah = aM ( I , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , L , X , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , H ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"vec3 Z = Y ( O , X ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:["mat3","dB","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["mat3","dB","=","H",";"]}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"O = _ ( u_camera_eye , Z , dB , O ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"O = ac ( u_camera_eye , Z , dB ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"O = ad ( u_wind , u_time , u_jitter_amp , u_jitter_freq , Z , O ) ;".split(" ")}]}}]},{a:"txt",b:"ae ah = af ( I - X , X , vec3 ( 0.0 ) , S , vec3 ( 0.0 ) , L , O ) ; ah . X = Z ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"ae ah = af ( I , X , vec3 ( 0.0 ) , S , vec3 ( 0.0 ) , L , O ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec3","aj","=","bw",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 aj = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"ai ( ah . I , ah . X , aj , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"c = ah . I ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",
"WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:12}],h:{a:"grp",d:[{a:"txt",b:"e = ah . L ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"float al = ( dot ( cross ( ah . L , ah . M ) , ah . N ) < 0.0 ) ? - 1.0 : 1.0 ; f = vec4 ( ah . M , al ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],
h:{a:"grp",d:[{a:"txt",b:"o = ah . am ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 bz = vec4 ( Y ( H , ah . I ) , 1.0 ) ; vec4 an = u_proj_matrix * bz ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_JITTER"],h:{a:"grp",d:[{a:"txt",b:"an . xy += u_subpixel_jitter * an . w ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_POSITION_CLIP",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"h = ao ( an ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"i = - bz . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["E","(",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["TEXTURE_COLOR"],h:{a:"grp",d:[{a:"txt",b:"n = ak ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"bA ( ah . I , ah . L ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["d","=","bz",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dC = ( u_proj_matrix * vec4 ( H [ 0 ] , 1.0 ) ) . xy ; float dD = SHADOW_TEX_RES / 2.0 ; dC = floor ( dC * dD + 0.5 ) / dD - dC ; an . xy += dC ;".split(" ")}]}}]},
{a:"txt",b:["gl_Position","=","an",";","}"]}]};a["sky.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},
{a:"include",o:"color_util.glslf"},{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cU",";"]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dE ; vec3 dk = normalize ( cU ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","dF","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dF = abs ( n . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dF = ( n . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dG = u_horizon_color ; vec3 dH = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec3 dI = vec3 ( n , 0.0 ) ; vec4 dJ = GLSL_TEXTURE_CUBE ( u_sky , dk ) ; bV ( dJ . rgb ) ; dE = dK ( dG , dH , dJ , dF , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"dE = mix ( dG , dH , dF ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dE = GLSL_TEXTURE_CUBE ( u_sky , dk ) . rgb ; bV ( dE ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float dL = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dM = vec3 ( 0.0 ) ; vec3 dN = mix ( u_underwater_fog_color_density . rgb , dM , min ( - dk . z , 1.0 ) ) ; dN *= min ( 1.0 - min ( 0.03 * dL , 0.8 ) , 1.0 ) ; float ay = clamp ( sign ( 0.01 * dL - dk . z ) , 0.0 , 1.0 ) ; dE = mix ( dE , dN , ay ) ;".split(" ")}]}}]},
{a:"txt",b:"aJ ( dE ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dE , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cU ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 I = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dk = u_sky_vp_inverse * I ; cU = dk . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"n = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","I",";","}"]}]};
a["skybox.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cU ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 I = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dk = u_cube_view_matrix * I ; cU = dk . xyz ;".split(" ")},{a:"cond",d:[{a:"if",g:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"n = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","I",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cU ; GLSL_IN vec2 n ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"include",o:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dk = normalize ( cU ) ; vec3 dE ; float dF = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYPAPER"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"dE = GLSL_TEXTURE_CUBE ( u_sky_texture , dk ) . xyz ; bV ( dE ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dE = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",
g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"float F = acos ( dk . z ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"dF = abs ( F * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dF = 1.0 - F * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dG = u_horizon_color ; vec3 dH = u_zenith_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["WO_SKYTEX"],h:{a:"grp",d:[{a:"txt",b:"vec4 dJ = GLSL_TEXTURE_CUBE ( u_sky_texture , dk ) ; bV ( dJ . rgb ) ; vec3 dI = vec3 ( cU . xy , 0.0 ) ; dE = dK ( dG , dH , dJ , dF , dI ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"dE = mix ( dG , dH , dF ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["dE","=","dG",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aJ ( dE ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dE , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",
o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",g:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",d:[{a:"if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],
h:{a:"grp",d:[{a:"txt",b:"const float aq = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bt ; GLSL_IN vec3 c ; GLSL_IN vec3 e ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","n",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 f ; GLSL_IN vec3 dO ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dP",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","dQ",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","h",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","ap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","o",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
o:"environment.glslf"},{a:"cond",d:[{a:"if",g:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"refraction.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"include",o:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ea ( in vec2 dR , in vec3 L , in vec3 u , in vec3 dS , out float dT ) { dT = 0.0 ; vec3 dU = reflect ( - u , L ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dV = dR . xy + L . xy * REFL_BUMP / i ; dT = u_reflect_factor ; vec3 dW ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dW = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dW = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dW = GLSL_TEXTURE ( u_plane_reflection , dV ) . rgb ; bV ( dW ) ; }".split(" ")}]}},
{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"dT = u_mirror_factor ; vec3 dW = dS * GLSL_TEXTURE_CUBE ( u_mirrormap , dU ) . rgb ; bV ( dW ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dT = u_reflect_factor ; vec3 dW = dS * vec3 ( 0.3 , 0.5 , 1.0 ) ; bV ( dW ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 dX = normalize ( dU + u ) ; float dY = 1.0 - dot ( u , dX ) ; float dZ = u_fresnel_params [ 3 ] ; float d_ = u_fresnel_params [ 2 ] ; float r = dZ + ( 1.0 - dZ ) * pow ( dY , d_ ) ; dT = min ( dT * r , 1.0 ) ; return dW ; }".split(" ")},
{a:"include",o:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 bD = mat3 ( f , dO , e ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 L = normalize ( e ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"float bn = c . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float bn = c . z ;".split(" ")}]}}]}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"vec2 bB = vec2 ( dP . x , - dP . y ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 bB = vec2 ( c . x , - c . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec2","bB","=","n",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,
{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 eb = vec3 ( 0.0 ) ; vec3 ec = GLSL_TEXTURE ( u_normalmap0 , bB * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; eb += ec ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 ed = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NORM_FOAM0"],h:{a:"grp",d:[{a:"txt",b:["ed","+=","ec",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"ec = GLSL_TEXTURE ( u_normalmap0 , bB * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; eb += ec ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM1"],h:{a:"grp",d:[{a:"txt",b:["ed","+=","ec",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ec = GLSL_TEXTURE ( u_normalmap0 , bB * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; eb += ec ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM2"],h:{a:"grp",d:[{a:"txt",b:["ed","+=","ec",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ec = GLSL_TEXTURE ( u_normalmap0 , bB * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; eb += ec ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NORM_FOAM3"],h:{a:"grp",d:[{a:"txt",
b:["ed","+=","ec",";"]}]}}]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"vec3 ee = bD * ed ; if ( ! ef ( ee , vec3 ( 0.0 ) ) ) ee = normalize ( ee ) ; vec3 eg = mix ( L , ee , 0.2 ) ; eg = normalize ( eg ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"L = mix ( L , normalize ( bD * eb ) , 0.3 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"L = mix ( L , normalize ( bD * eb ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"L = normalize ( L ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 u = normalize ( bt ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 dR = h . xy / h . z ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"vec2 eh = dR + L . xy * u_refr_bump / i ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float F = u_diffuse_color . a ; vec4 cr = GLSL_TEXTURE_PROJ ( u_scene_depth , h ) ; float ct = cs ( cr ) ; float cu = max ( ct - i , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"float ej = ei ( ct , eh , dR ) ; float ek = max ( ej - i , 0.0 ) ; float el = u_view_max_depth / ABSORB * ek ; float em = min ( F * el , 1.0 ) ; F = min ( 15.0 * F * u_view_max_depth * cu , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float cv = u_view_max_depth / ABSORB * cu ; if ( u_cam_water_depth > 0.0 ) F = min ( F * cv , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float F = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:["float","em","=","F",";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) em = 0.0 ; vec3 en = GLSL_TEXTURE ( u_refractmap , eh ) . rgb ; bV ( en ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eo = pow ( min ( dQ . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bW = mix ( u_shallow_water_col , u_diffuse_color . rgb , eo ) ; eo = pow ( min ( dQ . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bW = mix ( u_shore_water_col , bW , eo ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 bW = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING"],h:{a:"grp",d:[{a:"txt",b:"float ep = max ( 1.0 - u_view_max_depth * cu , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"float ep = 1.0 - F ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float eq = max ( bn / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],
h:{a:"grp",d:[{a:"txt",b:"vec3 er = normalize ( vec3 ( dQ . rg , 0.0 ) ) ; vec3 es = normalize ( mix ( UP_VECTOR , er , 0.8 ) ) ; float et = 1.25 * max ( dot ( eg , es ) - 0.2 , 0.0 ) ; et += max ( dot ( eg , - UP_VECTOR ) , 0.0 ) ; ep += et * ( 1.0 - dQ . b ) ; eq *= ( 1.0 - 0.95 * pow ( dQ . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"ep += eq ; ep = min ( u_foam_factor * ep , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 eu = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bB * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float ci = u_specular_params [ 0 ] ; vec2 cj = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 ck = ci * u_specular_color ; vec3 cc = u_environment_energy * cb ( L ) ; vec3 cd = u_ambient * cc ; vec3 dS = cd + u_sun_intensity ; float dT ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dW = ea ( dR , L , u , dS , dT ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dW = ea ( vec2 ( 0.0 ) , L , u , dS , dT ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 ca = u_diffuse_intensity * bW ; vec3 aD ; vec3 cl ; cm ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , ca , ck , c , L , u , cj , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aD , cl ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float ev = max ( dot ( u_sun_direction , - e ) + SSS_WIDTH , 0.0 ) * max ( dot ( - u , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ev = clamp ( SSS_STRENGTH * ev , 0.0 , 1.0 ) ; aD = mix ( aD , u_shallow_water_col , ev ) ; aD = mix ( aD , u_shore_water_col , ev ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"txt",b:"aD = mix ( en , aD , em ) ;".split(" ")}]}}]},{a:"txt",b:"aD = mix ( aD , dW , dT ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:"float ew = mix ( eu . g , eu . r , max ( 4.0 * ( ep - 0.75 ) , 0.0 ) ) ; ew = mix ( eu . b , ew , max ( 2.0 * ep - 1.0 , 0.0 ) ) ; ew = mix ( 0.0 , ew , ep ) ; aD = mix ( aD , dS , ew ) ;".split(" ")}]}}]},{a:"txt",b:["aD","+=","cl",";"]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ex = i * u_view_max_depth ; float ey = 1.0 ; if ( u_cam_water_depth > 1.0 ) ey = 2.0 ; bq ( aD , ex , u , ey ) ;".split(" ")}]}}]},{a:"txt",b:["aJ","(","aD",")",";"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"F = max ( F , cl . r ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOAM"],h:{a:"grp",d:[{a:"txt",b:["F","+=","ew",";"]}]}}]}]}},{a:"elif",g:["SHORE_SMOOTHING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:["F","=","1.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aK ( aD , F ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GLSL1"],h:{a:"grp",d:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aA = fwidth ( ap ) ; vec3 aB = smoothstep ( vec3 ( 0.0 ) , aA * aq , ap ) ; float ez = min ( min ( aB . x , aB . y ) , aB . z ) ; ez = clamp ( ez , 0.0 , 1.0 ) ; aD = mix ( u_wireframe_edge_color , aD , ez ) ; F = mix ( 1.0 , F , ez ) ;".split(" ")}]}},
{a:"elif",g:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 az = sign ( ap - vec3 ( 0.02 * aq ) ) ; float ez = 1.0 ; if ( az . x < 0.0 || az . y < 0.0 || az . z < 0.0 ) ez = 0.0 ; aD = mix ( u_wireframe_edge_color , aD , ez ) ; F = mix ( 1.0 , F , ez ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aD , F ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"include",o:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"DYNAMIC",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bt ; GLSL_OUT vec3 c ; GLSL_OUT vec3 e ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","n",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec3 f ; GLSL_OUT vec3 dO ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dP",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","dQ",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","h",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","float","i",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","ap",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_TBN_SHADING"],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec3","o",";"]}]}}]},{a:"cond",d:[{a:"if",g:["STATIC_BATCH"],h:{a:"grp",d:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 eG ( in vec2 eA ) { vec2 eB = 0.5 + vec2 ( ( eA . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eA . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eC = GLSL_TEXTURE ( u_shore_dist_map , eB ) ; const vec2 eD = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eE = dot ( eC . ba , eD ) ; vec2 eF = normalize ( eC . rg * 2.0 - 1.0 ) ; return vec3 ( eF , eE ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eV ( inout vec3 eA , in float eH , in vec3 eC ) { float eJ = eI ( DST_NOISE_SCALE_0 * ( eA . xy + DST_NOISE_FREQ_0 * eH ) ) * eI ( DST_NOISE_SCALE_1 * ( eA . yx - DST_NOISE_FREQ_1 * eH ) ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"float eK = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eE = eC . b ; float eL = sqrt ( eE ) ; float eM = max ( eE , DIR_MIN_SHR_FAC ) * sin ( eL / eK + DIR_FREQ * eH ) ; float eN = max ( eI ( DIR_NOISE_SCALE * ( eA . xy + DIR_NOISE_FREQ * eH ) ) , DIR_MIN_NOISE_FAC ) ; eM *= eN ; float eO = WAVES_HEIGHT * mix ( eM , eJ , max ( eL , DST_MIN_FAC ) ) ; vec2 eF = eC . rg ; float eP = WAVES_HOR_FAC * eM * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eE ) , 0.0 ) ; vec2 eQ = eP * eF ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"float eO = WAVES_HEIGHT * eJ ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec2 eR = 1.0 * ( eA . xy - 0.3 * eH ) ; vec2 eS = 0.7 * ( eA . yx + 0.07 * eH ) ; float eU = eT ( eR ) . x + eT ( eS ) . x - 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"eA . xy += eQ ; eU *= eE ;".split(" ")}]}}]},{a:"txt",b:"eO += SMALL_WAVES_FAC * eU ;".split(" ")}]}}]},{a:"txt",b:"eA . z += eO ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["DEBUG_WIREFRAME"],h:{a:"grp",d:[{a:"txt",b:"if ( a_polyindex == 0.0 ) ap = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) ap = vec3 ( 0.0 , 0.0 , 1.0 ) ; else ap = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"vec3 I = a_position ; float eW = abs ( I . z ) ; vec2 eX = u_camera_eye . xy - mod ( u_camera_eye . xy , eW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],
h:{a:"grp",d:[{a:"txt",b:"I . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"I . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"I . xy += eX ; vec3 bx = I ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["n","=","a_texcoord",";"]}]}}]},{a:"txt",b:"ae ah = af ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bx = ah . I ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"dQ = eG ( bx . xy ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DYNAMIC"],h:{a:"grp",d:[{a:"txt",b:"float eY = length ( u_wind ) ; if ( eY == 0.0 ) eY = 1.0 ; float eZ = u_time ; eZ *= eY ;".split(" ")},{a:"cond",d:[{a:"if",g:["GENERATED_MESH"],h:{a:"grp",d:[{a:"txt",b:"float e_ = eW ; vec3 fa = bx + vec3 ( e_ , 0.0 , 0.0 ) ; vec3 fb = bx + vec3 ( 0.0 , e_ , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",
i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["dP","=","bx",";"]}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 fa = bx + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fb = bx + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SHORE_PARAMS"],h:{a:"grp",d:[{a:"txt",b:"vec3 fc = eG ( fa . xy ) ; vec3 fd = eG ( fb . xy ) ; eV ( fa , eZ , fc ) ; eV ( fb , eZ , fd ) ; eV ( bx , eZ , dQ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"eV ( fa , eZ , vec3 ( 0.0 ) ) ; eV ( fb , eZ , vec3 ( 0.0 ) ) ; eV ( bx , eZ , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bx . z = WATER_LEVEL - 1.0 ; fa . z = bx . z ; fb . z = bx . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fe = normalize ( fa - bx ) ; vec3 M = normalize ( fb - bx ) ; e = normalize ( cross ( fe , M ) ) ; float ff = dot ( e , UP_VECTOR ) ; float ay = clamp ( 0.8 - ff , 0.0 , 1.0 ) ; e = mix ( e , UP_VECTOR , ay ) ;".split(" ")}]}},{a:"elif",g:["GENERATED_MESH",{a:"logic_negative_expr",
i:1}],h:{a:"grp",d:[{a:"txt",b:"e = J ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"e = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["GENERATED_MESH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 M = J ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",g:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec3 M = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"f = M ; dO = cross ( e , f ) ;".split(" ")}]}}]},{a:"txt",b:"c = bx ; bt = u_camera_eye - bx ; vec4 bz = vec4 ( Y ( u_view_tsr , bx ) , 1.0 ) ; vec4 an = u_proj_matrix * bz ;".split(" ")},{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"float fg = an . x ; float fh = an . y ; float fi = an . w ; h . x = ( fg + fi ) / 2.0 ; h . y = ( fh + fi ) / 2.0 ; h . z = fi ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",d:[{a:"txt",b:"i = - bz . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","an",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",o:"precision_statement.glslf"},
{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fk ( float x , float y ) { vec2 fj = n + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fj ) ; } vec4 fD ( ) { vec4 fl = fk ( - 1.0 , - 1.0 ) ; vec4 fm = fk ( 1.0 , - 1.0 ) ; vec4 fn = fk ( - 1.0 , 1.0 ) ; vec4 fo = fk ( 1.0 , 1.0 ) ; vec4 fp = fk ( 0.0 , 0.0 ) ; float fr = fq ( fp ) ; float fs = fq ( fl ) ; float ft = fq ( fm ) ; float fu = fq ( fn ) ; float fv = fq ( fo ) ; float fw = min ( fr , min ( min ( fs , ft ) , min ( fu , fv ) ) ) ; float fx = max ( fr , max ( max ( fs , ft ) , max ( fu , fv ) ) ) ; vec2 a_ ; a_ . x = - ( ( fs + ft ) - ( fu + fv ) ) ; a_ . y = ( ( fs + fu ) - ( ft + fv ) ) ; float fy = max ( ( fs + ft + fu + fv ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fz = 1.0 / ( min ( abs ( a_ . x ) , abs ( a_ . y ) ) + fy ) ; a_ = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , a_ * fz ) ) * u_texel_size ; vec4 fA = 0.5 * ( GLSL_TEXTURE ( u_color , n + a_ * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , n + a_ * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fB = fA * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , n + a_ * - 0.5 ) + GLSL_TEXTURE ( u_color , n + a_ * 0.5 ) ) ; float fC = fq ( fB ) ; if ( ( fC < fw ) || ( fC > fx ) ) return fA ; else return fB ; }".split(" ")}]}},
{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",o:"fxaa.glslf"},{a:"cond",d:[{a:"if",g:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",g:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fD ( ) ;".split(" ")}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 fE = u_texel_size ; GLSL_OUT_FRAG_COLOR = fF ( n , u_color , fE , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eV = vec2 ( 0.0 , 0.0 ) ; vec2 cu = u_texel_size ; vec4 fG = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR = fG * 0.0875447373698 ; eV += cu ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + eV ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - eV ) * 0.0858112354248 ; eV += cu ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + eV ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - eV ) * 0.0808139781061 ; eV += cu ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + eV ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - eV ) * 0.0731235112908 ; eV += cu ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + eV ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - eV ) * 0.0635705267419 ; eV += cu ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + eV ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - eV ) * 0.0530985673112 ; eV += cu ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + eV ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - eV ) * 0.0426125984122 ; eV += cu ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + eV ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - eV ) * 0.0328565115809 ; eV += cu ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n + eV ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , n - eV ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fG , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fH = GLSL_TEXTURE ( u_main , n ) ; vec4 fI = GLSL_TEXTURE ( u_bloom , n ) ; GLSL_OUT_FRAG_COLOR = fH + fI ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aD = GLSL_TEXTURE ( u_color , n ) ; if ( u_dof_dist > 0.0 ) { float fK = fJ ( u_depth , n , u_camera_range ) ; fK *= u_view_max_depth ; float fL = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 fM = GLSL_TEXTURE ( u_coc_fg , n ) ; float fN = fM . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fK < u_dof_dist ) fL = ( u_dof_dist - fK - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"else fL = ( fK - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fL = clamp ( fL , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"fL = max ( fL , fN ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fL ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aD . xyz * fL , fL ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aD . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fO = GLSL_TEXTURE ( u_color , n ) ; vec3 aD = fO . rgb ; if ( u_brightness < 0.0 ) aD = aD * ( 1.0 + u_brightness ) ; else aD = aD + ( ( 1.0 - aD ) * u_brightness ) ; aD = ( aD - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aD *= u_exposure ; float cW = fq ( vec4 ( aD , 0.0 ) ) ; aD = mix ( vec3 ( cW ) , aD , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aD , fO . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fP ( clamp ( fJ ( u_depth , n , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fQ = GLSL_TEXTURE ( u_sharp , n ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",
g:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fL ; vec4 fR = GLSL_TEXTURE ( u_blurred1 , n ) ; vec4 fS = GLSL_TEXTURE ( u_blurred2 , n ) ; vec4 fT = min ( fR . rgba , fS . rgba ) ; fL = fT . a ; if ( fL > 0.0 ) { fT = vec4 ( fT . rgb / fL , fQ . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fQ , fT , min ( fL * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fQ ;".split(" ")}]}},{a:"elif",g:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fK = fJ ( u_depth , n , u_camera_range ) ; fK *= u_view_max_depth ; float fU ; if ( fK < u_dof_dist ) fU = ( u_dof_dist - fK ) / u_dof_front_end ; else fU = ( fK - u_dof_dist ) / u_dof_rear_end ; fU = clamp ( fU , 0.0 , 1.0 ) ; vec4 fV = GLSL_TEXTURE ( u_blurred , n ) ; GLSL_OUT_FRAG_COLOR = mix ( fQ , fV , fU ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fQ",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fQ ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fW = GLSL_TEXTURE ( u_src_color , n ) ; vec4 fX = GLSL_TEXTURE ( u_glow_mask_small , n ) ; vec4 fY = GLSL_TEXTURE ( u_glow_mask_large , n ) ; GLSL_OUT_FRAG_COLOR = fW ; if ( fY . a != 0.0 ) { float fZ = u_glow_mask_large_coeff * fY . a ; fZ = clamp ( fZ , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , fY . rgb / fY . a , fZ ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , fZ ) ; } if ( fX . a != 0.0 ) { float f_ = u_glow_mask_small_coeff * fX . a ; f_ = clamp ( f_ , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , fX . rgb / fX . a , f_ ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , f_ ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"include",o:"procedural.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN float gc ; GLSL_IN vec2 gd ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 n ; GLSL_IN vec4 ge ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cu = ( ge . xy - n ) ; float az = length ( cu ) ; vec2 gf = u_radial_blur_step * cu / az ; float gh = az / u_radial_blur_step ; gf *= min ( gh , STEPS_PER_PASS ) / STEPS_PER_PASS ; gh = max ( gh , STEPS_PER_PASS ) ; vec2 gi = n ; float gj = 0.0 ; const int gk = int ( STEPS_PER_PASS ) ; int gl = int ( gh + 0.5 ) ; for ( int bN = 0 ; bN < gk ; bN += 1 ) { if ( bN <= gl ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["DEPTH_RGBA"],h:{a:"grp",d:[{a:"txt",b:"float fK = fJ ( u_input , gi , u_camera_range ) ; gj += max ( ( 1.0 - pow ( az , 0.3 ) ) * step ( 0.9 , fK ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 gm = GLSL_TEXTURE ( u_input , gi ) ; gj += cs ( gm ) ;".split(" ")}]}}]},{a:"txt",b:"} gi += gf ; }".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 bB = n + gd ; float gn = eT ( vec2 ( 2.5 * ( bB . x ) , 2.5 * ( bB . y ) + 1.0 * u_time ) ) . x + 0.75 * eT ( vec2 ( 5.0 * ( bB . x ) - 0.66 * u_time , 5.0 * ( bB . y ) + 0.66 * u_time ) ) . x + 0.5 * eI ( vec2 ( 7.5 * ( bB . x ) + 0.33 * u_time , 7.5 * ( bB . y ) - 0.33 * u_time ) ) ; gn *= clamp ( 1.2 - sqrt ( 0.2 * az ) , 0.0 , 1.0 ) * gc ; gj = max ( gn , gj ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fP ( gj / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT float gc ; GLSL_OUT vec2 gd ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 n ; GLSL_OUT vec4 ge ; void main ( ) { n = a_bb_vertex ; vec3 a_ = normalize ( u_sun_direction ) ; ge = u_view_proj_matrix * vec4 ( a_ , 0.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gc = 1.0 ; vec3 go = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gp = J ( u_camera_quat , go ) ; gp = normalize ( gp ) ; float gq = dot ( gp , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gs = atan ( gp . x , gp . z ) ; gd = vec2 ( - gs , acos ( gq ) ) ; } else { gc = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"ge . xy = 0.5 * ( ge . xy / ge . w + 1.0 ) ; ge += 99999.0 * step ( ge . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gt = GLSL_TEXTURE ( u_main , n ) ; vec3 gu = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bV ( gt . rgb ) ; float gv = cs ( GLSL_TEXTURE ( u_god_rays , n ) ) ; vec3 gw = gt . rgb + u_god_rays_intensity * vec3 ( gv ) * gu ; aJ ( gw ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gw , max ( 0.01 , gt . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gw , gt . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fH = GLSL_TEXTURE ( u_input , n ) ; float gx = dot ( fH . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gx ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gx ; float gy = 0.0 ; float w = 0.025 ; float bL = 0.025 ; for ( int bN = 0 ; bN < 20 ; bN += 1 ) { bL = 0.025 ; for ( int gz = 0 ; gz < 20 ; gz += 1 ) { gx = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bL ) ) . r , 0.01 ) ; gy += log ( gx ) ; bL += 0.05 ; } w += 0.05 ; } float gA = exp ( gy / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 n ; GLSL_IN float gB ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gC = GLSL_TEXTURE ( u_luminance , n ) . r ; vec4 aD = GLSL_TEXTURE ( u_main , n ) ; float gD = gC / gA ; float gE = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aD * max ( gD - gE , 0.0 ) * gB ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 n ; GLSL_OUT float gB ; void gM ( in vec4 gF , in vec3 gG , out vec3 gH ) { float gI = gF . w * gG . x + gF . y * gG . z - gF . z * gG . y ; float gJ = gF . w * gG . y + gF . z * gG . x - gF . x * gG . z ; float gK = gF . w * gG . z + gF . x * gG . y - gF . y * gG . x ; float gL = - gF . x * gG . x - gF . y * gG . y - gF . z * gG . z ; gH . x = gI * gF . w - gL * gF . x - gJ * gF . z + gK * gF . y ; gH . y = gJ * gF . w - gL * gF . y - gK * gF . x + gI * gF . z ; gH . z = gK * gF . w - gL * gF . z - gI * gF . y + gJ * gF . x ; } void main ( ) { n = 2.0 * a_position ; vec3 gp ; gM ( u_camera_quat , UP_VECTOR , gp ) ; gB = dot ( - gp , u_sun_direction ) * u_bloom_key ; gB *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gN = 0.0042 ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gO = GLSL_TEXTURE ( u_mb_tex_curr , n ) ; vec4 gP = GLSL_TEXTURE ( u_mb_tex_accum , n ) ; if ( length ( gO - gP ) > u_motion_blur_decay_threshold ) { vec4 gQ = ( 1.0 - u_motion_blur_exp ) * gO + u_motion_blur_exp * gP ; vec4 gR = gQ - gP ; vec4 gS = gO - gP ; vec4 cu = min ( max ( abs ( gR ) , vec4 ( gN ) ) , abs ( gS ) ) * sign ( gR ) ; GLSL_OUT_FRAG_COLOR = gP + cu ; } else { GLSL_OUT_FRAG_COLOR = gO ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gT = GLSL_TEXTURE ( u_outline_src , n ) ; GLSL_OUT_FRAG_COLOR = gT ; if ( u_draw_outline != 0.0 ) { vec4 gU = GLSL_TEXTURE ( u_outline_mask , n ) ; vec4 gV = GLSL_TEXTURE ( u_outline_mask_blurred , n ) ; float gW = gV . a - gU . a ; if ( gW != 0.0 ) { float gX = smoothstep ( 0.0 , 1.0 , gV . a ) ; if ( gU . a == 0.0 ) { vec3 gY = u_outline_color ; aJ ( gY ) ; vec4 gZ = vec4 ( clamp ( gY , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gT , gZ , gX ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aD = vec4 ( 0.0 ) ; for ( int bN = 0 ; bN < 10 ; bN ++ ) { vec2 g_ = vec2 ( fract ( n * vec2 ( bN ) * vec2 ( 1.431 , 3.921 ) ) ) ; aD += 0.01 * GLSL_TEXTURE ( u_color , g_ ) ; } GLSL_OUT_FRAG_COLOR = aD ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",d:[{a:"if",g:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , n ) ;".split(" ")}]}},{a:"elif",g:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 cY = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( cY . r + cY . g + cY . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eV = vec2 ( 0.0 , 0.0 ) ; vec2 cu = u_texel_size ; vec4 aD ; aD = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR = aD * 0.2270270270 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * 0.1945945946 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * 0.1945945946 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * 0.1216216216 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * 0.1216216216 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * 0.0540540541 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * 0.0540540541 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * 0.0162162162 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * 0.0162162162 ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eV = vec2 ( 0.0 , 0.0 ) ; vec2 cu = u_texel_size ; vec4 aD ; aD = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR = aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.152507 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.141763 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.141763 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.113861 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.113861 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.079019 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.079019 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.047383 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.047383 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.024549 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.024549 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.01099 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.01099 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.00425 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.00425 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.00142 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; GLSL_OUT_FRAG_COLOR += aD * ( 1.0 - step ( 0.0 , - aD . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eV = vec2 ( 0.0 , 0.0 ) ; vec2 cu = u_texel_size ; vec4 aD ; vec4 ha ; vec4 hb ; float fL ; float hc = u_dof_bokeh_intensity ; aD = GLSL_TEXTURE ( u_color , n ) ; ha = aD ; hb = aD ; fL = aD . a ; cu = fL * cu ; for ( int bN = 0 ; bN < 12 ; bN += 2 ) { eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; ha += aD ; hb = max ( hb , aD ) ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; ha += aD ; hb = max ( hb , aD ) ; } ha /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( ha , hb , hc ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 eV = vec2 ( 0.0 , 0.0 ) ; vec2 cu = u_texel_size ; vec4 aD ; vec4 ha ; vec4 hb ; aD = GLSL_TEXTURE ( u_color , n ) ; hb = max ( hb , aD ) ; ha = aD ; ha . a = aD . a * 0.2270270270 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; hb . a = max ( hb . a , aD . a ) ; ha . a += aD . a * 0.1945945946 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; hb . a = max ( hb . a , aD . a ) ; ha . a += aD . a * 0.1945945946 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; hb . a = max ( hb . a , aD . a ) ; ha . a += aD . a * 0.1216216216 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; hb . a = max ( hb . a , aD . a ) ; ha . a += aD . a * 0.1216216216 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; hb . a = max ( hb . a , aD . a ) ; ha . a += aD . a * 0.0540540541 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; hb . a = max ( hb . a , aD . a ) ; ha . a += aD . a * 0.0540540541 ; eV += cu ; aD = GLSL_TEXTURE ( u_color , n + eV ) ; hb . a = max ( hb . a , aD . a ) ; ha . a += aD . a * 0.0162162162 ; aD = GLSL_TEXTURE ( u_color , n - eV ) ; hb . a = max ( hb . a , aD . a ) ; ha . a += aD . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( ha , hb , 0.5 ) ;".split(" ")}]}},
{a:"elif",g:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 cu = u_texel_size ; vec4 aD = GLSL_TEXTURE ( u_color , n ) ; GLSL_OUT_FRAG_COLOR = aD ; if ( aD . a == 0.0 ) { aD = GLSL_TEXTURE ( u_color , n + cu ) ; if ( aD . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aD . a ) ; else { aD = GLSL_TEXTURE ( u_color , n - cu ) ; if ( aD . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aD . a ) ; } }".split(" ")}]}},{a:"elif",g:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float hd = u_delta [ 0 ] ; float he = u_delta [ 1 ] ; float hf = 1.0 / 3.0 ; float hg = 0.5 ; vec2 hh = vec2 ( hf , hg ) ; if ( u_tex_number == 0 ) { vec2 bB = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * n * hh + vec2 ( 2.0 * hf , hg ) ; bB [ 0 ] = max ( bB [ 0 ] , 2.0 * hf + hd ) ; bB [ 1 ] = max ( bB [ 1 ] , he ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bB [ 0 ] , hg - bB [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bB = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * n * hh + vec2 ( 0.0 , hg ) ; bB [ 0 ] = max ( bB [ 0 ] , hd ) ; bB [ 1 ] = min ( bB [ 1 ] , hg - he ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hf - bB [ 0 ] , bB [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bB = n * hh + vec2 ( 2.0 * hf , hg ) ; bB [ 0 ] = max ( bB [ 0 ] , 2.0 * hf + hd ) ; bB [ 1 ] = min ( bB [ 1 ] , 1.0 - he ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bB [ 0 ] , 1.5 - bB [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bB = n * hh + vec2 ( hf , 0.0 ) ; bB [ 0 ] = max ( bB [ 0 ] , hf + hd ) ; bB [ 0 ] = min ( bB [ 0 ] , 2.0 * hf - hd ) ; bB [ 1 ] = min ( bB [ 1 ] , hg - he ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bB [ 0 ] , bB [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bB = n * hh + vec2 ( hf , hg ) ; bB [ 0 ] = max ( bB [ 0 ] , hf + hd ) ; bB [ 0 ] = min ( bB [ 0 ] , 2.0 * hf - hd ) ; bB [ 1 ] = min ( bB [ 1 ] , 1.0 - he ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bB [ 0 ] , 3.0 * hg - bB [ 1 ] ) ) ; } else { vec2 bB = n * hh + vec2 ( 0.0 , hg ) ; bB [ 0 ] = max ( bB [ 0 ] , hd ) ; bB [ 1 ] = min ( bB [ 1 ] , 1.0 - he ) ; bB [ 1 ] = max ( bB [ 1 ] , hg + he ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hf - bB [ 0 ] , bB [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 n ; void main ( ) { n = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 n ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec4","hi",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec4 hj ; GLSL_IN vec4 hk ; GLSL_IN vec4 hl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec2","hm",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",h:{a:"grp",
d:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",d:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",h:{a:"grp",
d:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",d:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",h:{a:"grp",d:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 hq ( vec2 bB , sampler2D hn ) { float p = GLSL_TEXTURE ( hn , bB ) . r ; float ho = GLSL_TEXTURE ( hn , hj . xy ) . r ; float hp = GLSL_TEXTURE ( hn , hj . zw ) . r ; return vec3 ( p , ho , hp ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hu ( vec2 bB , sampler2D hr ) { vec3 hs = hq ( bB , hr ) ; vec2 cu = abs ( hs . xx - hs . yz ) ; vec2 ht = step ( SMAA_PREDICATION_THRESHOLD , cu ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * ht ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hy ( bvec2 hv , inout vec2 hw , vec2 hx ) { if ( hv . x ) hw . x = hx . x ; if ( hv . y ) hw . y = hx . y ; } void hy ( bvec4 hv , inout vec4 hw , vec4 hx ) { hy ( hv . xy , hw . xy , hx . xy ) ; hy ( hv . zw , hw . zw , hx . zw ) ; } vec2 hz ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hz ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec2 hM ( vec2 bB , sampler2D hA".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","hr"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:"vec2 hB = hu ( bB , hr ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hB = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hC = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hD = dot ( GLSL_TEXTURE ( hA , bB ) . rgb , hC ) ; float hE = dot ( GLSL_TEXTURE ( hA , hj . xy ) . rgb , hC ) ; float hF = dot ( GLSL_TEXTURE ( hA , hj . zw ) . rgb , hC ) ; vec4 cu ; cu . xy = abs ( hD - vec2 ( hE , hF ) ) ; vec2 ht = step ( hB , cu . xy ) ; if ( dot ( ht , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hG = dot ( GLSL_TEXTURE ( hA , hk . xy ) . rgb , hC ) ; float hH = dot ( GLSL_TEXTURE ( hA , hk . zw ) . rgb , hC ) ; cu . zw = abs ( hD - vec2 ( hG , hH ) ) ; vec2 hI = max ( cu . xy , cu . zw ) ; float hJ = dot ( GLSL_TEXTURE ( hA , hl . xy ) . rgb , hC ) ; float hK = dot ( GLSL_TEXTURE ( hA , hl . zw ) . rgb , hC ) ; cu . zw = abs ( vec2 ( hE , hF ) - vec2 ( hJ , hK ) ) ; hI = max ( hI . xy , cu . zw ) ; float hL = max ( hI . x , hI . y ) ; ht . xy *= step ( hL , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cu . xy ) ; return ht ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 hO ( vec2 hN ) { hN . r = hN . r * abs ( 5.0 * hN . r - 5.0 * 0.75 ) ; return hz ( hN ) ; } vec4 hO ( vec4 hN ) { hN . rb = hN . rb * abs ( 5.0 * hN . rb - 5.0 * 0.75 ) ; return hz ( hN ) ; } vec2 hQ ( sampler2D hP , vec2 bB , vec2 a_ , out vec2 hN ) { vec4 fj = vec4 ( bB , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bN = 0 ; bN < SMAA_MAX_SEARCH_STEPS_DIAG ; bN ++ ) { if ( fj . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fj . w > 0.9 ) { fj . xyz += t * vec3 ( a_ , 1.0 ) ; hN = GLSL_TEXTURE ( hP , fj . xy , 0.0 ) . rg ; fj . w = dot ( hN , vec2 ( 0.5 , 0.5 ) ) ; } } return fj . zw ; } vec2 hR ( sampler2D hP , vec2 bB , vec2 a_ , out vec2 hN ) { vec4 fj = vec4 ( bB , - 1.0 , 1.0 ) ; fj . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bN = 0 ; bN < SMAA_MAX_SEARCH_STEPS_DIAG ; bN ++ ) { if ( fj . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fj . w > 0.9 ) { fj . xyz = t * vec3 ( a_ , 1.0 ) + fj . xyz ; hN = GLSL_TEXTURE ( hP , fj . xy , 0.0 ) . rg ; hN = hO ( hN ) ; fj . w = dot ( hN , vec2 ( 0.5 , 0.5 ) ) ; } } return fj . zw ; } vec2 hT ( sampler2D hS , vec2 az , vec2 hN , float eV ) { vec2 bB = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hN + az ; bB = SMAA_AREATEX_PIXEL_SIZE * bB + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bB . x += 0.5 ; bB . y += SMAA_AREATEX_SUBTEX_SIZE * eV ; return GLSL_TEXTURE ( hS , bB , 0.0 ) . rg ; } vec2 hY ( sampler2D hP , sampler2D hS , vec2 bB , vec2 hN , vec4 hU ) { vec2 hC = vec2 ( 0.0 , 0.0 ) ; vec4 dc ; vec2 hV ; if ( hN . r > 0.0 ) { dc . xz = hQ ( hP , bB , vec2 ( - 1.0 , 1.0 ) , hV ) ; dc . x += float ( hV . y > 0.9 ) ; } else dc . xz = vec2 ( 0.0 , 0.0 ) ; dc . yw = hQ ( hP , bB , vec2 ( 1.0 , - 1.0 ) , hV ) ; if ( dc . x + dc . y > 2.0 ) { vec4 hW = vec4 ( - dc . x + 0.25 , dc . x , dc . y , - dc . y - 0.25 ) * u_texel_size . xyxy + bB . xyxy ; vec4 cY ; cY . xy = GLSL_TEXTURE ( hP , hW . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; cY . zw = GLSL_TEXTURE ( hP , hW . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; cY . yxwz = hO ( cY . xyzw ) ; vec2 hX = vec2 ( 2.0 , 2.0 ) * cY . xz + cY . yw ; hy ( bvec2 ( step ( 0.9 , dc . zw ) ) , hX , vec2 ( 0.0 , 0.0 ) ) ; hC += hT ( hS , dc . xy , hX , hU . z ) ; } dc . xz = hR ( hP , bB , vec2 ( - 1 , - 1 ) , hV ) ; if ( GLSL_TEXTURE ( hP , bB + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { dc . yw = hR ( hP , bB , vec2 ( 1 , 1 ) , hV ) ; dc . y += float ( hV . y > 0.9 ) ; } else dc . yw = vec2 ( 0.0 , 0.0 ) ; if ( dc . x + dc . y > 2.0 ) { vec4 hW = vec4 ( - dc . x , - dc . x , dc . y , dc . y ) * u_texel_size . xyxy + bB . xyxy ; vec4 cY ; cY . x = GLSL_TEXTURE ( hP , hW . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; cY . y = GLSL_TEXTURE ( hP , hW . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; cY . zw = GLSL_TEXTURE ( hP , hW . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 hX = vec2 ( 2.0 , 2.0 ) * cY . xz + cY . yw ; hy ( bvec2 ( step ( 0.9 , dc . zw ) ) , hX , vec2 ( 0 , 0 ) ) ; hC += hT ( hS , dc . xy , hX , hU . w ) . gr ; } return hC ; }".split(" ")}]}}]},
{a:"txt",b:"float ia ( sampler2D hZ , vec2 hN , float eV ) { vec2 hh = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 h_ = SMAA_SEARCHTEX_SIZE * vec2 ( eV , 1.0 ) ; hh += vec2 ( - 1.0 , 1.0 ) ; h_ += vec2 ( 0.5 , - 0.5 ) ; hh *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; h_ *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( hZ , hh * hN + h_ , 0.0 ) . r ; } float ib ( sampler2D hP , sampler2D hZ , vec2 bB , float hV ) { vec2 hN = vec2 ( 0.0 , 1.0 ) ; for ( int bN = 0 ; bN < SMAA_MAX_SEARCH_STEPS ; bN ++ ) { if ( bB . x > hV && hN . g > 0.8281 && hN . r == 0.0 ) { hN = GLSL_TEXTURE ( hP , bB , 0.0 ) . rg ; bB = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bB ; } } float eV = - ( 255.0 / 127.0 ) * ia ( hZ , hN , 0.0 ) + 3.25 ; return u_texel_size . x * eV + bB . x ; } float ic ( sampler2D hP , sampler2D hZ , vec2 bB , float hV ) { vec2 hN = vec2 ( 0.0 , 1.0 ) ; for ( int bN = 0 ; bN < SMAA_MAX_SEARCH_STEPS ; bN ++ ) { if ( bB . x < hV && hN . g > 0.8281 && hN . r == 0.0 ) { hN = GLSL_TEXTURE ( hP , bB , 0.0 ) . rg ; bB = vec2 ( 2.0 , 0.0 ) * u_texel_size + bB ; } } float eV = - ( 255.0 / 127.0 ) * ia ( hZ , hN , 0.5 ) + 3.25 ; return - u_texel_size . x * eV + bB . x ; } float id ( sampler2D hP , sampler2D hZ , vec2 bB , float hV ) { vec2 hN = vec2 ( 1.0 , 0.0 ) ; for ( int bN = 0 ; bN < SMAA_MAX_SEARCH_STEPS ; bN ++ ) { if ( bB . y > hV && hN . r > 0.8281 && hN . g == 0.0 ) { hN = GLSL_TEXTURE ( hP , bB , 0.0 ) . rg ; bB = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bB ; } } float eV = - ( 255.0 / 127.0 ) * ia ( hZ , hN . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eV + bB . y ; } float ie ( sampler2D hP , sampler2D hZ , vec2 bB , float hV ) { vec2 hN = vec2 ( 1.0 , 0.0 ) ; for ( int bN = 0 ; bN < SMAA_MAX_SEARCH_STEPS ; bN ++ ) { if ( bB . y < hV && hN . r > 0.8281 && hN . g == 0.0 ) { hN = GLSL_TEXTURE ( hP , bB , 0.0 ) . rg ; bB = vec2 ( 0.0 , 2.0 ) * u_texel_size + bB ; } } float eV = - ( 255.0 / 127.0 ) * ia ( hZ , hN . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eV + bB . y ; } vec2 ii ( sampler2D hS , vec2 az , float ig , float ih , float eV ) { vec2 bB = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hz ( 4.0 * vec2 ( ig , ih ) ) + az ; bB = SMAA_AREATEX_PIXEL_SIZE * bB + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bB . y = SMAA_AREATEX_SUBTEX_SIZE * eV + bB . y ; return GLSL_TEXTURE ( hS , bB , 0.0 ) . rg ; } void il ( sampler2D hP , inout vec2 hC , vec4 bB , vec2 dc ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 ij = step ( dc . xy , dc . yx ) ; vec2 ik = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ij ; ik /= ij . x + ij . y ; vec2 ay = vec2 ( 1.0 , 1.0 ) ; ay . x -= ik . x * GLSL_TEXTURE ( hP , bB . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; ay . x -= ik . y * GLSL_TEXTURE ( hP , bB . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; ay . y -= ik . x * GLSL_TEXTURE ( hP , bB . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; ay . y -= ik . y * GLSL_TEXTURE ( hP , bB . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hC *= clamp ( ay , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void im ( sampler2D hP , inout vec2 hC , vec4 bB , vec2 dc ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"vec2 ij = step ( dc . xy , dc . yx ) ; vec2 ik = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ij ; ik /= ij . x + ij . y ; vec2 ay = vec2 ( 1.0 , 1.0 ) ; ay . x -= ik . x * GLSL_TEXTURE ( hP , bB . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; ay . x -= ik . y * GLSL_TEXTURE ( hP , bB . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; ay . y -= ik . x * GLSL_TEXTURE ( hP , bB . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; ay . y -= ik . y * GLSL_TEXTURE ( hP , bB . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hC *= clamp ( ay , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iq ( vec2 bB , vec2 io , sampler2D hP , sampler2D hS , sampler2D hZ , vec4 hU ) { vec4 hC = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hN = GLSL_TEXTURE ( hP , bB ) . rg ; if ( hN . g > 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"hC . rg = hY ( hP , hS , bB , hN , hU ) ; if ( hC . r == - hC . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 dc ; vec3 hW ; hW . x = ib ( hP , hZ , hj . xy , hl . x ) ; hW . y = hk . y ; dc . x = hW . x ; float ig = GLSL_TEXTURE ( hP , hW . xy , 0.0 ) . r ; hW . z = ic ( hP , hZ , hj . zw , hl . y ) ; dc . y = hW . z ; dc = abs ( hz ( dc / u_texel_size . xx - io . xx ) ) ; vec2 ip = sqrt ( dc ) ; float ih = GLSL_TEXTURE ( hP , hW . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hC . rg = ii ( hS , ip , ig , ih , hU . y ) ; hW . y = bB . y ; il ( hP , hC . rg , hW . xyzy , dc ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"} else hN . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hN . r > 0.0 ) { vec2 dc ; vec3 hW ; hW . y = id ( hP , hZ , hk . xy , hl . z ) ; hW . x = hj . x ; dc . x = hW . y ; float ig = GLSL_TEXTURE ( hP , hW . xy , 0.0 ) . g ; hW . z = ie ( hP , hZ , hk . zw , hl . w ) ; dc . y = hW . z ; dc = abs ( hz ( dc / u_texel_size . yy - io . yy ) ) ; vec2 ip = sqrt ( dc ) ; float ih = GLSL_TEXTURE ( hP , hW . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hC . ba = ii ( hS , ip , ig , ih , hU . x ) ; hW . x = bB . x ; im ( hP , hC . ba , hW . xyxz , dc ) ; } return hC ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iz ( vec2 bB , sampler2D hA , sampler2D ir".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","is"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( ir , hi . xy ) . a ; a . y = GLSL_TEXTURE ( ir , hi . zw ) . g ; a . wz = GLSL_TEXTURE ( ir , bB ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aD = GLSL_TEXTURE ( hA , bB , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 it = GLSL_TEXTURE ( is , n ) ; vec2 cP = 2.0 * iu ( it ) - 1.0 ; aD . a = sqrt ( 2.0 * length ( cP ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aD ; } else { bool bL = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iv = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iw = a . yw ; hy ( bvec4 ( bL , bL , bL , bL ) , iv , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hy ( bvec2 ( bL , bL ) , iw , a . xz ) ; iw /= dot ( iw , vec2 ( 1.0 , 1.0 ) ) ; vec4 ix = iv * vec4 ( u_texel_size , - u_texel_size ) + bB . xyxy ; vec4 aD = iw . x * GLSL_TEXTURE ( hA , ix . xy , 0.0 ) ; aD += iw . y * GLSL_TEXTURE ( hA , ix . zw , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 it = GLSL_TEXTURE ( is , ix . xy ) ; vec2 iy = 2.0 * iu ( it ) - 1.0 ; vec2 cP = iw . x * iy ; it = GLSL_TEXTURE ( is , ix . zw ) ; iy = 2.0 * iu ( it ) - 1.0 ; cP += iw . y * iy ; aD . a = sqrt ( 2.0 * length ( cP ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aD",";","}","}"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 iE ( vec2 bB , sampler2D iA , sampler2D iB".split(" ")},
{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","sampler2D","is"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 it = GLSL_TEXTURE ( is , n ) ; vec2 cP ; cP = 2.0 * iu ( it ) - 1.0 ; vec4 iC = GLSL_TEXTURE ( iA , bB ) ; vec4 iD = GLSL_TEXTURE ( iB , bB - cP ) ; float cu = abs ( iC . a * iC . a - iD . a * iD . a ) / 2.0 ; float bR = 0.5 * clamp ( 1.0 - sqrt ( cu ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aD = mix ( iC , iD , bR ) ; aD . a = 1.0 ; return aD ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 iC = GLSL_TEXTURE ( iA , bB ) ; vec4 iD = GLSL_TEXTURE ( iB , bB ) ; return mix ( iC , iD , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aD = vec4 ( hM ( n , u_color".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PREDICATION"],h:{a:"grp",d:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aD = iq ( n , hm , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aD = iz ( n , u_color , u_blend".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 aD = vec4 ( iE ( n , u_color , u_color_prev".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_REPROJECTION"],h:{a:"grp",d:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 aD = GLSL_TEXTURE ( u_color , n ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aD",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",
b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",o:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 n ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec4","hi",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT vec4 hj ; GLSL_OUT vec4 hk ; GLSL_OUT vec4 hl ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_OUT","vec2","hm",";"]}]}}]},{a:"cond",d:[{a:"if",g:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",g:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",
g:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",d:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iF ( vec2 bB ) { hj = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bB . xyxy ; hk = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bB . xyxy ; hl = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bB . xyxy ; }".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iG ( vec2 bB , out vec2 io ) { io = bB / u_texel_size ; hj = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bB . xyxy ; hk = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bB . xyxy ; hl = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hj . xz , hk . yw ) ; }".split(" ")}]}},{a:"elif",g:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"void iH ( vec2 bB ) { hi = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bB . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { n = 2.0 * a_position ;".split(" ")},{a:"cond",d:[{a:"if",g:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iF","(","n",")",";"]}]}},{a:"elif",g:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"iG ( n , hm ) ;".split(" ")}]}},
{a:"elif",g:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["iH","(","n",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iI ( in vec2 fj ) { return fJ ( u_depth , fj , u_camera_range ) ; } void main ( ) { vec3 fO = GLSL_TEXTURE ( u_color , n ) . rgb ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_WHITE"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iJ = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , n * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fK = iI ( n ) ; float iK = fK * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iL = 8.0 ; const int iM = 1 ;".split(" ")}]}},
{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iL = 16.0 ; const int iM = 2 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iL = 24.0 ; const int iM = 3 ;".split(" ")}]}},{a:"elif",g:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float iL = 32.0 ; const int iM = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iN = u_ssao_radius_increase * 0.001 ; const float iO = 1.0 + 2.4 / iL ; float iP = 0.0 ; for ( int bN = 0 ; bN < iM ; bN ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iQ = reflect ( normalize ( vec3 ( x , y , z ) ) , iJ ) * ( iN *= iO ) ; vec3 iR = vec3 ( n , iK ) ; iR += vec3 ( iQ . xy , iQ . z * iK * 2.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iR . z -= 1.4 * ( iR . z - iK ) * step ( iK , iR . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iS = iI ( iR . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iT = clamp ( ( iK - iS ) / iS , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iP += mix ( 1.0 , iT , step ( iS , iR . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iP += mix ( step ( iR . z , iS ) , 0.5 , iT ) ;".split(" ")}]}}]},
{a:"txt",b:"} iP = iP / iL ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_HEMISPHERE"],h:{a:"grp",d:[{a:"txt",b:"iP = clamp ( iP * iP + 0.6 * iP , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iP = clamp ( iP * iP + iP , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iU = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fK ) ; iP = mix ( 1.0 , iP , iU ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fO , iP ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"include",o:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iI ( in vec2 fj ) { return fJ ( u_depth , fj , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iV = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float iW = iI ( n ) ; float bR = 0.0 ; float iX = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 iY = vec2 ( - 2.0 ) ; for ( int bN = 0 ; bN < 4 ; ++ bN ) { for ( int gz = 0 ; gz < 4 ; ++ gz ) { vec2 eV = ( iY + vec2 ( float ( bN ) , float ( gz ) ) ) * u_texel_size ; float iZ = GLSL_TEXTURE ( u_ssao_mask , n + eV ) . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"float i_ = iI ( n + eV ) ; float ja = 1.0 - clamp ( abs ( i_ - iW ) * iX , 0.0 , 1.0 ) ; iV += iZ * ja ; bR += ja ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["iV","+=","iZ",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",d:[{a:"if",g:["SSAO_BLUR_DEPTH"],h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , n ) . rgb , iV / bR ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , n ) . rgb , iV / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",d:[{a:"if",g:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jk ( vec2 bB , vec2 X , float cJ , sampler2D jb ) { vec2 jc = ( bB - X ) * 2.0 ; jc /= cJ ; float jd = jc . x * jc . x + jc . y * jc . y ; vec2 je = jc * ( 1.0 + u_distortion_params [ 0 ] * jd + u_distortion_params [ 1 ] * jd * jd ) ; vec2 jf = je * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jg = jf * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jd * u_chromatic_aberration_coefs [ 1 ] ) + X ; vec2 jh = jf + X ; vec2 ji = jf * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jd * u_chromatic_aberration_coefs [ 3 ] ) + X ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jj = GLSL_TEXTURE ( jb , jh ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( jb , jg ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jj . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( jb , ji ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jj . w ; } } else { jf = jf * cJ + X ; if ( clamp ( jf , 0.0 , 1.0 ) != jf ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( jb , jf ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",d:[{a:"if",g:["ANAGLYPH"],h:{a:"grp",d:[{a:"txt",b:"vec4 jl = GLSL_TEXTURE ( u_sampler_left , n ) ; vec4 jm = GLSL_TEXTURE ( u_sampler_right , n ) ; vec3 jn = vec3 ( jl [ 0 ] , jl [ 1 ] , jl [ 2 ] ) ; bV ( jn ) ; vec3 jo = vec3 ( jm [ 0 ] , jm [ 1 ] , jm [ 2 ] ) ; bV ( jo ) ; mat3 jp = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jq = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aD = clamp ( jp * jn , 0.0 , 1.0 ) + clamp ( jq * jo , 0.0 , 1.0 ) ; aJ ( aD ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aD , jl [ 3 ] + jm [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( n [ 0 ] < 0.5 ) { vec2 bB = vec2 ( 2.0 * n [ 0 ] , n [ 1 ] ) ; vec2 X = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cJ = 2.0 * u_distortion_params [ 3 ] ; jk ( bB , X , cJ , u_sampler_left ) ; } else { vec2 bB = vec2 ( 2.0 * ( n [ 0 ] - 0.5 ) , n [ 1 ] ) ; vec2 X = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cJ = 2.0 * u_distortion_params [ 3 ] ; jk ( bB , X , cJ , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , n ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",d:[{a:"version",b:["GLSL_VERSION"]},{a:"include",o:"precision_statement.glslf"},{a:"include",o:"std.glsl"},{a:"include",o:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 n ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fK = GLSL_TEXTURE ( u_depth , n ) . x ; vec4 jr = vec4 ( n * 2.0 - 1.0 , 2.0 * fK - 1.0 , 1.0 ) ; vec4 ca = u_view_proj_inverse * jr ; vec4 js = ca / ca . w ; vec4 jt = u_view_proj_prev * js ; jt /= jt . w ; vec2 cP = ( jr . xy - jt . xy ) / 4.0 + 0.5 ; cP = clamp ( cP , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fP ( cP ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jv ( vec3 rgb ) { vec4 ju = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , ju . wz ) , vec4 ( rgb . gb , ju . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dc = q . x - min ( q . w , q . y ) ; float hN = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dc + hN ) ) , dc / ( q . x + hN ) , q . x ) ; } vec3 jx ( vec3 jw ) { vec4 ju = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jw . r , jw . r , jw . r ) + ju . xyz ) * 6.0 - ju . www ) ; return jw . b * mix ( ju . xxx , clamp ( p - ju . xxx , _0_0 , _1_0 ) , jw . g ) ; } vec3 jB ( vec3 jy , vec3 jz , float jA ) { return mix ( jy , jz , jA ) ; } vec3 jC ( vec3 jy , vec3 jz , float jA ) { return jA * jy + jz ; } vec3 jD ( vec3 jy , vec3 jz , float jA ) { return jz - jA * jy ; } vec3 jF ( vec3 jy , vec3 jz , float jA ) { float jE = _1_0 - jA ; return ( vec3 ( jE ) + jA * jy ) * jz ; } vec3 jG ( vec3 jy , vec3 jz , float jA ) { vec3 jE = vec3 ( _1_0 - jA ) ; return vec3 ( _1_0 ) - ( jE + jA * ( vec3 ( _1_0 ) - jy ) ) * ( vec3 ( _1_0 ) - jz ) ; } vec3 jH ( vec3 jy , vec3 jz , float jA ) { vec3 jE = vec3 ( _1_0 - jA ) ; return mix ( jz * ( jE + 2.0 * jA * jy ) , vec3 ( _1_0 ) - ( jE + 2.0 * jA * ( vec3 ( _1_0 ) - jy ) ) * ( vec3 ( _1_0 ) - jz ) , step ( 0.5 , jz ) ) ; } vec3 jI ( vec3 jy , vec3 jz , float jA ) { return mix ( jz , abs ( jy - jz ) , jA ) ; } vec3 jJ ( vec3 jy , vec3 jz , float jA ) { return mix ( jz , jz / ( jy + step ( jy , vec3 ( _0_0 ) ) ) , jA ) ; } vec3 jK ( vec3 jy , vec3 jz , float jA ) { return mix ( jz , min ( jy , jz ) , jA ) ; } vec3 jL ( vec3 jy , vec3 jz , float jA ) { return max ( jA * jy , jz ) ; } vec3 jP ( vec3 jy , vec3 jz , float jA ) { vec3 jM = jv ( jz ) ; if ( jM . y != _0_0 ) { vec3 jN = jv ( jy ) ; vec3 jO = jx ( vec3 ( jM . x , jN . yz ) ) ; return mix ( jy , jO , jA ) ; } return jy ; } vec3 jQ ( vec3 jy , vec3 jz , float jA ) { vec3 jM = jv ( jy ) ; if ( jM . y != _0_0 ) { vec3 jN = jv ( jz ) ; return jx ( vec3 ( jM . x , mix ( jM . y , jN . y , jA ) , jM . z ) ) ; } return jy ; } vec3 jR ( vec3 jy , vec3 jz , float jA ) { vec3 jM = jv ( jy ) ; vec3 jN = jv ( jz ) ; return jx ( vec3 ( jM . xy , mix ( jM . z , jN . z , jA ) ) ) ; } vec3 jS ( vec3 jy , vec3 jz , float jA ) { vec3 jM = jv ( jz ) ; if ( jM . y != _0_0 ) { vec3 jN = jv ( jy ) ; vec3 jO = jx ( vec3 ( jM . xy , jN . z ) ) ; return mix ( jy , jO , jA ) ; } return jy ; } vec3 jU ( vec3 jy , vec3 jz , float jA ) { vec3 jT = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jz ) * ( vec3 ( _1_0 ) - jy ) ; return mix ( jy , ( ( vec3 ( _1_0 ) - jy ) * jz * jy ) + jy * jT , jA ) ; } vec3 jV ( vec3 jy , vec3 jz , float jA ) { return jy + jA * ( 2.0 * jz - _1_0 ) ; } float jZ ( float jW , float jX , float jA , float jY ) { float jE = _1_0 - jY ; return ( jE + jA * jW ) * jX ; } float j_ ( float jW , float jX , float jA , float jY ) { float jE = _1_0 - jY ; return _1_0 - ( jE + jA * ( _1_0 - jW ) ) * ( _1_0 - jX ) ; } float ka ( float jW , float jX , float jA , float jY ) { float jE = _1_0 - jY ; return mix ( jX * ( jE + 2.0 * jA * jW ) , _1_0 - ( jE + 2.0 * jA * ( _1_0 - jW ) ) * ( _1_0 - jX ) , step ( 0.5 , jX ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"CAUSTICS_GLSLF",h:{a:"grp",d:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",o:"procedural.glslf"},{a:"include",o:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bp ( inout vec3 aD , float kb , float eH , vec4 bo , vec3 L , vec3 kc , vec3 kd , vec4 ke , vec3 aZ , float bm ) { if ( bm > CAUSTICS_VIEW_DISTANCE ) return ; vec3 kf = aZ + L ; kf . xz = 10.0 * sin ( 0.1 * kf . xz ) ; vec3 kh = J ( kg ( ke ) , kf ) ; vec2 bB = kh . xz ; vec3 ki = kc ; float kj = max ( dot ( L , ki ) , 0.0 ) ; float kk = 0.025 ; vec2 kl = CAUST_SPEED * eH ; bB . s += 0.25 * sin ( dot ( aZ + eH , vec3 ( 1.0 ) ) ) ; bB . t += 0.35 * ( - sin ( dot ( aZ - eH , vec3 ( - 0.7 ) ) ) ) ; bB . st += 0.15 * cos ( 4.0 * kb - kl . x ) + 1.5 * sin ( kb - 0.3 * kl . y ) ; float hh = CAUST_SCALE * ( 1.0 + max ( 0.1 * kb , 0.0 ) ) ; vec3 kn = km ( ( bB / hh ) , kk ) ; kn *= CAUST_BRIGHT ; kn *= kn ; float ko = min ( 0.25 * kb , - kb ) + 1.0 ; ko = max ( ko , 0.0 ) ; float kp = bo [ SUN_NUM ] * kj ; float kq = max ( sign ( kb ) , 0.0 ) ; kp = kp + max ( 0.5 * sign ( - L . y ) * kq , 0.0 ) ; kp = min ( kp , 1.0 ) ; aD += kd * kn * ko * kp ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",h:{a:"grp",d:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",o:"std.glsl"},{a:"txt",b:"void bV ( inout float aD ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aD = pow ( aD , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"if ( aD <= 0.04045 ) aD = aD / 12.92 ; else aD = pow ( aD + 0.055 / 1.055 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aJ ( inout float aD ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aD = pow ( aD , 2.2 ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( aD <= 0.00031308 ) aD = aD * 12.92 ; else aD = 1.055 * pow ( aD , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},{a:"txt",
b:"} void bV ( inout vec3 aD ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aD = pow ( aD , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"bV ( aD . r ) ; bV ( aD . g ) ; bV ( aD . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aJ ( inout vec3 aD ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SRGB","SRGB_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aD = pow ( aD , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",g:["SRGB","SRGB_PROPER",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"aJ ( aD . r ) ; aJ ( aD . g ) ; aJ ( aD . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aK ( inout vec3 aD , in float F ) {".split(" ")},{a:"cond",d:[{a:"if",g:["PREMULTIPLY_ALPHA"],h:{a:"grp",d:[{a:"txt",b:"aD = aD * F ;".split(" ")}]}}]},{a:"txt",b:"} float fq ( vec4 aD ) { vec3 kr = vec3 ( 0.299 , 0.587 , 0.114 ) ; float ks = dot ( aD . rgb , kr ) ; return ks ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
d:[{a:"cond",d:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",h:{a:"grp",d:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fJ ( in sampler2D kt , in vec2 fj , in vec2 ku ) { float fK = GLSL_TEXTURE ( kt , fj ) . r ; float dg = ku . x ; float kv = ku . y ; float kw = 2.0 * dg / ( dg + kv - ( 2.0 * fK - 1.0 ) * ( kv - dg ) ) ; return kw ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",h:{a:"grp",d:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"cond",d:[{a:"if",g:["DYNAMIC_GRASS"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"include",o:"to_world.glslv"},{a:"txt",b:"vec2 kA ( vec3 I , float kx , vec2 ky ) { vec2 kz = vec2 ( ( I . x - ky . x ) / kx , ( I . y - ky . y ) / kx ) ; return fract ( kz ) ; } vec2 kB ( vec2 gi , float kx , vec2 ky ) { return vec2 ( gi . x * kx , gi . y * kx ) + ky ; } ae kC ( ) { return ae ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } ae aM ( vec3 I , vec3 M , vec3 kD , vec3 N , vec3 L , vec3 X , PRECISION sampler2D kE , sampler2D kF , vec3 kG , float kH , vec3 kI , vec4 kJ , mat3 H ) { vec3 kK = J ( kJ , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kL = - kK . x ; float kM = kK . y ; vec2 ky = vec2 ( kI . x - kH * ( 1.0 + kL ) / 2.0 , kI . y - kH * ( 1.0 - kM ) / 2.0 ) ; vec2 kN = kA ( X , kH , ky ) ; float kO = kH / 2.0 ; vec2 kP = abs ( kB ( kN - vec2 ( 0.5 ) , kH , vec2 ( 0.0 ) ) ) ; float kQ = kO * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( kP ) > kQ ) return kC ( ) ; float kR = kH / kG . z ; vec2 kS = ( kN - vec2 ( 0.5 ) ) * kR + vec2 ( 0.5 ) ; vec3 kT = kK * ( kH / kG . z - 1.0 ) / 2.0 ; kS . x += kT . x ; kS . y += kT . y ; vec4 kU = GLSL_TEXTURE ( kF , kS ) ; float hh = kU . r ; if ( hh < u_scale_threshold ) return kC ( ) ; float kV = kG . y - kG . x ; float bK = kG . y - GLSL_TEXTURE ( kE , kS ) . r * kV ; vec2 kW = I . xy - X . xy ; X . xy = kB ( kN , kH , ky ) ; X . z = bK ; I . xy = X . xy + kW ; I . z *= hh ; I . z += bK ; vec3 aD = kU . gba ;".split(" ")},
{a:"cond",d:[{a:"if",g:["BILLBOARD"],h:{a:"grp",d:[{a:"txt",b:"I -= X ; mat3 kX = ac ( kI , X , H ) ; ae ah = af ( I , X , M , kD , N , L , kX ) ; ah . X = X ; ah . aD = aD ; return kY ( ah ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return kY ( ae ( I , X , M , kD , N , L , aD ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",h:{a:"grp",d:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 cb ( vec3 L ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["SKY_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , L ) . rgb ;".split(" ")}]}},{a:"elif",g:["SKY_COLOR"],h:{a:"grp",d:[{a:"txt",b:"float kZ = 0.5 * L . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , kZ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",
b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FOG_GLSLF",h:{a:"grp",d:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",o:"std.glsl"},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_FOG"],
h:{a:"grp",d:[{a:"txt",b:"void ld ( inout vec3 aD , in float k_ , in float bK , in vec4 la ) { float lb = clamp ( ( k_ - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["lb","*=","lb",";"]}]}},{a:"elif",g:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"elif",g:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"lb = sqrt ( lb ) ;".split(" ")}]}}]},
{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bK > u_fog_params . w ) lb = 0.0 ; else { float lc = ( u_fog_params . w - max ( bK , 0.0 ) ) / u_fog_params . w ; lb *= lc * lc ; } } la . a = 1.0 - ( 1.0 - lb ) * ( 1.0 - u_fog_params . x ) ; aD = mix ( aD , la . rgb , la . a ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 li ( in mat4 le , in vec3 u ) { vec3 lf = mix ( le [ 0 ] . rgb , le [ 1 ] . rgb , max ( sign ( u . x ) , 0.0 ) ) ; vec3 lg = mix ( le [ 2 ] . rgb , le [ 3 ] . rgb , max ( sign ( u . z ) , 0.0 ) ) ; vec3 lh = vec3 ( le [ 0 ] . a , le [ 1 ] . a , le [ 2 ] . a ) ; vec3 aD = mix ( lf , lg , abs ( u . z ) ) ; aD = mix ( aD , lh , abs ( u . y ) ) ; bV ( aD ) ; return aD ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",b:"void lk ( inout float lj ) { lj -= 0.5 ; lj = 4.0 * ( lj * lj * lj ) + 0.5 ; } void lq ( inout vec3 aD , in float k_ , in vec3 u , in float dL , in vec4 ll , in float ey ) { float lm = max ( u . z , 0.0 ) ; float ln = max ( k_ - max ( dL / lm , 0.0 ) , 0.0 ) ; float lo = ll . w * ln ; vec3 dM = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lp = ll . rgb ; lo = min ( lo , 1.0 ) ; lk ( lo ) ; lo *= clamp ( 2.0 - ey , 0.0 , 1.0 ) ; vec3 dN = mix ( lp , dM , min ( lm , 1.0 ) ) ; dL = clamp ( - dL * 0.03 , 0.0 , 0.8 ) ; dN *= 1.0 - dL ; aD = mix ( aD , dN , lo ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bq ( inout vec3 aD , float k_ , vec3 u , float bn ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_FOG"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["PROCEDURAL_FOG"],h:{a:"grp",d:[{a:"txt",b:"vec3 le = li ( u_cube_fog , u ) ; vec4 dN = vec4 ( le , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec4","dN","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"ld ( aD , k_ , c . z , dN ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WATER_EFFECTS"],h:{a:"grp",d:[{a:"txt",
b:"lq ( aD , k_ , u , u_cam_water_depth , u_underwater_fog_color_density , bn ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSLF",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PS3",h:{a:"grp",d:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_360",h:{a:"grp",d:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",d:[{a:"ifndef",c:"FXAA_360_OPT",h:{a:"grp",d:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC",h:{a:"grp",d:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_PC_CONSOLE",h:{a:"grp",d:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_120",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GLSL_130",h:{a:"grp",d:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_HLSL_3",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_4",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_HLSL_5",h:{a:"grp",d:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",h:{a:"grp",d:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_EARLY_EXIT",h:{a:"grp",d:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_DISCARD",h:{a:"grp",d:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"cond",d:[{a:"ifdef",c:"GL_EXT_gpu_shader4",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
d:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",d:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_ARB_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",d:[{a:"ifdef",c:"GL_NV_gpu_shader5",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",h:{a:"grp",d:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",d:[{a:"if",g:[0],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",d:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
d:[{a:"if",g:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",o:"color_util.glslf"},{a:"txt",b:"float lr ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_BLEND4WEB",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 ls ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lu ( sampler2D t , vec2 p , vec2 lt , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lt * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fF ( vec2 eA , sampler2D hn , vec2 lv , float lw , float lx , float ly ) { vec2 lz ; lz . x = eA . x ; lz . y = eA . y ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",d:[]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 lA = ls ( hn , lz ) ; float fr = fq ( lA ) ; float lB = fq ( lu ( hn , lz , vec2 ( 0 , 1 ) , lv . xy ) ) ; float lC = fq ( lu ( hn , lz , vec2 ( 1 , 0 ) , lv . xy ) ) ; float lD = fq ( lu ( hn , lz , vec2 ( 0 , - 1 ) , lv . xy ) ) ; float lE = fq ( lu ( hn , lz , vec2 ( - 1 , 0 ) , lv . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lF = max ( lB , fr ) ; float lG = min ( lB , fr ) ; float lH = max ( lC , lF ) ; float lI = min ( lC , lG ) ; float lJ = max ( lD , lE ) ; float lK = min ( lD , lE ) ; float lL = max ( lJ , lH ) ; float lM = min ( lK , lI ) ; float lN = lL * lx ; float lO = lL - lM ; float lP = max ( ly , lN ) ; bool lQ = lO < lP ; if ( lQ ) return lA ;".split(" ")},{a:"cond",d:[{a:"if",g:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float fs = fq ( lu ( hn , lz , vec2 ( - 1 , - 1 ) , lv . xy ) ) ; float fv = fq ( lu ( hn , lz , vec2 ( 1 , 1 ) , lv . xy ) ) ; float ft = fq ( lu ( hn , lz , vec2 ( 1 , - 1 ) , lv . xy ) ) ; float fu = fq ( lu ( hn , lz , vec2 ( - 1 , 1 ) , lv . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[]}}]},{a:"txt",b:"float lR = lD + lB ; float lS = lE + lC ; float lT = 1.0 / lO ; float lU = lR + lS ; float lV = ( - 2.0 * fr ) + lR ; float lW = ( - 2.0 * fr ) + lS ; float lX = ft + fv ; float lY = fs + ft ; float lZ = ( - 2.0 * lC ) + lX ; float l_ = ( - 2.0 * lD ) + lY ; float ma = fs + fu ; float mb = fu + fv ; float mc = ( abs ( lV ) * 2.0 ) + abs ( lZ ) ; float md = ( abs ( lW ) * 2.0 ) + abs ( l_ ) ; float me = ( - 2.0 * lE ) + ma ; float mf = ( - 2.0 * lB ) + mb ; float mg = abs ( me ) + mc ; float mh = abs ( mf ) + md ; float mi = ma + lX ; float mj = lv . x ; bool mk = mg >= mh ; float ml = lU * 2.0 + mi ; if ( ! mk ) lD = lE ; if ( ! mk ) lB = lC ; if ( mk ) mj = lv . y ; float mm = ( ml * ( 1.0 / 12.0 ) ) - fr ; float mn = lD - fr ; float mo = lB - fr ; float mp = lD + fr ; float mq = lB + fr ; bool mr = abs ( mn ) >= abs ( mo ) ; float ms = max ( abs ( mn ) , abs ( mo ) ) ; if ( mr ) mj = - mj ; float mt = lr ( abs ( mm ) * lT ) ; vec2 mu ; mu . x = lz . x ; mu . y = lz . y ; vec2 mv ; mv . x = ( ! mk ) ? 0.0 : lv . x ; mv . y = ( mk ) ? 0.0 : lv . y ; if ( ! mk ) mu . x += mj * 0.5 ; if ( mk ) mu . y += mj * 0.5 ; vec2 mw ; mw . x = mu . x - mv . x * FXAA_QUALITY_P0 ; mw . y = mu . y - mv . y * FXAA_QUALITY_P0 ; vec2 mx ; mx . x = mu . x + mv . x * FXAA_QUALITY_P0 ; mx . y = mu . y + mv . y * FXAA_QUALITY_P0 ; float my = ( ( - 2.0 ) * mt ) + 3.0 ; float mz = fq ( ls ( hn , mw ) ) ; float mA = mt * mt ; float mB = fq ( ls ( hn , mx ) ) ; if ( ! mr ) mp = mq ; float mC = ms * 1.0 / 4.0 ; float mD = fr - mp * 0.5 ; float mE = my * mA ; bool mF = mD < 0.0 ; mz -= mp * 0.5 ; mB -= mp * 0.5 ; bool mG = abs ( mz ) >= mC ; bool mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P1 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P1 ; bool mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P1 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P1 ; if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P2 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P2 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P2 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P3 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P3 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P3 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P4 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P4 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P4 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P5 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P5 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P5 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P6 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P6 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P6 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P7 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P7 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P7 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P8 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P8 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P8 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P9 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P9 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P9 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P10 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P10 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P10 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P11 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P11 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P11 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"if ( mI ) { if ( ! mG ) mz = fq ( ls ( hn , mw . xy ) ) ; if ( ! mH ) mB = fq ( ls ( hn , mx . xy ) ) ; if ( ! mG ) mz = mz - mp * 0.5 ; if ( ! mH ) mB = mB - mp * 0.5 ; mG = abs ( mz ) >= mC ; mH = abs ( mB ) >= mC ; if ( ! mG ) mw . x -= mv . x * FXAA_QUALITY_P12 ; if ( ! mG ) mw . y -= mv . y * FXAA_QUALITY_P12 ; mI = ( ! mG ) || ( ! mH ) ; if ( ! mH ) mx . x += mv . x * FXAA_QUALITY_P12 ; if ( ! mH ) mx . y += mv . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mJ = lz . x - mw . x ; float mK = mx . x - lz . x ; if ( ! mk ) mJ = lz . y - mw . y ; if ( ! mk ) mK = mx . y - lz . y ; bool mL = ( mz < 0.0 ) != mF ; float mM = ( mK + mJ ) ; bool mN = ( mB < 0.0 ) != mF ; float mO = 1.0 / mM ; bool mP = mJ < mK ; float mQ = min ( mJ , mK ) ; bool mR = mP ? mL : mN ; float mS = mE * mE ; float mT = ( mQ * ( - mO ) ) + 0.5 ; float mU = mS * lw ; float mV = mR ? mT : 0.0 ; float mW = max ( mV , mU ) ; if ( ! mk ) lz . x += mW * mj ; if ( mk ) lz . y += mW * mj ;".split(" ")},
{a:"cond",d:[{a:"if",g:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ls ( hn , lz ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( ls ( hn , lz ) . xyz , fr ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"HALO_COLOR_GLSLF",h:{a:"grp",d:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const int mX = NUM_RINGS ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"const int mX = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float mY ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"void ne ( inout float mZ , in float m_ [ mX ] , in float na ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float nb = 40.0 * m_ [ a ] ; float nc = 300.0 * ( mY ( nb ) - 0.005 ) ; float nd = nb ; float lb = abs ( nd * ( u_halo_size * nc - na ) ) ; mZ += 1.0 - min ( lb , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"void nj ( inout float nf , in float m_ [ mX ] , in float az ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float ng = m_ [ a ] ; float nh = ng ; float ni = 1000.0 * ( mY ( ng ) - 0.005 ) ; float lb = 20.0 * abs ( nh * n . x + ni * n . y ) ; nf += 1.0 - min ( lb , 1.0 ) ; } nf *= az ; }".split(" ")}]}}]},
{a:"txt",b:"void nn ( inout float az , in vec2 bB ) { float nk , bj ; bj = atan ( bB . y , bB . x ) ; bj *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float nl = cos ( bj ) ; float nm = sin ( bj ) ; bj = ( nl * bB . x + nm * bB . y ) * ( nl * bB . y - nm * bB . x ) ; nk = abs ( bj ) ; if ( nk < 1.0 ) { nk = ( 0.01 * u_halo_size ) / ( nk ) ; az *= sqrt ( min ( nk , 1.0 ) ) ; } } vec4 aS ( ) { float az = ( n . x * n . x + n . y * n . y ) ; float na = sqrt ( az ) ; az = max ( 1.0 - az , 0.0 ) ; az = pow ( az , u_halo_hardness ) ; float F = u_diffuse_color . a ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float m_ [ mX ] ; for ( int bN = 0 ; bN < mX ; bN ++ ) { m_ [ bN ] = fract ( aR / float ( bN + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"float mZ = 0.0 ; ne ( mZ , m_ , na ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"float nf = 0.0 ; nj ( nf , m_ , az ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_STARS"],
h:{a:"grp",d:[{a:"txt",b:"nn ( az , n ) ;".split(" ")}]}}]},{a:"txt",b:"az *= F ; vec3 aD = u_diffuse_color . rgb ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_RINGS"],h:{a:"grp",d:[{a:"txt",b:"mZ *= az ; aD += u_halo_rings_color * mZ ; az += mZ ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_LINES"],h:{a:"grp",d:[{a:"txt",b:"nf *= F ; aD += u_halo_lines_color * nf ; az += nf ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["SKY_STARS"],h:{a:"grp",d:[{a:"txt",b:"az *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float ko = u_halo_stars_blend * ( aQ . y - u_halo_stars_height ) ; az *= clamp ( ko , 0.0 , 1.0 ) ; az *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 no = vec4 ( aD , az ) ; return no ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",h:{a:"grp",
d:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",o:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",m:[],l:[{a:"node_out",c:"nC",f:["vec3"],e:!1},{a:"node_out",c:"nD",f:["vec3"],e:!1},{a:"node_out",c:"nE",f:["vec3"],e:!1},{a:"node_out",c:"nF",f:["vec3"],e:!0},{a:"node_out",c:"nG",f:["vec3"],e:!0},{a:"node_out",c:"nH",f:["vec2"],e:!0},{a:"node_out",c:"nI",f:["vec2"],e:!0},{a:"node_out",c:"nJ",f:["vec4"],e:!0},{a:"node_out",c:"nK",f:["float"],e:!0},{a:"node_out",c:"nL",f:["vec4"],e:!0}],j:[{a:"txt",
b:"nC = np ; nD = nq ; nE = nr ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nF"],j:[{a:"txt",b:["nF","=","ns",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nG"],j:[{a:"txt",b:["nG","=","nu",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nI"],j:[{a:"txt",b:["nI","=","nw",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nH"],j:[{a:"txt",b:["nH","=","nx",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nJ"],j:[{a:"txt",b:["nJ","=","ny",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_nK"],j:[{a:"txt",b:["nK","=","nz",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_nL"],j:[{a:"txt",b:["nL","=","nA",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nM",f:["vec3"],e:!1},{a:"node_in",c:"nN",f:["vec3"],e:!1},{a:"node_in",c:"nO",f:["vec3"],e:!1},{a:"node_out",c:"nP",f:["vec4"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"nP = vec4 ( nM + nO * nN , _0_0 ) ; nQ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"nR",f:["vec4"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!1},{a:"node_out",c:"nT",f:["vec2"],e:!1},{a:"node_out",c:"nU",f:["vec3"],e:!1},{a:"node_out",c:"nV",f:["float"],e:!1}],j:[{a:"txt",b:"nT = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["nV","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["nV","=","_0_0",";"]}]}]},{a:"txt",b:"nU = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"nU *= nR [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 nW = u_light_positions [ LAMP_IND ] . xyz ; nS = nW - nt ; float az = length ( nS ) ; float nX = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + az * az ) ; nS = normalize ( nS ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 nY = u_light_directions [ LAMP_IND ] ; float nZ = dot ( nS , nY ) ; nZ *= smoothstep ( _0_0 , _1_0 , ( nZ - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; nX *= nZ ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"nX *= max ( LAMP_LIGHT_DIST - az , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["nU","*=","nX",";"]}]},{a:"node_else",j:[{a:"txt",b:"nS = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec2"],e:!1},{a:"node_in",c:"ob",f:["vec3"],e:!1},{a:"node_in",c:"oc",f:["float"],e:!1},
{a:"node_in",c:"od",f:["vec2"],e:!1},{a:"node_out",c:"oe",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( n_ , o . xyz ) ; ob = cross ( of , o . xyz ) ; ob = - normalize ( ob ) ;".split(" ")}]}]},{a:"txt",b:"oe = _0_0 ; if ( oa . r != _0_0 ) { float og = ( _1_0 - oc ) * dot ( ob , n_ ) + oc ; if ( od [ 0 ] == _0_0 ) { oe = _1_0 ; } else { float t = _1_0 + abs ( og ) ; t = od [ 1 ] + ( _1_0 - od [ 1 ] ) * pow ( t , od [ 0 ] ) ; oe = clamp ( t , _0_0 , _1_0 ) ; } oe = max ( oe , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oh",f:["vec3"],e:!1},{a:"node_in",c:"oi",f:["vec2"],e:!1},{a:"node_in",c:"oj",f:["vec3"],e:!1},{a:"node_in",c:"ok",f:["float"],e:!1},{a:"node_out",c:"ol",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oh , o . xyz ) ; oj = cross ( of , o . xyz ) ; oj = - normalize ( oj ) ;".split(" ")}]}]},{a:"txt",b:"ol = _0_0 ; if ( oi . r != _0_0 ) { float og = ( _1_0 - ok ) * dot ( oj , oh ) + ok ; ol = max ( og , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( om , o . xyz ) ; oo = cross ( of , o . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",
b:"or = _0_0 ; if ( on . r != _0_0 ) { float og = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] > _0_0 ) { float os = max ( dot ( oo , nv ) , _0_0 ) ; float ot = oq [ 0 ] * oq [ 0 ] ; float cd = _1_0 - _0_5 * ( ot / ( ot + 0.33 ) ) ; vec3 ou = om - og * oo ; vec3 ov = nv - os * oo ; if ( length ( ou ) == _0_0 || length ( ov ) == _0_0 || abs ( og ) > _1_0 || abs ( os ) > _1_0 ) or = og * cd ; else { float ow = acos ( og ) ; float ox = acos ( os ) ; vec3 oy = normalize ( ou ) ; vec3 oz = normalize ( ov ) ; float a , b ; a = max ( ow , ox ) ; b = min ( ow , ox ) ; b *= 0.95 ; float t = max ( dot ( oy , oz ) , _0_0 ) ; float oA = 0.45 * ( ot / ( ot + 0.09 ) ) ; or = og * ( cd + ( oA * t * sin ( a ) * tan ( b ) ) ) ; } } else or = og ; or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["vec2"],e:!1},{a:"node_in",c:"oD",f:["vec3"],e:!1},{a:"node_in",c:"oE",f:["float"],e:!1},{a:"node_in",c:"oF",f:["vec2"],e:!1},{a:"node_out",c:"oG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oB , o . xyz ) ; oD = cross ( of , o . xyz ) ; oD = - normalize ( oD ) ;".split(" ")}]}]},{a:"txt",
b:"oG = _0_0 ; if ( oC . r != _0_0 ) { float og = ( _1_0 - oE ) * dot ( oD , oB ) + oE ; float os = max ( dot ( oD , nv ) , _0_0 ) ; if ( oF [ 0 ] <= _1_0 ) oG = og * pow ( max ( os * og , 0.1 ) , oF [ 0 ] - _1_0 ) ; else oG = og * pow ( 1.0001 - os , oF [ 0 ] - _1_0 ) ; oG = max ( oG , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oH",f:["vec3"],e:!1},{a:"node_in",c:"oI",f:["vec2"],e:!1},{a:"node_in",c:"oJ",f:["vec3"],e:!1},
{a:"node_in",c:"oK",f:["float"],e:!1},{a:"node_in",c:"oL",f:["vec2"],e:!1},{a:"node_out",c:"oM",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oH , o . xyz ) ; oJ = cross ( of , o . xyz ) ; oJ = - normalize ( oJ ) ;".split(" ")}]}]},{a:"txt",b:"oM = _0_0 ; if ( oI . r != _0_0 ) { float og = ( _1_0 - oK ) * dot ( oJ , oH ) + oK ; float oN = acos ( og ) ; if ( oN < oL [ 0 ] ) oM = _1_0 ; else if ( oN > ( oL [ 0 ] + oL [ 1 ] ) || oL [ 1 ] == _0_0 ) oM = _0_0 ; else oM = _1_0 - ( ( oN - oL [ 0 ] ) / oL [ 1 ] ) ; oM = max ( oM , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:"oT = _0_0 ; if ( oP . g != _0_0 ) { vec3 oU = normalize ( oO + nv ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oR == _0_0 ) { oT = dot ( o . xyz , oU ) ; oT = sqrt ( _1_0 - oT * oT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"oT = ( _1_0 - oR ) * max ( dot ( oQ , oU ) , _0_0 ) + oR ;".split(" ")}]}]},{a:"txt",b:"oT = pow ( oT , oS [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oV",f:["vec3"],e:!1},{a:"node_in",c:"oW",f:["vec2"],e:!1},{a:"node_in",c:"oX",f:["vec3"],e:!1},{a:"node_in",c:"oY",f:["float"],e:!1},{a:"node_in",c:"oZ",f:["vec2"],e:!1},{a:"node_out",c:"o_",f:["float"],e:!1}],j:[{a:"txt",b:"o_ = _0_0 ; if ( oW . g != _0_0 ) { vec3 oU = normalize ( oV + nv ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oY == _0_0 ) { o_ = dot ( o . xyz , oU ) ; o_ = sqrt ( _1_0 - o_ * o_ ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"o_ = max ( dot ( oX , oU ) , _0_0 ) ; o_ = ( _1_0 - oY ) * o_ + oY ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float os = max ( dot ( o . xyz , nv ) , _0_0 ) ; os = sqrt ( _1_0 - os * os ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float os = max ( dot ( oX , nv ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"o_ = pow ( o_ , oZ [ 0 ] ) ; o_ = o_ / ( 0.1 + os ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 oU = normalize ( pa + nv ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pg = _0_0 ; float os = _0_0 ; float ph = _0_0 ; if ( pd == _0_0 ) { pg = dot ( o . xyz , oU ) ; os = dot ( o . xyz , nv ) ; ph = dot ( o . xyz , pa ) ; pg = sqrt ( _1_0 - pg * pg ) ; os = sqrt ( _1_0 - os * os ) ; ph = sqrt ( _1_0 - ph * ph ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pg = max ( dot ( pc , oU ) , 0.01 ) ; float os = max ( dot ( pc , nv ) , 0.01 ) ; float ph = max ( dot ( pc , pa ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bj = tan ( acos ( pg ) ) ; float F = max ( pe [ 0 ] , 0.01 ) ; pf = ph * ( _1_0 / ( 4.0 * M_PI * F * F ) ) * ( exp ( - ( bj * bj ) / ( F * F ) ) / ( sqrt ( os * ph ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pi",f:["vec3"],e:!1},{a:"node_in",c:"pj",f:["vec2"],e:!1},{a:"node_in",c:"pk",f:["vec3"],e:!1},{a:"node_in",c:"pl",f:["float"],e:!1},{a:"node_in",c:"pm",f:["vec2"],e:!1},{a:"node_out",c:"pn",f:["float"],
e:!1}],j:[{a:"txt",b:"pn = _0_0 ; if ( pj . g != _0_0 ) { vec3 bL = normalize ( pi + nv ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float po = dot ( bL , o . xyz ) ; float bj = pm [ 0 ] + pm [ 1 ] ; if ( pl == _0_0 ) bj = acos ( sqrt ( _1_0 - po * po ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bj = acos ( dot ( bL , pk ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bj < pm [ 0 ] ) pn = _1_0 ; else if ( bj >= pm [ 0 ] + pm [ 1 ] || pm [ 1 ] == _0_0 ) pn = _0_0 ; else pn = _1_0 - ( bj - pm [ 0 ] ) / pm [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["vec2"],e:!1},{a:"node_in",c:"pv",f:["vec3"],e:!1},{a:"node_in",c:"pw",f:["float"],e:!1},{a:"node_in",c:"px",f:["vec2"],e:!1},{a:"node_out",c:"py",f:["float"],e:!1}],j:[{a:"txt",b:"float pz = px [ 0 ] ; float pA = px [ 1 ] ; py = _0_0 ; if ( pu . g != _0_0 ) { if ( pz < 1.0 || pA == _0_0 ) py = _0_0 ; else { if ( pA < 100.0 ) pA = sqrt ( 1.0 / pA ) ; else pA = 10.0 / pA ; vec3 oU = normalize ( nv + pr ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pg = 0.0 ; if ( pw == _0_0 ) { float pB = dot ( o . xyz , oU ) ; pg = sqrt ( _1_0 - pB * pB ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pg = ( _1_0 - pw ) * max ( dot ( pv , oU ) , _0_0 ) + pw ;".split(" ")}]}]},{a:"txt",b:"if ( pg < _0_0 ) py = _0_0 ; else { float os = max ( dot ( pv , nv ) , 0.01 ) ; float ph = dot ( pv , pr ) ; if ( ph <= 0.01 ) py = _0_0 ; else { float pC = max ( dot ( nv , oU ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * pg * os ) / pC ; float cY = ( 2.0 * pg * ph ) / pC ; float g = min ( min ( a , b ) , cY ) ; float p = sqrt ( pow ( pz , 2.0 ) + pow ( pC , 2.0 ) - _1_0 ) ; float lj = pow ( p - pC , 2.0 ) / pow ( p + pC , 2.0 ) * ( _1_0 + pow ( pC * ( p + pC ) - _1_0 , 2.0 ) / pow ( pC * ( p - pC ) + _1_0 , 2.0 ) ) ; float oN = acos ( pg ) ; py = max ( lj * g * exp ( - pow ( oN , 2.0 ) / ( 2.0 * pow ( pA , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pD",f:["vec4"],e:!1},{a:"node_in",c:"pE",f:["vec3"],e:!1},{a:"node_in",c:"pF",f:["float"],e:!1},{a:"node_in",c:"pG",f:["float"],e:!1},{a:"node_in",c:"pH",f:["vec3"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["vec4"],e:!1},{a:"node_in",c:"pK",f:["vec3"],e:!1},{a:"node_in",c:"pL",f:["vec3"],e:!1},{a:"node_in",c:"pM",f:["vec3"],e:!1},{a:"node_in",c:"pN",f:["float"],e:!1},{a:"node_out",c:"pO",f:["vec4"],e:!1},{a:"node_out",c:"pP",
f:["vec3"],e:!1}],j:[{a:"txt",b:"pP = pE + pM * pL * pG ; pO = pD + vec4 ( pM * pK * pF , pG ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",m:[],l:[{a:"node_in",c:"pQ",f:["vec4"],e:!1},{a:"node_in",c:"pR",f:["vec3"],e:!1}],j:[{a:"txt",b:"v = pQ . rgb ; nB = pR ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cm ( vec3 np , vec3 nq , vec3 nr , vec3 ns , vec3 nt , vec3 nu , vec3 nv , vec2 nw , vec2 nx , vec4 ny , float nz , vec4 nA , out vec3 v , out vec3 nB ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MATH_GLSLV",h:{a:"grp",d:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",o:"std.glsl"},{a:"txt",b:"struct ae { vec3 I ; vec3 X ; vec3 M ; vec3 am ; vec3 N ; vec3 L ; vec3 aD ; } ; bool ef ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 J ( in vec4 q , in vec3 kf ) { return kf + 2.0 * cross ( q . xyz , cross ( q . xyz , kf ) + q . w * kf ) ; } vec4 kg ( in vec4 gF ) { return vec4 ( - gF . xyz , gF . w ) ; } vec4 pS ( in vec4 a , in vec4 b ) { vec4 gH ; gH . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gH . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gH . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gH . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gH ; } vec4 cF ( in vec3 pT , in float pU ) { vec4 gH ; pU = pU * 0.5 ; float s = sin ( pU ) ; gH . x = s * pT [ 0 ] ; gH . y = s * pT [ 1 ] ; gH . z = s * pT [ 2 ] ; gH . w = cos ( pU ) ; return gH ; } vec4 pX ( in vec3 a_ , in vec3 pV ) { vec4 gH ; float dc = dot ( pV , a_ ) ; vec3 pW = cross ( pV , a_ ) ; gH . xyz = pW . xyz ; gH . w = 1.0 + dc ; return normalize ( gH ) ; } vec3 pZ ( vec4 pY , vec4 gF , vec3 gG ) { vec3 gH = gG * pY . w ; gH = J ( gF , gH ) ; gH += pY . xyz ; return gH ; } vec3 Y ( mat3 p_ , vec3 gG ) { vec3 gH = gG * p_ [ 1 ] [ 0 ] ; vec4 gF = vec4 ( p_ [ 1 ] [ 1 ] , p_ [ 1 ] [ 2 ] , p_ [ 2 ] [ 0 ] , p_ [ 2 ] [ 1 ] ) ; gH = J ( gF , gH ) ; gH += p_ [ 0 ] ; return gH ; } vec3 qa ( vec4 pY , vec4 gF , vec3 a_ ) { vec3 gH = a_ * pY . w ; gH = J ( gF , gH ) ; return gH ; } vec3 P ( mat3 p_ , vec3 a_ ) { vec3 gH = a_ * p_ [ 1 ] [ 0 ] ; vec4 gF = vec4 ( p_ [ 1 ] [ 1 ] , p_ [ 1 ] [ 2 ] , p_ [ 2 ] [ 0 ] , p_ [ 2 ] [ 1 ] ) ; gH = J ( gF , gH ) ; return gH ; } vec3 qb ( vec4 pY , vec4 gF , vec3 gG ) { vec3 gH = gG - pY . xyz ; gH = J ( kg ( gF ) , gH ) ; gH /= pY . w ; return gH ; } vec3 qc ( vec4 pY , vec4 gF , vec3 a_ ) { return J ( kg ( gF ) , a_ ) / pY . w ; } mat4 qd ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qe ( float bj ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bj ) , sin ( bj ) , _0_0 , _0_0 , - sin ( bj ) , cos ( bj ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qf ( float bj ) { return mat4 ( cos ( bj ) , _0_0 , - sin ( bj ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bj ) , _0_0 , cos ( bj ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qg ( float bj ) { return mat4 ( cos ( bj ) , sin ( bj ) , _0_0 , _0_0 , - sin ( bj ) , cos ( bj ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } ae kY ( in ae kf ) { return ae ( kf . I , kf . X , normalize ( kf . M ) , normalize ( kf . am ) , normalize ( kf . N ) , normalize ( kf . L ) , kf . aD ) ; }".split(" ")},
{a:"cond",d:[{a:"if",g:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 ao ( vec4 an ) { float fg = an . x ; float fh = an . y ; float fi = an . w ; vec3 qh ; qh . x = ( fg + fi ) / 2.0 ; qh . y = ( fh + fi ) / 2.0 ; qh . z = fi ; return qh ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cD ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aO ( mat3 t ) { mat4 qi ; qi [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qi [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qi [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qi [ 0 ] [ 3 ] = _0_0 ; qi [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qi [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qi [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qi [ 1 ] [ 3 ] = _0_0 ; qi [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qi [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qi [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qi [ 2 ] [ 3 ] = _0_0 ; qi [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qi [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qi [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qi [ 3 ] [ 3 ] = 1.0 ; return qi ; } mat3 aL ( in mat3 p_ , in mat3 qj ) { mat3 gH ; vec3 gG = qj [ 0 ] ; vec4 pY = vec4 ( p_ [ 0 ] , p_ [ 1 ] [ 0 ] ) ; vec4 gF = vec4 ( p_ [ 1 ] [ 1 ] , p_ [ 1 ] [ 2 ] , p_ [ 2 ] [ 0 ] , p_ [ 2 ] [ 1 ] ) ; gH [ 0 ] = pZ ( pY , gF , gG ) ; gH [ 1 ] [ 0 ] = p_ [ 1 ] [ 0 ] * qj [ 1 ] [ 0 ] ; gH [ 1 ] [ 1 ] = p_ [ 1 ] [ 1 ] * qj [ 2 ] [ 1 ] + p_ [ 2 ] [ 1 ] * qj [ 1 ] [ 1 ] + p_ [ 1 ] [ 2 ] * qj [ 2 ] [ 0 ] - p_ [ 2 ] [ 0 ] * qj [ 1 ] [ 2 ] ; gH [ 1 ] [ 2 ] = p_ [ 1 ] [ 2 ] * qj [ 2 ] [ 1 ] + p_ [ 2 ] [ 1 ] * qj [ 1 ] [ 2 ] + p_ [ 2 ] [ 0 ] * qj [ 1 ] [ 1 ] - p_ [ 1 ] [ 1 ] * qj [ 2 ] [ 0 ] ; gH [ 2 ] [ 0 ] = p_ [ 2 ] [ 0 ] * qj [ 2 ] [ 1 ] + p_ [ 2 ] [ 1 ] * qj [ 2 ] [ 0 ] + p_ [ 1 ] [ 1 ] * qj [ 1 ] [ 2 ] - p_ [ 1 ] [ 2 ] * qj [ 1 ] [ 1 ] ; gH [ 2 ] [ 1 ] = p_ [ 2 ] [ 1 ] * qj [ 2 ] [ 1 ] - p_ [ 1 ] [ 1 ] * qj [ 1 ] [ 1 ] - p_ [ 1 ] [ 2 ] * qj [ 1 ] [ 2 ] - p_ [ 2 ] [ 0 ] * qj [ 2 ] [ 0 ] ; return gH ; } mat3 cH ( in vec4 gF , in mat3 p_ ) { mat3 gH ; gH [ 0 ] = p_ [ 0 ] ; gH [ 1 ] [ 0 ] = p_ [ 1 ] [ 0 ] ; gH [ 1 ] [ 1 ] = gF [ 0 ] ; gH [ 1 ] [ 2 ] = gF [ 1 ] ; gH [ 2 ] [ 0 ] = gF [ 2 ] ; gH [ 2 ] [ 1 ] = gF [ 3 ] ; return gH ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"MIRROR_GLSLF",h:{a:"grp",d:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"include",o:"color_util.glslf"},
{a:"include",o:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qk ( in vec3 u , vec3 dU , float d_ , float dZ ) { vec3 dX = normalize ( dU + u ) ; float dY = 1.0 - dot ( u , dX ) ; float r = dZ + ( 1.0 - dZ ) * pow ( dY , d_ ) ; return r ; } void cn ( inout vec3 ql , vec3 u , vec3 L , float qm , mat3 H ) { vec3 dU = reflect ( - u , L ) ; float d_ = u_fresnel_params [ 2 ] ; float dZ = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( d_ != 0.0 ) r = qk ( u , dU , d_ , dZ ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dW = GLSL_TEXTURE_CUBE ( u_cube_reflection , dU ) . xyz ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qn = u_refl_plane . xyz * dot ( L , u_refl_plane . xyz ) ; vec3 qo = L - qn ; vec2 qr = P ( H , qo ) . xy ; vec2 qu = h . xy / h . z ; qu += qr * REFL_BUMP ; vec3 dW = GLSL_TEXTURE ( u_plane_reflection , qu ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 dW = vec3 ( 1.0 ) ; qm = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 dW = GLSL_TEXTURE_CUBE ( u_mirrormap , dU ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bV ( dW . rgb ) ; ql = mix ( ql , dW , qm * r ) ; } vec3 qx ( vec3 ql , vec3 qv , vec3 u , vec3 L , float qw , mat3 H ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",
b:"vec3 dU = reflect ( - u , L ) ; vec3 dW = GLSL_TEXTURE_CUBE ( u_cube_reflection , dU ) . xyz ; bV ( dW ) ; dW *= qv ;".split(" ")}]}},{a:"elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 qn = u_refl_plane . xyz * dot ( L , u_refl_plane . xyz ) ; vec3 qo = L - qn ; vec2 qr = P ( H , qo ) . xy ; vec2 qu = h . xy / h . z ; qu += qr * REFL_BUMP ; vec3 dW = GLSL_TEXTURE ( u_plane_reflection , qu ) . rgb ; bV ( dW ) ; dW *= qv ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dW","=","qv",";"]}]}}]},{a:"txt",b:"return mix ( ql , dW , qw ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"mirror.glslf"},{a:"include",o:"shadow.glslf"},{a:"include",o:"environment.glslf"}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"include",
o:"refraction.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["GLSL_IN","vec3","qy",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"vec3 qB ( in vec3 qz , in float qA ) { vec3 en = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION"],h:{a:"grp",d:[{a:"txt",b:"en = cp ( h , qz . xy * qA ) ;".split(" ")}]}},
{a:"elif",g:["HAS_REFRACT_TEXTURE"],h:{a:"grp",d:[{a:"txt",b:"en = GLSL_TEXTURE ( u_refractmap , h . xy / h . z ) . rgb ; bV ( en ) ;".split(" ")}]}}]},{a:"txt",b:["return","en",";","}"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jv ( vec3 rgb ) { vec4 ju = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , ju . wz ) , vec4 ( rgb . gb , ju . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dc = q . x - min ( q . w , q . y ) ; float hN = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dc + hN ) ) , dc / ( q . x + hN ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jx ( vec3 jw ) { vec4 ju = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jw . r , jw . r , jw . r ) + ju . xyz ) * 6.0 - ju . www ) ; return jw . b * mix ( ju . xxx , clamp ( p - ju . xxx , _0_0 , _1_0 ) , jw . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",i:5}],h:{a:"grp",d:[{a:"txt",b:"vec3 qC ( vec2 gi ) { return vec3 ( gi * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qD ( vec3 gG ) { return vec2 ( gG . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float qI ( vec3 qE , vec3 qF , float qG ) { float cY = abs ( dot ( qE , qF ) ) ; float g = qG * qG - 1.0 + cY * cY ; float qH ; if ( g > 0.0 ) { g = sqrt ( g ) ; float cd = ( g - cY ) / ( g + cY ) ; float oA = ( cY * ( g + cY ) - 1.0 ) / ( cY * ( g - cY ) + 1.0 ) ; qH = 0.5 * cd * cd * ( 1.0 + oA * oA ) ; } else { qH = 1.0 ; } return qH ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rc",f:["vec3"],e:!0},{a:"node_out",c:"rd",f:["float"],e:!0},{a:"node_out",c:"re",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rc"],j:[{a:"txt",b:"rc = normalize ( qY . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rd"],j:[{a:"txt",b:"rd = abs ( qY . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_re"],j:[{a:"txt",b:"re = length ( qY . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"rf",f:["float"],
e:!1},{a:"node_in",c:"rh",f:["float"],e:!1},{a:"node_in",c:"ri",f:["float"],e:!1},{a:"node_out",c:"rj",f:["vec3"],e:!1}],j:[{a:"txt",b:"rj = vec3 ( rf , rh , ri ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"rk",f:["float"],e:!1},{a:"node_in",c:"rl",f:["float"],e:!1},{a:"node_in",c:"rm",f:["float"],e:!1},{a:"node_out",c:"rn",f:["vec3"],e:!1}],j:[{a:"txt",b:"rn = jx ( vec3 ( rk , rl , rm ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"ro",f:["vec3"],e:!1}],j:[{a:"txt",
b:"ro = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rp",f:["vec3"],e:!1}],j:[{a:"txt",b:"rp = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!1},{a:"node_param",c:"qJ",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rq = qC ( qJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rs",f:["vec3"],e:!1}],j:[{a:"txt",b:"rs = 2.0 * qy - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
m:[],l:[{a:"node_out",c:"rt",f:["vec3"],e:!1},{a:"node_param",c:"qK",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rt = max ( vec3 ( _0_0 ) , qK ) ; bV ( rt ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"ru",f:["float"],e:!1},{a:"node_param",c:"qL",f:["GLSL_IN","float"],e:!1}],j:[{a:"txt",b:"ru = max ( _0_0 , qL ) ; bV ( ru ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rv",f:["float"],e:!1},{a:"node_out",c:"rw",f:["float"],e:!1},{a:"node_param",c:"qM",
f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"rv = max ( _0_0 , qM [ 0 ] ) ; rw = max ( _0_0 , qM [ 1 ] ) ; bV ( rv ) ; bV ( rw ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rx",f:["float"],e:!1},{a:"node_out",c:"ry",f:["float"],e:!1},{a:"node_out",c:"rz",f:["float"],e:!1},{a:"node_param",c:"qN",f:["GLSL_IN","vec3"],e:!1}],j:[{a:"txt",b:"rx = max ( _0_0 , qN [ 0 ] ) ; ry = max ( _0_0 , qN [ 1 ] ) ; rz = max ( _0_0 , qN [ 2 ] ) ; bV ( rx ) ; bV ( ry ) ; bV ( rz ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rA",f:["vec3"],e:!1}],j:[{a:"txt",b:"rA = qW . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rB",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rB = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rB = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",m:[],l:[{a:"node_out",c:"rC",
f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rC = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rC = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = - P ( u_view_tsr_frag , nv ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE = qY . xyz ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:["rF","=","nt",";"]}]},{a:"node",c:"GEOMETRY_IN",m:[],l:[{a:"node_out",c:"rG",f:["vec3"],e:!1}],j:[{a:"txt",b:["rG","=","nv",";"]}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",c:"rH",f:["vec3"],e:!1},{a:"node_out",c:"rI",f:["vec3"],e:!1},{a:"node_out",c:"rJ",f:["vec3"],e:!1},{a:"node_out",c:"rK",f:["vec3"],e:!1},{a:"node_out",c:"rL",f:["vec3"],e:!1},{a:"node_out",c:"rM",f:["vec3"],e:!1},{a:"node_out",c:"rN",
f:["float"],e:!1},{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"txt",b:"rH = vec3 ( _0_0 ) ; rI = vec3 ( _0_0 ) ; rJ = vec3 ( _0_0 ) ; rK = vec3 ( _0_0 ) ; rL = vec3 ( _0_0 ) ; rM = vec3 ( _0_0 ) ; rN = _0_0 ; rO = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",c:"rP",f:["float"],e:!1},{a:"node_in",c:"rQ",f:["float"],e:!1},{a:"node_in",c:"rR",f:["float"],e:!1},{a:"node_in",c:"rS",f:["float"],e:!1},{a:"node_in",c:"rT",f:["vec3"],e:!1},{a:"node_out",c:"rU",f:["vec3"],e:!1}],j:[{a:"txt",
b:"vec3 jw = jv ( rT ) ; jw [ 0 ] += ( rP - _0_5 ) ; if ( jw [ 0 ] > _1_0 ) jw [ 0 ] -= _1_0 ; else if ( jw [ 0 ] < _0_0 ) jw [ 0 ] += _1_0 ; jw *= vec3 ( _1_0 , rQ , rR ) ; jw = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jw , step ( vec3 ( _0_0 ) , jw ) ) , step ( jw , vec3 ( _1_0 ) ) ) ; rU = mix ( rT , jx ( jw ) , rS ) ;".split(" ")}]},{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"rV",f:["float"],e:!1},{a:"node_in",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1}],j:[{a:"txt",b:"rX = mix ( rW , vec3 ( _1_0 ) - rW , rV ) ;".split(" ")}]},
{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",c:"rY",f:["vec3"],e:!0},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rY"],j:[{a:"txt",
b:"rY = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sb = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sc = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"rZ = - c + sc ; r_ = length ( rZ ) ; rZ = normalize ( rZ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sa"],j:[{a:"txt",b:"sa = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + r_ * r_ ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float nZ = dot ( rZ , sb ) ; nZ *= smoothstep ( _0_0 , _1_0 , ( nZ - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sa *= nZ ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sa *= max ( LAMP_LIGHT_DIST - r_ , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rZ"],j:[{a:"txt",b:["rZ","=","sb",";"]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_r_"],j:[{a:"txt",b:"r_ = length ( sc - c ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sa"],j:[{a:"txt",b:["sa","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"sd",f:["vec3"],e:!1},{a:"node_out",c:"se",f:["vec3"],e:!0},{a:"node_out",c:"sf",f:["float"],e:!0},{a:"node_param",c:"qO",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_se"],j:[{a:"txt",b:["se","=","qO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sf"],j:[{a:"txt",
b:"sf = - dot ( sd , qO ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sg",f:["vec3"],e:!1},{a:"node_out",c:"sh",f:["vec3"],e:!1}],j:[{a:"txt",b:"sh = - P ( u_view_tsr_frag , sg ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",m:[],l:[{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_in",c:"sj",f:["vec3"],e:!1},{a:"node_in",c:"sk",f:["float"],e:!1},{a:"node_in",c:"sl",f:["vec3"],e:!1},{a:"node_in",c:"sm",f:["float"],e:!1},{a:"node_in",c:"sn",f:["float"],e:!1},{a:"node_in",c:"so",
f:["vec3"],e:!1},{a:"node_out",c:"sr",f:["vec3"],e:!1},{a:"node_out",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!1},{a:"node_out",c:"sw",f:["vec3"],e:!1},{a:"node_out",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec4"],e:!1},{a:"node_out",c:"sz",f:["vec4"],e:!1},{a:"node_out",c:"sA",f:["vec3"],e:!1},{a:"node_out",c:"sB",f:["float"],e:!1}],j:[{a:"txt",b:"sv = sj ; sw = sl ; sx = so ; sA = sl ; sB = sn ; sr = qZ * sv ; su = q_ * u_environment_energy * cb ( sx ) ; sz = ce ( sv ) ; C = sz ; sy [ 0 ] = sk ; sy [ 1 ] = sm ; sy [ 2 ] = sn ;".split(" ")}]},
{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sC",f:["vec4"],e:!1},{a:"node_in",c:"sD",f:["vec3"],e:!1},{a:"node_in",c:"sE",f:["vec3"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",c:"sG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"v = qx ( sC . rgb , sF , nv , sE , sG , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"v = qx ( sC . rgb , sF , nv , sE , sG , u_view_tsr_frag ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"v = sC . rgb ;".split(" ")}]}]},{a:"txt",b:"v += sD ; sE ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"sH",f:["vec3"],e:!1},{a:"node_in",c:"sI",f:["vec2"],e:!1},{a:"node_in",c:"sJ",f:["vec3"],e:!1},{a:"node_in",c:"sK",f:["float"],e:!1},{a:"node_in",c:"sL",f:["vec4"],e:!1},{a:"node_out",c:"sM",f:["float"],e:!1},{a:"node_out",c:"sN",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qF = sJ ; float sO = clamp ( sL [ 0 ] , _0_0 , _1_0 ) ; float sP = clamp ( sL [ 1 ] , _0_0 , _1_0 ) ; float qw = sL [ 2 ] ; vec3 oU = normalize ( nv + sH ) ; float og = ( _1_0 - sK ) * dot ( qF , sH ) + sK ; float sQ = ( _1_0 - sK ) * max ( dot ( sH , oU ) , _0_0 ) + sK ; float sR = ( _1_0 - sK ) * max ( dot ( sJ , oU ) , _0_0 ) + sK ; sM = _0_0 ; if ( sI . r != _0_0 ) { if ( sO > _0_0 ) { float os = max ( dot ( qF , nv ) , _0_0 ) ; float ot = sO * sO ; float cd = _1_0 - _0_5 * ( ot / ( ot + 0.33 ) ) ; vec3 ou = sH - og * qF ; vec3 ov = nv - os * qF ; if ( length ( ou ) == _0_0 || length ( ov ) == _0_0 || abs ( og ) > _1_0 || abs ( os ) > _1_0 ) sM = og * cd ; else { float ow = acos ( og ) ; float ox = acos ( os ) ; vec3 oy = normalize ( ou ) ; vec3 oz = normalize ( ov ) ; float a , b ; a = max ( ow , ox ) ; b = min ( ow , ox ) ; b *= 0.95 ; float t = max ( dot ( oy , oz ) , _0_0 ) ; float oA = 0.45 * ( ot / ( ot + 0.09 ) ) ; sM = og * ( cd + ( oA * t * sin ( a ) * tan ( b ) ) ) ; } } else sM = og ; sM = max ( sM , _0_0 ) ; } float F = sP ; float sS = F * F ; float sT = ( sR * sS - sR ) * sR + _1_0 ; float ca = sS / ( M_PI * sT * sT ) ; float sU ; float sV ; float sW = pow ( _1_0 - sQ , 5.0 ) ; sU = _1_0 ; sV = sW ; float ju = F / 2.0 ; float sX = ju * ju ; float sY = _1_0 - sX ; float sZ = _1_0 / ( sQ * sQ * sY + sX ) ; sU *= sZ ; sV *= sZ ; float s_ = mix ( 0.04 , _1_0 , qw ) ; float ta = mix ( sV , sU , s_ ) ; sN = max ( og * ca * ta , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["float"],e:!1},{a:"node_in",c:"te",f:["float"],e:!1},{a:"node_in",c:"tf",f:["vec3"],e:!1},{a:"node_in",c:"tg",f:["vec3"],e:!1},{a:"node_out",c:"th",f:["vec3"],e:!1}],j:[{a:"txt",b:"th = tb ; tc ; td ; te ; tf ; tg ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"ti",f:["vec3"],e:!1},{a:"node_in",c:"tj",f:["float"],
e:!1},{a:"node_in",c:"tk",f:["vec3"],e:!1},{a:"node_out",c:"tl",f:["vec3"],e:!1},{a:"node_out",c:"tm",f:["vec3"],e:!1},{a:"node_out",c:"tn",f:["float"],e:!1},{a:"node_out",c:"to",f:["vec3"],e:!1},{a:"node_out",c:"tr",f:["float"],e:!1},{a:"node_out",c:"tu",f:["float"],e:!1},{a:"node_out",c:"tv",f:["vec3"],e:!1}],j:[{a:"txt",b:"tm = ti ; tn = tj ; tu = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["tv","=","tk",";"]}]},{a:"node_else",j:[{a:"txt",b:["tv","=","nu",
";"]}]}]},{a:"txt",b:"tl ; to ; tr ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tw",f:["vec3"],e:!1},{a:"node_in",c:"tx",f:["float"],e:!1},{a:"node_in",c:"ty",f:["float"],e:!1},{a:"node_in",c:"tz",f:["vec3"],e:!1},{a:"node_out",c:"tA",f:["vec3"],e:!1}],j:[{a:"txt",b:"tA = tw ; tx ; ty ; tz ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tB",f:["vec3"],e:!1},{a:"node_in",c:"tC",f:["float"],e:!1},{a:"node_in",c:"tD",f:["vec3"],
e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1},{a:"node_out",c:"tF",f:["vec3"],e:!1},{a:"node_out",c:"tG",f:["float"],e:!1},{a:"node_out",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["float"],e:!1},{a:"node_out",c:"tJ",f:["float"],e:!1},{a:"node_out",c:"tK",f:["vec3"],e:!1}],j:[{a:"txt",b:"tH = tB ; tI = tC ; tJ = _1_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["tK","=","tD",";"]}]},{a:"node_else",j:[{a:"txt",b:["tK","=","nu",";"]}]}]},{a:"txt",b:"tE ; tF ; tG ;".split(" ")}]},
{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"tL",f:["vec3"],e:!1},{a:"node_in",c:"tM",f:["float"],e:!1},{a:"node_in",c:"tN",f:["float"],e:!1},{a:"node_in",c:"tO",f:["float"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1}],j:[{a:"txt",b:"tP = tL ; tM ; tN ; tO ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",c:"tQ",f:["vec3"],e:!1},{a:"node_out",c:"tR",f:["vec3"],e:!1}],j:[{a:"txt",b:["tR","=","tQ",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"tS",f:["vec3"],e:!1},
{a:"node_in",c:"tT",f:["vec3"],e:!1},{a:"node_out",c:"tU",f:["vec3"],e:!1}],j:[{a:"txt",b:"tU = tS ; tT ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"tV",f:["vec3"],e:!1},{a:"node_in",c:"tW",f:["float"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"tZ [ 0 ] = tZ [ 1 ] = tZ [ 2 ] = _0_0 ; tV ; tW ; tX ; tY ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"t_",f:["vec3"],
e:!1},{a:"node_in",c:"ua",f:["float"],e:!1},{a:"node_in",c:"ub",f:["float"],e:!1},{a:"node_in",c:"uc",f:["vec3"],e:!1},{a:"node_out",c:"ud",f:["vec3"],e:!1}],j:[{a:"txt",b:"ud = t_ ; ua ; ub ; uc ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"ue",f:["vec3"],e:!1},{a:"node_in",c:"uf",f:["float"],e:!1},{a:"node_in",c:"ug",f:["vec3"],e:!1},{a:"node_out",c:"uh",f:["vec3"],e:!1}],j:[{a:"txt",b:"uh = ue ; uf ; ug ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",
c:"ui",f:["vec3"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["vec3"],e:!1},{a:"node_in",c:"ul",f:["float"],e:!1},{a:"node_in",c:"um",f:["float"],e:!1},{a:"node_in",c:"un",f:["vec3"],e:!1},{a:"node_out",c:"uo",f:["vec3"],e:!1}],j:[{a:"txt",b:"uo [ 0 ] = uo [ 1 ] = uo [ 2 ] = _0_0 ; ui ; uk ; ul ; um ; un ; uj ;".split(" ")}]},{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_in",c:"uq",f:["float"],e:!1},{a:"node_out",c:"ur",f:["vec3"],e:!1}],j:[{a:"txt",
b:"ur = up ; uq ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"us",f:["vec3"],e:!1},{a:"node_out",c:"ut",f:["vec3"],e:!1}],j:[{a:"txt",b:"ut [ 0 ] = ut [ 1 ] = ut [ 2 ] = _0_0 ; us ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uu",f:["vec3"],e:!1}],j:[{a:"txt",b:"uu [ 0 ] = uu [ 1 ] = uu [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"uv",f:["vec3"],e:!1},{a:"node_in",c:"uw",f:["float"],e:!1},{a:"node_out",c:"ux",f:["vec3"],
e:!1}],j:[{a:"txt",b:"ux [ 0 ] = ux [ 1 ] = ux [ 2 ] = _0_0 ; uv ; uw ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"uy",f:["vec3"],e:!1},{a:"node_in",c:"uz",f:["float"],e:!1},{a:"node_in",c:"uA",f:["float"],e:!1},{a:"node_out",c:"uB",f:["vec3"],e:!1}],j:[{a:"txt",b:"uB [ 0 ] = uB [ 1 ] = uB [ 2 ] = _0_0 ; uy ; uz ; uA ;".split(" ")}]},{a:"node",c:"BUMP",m:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"uC",f:["float"],e:!1},{a:"node_in",
c:"uD",f:["float"],e:!1},{a:"node_in",c:"uE",f:["float"],e:!1},{a:"node_in",c:"uF",f:["vec3"],e:!1},{a:"node_out",c:"uG",f:["vec3"],e:!1}],j:[{a:"txt",b:"float az = uD ; float fU = uC ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["INVERT"],j:[{a:"txt",b:["az","=","-","1.0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["vec3","L","=","uF",";"]}]},{a:"node_else",j:[{a:"txt",b:["vec3","L","=","nu",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_DERIVATIVES_EXT"],j:[{a:"txt",
b:"vec3 uH = dFdx ( nt ) ; vec3 uI = dFdy ( nt ) ; vec3 uJ = cross ( uI , L ) ; vec3 uK = cross ( L , uH ) ; float cZ = dot ( uH , uJ ) ; float uL = abs ( cZ ) ; vec3 uM = dFdx ( uE ) * uJ + dFdy ( uE ) * uK ; fU = max ( fU , 0.0 ) ; uG = normalize ( uL * L - az * sign ( cZ ) * uM ) ; uG = normalize ( fU * uG + ( 1.0 - fU ) * L ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["uG","=","L",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"uN",f:["float"],
e:!1},{a:"node_in",c:"uO",f:["vec4"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","uQ","=","nu",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uP = 2.0 * uO . xyz - _1_0 ; uP = qX * uP ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"uP = 2.0 * uO . xyz - _1_0 ; uP . yz *= - 1.0 ; uP = P ( u_model_tsr , uP ) ;".split(" ")}]},
{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"uP = 2.0 * uO . xyz - _1_0 ; uP . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"uP = normalize ( mix ( uQ , uP , uN ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["vec3"],e:!1}],j:[{a:"node_cond",
d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["uS","=","uR",";"]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_view_tsr_frag , uR ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_model_tsr_inverse , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_model_tsr , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_model_tsr , uR ) ; uS = Y ( u_view_tsr_frag , uS ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_view_tsr_inverse , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_view_tsr_inverse , uR ) ; uS = Y ( u_model_tsr_inverse , uS ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_view_tsr_frag , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",
{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_model_tsr_inverse , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_model_tsr , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_model_tsr , uR ) ; uS = P ( u_view_tsr_frag , uS ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_view_tsr_inverse , uR ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_view_tsr_inverse , uR ) ; uS = P ( u_model_tsr_inverse , uS ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = normalize ( uS ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1}],j:[{a:"txt",b:"uU [ 0 ] = uU [ 1 ] = uU [ 2 ] = _0_0 ; uT ;".split(" ")}]},
{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"uV",f:["float"],e:!1},{a:"node_out",c:"uW",f:["vec3"],e:!1}],j:[{a:"txt",b:"uW [ 0 ] = uW [ 1 ] = uW [ 2 ] = _0_0 ; uV ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},{a:"node_out",c:"uY",f:["float"],e:!1},{a:"node_out",c:"uZ",f:["float"],e:!1},{a:"node_out",c:"u_",f:["float"],e:!1}],j:[{a:"txt",b:"uY = uX [ 0 ] ; uZ = uX [ 1 ] ; u_ = uX [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"va",f:["float"],
e:!1},{a:"node_in",c:"vb",f:["float"],e:!1},{a:"node_in",c:"vc",f:["float"],e:!1},{a:"node_out",c:"vd",f:["vec3"],e:!1}],j:[{a:"txt",b:"vd [ 0 ] = va ; vd [ 1 ] = vb ; vd [ 2 ] = vc ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",c:"ve",f:["vec3"],e:!1},{a:"node_in",c:"vf",f:["float"],e:!1},{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_out",c:"vh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vf - vg * _0_5 ; vh = max ( ( _1_0 + vg ) * ve + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",
c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"vj",f:["float"],e:!1},{a:"node_out",c:"vk",f:["float"],e:!1},{a:"node_out",c:"vl",f:["float"],e:!1},{a:"node_out",c:"vm",f:["float"],e:!1}],j:[{a:"txt",b:"vk = vl = vm = _0_0 ; vi ; vj ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vn",f:["vec3"],e:!1},{a:"node_out",c:"vo",f:["vec3"],e:!1}],j:[{a:"txt",b:"vo [ 0 ] = vo [ 1 ] = vo [ 2 ] = _0_0 ; vn ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",
c:"vp",f:["vec3"],e:!1},{a:"node_in",c:"vq",f:["float"],e:!1},{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["float"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1},{a:"node_out",c:"vu",f:["float"],e:!1}],j:[{a:"txt",b:"vt [ 0 ] = vt [ 1 ] = vt [ 2 ] = _0_0 ; vu = _1_0 ; vp ; vq ; vr ; vs ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",c:"vv",f:["vec3"],e:!1},{a:"node_in",c:"vw",f:["float"],e:!1},{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_in",c:"vy",f:["float"],e:!1},{a:"node_in",
c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1},{a:"node_out",c:"vB",f:["float"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vB = _1_0 ; vv ; vw ; vx ; vy ; vz ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"vC",f:["vec3"],e:!1},{a:"node_in",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["vec3"],e:!1},{a:"node_out",c:"vF",f:["float"],e:!1}],j:[{a:"txt",b:"vE [ 0 ] = vE [ 1 ] = vE [ 2 ] = _0_0 ; vF = _1_0 ; vC ; vD ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",
m:[],l:[{a:"node_in",c:"vG",f:["vec3"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_in",c:"vI",f:["float"],e:!1},{a:"node_in",c:"vJ",f:["float"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_in",c:"vM",f:["float"],e:!1},{a:"node_out",c:"vN",f:["vec3"],e:!1},{a:"node_out",c:"vO",f:["float"],e:!1}],j:[{a:"txt",b:"vN [ 0 ] = vN [ 1 ] = vN [ 2 ] = _0_0 ; vO = _1_0 ; vG ; vH ; vI ; vJ ; vK ; vL ; vM ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",
c:"vP",f:["vec3"],e:!1},{a:"node_out",c:"vQ",f:["vec3"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vQ [ 0 ] = vQ [ 1 ] = vQ [ 2 ] = _0_0 ; vR = _1_0 ; vP ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_in",c:"vT",f:["float"],e:!1},{a:"node_in",c:"vU",f:["float"],e:!1},{a:"node_out",c:"vV",f:["vec3"],e:!1},{a:"node_out",c:"vW",f:["float"],e:!1}],j:[{a:"txt",b:"vV [ 0 ] = vV [ 1 ] = vV [ 2 ] = _0_0 ; vW = _1_0 ; vS ; vT ; vU ;".split(" ")}]},
{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"vX",f:["vec3"],e:!1},{a:"node_in",c:"vY",f:["vec3"],e:!1},{a:"node_in",c:"vZ",f:["vec3"],e:!1},{a:"node_in",c:"v_",f:["float"],e:!1},{a:"node_out",c:"wa",f:["vec3"],e:!1},{a:"node_out",c:"wb",f:["float"],e:!1}],j:[{a:"txt",b:"wa [ 0 ] = wa [ 1 ] = wa [ 2 ] = _0_0 ; wb = _1_0 ; vX ; vY ; vZ ; v_ ;".split(" ")}]},{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wc",f:["vec3"],e:!1},{a:"node_in",c:"wd",f:["vec3"],e:!1},{a:"node_in",c:"we",f:["vec3"],e:!1},
{a:"node_in",c:"wf",f:["vec3"],e:!1},{a:"node_in",c:"wg",f:["float"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_in",c:"wi",f:["float"],e:!1},{a:"node_in",c:"wj",f:["float"],e:!1},{a:"node_in",c:"wk",f:["float"],e:!1},{a:"node_out",c:"wl",f:["vec3"],e:!1},{a:"node_out",c:"wm",f:["float"],e:!1}],j:[{a:"txt",b:"wl [ 0 ] = wl [ 1 ] = wl [ 2 ] = _0_0 ; wm = _1_0 ; wc ; wd ; we ; wf ; wg ; wh ; wi ; wj ; wk ;".split(" ")}]},{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wn",f:["vec3"],e:!1},
{a:"node_in",c:"wo",f:["vec3"],e:!1},{a:"node_out",c:"wp",f:["vec3"],e:!1}],j:[{a:"txt",b:"wp = clamp ( wn + wo , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_in",c:"wr",f:["vec3"],e:!1},{a:"node_in",c:"ws",f:["vec3"],e:!1},{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_in",c:"wu",f:["float"],e:!1},{a:"node_in",c:"wv",f:["vec3"],e:!1},{a:"node_in",c:"wA",f:["float"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",
c:"wC",f:["vec3"],e:!1},{a:"node_in",c:"wD",f:["vec3"],e:!1},{a:"node_in",c:"wE",f:["float"],e:!1},{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["float"],e:!1},{a:"node_in",c:"wH",f:["float"],e:!1},{a:"node_in",c:"wI",f:["vec3"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["vec3"],e:!1},{a:"node_out",c:"wL",f:["float"],e:!1},{a:"node_out",c:"wM",f:["vec3"],e:!1},{a:"node_out",c:"wN",f:["float"],e:!1},{a:"node_out",c:"wO",f:["float"],e:!1},{a:"node_out",c:"wP",
f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( wq , _0_0 , _1_0 ) ; wK = mix ( wt , wD , wQ ) ; wL = mix ( wu , wE , wQ ) ; if ( wB > _0_0 ) { if ( wH > _0_0 ) { wM = mix ( wv , wF , wQ ) ; wN = mix ( wA , wG , wQ ) ; } else { wM = wv ; wN = wA ; } } else { wM = wF ; wN = wG ; } wO = mix ( wB , wH , wQ ) ; wP = mix ( wC , wI , wQ ) ;".split(" ")}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"wR",f:["vec3"],e:!1},{a:"node_out",c:"wS",f:["vec3"],e:!1},{a:"node_param",c:"qP",f:["GLSL_IN","vec2"],
e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_wR"],j:[{a:"txt",b:"wR = qC ( qP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_wS"],j:[{a:"txt",b:"wS = vec3 ( qP , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"wT",f:["vec3"],e:!1},{a:"node_param",c:"qQ",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"wT = vec3 ( qQ , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"wU",f:["vec3"],e:!1}],j:[{a:"txt",b:["wU","=","nu",";"]}]},
{a:"node",c:"TEX_COORD_GE",m:[],l:[{a:"node_out",c:"wV",f:["vec3"],e:!1}],j:[{a:"txt",b:["wV","=","qy",";"]}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"wW",f:["vec3"],e:!1}],j:[{a:"txt",b:"wW = Y ( u_model_tsr_inverse , nt ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"wX",f:["vec3"],e:!1}],j:[{a:"txt",b:"wX . xy = qY . xy ; wX . z = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY . xy = h . xy / h . z ; wY . z = _0_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"wZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"wZ = reflect ( - nv , nu ) ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"w_",f:["vec3"],e:!1},{a:"node_param",c:"qR",f:["GLSL_IN","vec2"],e:!1}],j:[{a:"txt",b:"w_ = vec3 ( qR , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xa",f:["float"],e:!1},{a:"node_out",c:"xb",f:["float"],e:!1},{a:"node_out",c:"xc",f:["float"],e:!1},{a:"node_out",c:"xd",f:["vec3"],e:!1},{a:"node_out",
c:"xe",f:["float"],e:!1},{a:"node_out",c:"xf",f:["vec3"],e:!1},{a:"node_out",c:"xg",f:["vec3"],e:!1}],j:[{a:"txt",b:"xa = _0_0 ; xb = _0_0 ; xc = _0_0 ; xd = vec3 ( _0_0 ) ; xe = _0_0 ; xf = xd ; xg = xd ;".split(" ")}]},{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xh",f:["float"],e:!1},{a:"node_out",c:"xi",f:["float"],e:!1},{a:"node_out",c:"xj",f:["float"],e:!1},{a:"node_out",c:"xk",f:["vec3"],e:!1}],j:[{a:"txt",b:"xh = _0_0 ; xi = _0_0 ; xj = _0_0 ; xk = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"OBJECT_INFO",m:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],l:[{a:"node_out",c:"xl",f:["vec3"],e:!1},{a:"node_out",c:"xm",f:["float"],e:!1},{a:"node_out",c:"xn",f:["float"],e:!1},{a:"node_out",c:"xo",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_LOCATION_OUT"],j:[{a:"txt",b:"xl = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OBJ_IND_OUT"],j:[{a:"txt",b:"xm = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MAT_IND_OUT"],j:[{a:"txt",b:"xn = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_RANDOM_OUT"],j:[{a:"txt",b:"xo = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"xp",f:["float"],e:!1},{a:"node_out",c:"xq",f:["float"],e:!1}],j:[{a:"txt",b:["xq","=","xp",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"xr",f:["vec3"],e:!1}],
j:[{a:"txt",b:"xr = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"xs",f:["float"],e:!1},{a:"node_in",c:"xt",f:["vec3"],e:!1},{a:"node_out",c:"xu",f:["float"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:"vec3 bT = normalize ( xt ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","bT","=","nu",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE",
"CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 xA = normalize ( nv ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","xA","=","u_camera_direction",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xu"],j:[{a:"txt",b:"float qG = max ( _1_0 - xs , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"qG = ! gl_FrontFacing ? qG : _1_0 / qG ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"qG = gl_FrontFacing ? qG : _1_0 / qG ;".split(" ")}]}]},
{a:"txt",b:"xu = qI ( xA , bT , qG ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["xu","=","_0_0",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xv"],j:[{a:"txt",b:"xv = abs ( dot ( xA , bT ) ) ; float dF = xs ; if ( dF != _0_5 ) { dF = clamp ( dF , _0_0 , 0.99999 ) ; dF = ( dF < _0_5 ) ? 2.0 * dF : _0_5 / ( _1_0 - dF ) ; xv = pow ( xv , dF ) ; } xv = _1_0 - xv ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["xv","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"xB",
f:["float"],e:!1},{a:"node_out",c:"xC",f:["float"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1},{a:"node_out",c:"xE",f:["float"],e:!1},{a:"node_out",c:"xF",f:["float"],e:!1},{a:"node_out",c:"xG",f:["float"],e:!1},{a:"node_out",c:"xH",f:["float"],e:!1},{a:"node_out",c:"xI",f:["float"],e:!1},{a:"node_out",c:"xJ",f:["float"],e:!1},{a:"node_out",c:"xK",f:["float"],e:!1}],j:[{a:"txt",b:"xB = xC = xD = _0_0 ; xE = xF = xG = _0_0 ; xH = xH = xJ = xK = _0_0 ; xI = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",
m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1},{a:"node_out",c:"xM",f:["vec3"],e:!1},{a:"node_out",c:"xN",f:["float"],e:!1}],j:[{a:"txt",b:"xL = xM = vec3 ( _0_0 ) ; xN = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"xO",f:["float"],e:!1},{a:"node_in",c:"xP",f:["vec3"],e:!1},{a:"node_out",c:"xQ",f:["vec3"],
e:!1}],j:[{a:"txt",b:["xQ","=","xP",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"xQ . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * xP . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"xQ . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * xP . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"xQ . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * xP . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"txt",b:"xQ = mix ( xP , xQ , xO ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"xR",f:["float"],e:!1},{a:"node_in",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( xS . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( xS . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( xS . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = xS . r ; float g = xS . g ; float b = xS . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"xT . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"xT . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"xT . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"xT . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"xT . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"xT . b = b ;".split(" ")}]}]},{a:"txt",b:"xT = mix ( xS , xT , xR ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"xU",f:["float"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_out",c:"xW",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 xX = GLSL_TEXTURE ( u_nodes_texture , vec2 ( xU , NODE_TEX_ROW ) ) ; xV = xX . rgb ; xW = xX . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"xY",f:["vec3"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xZ","=","xY",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"xZ = xZ * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"xZ = xZ + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"xZ = ( MAPPING_TRS_MATRIX * vec4 ( xZ , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"xZ = max ( xZ , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"xZ = min ( xZ , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"xZ = normalize ( xZ ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"x_",f:["float"],e:!1},{a:"node_in",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1}],j:[{a:"txt",b:"yb = x_ + ya ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yb = clamp ( yb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yc",f:["float"],e:!1},{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:"ye = yc - yd ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"ye = clamp ( ye , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yf",f:["float"],e:!1},{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_out",c:"yh",f:["float"],e:!1}],j:[{a:"txt",b:"yh = yf * yg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yh = clamp ( yh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yi",f:["float"],e:!1},{a:"node_in",c:"yj",f:["float"],e:!1},{a:"node_out",c:"yk",f:["float"],e:!1}],j:[{a:"txt",b:"yk = ( yj != _0_0 ) ? yi / yj : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yk = clamp ( yk , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yl",f:["float"],e:!1},{a:"node_in",c:"ym",f:["float"],e:!1},
{a:"node_out",c:"yn",f:["float"],e:!1}],j:[{a:"txt",b:"yn = sin ( yl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yn = clamp ( yn , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ym",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yo",f:["float"],e:!1},{a:"node_in",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1}],j:[{a:"txt",b:"yq = cos ( yo ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"yq = clamp ( yq , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yp",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yr",f:["float"],e:!1},{a:"node_in",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1}],j:[{a:"txt",b:"yt = tan ( yr ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yt = clamp ( yt , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ys",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yu",f:["float"],e:!1},{a:"node_in",c:"yv",f:["float"],e:!1},{a:"node_out",c:"yA",f:["float"],e:!1}],j:[{a:"txt",b:"yA = ( yu <= _1_0 && yu >= - _1_0 ) ? asin ( yu ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yA = clamp ( yA , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yv",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yB",f:["float"],e:!1},{a:"node_in",
c:"yC",f:["float"],e:!1},{a:"node_out",c:"yD",f:["float"],e:!1}],j:[{a:"txt",b:"yD = ( yB <= _1_0 && yB >= - _1_0 ) ? acos ( yB ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yD = clamp ( yD , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yC",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yE",f:["float"],e:!1},{a:"node_in",c:"yF",f:["float"],e:!1},{a:"node_out",c:"yG",f:["float"],e:!1}],j:[{a:"txt",
b:"yG = atan ( yE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yG = clamp ( yG , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yF",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yH",f:["float"],e:!1},{a:"node_in",c:"yI",f:["float"],e:!1},{a:"node_out",c:"yJ",f:["float"],e:!1}],j:[{a:"txt",b:"if ( yH < _0_0 && yI != floor ( yI ) ) yJ = _0_0 ; else if ( yI == _0_0 ) yJ = _1_0 ; else if ( yH < _0_0 ) yJ = mix ( _1_0 , - _1_0 , sign ( mod ( - yI , 2.0 ) ) ) * pow ( - yH , yI ) ; else if ( yH == _0_0 ) yJ = _0_0 ; else yJ = pow ( yH , yI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yJ = clamp ( yJ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yK",f:["float"],e:!1},{a:"node_in",c:"yL",f:["float"],e:!1},{a:"node_out",c:"yM",f:["float"],e:!1}],j:[{a:"txt",b:"yM = ( yK > _0_0 && yL > _0_0 ) ? log2 ( yK ) / log2 ( yL ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yM = clamp ( yM , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yN",f:["float"],e:!1},{a:"node_in",c:"yO",f:["float"],e:!1},{a:"node_out",c:"yP",f:["float"],e:!1}],j:[{a:"txt",b:"yP = min ( yN , yO ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yP = clamp ( yP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_in",c:"yR",f:["float"],
e:!1},{a:"node_out",c:"yS",f:["float"],e:!1}],j:[{a:"txt",b:"yS = max ( yQ , yR ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yS = clamp ( yS , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_in",c:"yU",f:["float"],e:!1},{a:"node_out",c:"yV",f:["float"],e:!1}],j:[{a:"txt",b:"yV = floor ( yT + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"yV = clamp ( yV , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yU",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_in",c:"yX",f:["float"],e:!1},{a:"node_out",c:"yY",f:["float"],e:!1}],j:[{a:"txt",b:"yY = ( yW < yX ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yY = clamp ( yY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_in",c:"y_",f:["float"],e:!1},{a:"node_out",c:"za",f:["float"],e:!1}],j:[{a:"txt",b:"za = ( yZ > y_ ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"za = clamp ( za , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_in",c:"zc",f:["float"],e:!1},{a:"node_out",c:"zd",
f:["float"],e:!1}],j:[{a:"txt",b:"zd = abs ( zc ) > 0.000001 ? mod ( zb , zc ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zd = clamp ( zd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_in",c:"zf",f:["float"],e:!1},{a:"node_out",c:"zg",f:["float"],e:!1}],j:[{a:"txt",b:"zg = abs ( ze ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zg = clamp ( zg , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zf",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_in",c:"zi",f:["vec3"],e:!1},{a:"node_in",c:"zj",f:["vec3"],e:!1},{a:"node_out",c:"zk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zh , _0_0 , _1_0 ) ; zk = mix ( zi , zj , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zk = clamp ( zk , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zl",f:["float"],e:!1},{a:"node_in",c:"zm",f:["vec3"],e:!1},{a:"node_in",c:"zn",f:["vec3"],e:!1},{a:"node_out",c:"zo",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zl , _0_0 , _1_0 ) ; zo = mix ( zm , zm + zn , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["vec3"],e:!1},{a:"node_in",c:"zr",f:["vec3"],e:!1},{a:"node_out",c:"zs",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zp , _0_0 , _1_0 ) ; zs = mix ( zq , zq * zr , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zs = clamp ( zs , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"zt",f:["float"],e:!1},{a:"node_in",c:"zu",f:["vec3"],e:!1},{a:"node_in",c:"zv",f:["vec3"],e:!1},{a:"node_out",c:"zA",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zt , _0_0 , _1_0 ) ; zA = mix ( zu , zu - zv , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zA = clamp ( zA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zB",f:["float"],e:!1},{a:"node_in",c:"zC",
f:["vec3"],e:!1},{a:"node_in",c:"zD",f:["vec3"],e:!1},{a:"node_out",c:"zE",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zB , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; zE = vec3 ( _1_0 ) - ( vec3 ( zF ) + wQ * ( vec3 ( _1_0 ) - zD ) ) * ( vec3 ( _1_0 ) - zC ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zG",
f:["float"],e:!1},{a:"node_in",c:"zH",f:["vec3"],e:!1},{a:"node_in",c:"zI",f:["vec3"],e:!1},{a:"node_out",c:"zJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zG , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; zI += step ( zI , vec3 ( _0_0 ) ) ; zJ = zF * zH + wQ * zH / zI ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zJ = clamp ( zJ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"zK",f:["float"],e:!1},{a:"node_in",c:"zL",f:["vec3"],e:!1},{a:"node_in",c:"zM",f:["vec3"],e:!1},{a:"node_out",c:"zN",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zK , _0_0 , _1_0 ) ; zN = mix ( zL , abs ( zL - zM ) , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",
c:"zP",f:["vec3"],e:!1},{a:"node_in",c:"zQ",f:["vec3"],e:!1},{a:"node_out",c:"zR",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zO , _0_0 , _1_0 ) ; zR = min ( zP . rgb , zQ . rgb * wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zR = clamp ( zR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_in",c:"zT",f:["vec3"],e:!1},{a:"node_in",
c:"zU",f:["vec3"],e:!1},{a:"node_out",c:"zV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zS , _0_0 , _1_0 ) ; zV = max ( zT . rgb , zU . rgb * wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zV = clamp ( zV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zW",f:["float"],e:!1},{a:"node_in",c:"zX",f:["vec3"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_out",
c:"zZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zW , _0_0 , _1_0 ) ; vec3 z_ = vec3 ( _1_0 - wQ ) ; zZ = mix ( zX * ( z_ + 2.0 * wQ * zY ) , vec3 ( _1_0 ) - ( z_ + 2.0 * wQ * ( vec3 ( _1_0 ) - zY ) ) * ( vec3 ( _1_0 ) - zX ) , step ( _0_5 , zX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zZ = clamp ( zZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],
e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Aa , _0_0 , _1_0 ) ; vec3 Ae = vec3 ( _1_0 ) - wQ * Ac ; vec3 Af = clamp ( Ab / Ae , _0_0 , _1_0 ) ; Ad = mix ( mix ( Af , vec3 ( _1_0 ) , step ( Ae , vec3 ( _0_0 ) ) ) , Ab , step ( Ab , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ag",f:["float"],e:!1},{a:"node_in",c:"Ah",f:["vec3"],e:!1},{a:"node_in",c:"Ai",f:["vec3"],e:!1},{a:"node_out",c:"Aj",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Ag , _0_0 , _1_0 ) ; vec3 jE = vec3 ( _1_0 - wQ ) ; vec3 Ae = jE + wQ * Ai ; vec3 Af = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - Ah ) / Ae , _0_0 , _1_0 ) ; Aj = mix ( Af , vec3 ( _0_0 ) , step ( Ae , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Aj = clamp ( Aj , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ak",f:["float"],e:!1},{a:"node_in",c:"Al",f:["vec3"],e:!1},{a:"node_in",c:"Am",f:["vec3"],e:!1},{a:"node_out",c:"An",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Ak , _0_0 , _1_0 ) ; vec3 jw , Ao , Ae ; An = Al ; Ao = jv ( Am ) ; if ( Ao . y != _0_0 ) { jw = jv ( An ) ; jw . x = Ao . x ; Ae = jx ( jw ) ; An = mix ( An , Ae , wQ ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"An = clamp ( An , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ap",f:["float"],e:!1},{a:"node_in",c:"Aq",f:["vec3"],e:!1},{a:"node_in",c:"Ar",f:["vec3"],e:!1},{a:"node_out",c:"As",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Ap , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; As = Aq ; vec3 jw , Ao ; jw = jv ( As ) ; if ( jw . y != _0_0 ) { Ao = jv ( Ar ) ; jw . y = zF * jw . y + wQ * Ao . y ; As = jx ( jw ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"As = clamp ( As , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"At",f:["float"],e:!1},{a:"node_in",c:"Au",f:["vec3"],e:!1},{a:"node_in",c:"Av",f:["vec3"],e:!1},{a:"node_out",c:"Aw",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( At , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; vec3 jw , Ao ; jw = jv ( Au ) ; Ao = jv ( Av ) ; jw . z = zF * jw . z + wQ * Ao . z ; Aw = jx ( jw ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Aw = clamp ( Aw , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ax",f:["float"],e:!1},{a:"node_in",c:"Ay",f:["vec3"],e:!1},{a:"node_in",c:"Az",f:["vec3"],e:!1},{a:"node_out",c:"AA",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Ax , _0_0 , _1_0 ) ; vec3 jw , Ao , Ae ; AA = Ay ; Ao = jv ( Az ) ; if ( Ao . y != _0_0 ) { jw = jv ( AA ) ; jw . x = Ao . x ; jw . y = Ao . y ; Ae = jx ( jw ) ; AA = mix ( AA , Ae , wQ ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AA = clamp ( AA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AB",f:["float"],e:!1},{a:"node_in",c:"AC",f:["vec3"],e:!1},{a:"node_in",c:"AD",f:["vec3"],e:!1},{a:"node_out",c:"AE",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( AB , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; vec3 AF = AD + AC - AD * AC ; AE = AC * ( vec3 ( zF ) + vec3 ( wQ ) * ( ( vec3 ( _1_0 ) - AC ) * AD + AF ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AE = clamp ( AE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AG",f:["float"],e:!1},{a:"node_in",c:"AH",f:["vec3"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_out",c:"AJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( AG , _0_0 , _1_0 ) ; AJ = AH + wQ * ( 2.0 * AI - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AJ = clamp ( AJ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"AK",f:["vec3"],e:!1},{a:"node_in",c:"AL",f:["float"],e:!1}],j:[{a:"txt",b:"v = AK ; D = AL ;".split(" ")}]},{a:"node",c:"OUTPUT_MATERIAL",m:[],l:[{a:"node_in",c:"AM",f:["vec3"],e:!1},{a:"node_in",c:"AN",f:["vec3"],e:!1},{a:"node_in",c:"AO",f:["float"],e:!1}],j:[{a:"txt",b:["v","=","AM",";"]}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},
{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"AP",f:["vec3"],e:!1},{a:"node_in",c:"AQ",f:["vec3"],e:!1},{a:"node_in",c:"AR",f:["float"],e:!1},{a:"node_in",c:"AS",f:["vec3"],e:!0},{a:"node_in",c:"AT",f:["float"],e:!0},{a:"node_out",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1},{a:"node_out",c:"AW",f:["vec3"],e:!1},{a:"node_out",c:"AX",f:["vec3"],e:!1},{a:"node_out",c:"AY",f:["vec3"],
e:!1},{a:"node_out",c:"AZ",f:["vec2"],e:!1},{a:"node_out",c:"A_",f:["vec2"],e:!1},{a:"node_out",c:"Ba",f:["vec4"],e:!1},{a:"node_param",c:"qS",f:["const","vec2"],e:!1},{a:"node_param",c:"qT",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"AW = clamp ( AP , _0_0 , _1_0 ) ; AX = qT [ 0 ] * clamp ( AQ , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"AY = normalize ( AS ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["AY","=","nu",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"AU = AT * AW ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"AU = qZ * AW ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["AW","*=","AR",";"]}]}]},{a:"txt",b:"AV = q_ * u_environment_energy * cb ( AY ) ; Ba = ce ( AW ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"AZ = vec2 ( qS [ 0 ] , qS [ 1 ] ) ; A_ = vec2 ( qT [ 1 ] , qT [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["C","=","Ba",";"]}]},{a:"node_else",j:[{a:"txt",b:"AU = vec3 ( _0_0 ) ; AV = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"Bb",f:["vec4"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_in",c:"Bd",f:["vec3"],e:!1},{a:"node_in",c:"Be",f:["float"],e:!0},{a:"node_in",c:"Bf",f:["float"],e:!0},{a:"node_in",c:"Bg",
f:["float"],e:!0},{a:"node_out",c:"Bh",f:["vec3"],e:!0},{a:"node_out",c:"Bi",f:["float"],e:!0},{a:"node_out",c:"Bj",f:["vec3"],e:!0},{a:"node_out",c:"Bk",f:["vec3"],e:!0},{a:"node_out",c:"Bl",f:["vec3"],e:!0},{a:"node_param",c:"qU",f:["float"],e:!1},{a:"node_param",c:"qV",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bh"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"Bh = Bb . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Bh = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"cn ( Bh , nv , Bd , Be , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"cn ( Bh , nv , Bd , Be , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["Bh","+=","Bc",";"]}]}]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Bj"],j:[{a:"txt",b:["Bj","=","Bd",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bk"],j:[{a:"txt",b:"Bk = Bb . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bl"],j:[{a:"txt",b:["Bl","=","Bc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bi"],j:[{a:"txt",b:"Bi = clamp ( Bg , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( Bc . r , Bc . g ) , Bc . b ) * Bf ; Bi = clamp ( Bg * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bi"],j:[{a:"txt",b:"Bi = clamp ( qU , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( Bc . r , Bc . g ) , Bc . b ) * qV ; Bi = qU * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["A","=","Bc",";"]}]},{a:"node_else",j:[{a:"txt",b:"A = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["B","=","Bd",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nM",f:["vec3"],e:!1},{a:"node_in",c:"nN",f:["vec3"],e:!1},{a:"node_in",c:"nO",f:["vec3"],e:!1},{a:"node_out",c:"nP",f:["vec4"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"nP = vec4 ( nM + nO * nN , _0_0 ) ; nQ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],l:[{a:"node_in",c:"nR",f:["vec4"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!1},{a:"node_out",c:"nT",f:["vec2"],e:!1},{a:"node_out",c:"nU",f:["vec3"],e:!1},{a:"node_out",c:"nV",f:["float"],e:!1}],j:[{a:"txt",b:"nT = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["nV","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["nV","=","_0_0",";"]}]}]},{a:"txt",b:"nU = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"nU *= nR [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 nW = u_light_positions [ LAMP_IND ] . xyz ; nS = nW - nt ; float az = length ( nS ) ; nU *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + az * az ) ; nS = normalize ( nS ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 nY = u_light_directions [ LAMP_IND ] ; float nZ = dot ( nS , nY ) ; nZ *= smoothstep ( _0_0 , _1_0 , ( nZ - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; nU *= nZ ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"nU *= max ( LAMP_LIGHT_DIST - az , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"nS = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec2"],e:!1},{a:"node_in",c:"ob",f:["vec3"],e:!1},{a:"node_in",c:"oc",f:["float"],e:!1},{a:"node_in",c:"od",f:["vec2"],
e:!1},{a:"node_out",c:"oe",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qF","=","ob",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( n_ , o . xyz ) ; qF = cross ( of , o . xyz ) ; qF = - normalize ( qF ) ;".split(" ")}]}]},{a:"txt",b:"oe = _0_0 ; if ( oa . r != _0_0 ) { float og = ( _1_0 - oc ) * dot ( qF , n_ ) + oc ; if ( od [ 0 ] == _0_0 ) { oe = _1_0 ; } else { float t = _1_0 + abs ( og ) ; t = od [ 1 ] + ( _1_0 - od [ 1 ] ) * pow ( t , od [ 0 ] ) ; oe = clamp ( t , _0_0 , _1_0 ) ; } oe = max ( oe , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oh",f:["vec3"],e:!1},{a:"node_in",c:"oi",f:["vec2"],e:!1},{a:"node_in",c:"oj",f:["vec3"],e:!1},{a:"node_in",c:"ok",f:["float"],e:!1},{a:"node_out",c:"ol",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qF","=","oj",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oh , o . xyz ) ; qF = cross ( of , o . xyz ) ; qF = - normalize ( qF ) ;".split(" ")}]}]},{a:"txt",
b:"ol = _0_0 ; if ( oi . r != _0_0 ) { float og = ( _1_0 - ok ) * dot ( qF , oh ) + ok ; ol = max ( og , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qF","=","oo",";"]},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( om , o . xyz ) ; qF = cross ( of , o . xyz ) ; qF = - normalize ( qF ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float og = ( _1_0 - op ) * dot ( qF , om ) + op ; if ( oq [ 0 ] > _0_0 ) { float os = max ( dot ( qF , nv ) , _0_0 ) ; float ot = oq [ 0 ] * oq [ 0 ] ; float cd = _1_0 - _0_5 * ( ot / ( ot + 0.33 ) ) ; vec3 ou = om - og * qF ; vec3 ov = nv - os * qF ; if ( length ( ou ) == _0_0 || length ( ov ) == _0_0 || abs ( og ) > _1_0 || abs ( os ) > _1_0 ) or = og * cd ; else { float ow = acos ( og ) ; float ox = acos ( os ) ; vec3 oy = normalize ( ou ) ; vec3 oz = normalize ( ov ) ; float a , b ; a = max ( ow , ox ) ; b = min ( ow , ox ) ; b *= 0.95 ; float t = max ( dot ( oy , oz ) , _0_0 ) ; float oA = 0.45 * ( ot / ( ot + 0.09 ) ) ; or = og * ( cd + ( oA * t * sin ( a ) * tan ( b ) ) ) ; } } else or = og ; or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["vec2"],e:!1},{a:"node_in",c:"oD",f:["vec3"],e:!1},{a:"node_in",c:"oE",f:["float"],e:!1},{a:"node_in",c:"oF",f:["vec2"],e:!1},{a:"node_out",c:"oG",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qF","=","oD",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oB , o . xyz ) ; qF = cross ( of , o . xyz ) ; qF = - normalize ( qF ) ;".split(" ")}]}]},
{a:"txt",b:"oG = _0_0 ; if ( oC . r != _0_0 ) { float og = ( _1_0 - oE ) * dot ( qF , oB ) + oE ; float os = max ( dot ( qF , nv ) , _0_0 ) ; if ( oF [ 0 ] <= _1_0 ) oG = og * pow ( max ( os * og , 0.1 ) , oF [ 0 ] - _1_0 ) ; else oG = og * pow ( 1.0001 - os , oF [ 0 ] - _1_0 ) ; oG = max ( oG , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oH",f:["vec3"],e:!1},{a:"node_in",c:"oI",f:["vec2"],e:!1},{a:"node_in",c:"oJ",f:["vec3"],
e:!1},{a:"node_in",c:"oK",f:["float"],e:!1},{a:"node_in",c:"oL",f:["vec2"],e:!1},{a:"node_out",c:"oM",f:["float"],e:!1}],j:[{a:"txt",b:["vec3","qF","=","oJ",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oH , o . xyz ) ; qF = cross ( of , o . xyz ) ; qF = - normalize ( qF ) ;".split(" ")}]}]},{a:"txt",b:"oM = _0_0 ; if ( oI . r != _0_0 ) { float og = ( _1_0 - oK ) * dot ( qF , oH ) + oK ; float oN = acos ( og ) ; if ( oN < oL [ 0 ] ) oM = _1_0 ; else if ( oN > ( oL [ 0 ] + oL [ 1 ] ) || oL [ 1 ] == _0_0 ) oM = _0_0 ; else oM = _1_0 - ( ( oN - oL [ 0 ] ) / oL [ 1 ] ) ; oM = max ( oM , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:"oT = _0_0 ; if ( oP . g == _1_0 ) { vec3 oU = normalize ( oO + nv ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oR == _0_0 ) { oT = dot ( o . xyz , oU ) ; oT = sqrt ( _1_0 - oT * oT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"oT = ( _1_0 - oR ) * max ( dot ( oQ , oU ) , _0_0 ) + oR ;".split(" ")}]}]},{a:"txt",b:"oT = pow ( oT , oS [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oV",f:["vec3"],e:!1},{a:"node_in",c:"oW",f:["vec2"],e:!1},{a:"node_in",c:"oX",f:["vec3"],e:!1},{a:"node_in",c:"oY",f:["float"],e:!1},{a:"node_in",c:"oZ",f:["vec2"],e:!1},{a:"node_out",c:"o_",f:["float"],e:!1}],j:[{a:"txt",b:"o_ = _0_0 ; if ( oW . g != _0_0 ) { vec3 oU = normalize ( oV + nv ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oY == _0_0 ) { o_ = dot ( o . xyz , oU ) ; o_ = sqrt ( _1_0 - o_ * o_ ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"o_ = max ( dot ( oX , oU ) , _0_0 ) ; o_ = ( _1_0 - oY ) * o_ + oY ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float os = max ( dot ( o . xyz , nv ) , _0_0 ) ; os = sqrt ( _1_0 - os * os ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float os = max ( dot ( oX , nv ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"o_ = pow ( o_ , oZ [ 0 ] ) ; o_ = o_ / ( 0.1 + os ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 oU = normalize ( pa + nv ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pg = _0_0 ; float os = _0_0 ; float ph = _0_0 ; if ( pd == _0_0 ) { pg = dot ( o . xyz , oU ) ; os = dot ( o . xyz , nv ) ; ph = dot ( o . xyz , pa ) ; pg = sqrt ( _1_0 - pg * pg ) ; os = sqrt ( _1_0 - os * os ) ; ph = sqrt ( _1_0 - ph * ph ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pg = max ( dot ( pc , oU ) , 0.01 ) ; float os = max ( dot ( pc , nv ) , 0.01 ) ; float ph = max ( dot ( pc , pa ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bj = tan ( acos ( pg ) ) ; float F = max ( pe [ 0 ] , 0.01 ) ; pf = ph * ( _1_0 / ( 4.0 * M_PI * F * F ) ) * ( exp ( - ( bj * bj ) / ( F * F ) ) / ( sqrt ( os * ph ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pi",f:["vec3"],e:!1},{a:"node_in",c:"pj",f:["vec2"],e:!1},{a:"node_in",c:"pk",f:["vec3"],e:!1},{a:"node_in",c:"pl",f:["float"],e:!1},{a:"node_in",c:"pm",f:["vec2"],e:!1},{a:"node_out",c:"pn",f:["float"],
e:!1}],j:[{a:"txt",b:"pn = _0_0 ; if ( pj . g == _1_0 ) { vec3 bL = normalize ( pi + nv ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float po = dot ( bL , o . xyz ) ; float bj = pm [ 0 ] + pm [ 1 ] ; if ( pl == _0_0 ) bj = acos ( sqrt ( _1_0 - po * po ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bj = acos ( dot ( bL , pk ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bj < pm [ 0 ] ) pn = _1_0 ; else if ( bj >= pm [ 0 ] + pm [ 1 ] || pm [ 1 ] == _0_0 ) pn = _0_0 ; else pn = _1_0 - ( bj - pm [ 0 ] ) / pm [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["vec2"],e:!1},{a:"node_in",c:"pv",f:["vec3"],e:!1},{a:"node_in",c:"pw",f:["float"],e:!1},{a:"node_in",c:"px",f:["vec2"],e:!1},{a:"node_out",c:"py",f:["float"],e:!1}],j:[{a:"txt",b:"float pz = px [ 0 ] ; float pA = px [ 1 ] ; py = _0_0 ; if ( pu . g == _1_0 ) { if ( pz < 1.0 || pA == _0_0 ) py = _0_0 ; else { if ( pA < 100.0 ) pA = sqrt ( 1.0 / pA ) ; else pA = 10.0 / pA ; vec3 oU = normalize ( nv + pr ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pg = 0.0 ; if ( pw == _0_0 ) { float pB = dot ( o . xyz , oU ) ; pg = sqrt ( _1_0 - pB * pB ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pg = ( _1_0 - pw ) * max ( dot ( pv , oU ) , _0_0 ) + pw ;".split(" ")}]}]},{a:"txt",b:"if ( pg < _0_0 ) py = _0_0 ; else { float os = max ( dot ( pv , nv ) , 0.01 ) ; float ph = dot ( pv , pr ) ; if ( ph <= 0.01 ) py = _0_0 ; else { float pC = max ( dot ( nv , oU ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * pg * os ) / pC ; float cY = ( 2.0 * pg * ph ) / pC ; float g = min ( min ( a , b ) , cY ) ; float p = sqrt ( pow ( pz , 2.0 ) + pow ( pC , 2.0 ) - _1_0 ) ; float lj = pow ( p - pC , 2.0 ) / pow ( p + pC , 2.0 ) * ( _1_0 + pow ( pC * ( p + pC ) - _1_0 , 2.0 ) / pow ( pC * ( p - pC ) + _1_0 , 2.0 ) ) ; float oN = acos ( pg ) ; py = max ( lj * g * exp ( - pow ( oN , 2.0 ) / ( 2.0 * pow ( pA , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pD",f:["vec4"],e:!1},{a:"node_in",c:"pE",f:["vec3"],e:!1},{a:"node_in",c:"pF",f:["float"],e:!1},{a:"node_in",c:"pG",f:["float"],e:!1},{a:"node_in",c:"pH",f:["vec3"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["vec4"],e:!1},{a:"node_in",c:"pK",f:["vec3"],e:!1},{a:"node_in",c:"pL",f:["vec3"],e:!1},{a:"node_in",c:"pM",f:["vec3"],e:!1},{a:"node_in",c:"pN",f:["float"],e:!1},{a:"node_out",c:"pO",f:["vec4"],e:!1},{a:"node_out",c:"pP",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pH , pI ) * dot ( nv , pI ) < _0_0 ) { float Bm = pJ . x ; float Bn = pJ . y ; float Bo = pJ . z ; float Bp = pJ . w ; float Bq = clamp ( abs ( dot ( pH , pI ) ) , _0_0 , _1_0 ) ; float Br = clamp ( dot ( nv , - pH ) , _0_0 , _1_0 ) ; float Bs = pow ( Br , Bn ) ; pO = pD + pN * vec4 ( pM * Bq * pow ( pK , vec3 ( Bm ) ) , _1_0 ) ; pO += Bo * mix ( vec4 ( pK , _1_0 ) , vec4 ( _1_0 ) , Bp ) * pN * vec4 ( pM * Bq * vec3 ( Bs ) , _1_0 ) ; pP = pE ; } else { pP = pE + pM * pL * pG ; pO = pD + vec4 ( pM * pK * pF , pG ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pP = pE + pM * pL * pG ; pO = pD + vec4 ( pM * pK * pF , pG ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Bt",f:["vec3"],e:!1}],j:[{a:"txt",b:"Bt = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Bu",f:["vec3"],e:!1},{a:"node_out",c:"Bv",f:["float"],e:!1}],j:[{a:"txt",b:"Bv = dot ( Bu , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Bw",
f:["vec3"],e:!1},{a:"node_out",c:"Bx",f:["float"],e:!0},{a:"node_out",c:"By",f:["float"],e:!0},{a:"node_out",c:"Bz",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bx"],j:[{a:"txt",b:"Bx = Bw . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_By"],j:[{a:"txt",b:"By = Bw . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bz"],j:[{a:"txt",b:"Bz = Bw . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_out",
c:"BB",f:["float"],e:!0},{a:"node_out",c:"BC",f:["float"],e:!0},{a:"node_out",c:"BD",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 BE = jv ( BA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BB"],j:[{a:"txt",b:"BB = BE . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BC"],j:[{a:"txt",b:"BC = BE . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BD"],j:[{a:"txt",b:"BD = BE . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"BF",f:["float"],e:!1},
{a:"node_in",c:"BG",f:["float"],e:!1},{a:"node_in",c:"BH",f:["float"],e:!1},{a:"node_out",c:"BI",f:["float"],e:!1}],j:[{a:"txt",b:"BI = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( BF - BH ) * BG ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"BJ",f:["vec3"],e:!1},{a:"node_in",c:"BK",f:["float"],e:!1},{a:"node_out",c:"BL",f:["vec3"],e:!1}],j:[{a:"txt",b:"BL = BJ ; if ( BL . x > _0_0 ) BL . x = pow ( BJ . x , BK ) ; if ( BL . y > _0_0 ) BL . y = pow ( BJ . y , BK ) ; if ( BL . z > _0_0 ) BL . z = pow ( BJ . z , BK ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"BM",f:["vec3"],e:!1},{a:"node_out",c:"BN",f:["vec3"],e:!1}],j:[{a:"txt",b:"BN = max ( vec3 ( _0_0 ) , BM ) ; BN = pow ( BN , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_out",c:"BP",f:["vec3"],e:!1}],j:[{a:"txt",b:"BP = max ( vec3 ( _0_0 ) , BO ) ; BP = pow ( BP , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"BQ",f:["vec3"],
e:!1},{a:"node_out",c:"BR",f:["vec3"],e:!1},{a:"node_out",c:"BS",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BQ"],j:[{a:"txt",b:"BQ [ 2 ] = BQ [ 1 ] = BQ [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BR"],j:[{a:"txt",b:"BR [ 2 ] = BR [ 1 ] = BR [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BS"],j:[{a:"txt",b:["BS","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"BT",f:["vec3"],e:!1},{a:"node_out",
c:"BU",f:["vec3"],e:!0},{a:"node_out",c:"BV",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec3 BW = vec3 ( BT . x , BT . y , BT . z ) ; vec4 xX = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , BW ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = xX . xyz ; bV ( BU ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:"BV = xX . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"BX",f:["vec3"],e:!0},{a:"node_in",c:"BY",f:["vec3"],e:!0},{a:"node_in",c:"BZ",f:["vec3"],e:!0},{a:"node_in",c:"B_",f:["vec3"],e:!0},{a:"node_out",c:"Ca",f:["vec3"],e:!0},{a:"node_out",c:"Cb",f:["float"],e:!0},{a:"node_out",c:"Cc",f:["vec3"],e:!0},{a:"node_out",c:"Cd",f:["float"],
e:!0},{a:"node_out",c:"Ce",f:["vec3"],e:!0},{a:"node_out",c:"Cf",f:["float"],e:!0},{a:"node_out",c:"Cg",f:["vec3"],e:!0},{a:"node_out",c:"Ch",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"vec4 xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qD ( BX ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"vec4 xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , BX . xy ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ca"],j:[{a:"txt",b:"Ca = xX . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bV","(","Ca",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cb"],j:[{a:"txt",b:"Cb = xX . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qD ( BY ) ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , BY . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cc"],j:[{a:"txt",b:"Cc = xX . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bV","(","Cc",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cd"],j:[{a:"txt",b:"Cd = xX . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"node_cond",d:[{a:"node_if",
g:["CONVERT_UV"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qD ( BZ ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , BZ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ce"],j:[{a:"txt",b:"Ce = xX . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bV","(","Ce",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cf"],j:[{a:"txt",
b:"Cf = xX . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_UV"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qD ( B_ ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , B_ . xy ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cg"],j:[{a:"txt",b:"Cg = xX . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",
i:1}],j:[{a:"txt",b:["bV","(","Cg",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ch"],j:[{a:"txt",b:"Ch = xX . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"Ci",f:["vec3"],e:!0},{a:"node_in",c:"Cj",f:["vec3"],e:!0},{a:"node_in",c:"Ck",f:["vec3"],e:!0},{a:"node_in",c:"Cl",f:["vec3"],e:!0},{a:"node_out",c:"Cm",f:["vec3"],e:!0},{a:"node_out",c:"Cn",
f:["float"],e:!0},{a:"node_out",c:"Co",f:["vec3"],e:!0},{a:"node_out",c:"Cp",f:["float"],e:!0},{a:"node_out",c:"Cq",f:["vec3"],e:!0},{a:"node_out",c:"Cr",f:["float"],e:!0},{a:"node_out",c:"Cs",f:["vec3"],e:!0},{a:"node_out",c:"Ct",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 xX = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qD ( Ci ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = normalize ( qX * ( xX . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = xX . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qD ( Cj ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = normalize ( qX * ( xX . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cp"],j:[{a:"txt",b:"Cp = xX . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],
j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qD ( Ck ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cq"],j:[{a:"txt",b:"Cq = normalize ( qX * ( xX . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cr"],j:[{a:"txt",b:"Cr = xX . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qD ( Cl ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cs"],
j:[{a:"txt",b:"Cs = normalize ( qX * ( xX . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ct"],j:[{a:"txt",b:"Ct = xX . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",b:["0"]}],l:[{a:"node_out",c:"Cu",f:["float"],e:!1}],j:[{a:"txt",b:"Cu = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Cv",f:["vec3"],e:!1},{a:"node_in",c:"Cw",f:["vec3"],e:!1},{a:"node_out",c:"Cx",f:["vec3"],e:!1},{a:"node_out",
c:"Cy",f:["float"],e:!0}],j:[{a:"txt",b:"Cx = Cv + Cw ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cy"],j:[{a:"txt",b:"Cy = ( abs ( Cx [ 0 ] ) + abs ( Cx [ 1 ] ) + abs ( Cx [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_in",c:"CA",f:["vec3"],e:!1},{a:"node_out",c:"CB",f:["vec3"],e:!1},{a:"node_out",c:"CC",f:["float"],e:!0}],j:[{a:"txt",b:"CB = Cz - CA ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],
j:[{a:"txt",b:"CC = ( abs ( CB [ 0 ] ) + abs ( CB [ 1 ] ) + abs ( CB [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"CD",f:["vec3"],e:!1},{a:"node_in",c:"CE",f:["vec3"],e:!1},{a:"node_out",c:"CF",f:["vec3"],e:!1},{a:"node_out",c:"CG",f:["float"],e:!0}],j:[{a:"txt",b:"CF = CD + CE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = length ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",
b:"CF = normalize ( CF ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"CH",f:["vec3"],e:!1},{a:"node_in",c:"CI",f:["vec3"],e:!1},{a:"node_out",c:"CJ",f:["vec3"],e:!1},{a:"node_out",c:"CK",f:["float"],e:!0}],j:[{a:"txt",b:"CJ = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CK"],j:[{a:"txt",b:"CK = dot ( CH , CI ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"CL",f:["vec3"],e:!1},{a:"node_in",c:"CM",f:["vec3"],
e:!1},{a:"node_out",c:"CN",f:["vec3"],e:!1},{a:"node_out",c:"CO",f:["float"],e:!0}],j:[{a:"txt",b:"CN = cross ( CL , CM ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = length ( CN ) ; CN /= CO ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"CN = normalize ( CN ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"CP",f:["vec3"],e:!1},{a:"node_in",c:"CQ",f:["vec3"],e:!1},{a:"node_out",c:"CR",f:["vec3"],e:!1},{a:"node_out",c:"CS",f:["float"],
e:!0}],j:[{a:"txt",b:"CR = normalize ( CP ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = length ( CP ) ;".split(" ")}]}]},{a:"txt",b:["CQ",";"]}]},{a:"node",c:"FRESNEL",m:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],l:[{a:"node_in",c:"CT",f:["float"],e:!1},{a:"node_in",c:"CU",f:["vec3"],e:!1},{a:"node_out",c:"CV",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_FRESNEL_NORMAL"],j:[{a:"txt",b:"vec3 bT = normalize ( CU ) ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:["vec3","bT","=","nu",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 xA = normalize ( nv ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["vec3","xA","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qG = max ( CT , 0.00001 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"qG = ! gl_FrontFacing ? qG : _1_0 / qG ;".split(" ")}]},{a:"node_else",
j:[{a:"txt",b:"qG = gl_FrontFacing ? qG : _1_0 / qG ;".split(" ")}]}]},{a:"txt",b:"CV = qI ( xA , bT , qG ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"CW",f:["vec3"],e:!1},{a:"node_in",c:"CX",f:["vec3"],e:!1},{a:"node_out",c:"CY",f:["vec3"],e:!1}],j:[{a:"txt",b:"CY = reflect ( P ( u_view_tsr_inverse , CW ) , CX ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"CZ",f:["vec3"],e:!1},{a:"node_out",c:"C_",f:["vec3"],e:!1}],j:[{a:"txt",b:"C_ = reflect ( - nv . xyz , CZ ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"Da",f:["vec3"],e:!1},{a:"node_in",c:"Db",f:["float"],e:!1},{a:"node_in",c:"Dc",f:["const","float"],e:!1},{a:"node_in",c:"Dd",f:["const","float"],e:!1},{a:"node_out",c:"De",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bm = length ( qY ) ; if ( bm < Dd ) { vec2 bB = qD ( Da ) ; float bF = clamp ( _0_5 * ( Dd - bm ) , _0_0 , _1_0 ) ; float hh = Db * bF ; vec3 bH = normalize ( nv * qX ) ; float bI = _1_0 / Dc ; vec2 bJ = bH . xy * hh / ( Dc * bH . z ) ; float bK = _1_0 ; float bL = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bB ) . a ; for ( float bN = 1.0 ; bN <= Dc ; bN ++ ) { if ( bL < bK ) { bK -= bI ; bB -= bJ ; bL = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bB ) . a ; } } vec2 bO = bB + bJ ; float bP = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bO ) . a - ( bK + bI ) ; float bQ = bL - bK ; float bR = bQ / ( bQ - bP ) ; bB = bR * bO + ( _1_0 - bR ) * bB ; De = qC ( bB ) ; } else De = Da ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"Df",f:["vec3"],e:!1},{a:"node_out",c:"Dg",f:["vec3"],e:!1}],j:[{a:"txt",b:"Dg = clamp ( Df , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_in",c:"Di",f:["float"],e:!1},{a:"node_out",c:"Dj",f:["vec3"],e:!1}],j:[{a:"txt",b:"Dj = qB ( Dh , Di ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"Dk",f:["float"],e:!1},{a:"node_in",c:"Dl",f:["float"],e:!1},{a:"node_in",
c:"Dm",f:["float"],e:!1},{a:"node_in",c:"Dn",f:["float"],e:!1},{a:"node_in",c:"Do",f:["float"],e:!1},{a:"node_out",c:"Dp",f:["float"],e:!0},{a:"node_out",c:"Dq",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dp"],j:[{a:"txt",b:["Dp","=","Dk",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = vec4 ( Dl , Dm , Dn , Do ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Dr",f:["float"],e:!1}],j:[{a:"txt",b:["Dr","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",m:[],l:[{a:"node_in",c:"Ds",f:["float"],e:!1},{a:"node_in",c:"Dt",f:["float"],e:!1},{a:"node_in",c:"Du",f:["float"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!1}],j:[{a:"txt",b:"Dv = smoothstep ( Dt , Du , Ds ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["float"],e:!1}],j:[{a:"txt",b:"v = Dw ; D = Dx ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",
f:["float"],e:!1}],j:[{a:"txt",b:"Dz = ( Dy . r + Dy . g + Dy . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"DA",f:["float"],e:!1},{a:"node_out",c:"DB",f:["vec3"],e:!1}],j:[{a:"txt",b:"DB [ 0 ] = DA ; DB [ 1 ] = DA ; DB [ 2 ] = DA ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void E ( in vec3 nv , out vec3 v , out vec3 A , out vec3 B , out vec4 C , out float D ) { v = vec3 ( _0_0 ) ; A = vec3 ( _0_0 ) ; B = vec3 ( _0_0 ) ; C = vec4 ( _0_0 ) ; D = _0_0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 L = normalize ( e ) ; vec3 bC = L ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bC = bC ; else bC = - bC ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nu","=","bC",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nu","=","L",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","qW","=","bC",
";"]}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = cross ( bC , f . xyz ) * f . w ; N = normalize ( N ) ; vec3 M = cross ( N , bC ) * f . w ; mat3 qX = mat3 ( M , N , bC ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nt = c ; vec4 qY = d ; float qZ = u_emit ; float q_ = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"NODES_GLSLV",b:[""]},{a:"var",
c:"PARTICLE_BATCH",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qy ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qQ",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qQ","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qP",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qP","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_param",c:"node_UVMAP_var_a_uv",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qR",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qR","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"qJ",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["qJ","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"DC",f:["GLSL_OUT","vec3"],e:!1}],j:[{a:"txt",b:["DC","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",f:["GLSL_IN","float"],e:!1},{a:"node_param",
c:"DD",f:["GLSL_OUT","float"],e:!1}],j:[{a:"txt",b:["DD","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",f:["GLSL_IN","vec2"],e:!1},{a:"node_param",c:"DE",f:["GLSL_OUT","vec2"],e:!1}],j:[{a:"txt",b:["DE","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",f:["GLSL_IN","vec3"],e:!1},{a:"node_param",c:"DF",f:["GLSL_OUT",
"vec3"],e:!1}],j:[{a:"txt",b:["DF","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","E","(",")","{"]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["qy","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PACK_GLSLF",h:{a:"grp",d:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fP ( const in float hx ) { vec4 eD = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 DG = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iP = fract ( hx * eD ) ; iP -= iP . xxyz * DG ; return iP ; } float cs ( const in vec4 DH ) { float fK ; vec4 eD = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fK = dot ( DH , eD ) ; return fK ; } vec4 fP ( const in vec2 gG ) { vec2 eD = vec2 ( _255_0 , _1_0 ) ; vec2 DG = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iP = fract ( gG . xxyy * eD . xyxy ) ; iP -= iP . xxzz * DG . xyxy ; if ( gG . r == _1_0 ) iP . rg = vec2 ( _0_0 , _1_0 ) ; if ( gG . g == _1_0 ) iP . ba = vec2 ( _0_0 , _1_0 ) ; return iP ; } vec2 iu ( const in vec4 DI ) { vec2 gG ; vec2 eD = vec2 ( _1_0 / _255_0 , _1_0 ) ; gG . r = dot ( DI . rg , eD ) ; gG . g = dot ( DI . ba , eD ) ; return gG ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",o:"math.glslv"},{a:"txt",b:"struct cA { float cJ ; vec3 I ; float F ; vec3 aD ; float bj ; vec3 cP ; vec3 cQ ; float cR ; } ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"void DM ( inout vec3 aD , float DJ , vec4 jp , vec4 jq ) { float DK = jq . x - jp . x ; float DL = ( DJ - jp . x ) / DK ; aD = mix ( aD , jq . yzw , clamp ( DL , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 DP ( float t , float DN , vec4 DO [ COLOR_RAMP_LENGTH ] ) { float DJ = t / DN ; vec3 aD = DO [ 0 ] . yzw ;".split(" ")},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],
h:{a:"grp",d:[{a:"txt",b:"DM ( aD , DJ , DO [ 0 ] , DO [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"DM ( aD , DJ , DO [ 1 ] , DO [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"DM ( aD , DJ , DO [ 2 ] , DO [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aD",";","}"]}]}}]},{a:"txt",b:"float DV ( float t , float DN , float DQ , float DR ) { float DS = max ( 0.01 , min ( DN , DQ ) ) ; float DT = max ( 0.01 , min ( DN , DR ) ) ; float DU = DN - DT ; float F = clamp ( t / DS , 0.0 , 1.0 ) - step ( DU , t ) * ( t - DU ) / DT ; return F ; } cA cB ( ) { cA sp ; float t ; float DN = a_p_data [ 0 ] ; float DW = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - DW ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - DW ; } if ( t < 0.0 || t >= DN ) { sp . cJ = 0.0001 ; sp . I = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= DN ) ) { vec3 bw = J ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["WORLD_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 eA = a_position ; vec3 qF = bw ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 eA = Y ( u_model_tsr , a_position ) ; vec3 qF = P ( u_model_tsr , bw ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 DX = u_p_nfactor * qF ; DX += a_p_vels . xyz ; DX . z -= u_p_gravity * t / 2.0 ; float DY = max ( u_p_mass , EPSILON ) ; DX += ( u_p_wind_fac * u_wind / DY ) * t / 2.0 ; sp . cR = t ; sp . cP = DX ; sp . cQ = bw * a_p_vels . w ; sp . I = eA + DX * t ; sp . bj = a_p_vels . w * t ;".split(" ")},
{a:"cond",d:[{a:"if",g:["USE_COLOR_RAMP"],h:{a:"grp",d:[{a:"txt",b:"sp . cJ = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . cJ = 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"sp . aD = DP ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sp . aD = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . F = DV ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",d:[{a:"if",g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",i:2}],h:{a:"grp",
d:[{a:"include",o:"environment.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"include",o:"math.glslv"},{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jv ( vec3 rgb ) { vec4 ju = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , ju . wz ) , vec4 ( rgb . gb , ju . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float dc = q . x - min ( q . w , q . y ) ; float hN = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * dc + hN ) ) , dc / ( q . x + hN ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",d:[{a:"txt",b:"vec3 jx ( vec3 jw ) { vec4 ju = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jw . r , jw . r , jw . r ) + ju . xyz ) * 6.0 - ju . www ) ; return jw . b * mix ( ju . xxx , clamp ( p - ju . xxx , _0_0 , _1_0 ) , jw . g ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec3 qC ( vec2 gi ) { return vec3 ( gi * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"txt",b:"vec2 qD ( vec3 gG ) { return vec2 ( gG . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
m:[],l:[{a:"node_out",c:"rc",f:["vec3"],e:!0},{a:"node_out",c:"rd",f:["float"],e:!0},{a:"node_out",c:"re",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rc"],j:[{a:"txt",b:"rc = normalize ( qY . xyz ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rd"],j:[{a:"txt",b:"rd = abs ( qY . z ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_re"],j:[{a:"txt",b:"re = length ( qY . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",m:[],l:[{a:"node_in",c:"rf",f:["float"],
e:!1},{a:"node_in",c:"rh",f:["float"],e:!1},{a:"node_in",c:"ri",f:["float"],e:!1},{a:"node_out",c:"rj",f:["vec3"],e:!1}],j:[{a:"txt",b:"rj = vec3 ( rf , rh , ri ) ;".split(" ")}]},{a:"node",c:"COMBHSV",m:[],l:[{a:"node_in",c:"rk",f:["float"],e:!1},{a:"node_in",c:"rl",f:["float"],e:!1},{a:"node_in",c:"rm",f:["float"],e:!1},{a:"node_out",c:"rn",f:["vec3"],e:!1}],j:[{a:"txt",b:"rn = jx ( vec3 ( rk , rl , rm ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",m:[],l:[{a:"node_out",c:"ro",f:["vec3"],e:!1}],j:[{a:"txt",
b:"ro = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",m:[],l:[{a:"node_out",c:"rp",f:["vec3"],e:!1}],j:[{a:"txt",b:"rp = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[{a:"node_out",c:"rq",f:["vec3"],e:!1}],j:[{a:"txt",b:"rq = qC ( n ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",m:[],l:[{a:"node_out",c:"rs",f:["vec3"],e:!1}],j:[{a:"txt",b:"rs = 2.0 * vec3 ( n , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",m:[],l:[{a:"node_out",c:"rt",
f:["vec3"],e:!1}],j:[{a:"txt",b:"rt = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",m:[],l:[{a:"node_out",c:"ru",f:["float"],e:!1}],j:[{a:"txt",b:["ru","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",m:[],l:[{a:"node_out",c:"rv",f:["float"],e:!1},{a:"node_out",c:"rw",f:["float"],e:!1}],j:[{a:"txt",b:"rv = _1_0 ; rw = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",m:[],l:[{a:"node_out",c:"rx",f:["float"],e:!1},{a:"node_out",c:"ry",f:["float"],e:!1},{a:"node_out",c:"rz",f:["float"],e:!1}],
j:[{a:"txt",b:"rx = _1_0 ; ry = _1_0 ; rz = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",m:[],l:[{a:"node_out",c:"rA",f:["vec3"],e:!1}],j:[{a:"txt",b:"rA = qW . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_FB",m:[],l:[{a:"node_out",c:"rB",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"rB = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"rB = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},
{a:"node",c:"GEOMETRY_VW",m:[],l:[{a:"node_out",c:"rD",f:["vec3"],e:!1}],j:[{a:"txt",b:"rD = - P ( u_view_tsr_frag , nv ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",m:[],l:[{a:"node_out",c:"rE",f:["vec3"],e:!1}],j:[{a:"txt",b:"rE [ 0 ] = qY [ 0 ] ; rE [ 1 ] = qY [ 1 ] ; rE [ 2 ] = qY [ 2 ] ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",m:[],l:[{a:"node_out",c:"rF",f:["vec3"],e:!1}],j:[{a:"txt",b:"rF = vec3 ( nt . r , nt . g , nt . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",m:[],l:[{a:"node_out",
c:"rH",f:["vec3"],e:!1},{a:"node_out",c:"rI",f:["vec3"],e:!1},{a:"node_out",c:"rJ",f:["vec3"],e:!1},{a:"node_out",c:"rK",f:["vec3"],e:!1},{a:"node_out",c:"rL",f:["vec3"],e:!1},{a:"node_out",c:"rM",f:["vec3"],e:!1},{a:"node_out",c:"rN",f:["float"],e:!1},{a:"node_out",c:"rO",f:["float"],e:!1}],j:[{a:"txt",b:"rH = vec3 ( _0_0 ) ; rI = vec3 ( _0_0 ) ; rJ = vec3 ( _0_0 ) ; rK = vec3 ( _0_0 ) ; rL = vec3 ( _0_0 ) ; rM = vec3 ( _0_0 ) ; rN = _0_0 ; rO = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",m:[],l:[{a:"node_in",
c:"rP",f:["float"],e:!1},{a:"node_in",c:"rQ",f:["float"],e:!1},{a:"node_in",c:"rR",f:["float"],e:!1},{a:"node_in",c:"rS",f:["float"],e:!1},{a:"node_in",c:"rT",f:["vec3"],e:!1},{a:"node_out",c:"rU",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 jw = jv ( rT ) ; jw [ 0 ] += ( rP - _0_5 ) ; if ( jw [ 0 ] > _1_0 ) jw [ 0 ] -= _1_0 ; else if ( jw [ 0 ] < _0_0 ) jw [ 0 ] += _1_0 ; jw *= vec3 ( _1_0 , rQ , rR ) ; jw = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jw , step ( vec3 ( _0_0 ) , jw ) ) , step ( jw , vec3 ( _1_0 ) ) ) ; rU = mix ( rT , jx ( jw ) , rS ) ;".split(" ")}]},
{a:"node",c:"INVERT",m:[],l:[{a:"node_in",c:"rV",f:["float"],e:!1},{a:"node_in",c:"rW",f:["vec3"],e:!1},{a:"node_out",c:"rX",f:["vec3"],e:!1}],j:[{a:"txt",b:"rX = mix ( rW , vec3 ( _1_0 ) - rW , rV ) ;".split(" ")}]},{a:"node",c:"LAMP",m:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],l:[{a:"node_out",
c:"rY",f:["vec3"],e:!0},{a:"node_out",c:"rZ",f:["vec3"],e:!1},{a:"node_out",c:"r_",f:["float"],e:!1},{a:"node_out",c:"sa",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rY"],j:[{a:"txt",b:"rY = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sb = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 sc = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"rZ = - c + sc ; r_ = length ( rZ ) ; rZ = normalize ( rZ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sa"],j:[{a:"txt",b:"sa = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + r_ * r_ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"float nZ = dot ( rZ , sb ) ; nZ *= smoothstep ( _0_0 , _1_0 , ( nZ - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; sa *= nZ ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",
g:["LAMP_USE_SPHERE"],j:[{a:"txt",b:"sa *= max ( LAMP_LIGHT_DIST - r_ , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_rZ"],j:[{a:"txt",b:["rZ","=","sb",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_r_"],j:[{a:"txt",b:"r_ = length ( sc - c ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sa"],j:[{a:"txt",b:["sa","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",m:[],l:[{a:"node_in",c:"sd",f:["vec3"],e:!1},{a:"node_out",
c:"se",f:["vec3"],e:!0},{a:"node_out",c:"sf",f:["float"],e:!0},{a:"node_param",c:"qO",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_se"],j:[{a:"txt",b:["se","=","qO",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_sf"],j:[{a:"txt",b:"sf = - dot ( sd , qO ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",m:[],l:[{a:"node_in",c:"sg",f:["vec3"],e:!1},{a:"node_out",c:"sh",f:["vec3"],e:!1}],j:[{a:"txt",b:"sh = - P ( u_view_tsr_frag , sg ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
m:[],l:[{a:"node_in",c:"si",f:["vec3"],e:!1},{a:"node_in",c:"sj",f:["vec3"],e:!1},{a:"node_in",c:"sk",f:["float"],e:!1},{a:"node_in",c:"sl",f:["vec3"],e:!1},{a:"node_in",c:"sm",f:["float"],e:!1},{a:"node_in",c:"sn",f:["float"],e:!1},{a:"node_in",c:"so",f:["vec3"],e:!1},{a:"node_out",c:"sr",f:["vec3"],e:!1},{a:"node_out",c:"su",f:["vec3"],e:!1},{a:"node_out",c:"sv",f:["vec3"],e:!1},{a:"node_out",c:"sw",f:["vec3"],e:!1},{a:"node_out",c:"sx",f:["vec3"],e:!1},{a:"node_out",c:"sy",f:["vec4"],e:!1},{a:"node_out",
c:"sz",f:["vec4"],e:!1},{a:"node_out",c:"sA",f:["vec3"],e:!1},{a:"node_out",c:"sB",f:["float"],e:!1}],j:[{a:"txt",b:"sv = sj ; sw = sl ; sx = so ; sA = sl ; sB = sn ; sr = qZ * sv ; su = q_ * u_environment_energy * cb ( sx ) ; sz = ce ( sv ) ; C = sz ; sy [ 0 ] = sk ; sy [ 1 ] = sm ; sy [ 2 ] = sn ;".split(" ")}]},{a:"node",c:"BSDF_END",m:[],l:[{a:"node_in",c:"sC",f:["vec4"],e:!1},{a:"node_in",c:"sD",f:["vec3"],e:!1},{a:"node_in",c:"sE",f:["vec3"],e:!1},{a:"node_in",c:"sF",f:["vec3"],e:!1},{a:"node_in",
c:"sG",f:["float"],e:!1}],j:[{a:"txt",b:"v = sC . rgb + sD ; sE ;".split(" ")}]},{a:"node",c:"BSDF_COMPUTE",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"sH",f:["vec3"],e:!1},{a:"node_in",c:"sI",f:["vec2"],e:!1},{a:"node_in",c:"sJ",f:["vec3"],e:!1},{a:"node_in",c:"sK",f:["float"],e:!1},{a:"node_in",c:"sL",f:["vec4"],e:!1},{a:"node_out",c:"sM",f:["float"],e:!1},{a:"node_out",c:"sN",f:["float"],e:!1}],j:[{a:"txt",b:"vec3 qF = sJ ; float sO = clamp ( sL [ 0 ] , _0_0 , _1_0 ) ; float sP = clamp ( sL [ 1 ] , _0_0 , _1_0 ) ; float qw = sL [ 2 ] ; vec3 oU = normalize ( nv + sH ) ; float og = ( _1_0 - sK ) * dot ( qF , sH ) + sK ; float sQ = ( _1_0 - sK ) * max ( dot ( sH , oU ) , _0_0 ) + sK ; float sR = ( _1_0 - sK ) * max ( dot ( sJ , oU ) , _0_0 ) + sK ; sM = _0_0 ; if ( sI . r != _0_0 ) { if ( sO > _0_0 ) { float os = max ( dot ( qF , nv ) , _0_0 ) ; float ot = sO * sO ; float cd = _1_0 - _0_5 * ( ot / ( ot + 0.33 ) ) ; vec3 ou = sH - og * qF ; vec3 ov = nv - os * qF ; if ( length ( ou ) == _0_0 || length ( ov ) == _0_0 || abs ( og ) > _1_0 || abs ( os ) > _1_0 ) sM = og * cd ; else { float ow = acos ( og ) ; float ox = acos ( os ) ; vec3 oy = normalize ( ou ) ; vec3 oz = normalize ( ov ) ; float a , b ; a = max ( ow , ox ) ; b = min ( ow , ox ) ; b *= 0.95 ; float t = max ( dot ( oy , oz ) , _0_0 ) ; float oA = 0.45 * ( ot / ( ot + 0.09 ) ) ; sM = og * ( cd + ( oA * t * sin ( a ) * tan ( b ) ) ) ; } } else sM = og ; sM = max ( sM , _0_0 ) ; } float F = sP ; float sS = F * F ; float sT = ( sR * sS - sR ) * sR + _1_0 ; float ca = sS / ( M_PI * sT * sT ) ; float sU ; float sV ; float sW = pow ( _1_0 - sQ , 5.0 ) ; sU = _1_0 ; sV = sW ; float ju = F / 2.0 ; float sX = ju * ju ; float sY = _1_0 - sX ; float sZ = _1_0 / ( sQ * sQ * sY + sX ) ; sU *= sZ ; sV *= sZ ; float s_ = mix ( 0.04 , _1_0 , qw ) ; float ta = mix ( sV , sU , s_ ) ; sN = max ( og * ca * ta , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",m:[],l:[{a:"node_in",c:"tb",f:["vec3"],e:!1},{a:"node_in",c:"tc",f:["float"],e:!1},{a:"node_in",c:"td",f:["float"],e:!1},{a:"node_in",c:"te",f:["float"],e:!1},{a:"node_in",c:"tf",f:["vec3"],e:!1},{a:"node_in",c:"tg",f:["vec3"],e:!1},{a:"node_out",c:"th",f:["vec3"],e:!1}],j:[{a:"txt",b:"th = tb ; tc ; td ; te ; tf ; tg ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"ti",f:["vec3"],e:!1},{a:"node_in",c:"tj",f:["float"],
e:!1},{a:"node_in",c:"tk",f:["vec3"],e:!1},{a:"node_out",c:"tl",f:["vec3"],e:!1},{a:"node_out",c:"tm",f:["vec3"],e:!1},{a:"node_out",c:"tn",f:["float"],e:!1},{a:"node_out",c:"to",f:["vec3"],e:!1},{a:"node_out",c:"tr",f:["float"],e:!1},{a:"node_out",c:"tu",f:["float"],e:!1},{a:"node_out",c:"tv",f:["vec3"],e:!1}],j:[{a:"txt",b:"tm = ti ; tn = tj ; tu = _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["tv","=","tk",";"]}]},{a:"node_else",j:[{a:"txt",b:["tv","=","nu",
";"]}]}]},{a:"txt",b:"tl ; to ; tr ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",m:[],l:[{a:"node_in",c:"tw",f:["vec3"],e:!1},{a:"node_in",c:"tx",f:["float"],e:!1},{a:"node_in",c:"ty",f:["float"],e:!1},{a:"node_in",c:"tz",f:["vec3"],e:!1},{a:"node_out",c:"tA",f:["vec3"],e:!1}],j:[{a:"txt",b:"tA = tw ; tx ; ty ; tz ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",m:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],l:[{a:"node_in",c:"tB",f:["vec3"],e:!1},{a:"node_in",c:"tC",f:["float"],e:!1},{a:"node_in",c:"tD",f:["vec3"],
e:!1},{a:"node_out",c:"tE",f:["vec3"],e:!1},{a:"node_out",c:"tF",f:["vec3"],e:!1},{a:"node_out",c:"tG",f:["float"],e:!1},{a:"node_out",c:"tH",f:["vec3"],e:!1},{a:"node_out",c:"tI",f:["float"],e:!1},{a:"node_out",c:"tJ",f:["float"],e:!1},{a:"node_out",c:"tK",f:["vec3"],e:!1}],j:[{a:"txt",b:"tH = tB ; tI = tC ; tJ = _1_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_NORMAL_IN"],j:[{a:"txt",b:["tK","=","tD",";"]}]},{a:"node_else",j:[{a:"txt",b:["tK","=","nu",";"]}]}]},{a:"txt",b:"tE ; tF ; tG ;".split(" ")}]},
{a:"node",c:"BSDF_HAIR",m:[],l:[{a:"node_in",c:"tL",f:["vec3"],e:!1},{a:"node_in",c:"tM",f:["float"],e:!1},{a:"node_in",c:"tN",f:["float"],e:!1},{a:"node_in",c:"tO",f:["float"],e:!1},{a:"node_out",c:"tP",f:["vec3"],e:!1}],j:[{a:"txt",b:"tP = tL ; tM ; tN ; tO ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",m:[],l:[{a:"node_in",c:"tQ",f:["vec3"],e:!1},{a:"node_out",c:"tR",f:["vec3"],e:!1}],j:[{a:"txt",b:["tR","=","tQ",";"]}]},{a:"node",c:"BSDF_TRANSLUCENT",m:[],l:[{a:"node_in",c:"tS",f:["vec3"],e:!1},
{a:"node_in",c:"tT",f:["vec3"],e:!1},{a:"node_out",c:"tU",f:["vec3"],e:!1}],j:[{a:"txt",b:"tU = tS ; tT ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",m:[],l:[{a:"node_in",c:"tV",f:["vec3"],e:!1},{a:"node_in",c:"tW",f:["float"],e:!1},{a:"node_in",c:"tX",f:["float"],e:!1},{a:"node_in",c:"tY",f:["vec3"],e:!1},{a:"node_out",c:"tZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"tZ [ 0 ] = tZ [ 1 ] = tZ [ 2 ] = _0_0 ; tV ; tW ; tX ; tY ;".split(" ")}]},{a:"node",c:"BSDF_TOON",m:[],l:[{a:"node_in",c:"t_",f:["vec3"],
e:!1},{a:"node_in",c:"ua",f:["float"],e:!1},{a:"node_in",c:"ub",f:["float"],e:!1},{a:"node_in",c:"uc",f:["vec3"],e:!1},{a:"node_out",c:"ud",f:["vec3"],e:!1}],j:[{a:"txt",b:"ud = t_ ; ua ; ub ; uc ;".split(" ")}]},{a:"node",c:"BSDF_VELVET",m:[],l:[{a:"node_in",c:"ue",f:["vec3"],e:!1},{a:"node_in",c:"uf",f:["float"],e:!1},{a:"node_in",c:"ug",f:["vec3"],e:!1},{a:"node_out",c:"uh",f:["vec3"],e:!1}],j:[{a:"txt",b:"uh = ue ; uf ; ug ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",m:[],l:[{a:"node_in",
c:"ui",f:["vec3"],e:!1},{a:"node_in",c:"uj",f:["float"],e:!1},{a:"node_in",c:"uk",f:["vec3"],e:!1},{a:"node_in",c:"ul",f:["float"],e:!1},{a:"node_in",c:"um",f:["float"],e:!1},{a:"node_in",c:"un",f:["vec3"],e:!1},{a:"node_out",c:"uo",f:["vec3"],e:!1}],j:[{a:"txt",b:"uo [ 0 ] = uo [ 1 ] = uo [ 2 ] = _0_0 ; ui ; uk ; ul ; um ; un ; uj ;".split(" ")}]},{a:"node",c:"EMISSION",m:[],l:[{a:"node_in",c:"up",f:["vec3"],e:!1},{a:"node_in",c:"uq",f:["float"],e:!1},{a:"node_out",c:"ur",f:["vec3"],e:!1}],j:[{a:"txt",
b:"ur = up ; uq ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",m:[],l:[{a:"node_in",c:"us",f:["vec3"],e:!1},{a:"node_out",c:"ut",f:["vec3"],e:!1}],j:[{a:"txt",b:"ut [ 0 ] = ut [ 1 ] = ut [ 2 ] = _0_0 ; us ;".split(" ")}]},{a:"node",c:"HOLDOUT",m:[],l:[{a:"node_out",c:"uu",f:["vec3"],e:!1}],j:[{a:"txt",b:"uu [ 0 ] = uu [ 1 ] = uu [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",m:[],l:[{a:"node_in",c:"uv",f:["vec3"],e:!1},{a:"node_in",c:"uw",f:["float"],e:!1},{a:"node_out",c:"ux",f:["vec3"],
e:!1}],j:[{a:"txt",b:"ux [ 0 ] = ux [ 1 ] = ux [ 2 ] = _0_0 ; uv ; uw ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",m:[],l:[{a:"node_in",c:"uy",f:["vec3"],e:!1},{a:"node_in",c:"uz",f:["float"],e:!1},{a:"node_in",c:"uA",f:["float"],e:!1},{a:"node_out",c:"uB",f:["vec3"],e:!1}],j:[{a:"txt",b:"uB [ 0 ] = uB [ 1 ] = uB [ 2 ] = _0_0 ; uy ; uz ; uA ;".split(" ")}]},{a:"node",c:"BUMP",m:[],l:[{a:"node_in",c:"Ec",f:["float"],e:!1},{a:"node_in",c:"Ed",f:["float"],e:!1},{a:"node_in",c:"uE",f:["float"],e:!1},
{a:"node_in",c:"Ee",f:["vec3"],e:!1},{a:"node_out",c:"uG",f:["vec3"],e:!1}],j:[{a:"txt",b:"uG = Ee ; Ec ; Ed ; uE ;".split(" ")}]},{a:"node",c:"NORMAL_MAP",m:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]}],l:[{a:"node_in",c:"uN",f:["float"],e:!1},{a:"node_in",c:"uO",f:["vec3"],e:!1},{a:"node_out",c:"uP",f:["vec3"],e:!1}],j:[{a:"txt",b:["vec3","uQ","=","nu",";"]},{a:"node_cond",d:[{a:"node_if",g:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uP = qX * ( uO . xyz - _0_5 ) ;".split(" ")}]},{a:"node_elif",
g:["SPACE","NM_OBJECT",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"uP = uO . xyz - _0_5 ; uP . yz *= - 1.0 ; uP = P ( u_model_tsr , uP ) ;".split(" ")}]},{a:"node_elif",g:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"uP = uO . xyz - _0_5 ; uP . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"uP = normalize ( mix ( uQ , uP , uN ) ) ;".split(" ")}]},{a:"node",
c:"VECT_TRANSFORM",m:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],l:[{a:"node_in",c:"uR",f:["vec3"],e:!1},{a:"node_out",c:"uS",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["uS","=","uR",";"]}]},{a:"node_else",j:[{a:"node_cond",
d:[{a:"node_if",g:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_view_tsr_frag , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_model_tsr_inverse , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_model_tsr , uR ) ;".split(" ")}]},
{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_model_tsr , uR ) ; uS = Y ( u_view_tsr_frag , uS ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_view_tsr_inverse , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = Y ( u_view_tsr_inverse , uR ) ; uS = Y ( u_model_tsr_inverse , uS ) ;".split(" ")}]}]}]},{a:"node_else",
j:[{a:"node_cond",d:[{a:"node_if",g:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_view_tsr_frag , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_model_tsr_inverse , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_model_tsr , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",
i:2}],j:[{a:"txt",b:"uS = P ( u_model_tsr , uR ) ; uS = P ( u_view_tsr_frag , uS ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_view_tsr_inverse , uR ) ;".split(" ")}]},{a:"node_elif",g:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"uS = P ( u_view_tsr_inverse , uR ) ; uS = P ( u_model_tsr_inverse , uS ) ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",
i:2}],j:[{a:"txt",b:"uS = normalize ( uS ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",m:[],l:[{a:"node_in",c:"uT",f:["float"],e:!1},{a:"node_out",c:"uU",f:["vec3"],e:!1}],j:[{a:"txt",b:"uU [ 0 ] = uU [ 1 ] = uU [ 2 ] = _0_0 ; uT ;".split(" ")}]},{a:"node",c:"WAVELENGTH",m:[],l:[{a:"node_in",c:"uV",f:["float"],e:!1},{a:"node_out",c:"uW",f:["vec3"],e:!1}],j:[{a:"txt",b:"uW [ 0 ] = uW [ 1 ] = uW [ 2 ] = _0_0 ; uV ;".split(" ")}]},{a:"node",c:"SEPXYZ",m:[],l:[{a:"node_in",c:"uX",f:["vec3"],e:!1},
{a:"node_out",c:"uY",f:["float"],e:!1},{a:"node_out",c:"uZ",f:["float"],e:!1},{a:"node_out",c:"u_",f:["float"],e:!1}],j:[{a:"txt",b:"uY = uX [ 0 ] ; uZ = uX [ 1 ] ; u_ = uX [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",m:[],l:[{a:"node_in",c:"va",f:["float"],e:!1},{a:"node_in",c:"vb",f:["float"],e:!1},{a:"node_in",c:"vc",f:["float"],e:!1},{a:"node_out",c:"vd",f:["vec3"],e:!1}],j:[{a:"txt",b:"vd [ 0 ] = va ; vd [ 1 ] = vb ; vd [ 2 ] = vc ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",m:[],l:[{a:"node_in",
c:"ve",f:["vec3"],e:!1},{a:"node_in",c:"vf",f:["float"],e:!1},{a:"node_in",c:"vg",f:["float"],e:!1},{a:"node_out",c:"vh",f:["vec3"],e:!1}],j:[{a:"txt",b:"float b = vf - vg * _0_5 ; vh = max ( ( _1_0 + vg ) * ve + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",m:[],l:[{a:"node_in",c:"vi",f:["float"],e:!1},{a:"node_in",c:"vj",f:["float"],e:!1},{a:"node_out",c:"vk",f:["float"],e:!1},{a:"node_out",c:"vl",f:["float"],e:!1},{a:"node_out",c:"vm",f:["float"],e:!1}],j:[{a:"txt",b:"vk = vl = vm = _0_0 ; vi ; vj ;".split(" ")}]},
{a:"node",c:"TEX_IMAGE",m:[],l:[{a:"node_in",c:"Ef",f:["vec3"],e:!1},{a:"node_out",c:"Eg",f:["vec3"],e:!1},{a:"node_out",c:"Eh",f:["float"],e:!1}],j:[{a:"txt",b:"Eg [ 0 ] = Eg [ 1 ] = Eg [ 2 ] = _0_0 ; Eh = _1_0 ; Ef ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",m:[],l:[{a:"node_in",c:"Ei",f:["vec3"],e:!1},{a:"node_out",c:"Ej",f:["vec3"],e:!1}],j:[{a:"txt",b:"Ej [ 0 ] = Ej [ 1 ] = Ej [ 2 ] = _0_0 ; Ei ;".split(" ")}]},{a:"node",c:"TEX_SKY",m:[],l:[{a:"node_in",c:"vn",f:["vec3"],e:!1},{a:"node_out",
c:"vo",f:["vec3"],e:!1}],j:[{a:"txt",b:"vo [ 0 ] = vo [ 1 ] = vo [ 2 ] = _0_0 ; vn ;".split(" ")}]},{a:"node",c:"TEX_NOISE",m:[],l:[{a:"node_in",c:"vp",f:["vec3"],e:!1},{a:"node_in",c:"vq",f:["float"],e:!1},{a:"node_in",c:"vr",f:["float"],e:!1},{a:"node_in",c:"vs",f:["float"],e:!1},{a:"node_out",c:"vt",f:["vec3"],e:!1},{a:"node_out",c:"vu",f:["float"],e:!1}],j:[{a:"txt",b:"vt [ 0 ] = vt [ 1 ] = vt [ 2 ] = _0_0 ; vu = _1_0 ; vp ; vq ; vr ; vs ;".split(" ")}]},{a:"node",c:"TEX_WAVE",m:[],l:[{a:"node_in",
c:"vv",f:["vec3"],e:!1},{a:"node_in",c:"vw",f:["float"],e:!1},{a:"node_in",c:"vx",f:["float"],e:!1},{a:"node_in",c:"vy",f:["float"],e:!1},{a:"node_in",c:"vz",f:["float"],e:!1},{a:"node_out",c:"vA",f:["vec3"],e:!1},{a:"node_out",c:"vB",f:["float"],e:!1}],j:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vB = _1_0 ; vv ; vw ; vx ; vy ; vz ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",m:[],l:[{a:"node_in",c:"vC",f:["vec3"],e:!1},{a:"node_in",c:"vD",f:["float"],e:!1},{a:"node_out",c:"vE",f:["vec3"],
e:!1},{a:"node_out",c:"vF",f:["float"],e:!1}],j:[{a:"txt",b:"vE [ 0 ] = vE [ 1 ] = vE [ 2 ] = _0_0 ; vF = _1_0 ; vC ; vD ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",m:[],l:[{a:"node_in",c:"vG",f:["vec3"],e:!1},{a:"node_in",c:"vH",f:["float"],e:!1},{a:"node_in",c:"vI",f:["float"],e:!1},{a:"node_in",c:"vJ",f:["float"],e:!1},{a:"node_in",c:"vK",f:["float"],e:!1},{a:"node_in",c:"vL",f:["float"],e:!1},{a:"node_in",c:"vM",f:["float"],e:!1},{a:"node_out",c:"vN",f:["vec3"],e:!1},{a:"node_out",c:"vO",f:["float"],
e:!1}],j:[{a:"txt",b:"vN [ 0 ] = vN [ 1 ] = vN [ 2 ] = _0_0 ; vO = _1_0 ; vG ; vH ; vI ; vJ ; vK ; vL ; vM ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",m:[],l:[{a:"node_in",c:"vP",f:["vec3"],e:!1},{a:"node_out",c:"vQ",f:["vec3"],e:!1},{a:"node_out",c:"vR",f:["float"],e:!1}],j:[{a:"txt",b:"vQ [ 0 ] = vQ [ 1 ] = vQ [ 2 ] = _0_0 ; vR = _1_0 ; vP ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",m:[],l:[{a:"node_in",c:"vS",f:["vec3"],e:!1},{a:"node_in",c:"vT",f:["float"],e:!1},{a:"node_in",c:"vU",f:["float"],e:!1},
{a:"node_out",c:"vV",f:["vec3"],e:!1},{a:"node_out",c:"vW",f:["float"],e:!1}],j:[{a:"txt",b:"vV [ 0 ] = vV [ 1 ] = vV [ 2 ] = _0_0 ; vW = _1_0 ; vS ; vT ; vU ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",m:[],l:[{a:"node_in",c:"vX",f:["vec3"],e:!1},{a:"node_in",c:"vY",f:["vec3"],e:!1},{a:"node_in",c:"vZ",f:["vec3"],e:!1},{a:"node_in",c:"v_",f:["float"],e:!1},{a:"node_out",c:"wa",f:["vec3"],e:!1},{a:"node_out",c:"wb",f:["float"],e:!1}],j:[{a:"txt",b:"wa [ 0 ] = wa [ 1 ] = wa [ 2 ] = _0_0 ; wb = _1_0 ; vX ; vY ; vZ ; v_ ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",m:[],l:[{a:"node_in",c:"wc",f:["vec3"],e:!1},{a:"node_in",c:"wd",f:["vec3"],e:!1},{a:"node_in",c:"we",f:["vec3"],e:!1},{a:"node_in",c:"wf",f:["vec3"],e:!1},{a:"node_in",c:"wg",f:["float"],e:!1},{a:"node_in",c:"wh",f:["float"],e:!1},{a:"node_in",c:"wi",f:["float"],e:!1},{a:"node_in",c:"wj",f:["float"],e:!1},{a:"node_in",c:"wk",f:["float"],e:!1},{a:"node_out",c:"wl",f:["vec3"],e:!1},{a:"node_out",c:"wm",f:["float"],e:!1}],j:[{a:"txt",b:"wl [ 0 ] = wl [ 1 ] = wl [ 2 ] = _0_0 ; wm = _1_0 ; wc ; wd ; we ; wf ; wg ; wh ; wi ; wj ; wk ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",m:[],l:[{a:"node_in",c:"wn",f:["vec3"],e:!1},{a:"node_in",c:"wo",f:["vec3"],e:!1},{a:"node_out",c:"wp",f:["vec3"],e:!1}],j:[{a:"txt",b:"wp = clamp ( wn + wo , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",m:[],l:[{a:"node_in",c:"wq",f:["float"],e:!1},{a:"node_in",c:"wr",f:["vec3"],e:!1},{a:"node_in",c:"ws",f:["vec3"],e:!1},{a:"node_in",c:"wt",f:["vec3"],e:!1},{a:"node_in",c:"wu",f:["float"],e:!1},{a:"node_in",c:"wv",f:["vec3"],e:!1},{a:"node_in",
c:"wA",f:["float"],e:!1},{a:"node_in",c:"wB",f:["float"],e:!1},{a:"node_in",c:"wC",f:["vec3"],e:!1},{a:"node_in",c:"wD",f:["vec3"],e:!1},{a:"node_in",c:"wE",f:["float"],e:!1},{a:"node_in",c:"wF",f:["vec3"],e:!1},{a:"node_in",c:"wG",f:["float"],e:!1},{a:"node_in",c:"wH",f:["float"],e:!1},{a:"node_in",c:"wI",f:["vec3"],e:!1},{a:"node_out",c:"wJ",f:["vec3"],e:!1},{a:"node_out",c:"wK",f:["vec3"],e:!1},{a:"node_out",c:"wL",f:["float"],e:!1},{a:"node_out",c:"wM",f:["vec3"],e:!1},{a:"node_out",c:"wN",f:["float"],
e:!1},{a:"node_out",c:"wO",f:["float"],e:!1},{a:"node_out",c:"wP",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( wq , _0_0 , _1_0 ) ; wK = mix ( wt , wD , wQ ) ; wL = mix ( wu , wE , wQ ) ; if ( wB > _0_0 ) { if ( wH > _0_0 ) { wM = mix ( wv , wF , wQ ) ; wN = mix ( wA , wG , wQ ) ; } else { wM = wv ; wN = wA ; } } else { wM = wF ; wN = wG ; } wO = mix ( wB , wH , wQ ) ; wP = mix ( wC , wI , wQ ) ;".split(" ")}]},{a:"node",c:"UV_MERGED",m:[],l:[{a:"node_out",c:"wR",f:["vec3"],e:!1},{a:"node_out",
c:"wS",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_wR"],j:[{a:"txt",b:"wR = qC ( n ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_wS"],j:[{a:"txt",b:"wS = vec3 ( n , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",m:[],l:[{a:"node_out",c:"wT",f:["vec3"],e:!1}],j:[{a:"txt",b:"wT = vec3 ( n , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",m:[],l:[{a:"node_out",c:"wU",f:["vec3"],e:!1}],j:[{a:"txt",b:["wU","=","nu",";"]}]},{a:"node",c:"TEX_COORD_GE",m:[],
l:[{a:"node_out",c:"wV",f:["vec3"],e:!1}],j:[{a:"txt",b:"wV = vec3 ( n , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",m:[],l:[{a:"node_out",c:"wW",f:["vec3"],e:!1}],j:[{a:"txt",b:"wW [ 0 ] = wW [ 1 ] = wW [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",m:[],l:[{a:"node_out",c:"wX",f:["vec3"],e:!1}],j:[{a:"txt",b:"wX [ 0 ] = qY [ 0 ] ; wX [ 1 ] = qY [ 1 ] ; wX [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",m:[],l:[{a:"node_out",c:"wY",f:["vec3"],e:!1}],j:[{a:"txt",b:"wY [ 0 ] = wY [ 1 ] = wY [ 2 ] = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_RE",m:[],l:[{a:"node_out",c:"wZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"wZ [ 0 ] = wZ [ 1 ] = wZ [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",m:[],l:[{a:"node_out",c:"w_",f:["vec3"],e:!1}],j:[{a:"txt",b:"w_ = vec3 ( n , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",m:[],l:[{a:"node_out",c:"xa",f:["float"],e:!1},{a:"node_out",c:"xb",f:["float"],e:!1},{a:"node_out",c:"xc",f:["float"],e:!1},{a:"node_out",c:"xd",f:["vec3"],e:!1},{a:"node_out",c:"xe",f:["float"],e:!1},{a:"node_out",
c:"xf",f:["vec3"],e:!1},{a:"node_out",c:"xg",f:["vec3"],e:!1},{a:"node_param",c:"DZ",f:["GLSL_IN","vec4"],e:!0},{a:"node_param",c:"D_",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"Ea",f:["GLSL_IN","vec3"],e:!0},{a:"node_param",c:"Eb",f:["GLSL_IN","vec3"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PARTICLE_BATCH"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xa"],j:[{a:"txt",b:"xa = DZ [ 0 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xb"],j:[{a:"txt",b:"xb = DZ [ 1 ] ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xc"],j:[{a:"txt",b:"xc = DZ [ 2 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xd"],j:[{a:"txt",b:["xd","=","D_",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xe"],j:[{a:"txt",b:"xe = DZ [ 3 ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xf"],j:[{a:"txt",b:["xf","=","Ea",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_xg"],j:[{a:"txt",b:["xg","=","Eb",";"]}]}]}]},{a:"node_else",j:[{a:"txt",b:"xa = _0_0 ; xb = _0_0 ; xc = _0_0 ; xd = vec3 ( _0_0 ) ; xe = _0_0 ; xf = xd ; xg = xd ;".split(" ")}]}]}]},
{a:"node",c:"HAIR_INFO",m:[],l:[{a:"node_out",c:"xh",f:["float"],e:!1},{a:"node_out",c:"xi",f:["float"],e:!1},{a:"node_out",c:"xj",f:["float"],e:!1},{a:"node_out",c:"xk",f:["vec3"],e:!1}],j:[{a:"txt",b:"xh = _0_0 ; xi = _0_0 ; xj = _0_0 ; xk = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",m:[],l:[{a:"node_out",c:"xl",f:["vec3"],e:!1},{a:"node_out",c:"xm",f:["float"],e:!1},{a:"node_out",c:"xn",f:["float"],e:!1},{a:"node_out",c:"xo",f:["float"],e:!1}],j:[{a:"txt",b:"xm = _0_0 ; xn = _0_0 ; xo = _0_0 ; xl = vec3 ( _0_0 ) ;".split(" ")}]},
{a:"node",c:"WIREFRAME",m:[],l:[{a:"node_in",c:"xp",f:["float"],e:!1},{a:"node_out",c:"xq",f:["float"],e:!1}],j:[{a:"txt",b:["xq","=","xp",";"]}]},{a:"node",c:"TANGENT",m:[],l:[{a:"node_out",c:"xr",f:["vec3"],e:!1}],j:[{a:"txt",b:"xr = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",m:[],l:[{a:"node_in",c:"Ek",f:["float"],e:!1},{a:"node_in",c:"El",f:["vec3"],e:!1},{a:"node_out",c:"xu",f:["float"],e:!1},{a:"node_out",c:"xv",f:["float"],e:!1}],j:[{a:"txt",b:"xu = xv = _0_0 ; El ; Ek ;".split(" ")}]},
{a:"node",c:"LIGHT_PATH",m:[],l:[{a:"node_out",c:"xB",f:["float"],e:!1},{a:"node_out",c:"xC",f:["float"],e:!1},{a:"node_out",c:"xD",f:["float"],e:!1},{a:"node_out",c:"xE",f:["float"],e:!1},{a:"node_out",c:"xF",f:["float"],e:!1},{a:"node_out",c:"xG",f:["float"],e:!1},{a:"node_out",c:"xH",f:["float"],e:!1},{a:"node_out",c:"xI",f:["float"],e:!1},{a:"node_out",c:"xJ",f:["float"],e:!1},{a:"node_out",c:"xK",f:["float"],e:!1}],j:[{a:"txt",b:"xB = xC = xD = _0_0 ; xE = xF = xG = _0_0 ; xH = xH = xJ = xK = _0_0 ; xI = _0_0 ;".split(" ")}]},
{a:"node",c:"ATTRIBUTE",m:[],l:[{a:"node_out",c:"xL",f:["vec3"],e:!1},{a:"node_out",c:"xM",f:["vec3"],e:!1},{a:"node_out",c:"xN",f:["float"],e:!1}],j:[{a:"txt",b:"xL = xM = vec3 ( _0_0 ) ; xN = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",m:[],l:[],j:[]},{a:"node",c:"CURVE_VEC",m:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"xO",f:["float"],e:!1},{a:"node_in",c:"xP",f:["vec3"],e:!1},
{a:"node_out",c:"xQ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xQ","=","xP",";"]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"xQ . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * xP . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"xQ . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * xP . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"xQ . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * xP . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"txt",b:"xQ = mix ( xP , xQ , xO ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",m:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"xR",f:["float"],e:!1},{a:"node_in",c:"xS",f:["vec3"],e:!1},{a:"node_out",c:"xT",f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( xS . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( xS . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( xS . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = xS . r ; float g = xS . g ; float b = xS . b ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_R"],j:[{a:"txt",b:"xT . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"xT . r = r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["READ_G"],j:[{a:"txt",b:"xT . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"xT . g = g ;".split(" ")}]}]},
{a:"node_cond",d:[{a:"node_if",g:["READ_B"],j:[{a:"txt",b:"xT . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"xT . b = b ;".split(" ")}]}]},{a:"txt",b:"xT = mix ( xS , xT , xR ) ;".split(" ")}]},{a:"node",c:"VALTORGB",m:[{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],l:[{a:"node_in",c:"xU",f:["float"],e:!1},{a:"node_out",c:"xV",f:["vec3"],e:!1},{a:"node_out",c:"xW",f:["float"],e:!1}],j:[{a:"txt",b:"vec4 xX = GLSL_TEXTURE ( u_nodes_texture , vec2 ( xU , NODE_TEX_ROW ) ) ; xV = xX . rgb ; xW = xX . a ;".split(" ")}]},
{a:"node",c:"MAPPING",m:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","1.0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","0.0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","1.0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],l:[{a:"node_in",c:"xY",f:["vec3"],e:!1},{a:"node_out",c:"xZ",f:["vec3"],e:!1}],j:[{a:"txt",b:["xZ","=","xY",";"]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_SCALE_DEF"],j:[{a:"txt",b:"xZ = xZ * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRANS_DEF"],j:[{a:"txt",b:"xZ = xZ + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_TRS_MATRIX_DEF"],
j:[{a:"txt",b:"xZ = ( MAPPING_TRS_MATRIX * vec4 ( xZ , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MIN_CLIP_DEF"],j:[{a:"txt",b:"xZ = max ( xZ , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_MAX_CLIP_DEF"],j:[{a:"txt",b:"xZ = min ( xZ , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"xZ = normalize ( xZ ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",m:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],l:[{a:"node_in",c:"x_",f:["float"],e:!1},{a:"node_in",c:"ya",f:["float"],e:!1},{a:"node_out",c:"yb",f:["float"],e:!1}],j:[{a:"txt",b:"yb = x_ + ya ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yb = clamp ( yb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yc",f:["float"],e:!1},{a:"node_in",c:"yd",f:["float"],e:!1},{a:"node_out",c:"ye",f:["float"],e:!1}],j:[{a:"txt",b:"ye = yc - yd ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"ye = clamp ( ye , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yf",f:["float"],e:!1},{a:"node_in",c:"yg",f:["float"],e:!1},{a:"node_out",c:"yh",f:["float"],e:!1}],j:[{a:"txt",b:"yh = yf * yg ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yh = clamp ( yh , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yi",f:["float"],e:!1},{a:"node_in",c:"yj",f:["float"],e:!1},{a:"node_out",c:"yk",f:["float"],e:!1}],j:[{a:"txt",b:"yk = ( yj != _0_0 ) ? yi / yj : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yk = clamp ( yk , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yl",f:["float"],e:!1},{a:"node_in",c:"ym",f:["float"],e:!1},
{a:"node_out",c:"yn",f:["float"],e:!1}],j:[{a:"txt",b:"yn = sin ( yl ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yn = clamp ( yn , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ym",";"]}]},{a:"node",c:"MATH_COSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yo",f:["float"],e:!1},{a:"node_in",c:"yp",f:["float"],e:!1},{a:"node_out",c:"yq",f:["float"],e:!1}],j:[{a:"txt",b:"yq = cos ( yo ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"yq = clamp ( yq , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yp",";"]}]},{a:"node",c:"MATH_TANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yr",f:["float"],e:!1},{a:"node_in",c:"ys",f:["float"],e:!1},{a:"node_out",c:"yt",f:["float"],e:!1}],j:[{a:"txt",b:"yt = tan ( yr ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yt = clamp ( yt , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["ys",";"]}]},{a:"node",c:"MATH_ARCSINE",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yu",f:["float"],e:!1},{a:"node_in",c:"yv",f:["float"],e:!1},{a:"node_out",c:"yA",f:["float"],e:!1}],j:[{a:"txt",b:"yA = ( yu <= _1_0 && yu >= - _1_0 ) ? asin ( yu ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yA = clamp ( yA , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yv",";"]}]},{a:"node",c:"MATH_ARCCOSINE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yB",f:["float"],e:!1},{a:"node_in",
c:"yC",f:["float"],e:!1},{a:"node_out",c:"yD",f:["float"],e:!1}],j:[{a:"txt",b:"yD = ( yB <= _1_0 && yB >= - _1_0 ) ? acos ( yB ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yD = clamp ( yD , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yC",";"]}]},{a:"node",c:"MATH_ARCTANGENT",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yE",f:["float"],e:!1},{a:"node_in",c:"yF",f:["float"],e:!1},{a:"node_out",c:"yG",f:["float"],e:!1}],j:[{a:"txt",
b:"yG = atan ( yE ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yG = clamp ( yG , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yF",";"]}]},{a:"node",c:"MATH_POWER",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yH",f:["float"],e:!1},{a:"node_in",c:"yI",f:["float"],e:!1},{a:"node_out",c:"yJ",f:["float"],e:!1}],j:[{a:"txt",b:"if ( yH < _0_0 && yI != floor ( yI ) ) yJ = _0_0 ; else if ( yI == _0_0 ) yJ = _1_0 ; else if ( yH < _0_0 ) yJ = mix ( _1_0 , - _1_0 , sign ( mod ( - yI , 2.0 ) ) ) * pow ( - yH , yI ) ; else if ( yH == _0_0 ) yJ = _0_0 ; else yJ = pow ( yH , yI ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yJ = clamp ( yJ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yK",f:["float"],e:!1},{a:"node_in",c:"yL",f:["float"],e:!1},{a:"node_out",c:"yM",f:["float"],e:!1}],j:[{a:"txt",b:"yM = ( yK > _0_0 && yL > _0_0 ) ? log2 ( yK ) / log2 ( yL ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yM = clamp ( yM , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yN",f:["float"],e:!1},{a:"node_in",c:"yO",f:["float"],e:!1},{a:"node_out",c:"yP",f:["float"],e:!1}],j:[{a:"txt",b:"yP = min ( yN , yO ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yP = clamp ( yP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yQ",f:["float"],e:!1},{a:"node_in",c:"yR",f:["float"],
e:!1},{a:"node_out",c:"yS",f:["float"],e:!1}],j:[{a:"txt",b:"yS = max ( yQ , yR ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yS = clamp ( yS , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yT",f:["float"],e:!1},{a:"node_in",c:"yU",f:["float"],e:!1},{a:"node_out",c:"yV",f:["float"],e:!1}],j:[{a:"txt",b:"yV = floor ( yT + _0_5 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"yV = clamp ( yV , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["yU",";"]}]},{a:"node",c:"MATH_LESS_THAN",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yW",f:["float"],e:!1},{a:"node_in",c:"yX",f:["float"],e:!1},{a:"node_out",c:"yY",f:["float"],e:!1}],j:[{a:"txt",b:"yY = ( yW < yX ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"yY = clamp ( yY , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",m:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"yZ",f:["float"],e:!1},{a:"node_in",c:"y_",f:["float"],e:!1},{a:"node_out",c:"za",f:["float"],e:!1}],j:[{a:"txt",b:"za = ( yZ > y_ ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"za = clamp ( za , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zb",f:["float"],e:!1},{a:"node_in",c:"zc",f:["float"],e:!1},{a:"node_out",c:"zd",
f:["float"],e:!1}],j:[{a:"txt",b:"zd = abs ( zc ) > 0.000001 ? mod ( zb , zc ) : _0_0 ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],j:[{a:"txt",b:"zd = clamp ( zd , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",m:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"ze",f:["float"],e:!1},{a:"node_in",c:"zf",f:["float"],e:!1},{a:"node_out",c:"zg",f:["float"],e:!1}],j:[{a:"txt",b:"zg = abs ( ze ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MATH_USE_CLAMP"],
j:[{a:"txt",b:"zg = clamp ( zg , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zf",";"]}]},{a:"node",c:"MIX_RGB_MIX",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zh",f:["float"],e:!1},{a:"node_in",c:"zi",f:["vec3"],e:!1},{a:"node_in",c:"zj",f:["vec3"],e:!1},{a:"node_out",c:"zk",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zh , _0_0 , _1_0 ) ; zk = mix ( zi , zj , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zk = clamp ( zk , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zl",f:["float"],e:!1},{a:"node_in",c:"zm",f:["vec3"],e:!1},{a:"node_in",c:"zn",f:["vec3"],e:!1},{a:"node_out",c:"zo",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zl , _0_0 , _1_0 ) ; zo = mix ( zm , zm + zn , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zo = clamp ( zo , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",m:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zp",f:["float"],e:!1},{a:"node_in",c:"zq",f:["vec3"],e:!1},{a:"node_in",c:"zr",f:["vec3"],e:!1},{a:"node_out",c:"zs",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zp , _0_0 , _1_0 ) ; zs = mix ( zq , zq * zr , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zs = clamp ( zs , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"zt",f:["float"],e:!1},{a:"node_in",c:"zu",f:["vec3"],e:!1},{a:"node_in",c:"zv",f:["vec3"],e:!1},{a:"node_out",c:"zA",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zt , _0_0 , _1_0 ) ; zA = mix ( zu , zu - zv , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zA = clamp ( zA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zB",f:["float"],e:!1},{a:"node_in",c:"zC",
f:["vec3"],e:!1},{a:"node_in",c:"zD",f:["vec3"],e:!1},{a:"node_out",c:"zE",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zB , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; zE = vec3 ( _1_0 ) - ( vec3 ( zF ) + wQ * ( vec3 ( _1_0 ) - zD ) ) * ( vec3 ( _1_0 ) - zC ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zE = clamp ( zE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zG",
f:["float"],e:!1},{a:"node_in",c:"zH",f:["vec3"],e:!1},{a:"node_in",c:"zI",f:["vec3"],e:!1},{a:"node_out",c:"zJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zG , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; zI += step ( zI , vec3 ( _0_0 ) ) ; zJ = zF * zH + wQ * zH / zI ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zJ = clamp ( zJ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",
c:"zK",f:["float"],e:!1},{a:"node_in",c:"zL",f:["vec3"],e:!1},{a:"node_in",c:"zM",f:["vec3"],e:!1},{a:"node_out",c:"zN",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zK , _0_0 , _1_0 ) ; zN = mix ( zL , abs ( zL - zM ) , wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zN = clamp ( zN , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zO",f:["float"],e:!1},{a:"node_in",
c:"zP",f:["vec3"],e:!1},{a:"node_in",c:"zQ",f:["vec3"],e:!1},{a:"node_out",c:"zR",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zO , _0_0 , _1_0 ) ; zR = min ( zP . rgb , zQ . rgb * wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zR = clamp ( zR , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zS",f:["float"],e:!1},{a:"node_in",c:"zT",f:["vec3"],e:!1},{a:"node_in",
c:"zU",f:["vec3"],e:!1},{a:"node_out",c:"zV",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zS , _0_0 , _1_0 ) ; zV = max ( zT . rgb , zU . rgb * wQ ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zV = clamp ( zV , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"zW",f:["float"],e:!1},{a:"node_in",c:"zX",f:["vec3"],e:!1},{a:"node_in",c:"zY",f:["vec3"],e:!1},{a:"node_out",
c:"zZ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( zW , _0_0 , _1_0 ) ; vec3 z_ = vec3 ( _1_0 - wQ ) ; zZ = mix ( zX * ( z_ + 2.0 * wQ * zY ) , vec3 ( _1_0 ) - ( z_ + 2.0 * wQ * ( vec3 ( _1_0 ) - zY ) ) * ( vec3 ( _1_0 ) - zX ) , step ( _0_5 , zX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"zZ = clamp ( zZ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Aa",f:["float"],
e:!1},{a:"node_in",c:"Ab",f:["vec3"],e:!1},{a:"node_in",c:"Ac",f:["vec3"],e:!1},{a:"node_out",c:"Ad",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Aa , _0_0 , _1_0 ) ; vec3 Ae = vec3 ( _1_0 ) - wQ * Ac ; vec3 Af = clamp ( Ab / Ae , _0_0 , _1_0 ) ; Ad = mix ( mix ( Af , vec3 ( _1_0 ) , step ( Ae , vec3 ( _0_0 ) ) ) , Ab , step ( Ab , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Ad = clamp ( Ad , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ag",f:["float"],e:!1},{a:"node_in",c:"Ah",f:["vec3"],e:!1},{a:"node_in",c:"Ai",f:["vec3"],e:!1},{a:"node_out",c:"Aj",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Ag , _0_0 , _1_0 ) ; vec3 jE = vec3 ( _1_0 - wQ ) ; vec3 Ae = jE + wQ * Ai ; vec3 Af = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - Ah ) / Ae , _0_0 , _1_0 ) ; Aj = mix ( Af , vec3 ( _0_0 ) , step ( Ae , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Aj = clamp ( Aj , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ak",f:["float"],e:!1},{a:"node_in",c:"Al",f:["vec3"],e:!1},{a:"node_in",c:"Am",f:["vec3"],e:!1},{a:"node_out",c:"An",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Ak , _0_0 , _1_0 ) ; vec3 jw , Ao , Ae ; An = Al ; Ao = jv ( Am ) ; if ( Ao . y != _0_0 ) { jw = jv ( An ) ; jw . x = Ao . x ; Ae = jx ( jw ) ; An = mix ( An , Ae , wQ ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"An = clamp ( An , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ap",f:["float"],e:!1},{a:"node_in",c:"Aq",f:["vec3"],e:!1},{a:"node_in",c:"Ar",f:["vec3"],e:!1},{a:"node_out",c:"As",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Ap , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; As = Aq ; vec3 jw , Ao ; jw = jv ( As ) ; if ( jw . y != _0_0 ) { Ao = jv ( Ar ) ; jw . y = zF * jw . y + wQ * Ao . y ; As = jx ( jw ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"As = clamp ( As , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"At",f:["float"],e:!1},{a:"node_in",c:"Au",f:["vec3"],e:!1},{a:"node_in",c:"Av",f:["vec3"],e:!1},{a:"node_out",c:"Aw",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( At , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; vec3 jw , Ao ; jw = jv ( Au ) ; Ao = jv ( Av ) ; jw . z = zF * jw . z + wQ * Ao . z ; Aw = jx ( jw ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"Aw = clamp ( Aw , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"Ax",f:["float"],e:!1},{a:"node_in",c:"Ay",f:["vec3"],e:!1},{a:"node_in",c:"Az",f:["vec3"],e:!1},{a:"node_out",c:"AA",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( Ax , _0_0 , _1_0 ) ; vec3 jw , Ao , Ae ; AA = Ay ; Ao = jv ( Az ) ; if ( Ao . y != _0_0 ) { jw = jv ( AA ) ; jw . x = Ao . x ; jw . y = Ao . y ; Ae = jx ( jw ) ; AA = mix ( AA , Ae , wQ ) ; }".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AA = clamp ( AA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AB",f:["float"],e:!1},{a:"node_in",c:"AC",f:["vec3"],e:!1},{a:"node_in",c:"AD",f:["vec3"],e:!1},{a:"node_out",c:"AE",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( AB , _0_0 , _1_0 ) ; float zF = _1_0 - wQ ; vec3 AF = AD + AC - AD * AC ; AE = AC * ( vec3 ( zF ) + vec3 ( wQ ) * ( ( vec3 ( _1_0 ) - AC ) * AD + AF ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AE = clamp ( AE , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",m:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],l:[{a:"node_in",c:"AG",f:["float"],e:!1},{a:"node_in",c:"AH",f:["vec3"],e:!1},{a:"node_in",c:"AI",f:["vec3"],e:!1},{a:"node_out",c:"AJ",f:["vec3"],e:!1}],j:[{a:"txt",b:"float wQ = clamp ( AG , _0_0 , _1_0 ) ; AJ = AH + wQ * ( 2.0 * AI - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",
g:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"AJ = clamp ( AJ , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",m:[],l:[{a:"node_in",c:"AK",f:["vec3"],e:!1},{a:"node_in",c:"AL",f:["float"],e:!1}],j:[{a:"txt",b:"v = AK ; D = AL ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],l:[{a:"node_in",c:"AP",f:["vec3"],e:!1},{a:"node_in",
c:"AQ",f:["vec3"],e:!1},{a:"node_in",c:"AR",f:["float"],e:!1},{a:"node_in",c:"AS",f:["vec3"],e:!0},{a:"node_in",c:"AT",f:["float"],e:!0},{a:"node_out",c:"AU",f:["vec3"],e:!1},{a:"node_out",c:"AV",f:["vec3"],e:!1},{a:"node_out",c:"AW",f:["vec3"],e:!1},{a:"node_out",c:"AX",f:["vec3"],e:!1},{a:"node_out",c:"AY",f:["vec3"],e:!1},{a:"node_out",c:"AZ",f:["vec2"],e:!1},{a:"node_out",c:"A_",f:["vec2"],e:!1},{a:"node_out",c:"Ba",f:["vec4"],e:!1},{a:"node_param",c:"qS",f:["const","vec2"],e:!0},{a:"node_param",
c:"qT",f:["const","vec3"],e:!1}],j:[{a:"txt",b:"AW = clamp ( AP , _0_0 , _1_0 ) ; AX = qT [ 0 ] * clamp ( AQ , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"AY = normalize ( AS ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["AY","=","nu",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"txt",b:"AU = AT * AW ;".split(" ")}]},{a:"node_else",j:[{a:"txt",
b:"AU = qZ * AW ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["AW","*=","AR",";"]}]}]},{a:"txt",b:"AV = q_ * u_environment_energy * cb ( AY ) ; Ba = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"AZ = vec2 ( qS [ 0 ] , qS [ 1 ] ) ; A_ = vec2 ( qT [ 1 ] , qT [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["C","=","Ba",";"]}]},{a:"node_else",j:[{a:"txt",b:"AU = vec3 ( _0_0 ) ; AV = vec3 ( _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATERIAL_END",m:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],l:[{a:"node_in",c:"Bb",f:["vec4"],e:!1},{a:"node_in",c:"Bc",f:["vec3"],e:!1},{a:"node_in",c:"Bd",f:["vec3"],e:!1},{a:"node_in",c:"Be",f:["float"],e:!0},{a:"node_in",c:"Bf",f:["float"],e:!0},{a:"node_in",c:"Bg",f:["float"],e:!0},{a:"node_out",c:"Bh",f:["vec3"],e:!0},{a:"node_out",c:"Bi",f:["float"],e:!0},{a:"node_out",c:"Bj",f:["vec3"],
e:!0},{a:"node_out",c:"Bk",f:["vec3"],e:!0},{a:"node_out",c:"Bl",f:["vec3"],e:!0},{a:"node_param",c:"qU",f:["float"],e:!1},{a:"node_param",c:"qV",f:["float"],e:!1}],j:[{a:"txt",b:["Be",";"]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bh"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"Bh = Bb . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"Bh = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["Bh","+=","Bc",
";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bj"],j:[{a:"txt",b:["Bj","=","Bd",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["MATERIAL_EXT"],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bk"],j:[{a:"txt",b:"Bk = Bb . rgb ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bl"],j:[{a:"txt",b:["Bl","=","Bc",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bi"],j:[{a:"txt",b:"Bi = clamp ( Bg , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:"float t = max ( max ( Bc . r , Bc . g ) , Bc . b ) * Bf ; Bi = clamp ( Bg * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bi"],j:[{a:"txt",b:"Bi = clamp ( qU , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( Bc . r , Bc . g ) , Bc . b ) * qV ; Bi = qU * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_MATERIAL_SPECULAR"],
j:[{a:"txt",b:["A","=","Bc",";"]}]},{a:"node_else",j:[{a:"txt",b:"A = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["B","=","Bd",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",m:[],l:[{a:"node_in",c:"nM",f:["vec3"],e:!1},{a:"node_in",c:"nN",f:["vec3"],e:!1},{a:"node_in",c:"nO",f:["vec3"],e:!1},{a:"node_out",c:"nP",f:["vec4"],e:!1},{a:"node_out",c:"nQ",f:["vec3"],e:!1}],j:[{a:"txt",b:"nP = vec4 ( nM + nO * nN , _0_0 ) ; nQ = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",m:[{a:"node_var",c:"LAMP_TYPE",
b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],l:[{a:"node_in",c:"nR",f:["vec4"],e:!1},{a:"node_out",c:"nS",f:["vec3"],e:!1},{a:"node_out",c:"nT",f:["vec2"],e:!1},{a:"node_out",c:"nU",f:["vec3"],e:!1},{a:"node_out",c:"nV",f:["float"],e:!1}],j:[{a:"txt",b:"nT = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["nV","=","_0_5",";"]}]},{a:"node_else",j:[{a:"txt",b:["nV","=","_0_0",";"]}]}]},{a:"txt",b:"nU = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"nU *= nR [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 nW = u_light_positions [ LAMP_IND ] . xyz ; nS = nW - nt ; float az = length ( nS ) ; nU *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + az * az ) ; nS = normalize ( nS ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 nY = u_light_directions [ LAMP_IND ] ; float nZ = dot ( nS , nY ) ; nZ *= smoothstep ( _0_0 , _1_0 , ( nZ - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; nU *= nZ ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"nS = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"n_",f:["vec3"],e:!1},{a:"node_in",c:"oa",f:["vec2"],e:!1},{a:"node_in",c:"ob",f:["vec3"],e:!1},{a:"node_in",c:"oc",f:["float"],e:!1},{a:"node_in",c:"od",f:["vec2"],e:!1},{a:"node_out",c:"oe",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( n_ , f . xyz ) ; ob = cross ( of , f . xyz ) ; ob = - normalize ( ob ) ;".split(" ")}]}]},
{a:"txt",b:"oe = _0_0 ; if ( oa . r != _0_0 ) { float og = ( _1_0 - oc ) * dot ( ob , n_ ) + oc ; if ( od [ 0 ] == _0_0 ) { oe = _1_0 ; } else { float t = _1_0 + abs ( og ) ; t = od [ 1 ] + ( _1_0 - od [ 1 ] ) * pow ( t , od [ 0 ] ) ; oe = clamp ( t , _0_0 , _1_0 ) ; } oe = max ( oe , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oh",f:["vec3"],e:!1},{a:"node_in",c:"oi",f:["vec2"],e:!1},{a:"node_in",c:"oj",f:["vec3"],
e:!1},{a:"node_in",c:"ok",f:["float"],e:!1},{a:"node_out",c:"ol",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oh , f . xyz ) ; oj = cross ( of , f . xyz ) ; oj = - normalize ( oj ) ;".split(" ")}]}]},{a:"txt",b:"ol = _0_0 ; if ( oi . r != _0_0 ) { float og = ( _1_0 - ok ) * dot ( oj , oh ) + ok ; ol = max ( og , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",
c:"om",f:["vec3"],e:!1},{a:"node_in",c:"on",f:["vec2"],e:!1},{a:"node_in",c:"oo",f:["vec3"],e:!1},{a:"node_in",c:"op",f:["float"],e:!1},{a:"node_in",c:"oq",f:["vec2"],e:!1},{a:"node_out",c:"or",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( om , f . xyz ) ; oo = cross ( of , f . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float og = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] > _0_0 ) { float os = max ( dot ( oo , nv ) , _0_0 ) ; float ot = oq [ 0 ] * oq [ 0 ] ; float cd = _1_0 - _0_5 * ( ot / ( ot + 0.33 ) ) ; vec3 ou = om - og * oo ; vec3 ov = nv - os * oo ; if ( length ( ou ) == _0_0 || length ( ov ) == _0_0 || abs ( og ) > _1_0 || abs ( os ) > _1_0 ) or = og * cd ; else { float ow = acos ( og ) ; float ox = acos ( os ) ; vec3 oy = normalize ( ou ) ; vec3 oz = normalize ( ov ) ; float a , b ; a = max ( ow , ox ) ; b = min ( ow , ox ) ; b *= 0.95 ; float t = max ( dot ( oy , oz ) , _0_0 ) ; float oA = 0.45 * ( ot / ( ot + 0.09 ) ) ; or = og * ( cd + ( oA * t * sin ( a ) * tan ( b ) ) ) ; } } else or = og ; or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oB",f:["vec3"],e:!1},{a:"node_in",c:"oC",f:["vec2"],e:!1},{a:"node_in",c:"oD",f:["vec3"],e:!1},{a:"node_in",c:"oE",f:["float"],e:!1},{a:"node_in",c:"oF",f:["vec2"],e:!1},{a:"node_out",c:"oG",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oB , f . xyz ) ; oD = cross ( of , f . xyz ) ; oD = - normalize ( oD ) ;".split(" ")}]}]},{a:"txt",
b:"oG = _0_0 ; if ( oC . r != _0_0 ) { float og = ( _1_0 - oE ) * dot ( oD , oB ) + oE ; float os = max ( dot ( oD , nv ) , _0_0 ) ; if ( oF [ 0 ] <= _1_0 ) oG = og * pow ( max ( os * og , 0.1 ) , oF [ 0 ] - _1_0 ) ; else oG = og * pow ( 1.0001 - os , oF [ 0 ] - _1_0 ) ; oG = max ( oG , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oH",f:["vec3"],e:!1},{a:"node_in",c:"oI",f:["vec2"],e:!1},{a:"node_in",c:"oJ",f:["vec3"],e:!1},
{a:"node_in",c:"oK",f:["float"],e:!1},{a:"node_in",c:"oL",f:["vec2"],e:!1},{a:"node_out",c:"oM",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 of = cross ( oH , f . xyz ) ; oJ = cross ( of , f . xyz ) ; oJ = - normalize ( oJ ) ;".split(" ")}]}]},{a:"txt",b:"oM = _0_0 ; if ( oI . r != _0_0 ) { float og = ( _1_0 - oK ) * dot ( oJ , oH ) + oK ; float oN = acos ( og ) ; if ( oN < oL [ 0 ] ) oM = _1_0 ; else if ( oN > ( oL [ 0 ] + oL [ 1 ] ) || oL [ 1 ] == _0_0 ) oM = _0_0 ; else oM = _1_0 - ( ( oN - oL [ 0 ] ) / oL [ 1 ] ) ; oM = max ( oM , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oO",f:["vec3"],e:!1},{a:"node_in",c:"oP",f:["vec2"],e:!1},{a:"node_in",c:"oQ",f:["vec3"],e:!1},{a:"node_in",c:"oR",f:["float"],e:!1},{a:"node_in",c:"oS",f:["vec2"],e:!1},{a:"node_out",c:"oT",f:["float"],e:!1}],j:[{a:"txt",b:"oT = _0_0 ; if ( oP . g == _1_0 ) { vec3 oU = normalize ( oO + nv ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oR == _0_0 ) { oT = dot ( f . xyz , oU ) ; oT = sqrt ( _1_0 - oT * oT ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"oT = ( _1_0 - oR ) * max ( dot ( oQ , oU ) , _0_0 ) + oR ;".split(" ")}]}]},{a:"txt",b:"oT = pow ( oT , oS [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"oV",f:["vec3"],e:!1},{a:"node_in",c:"oW",f:["vec2"],e:!1},{a:"node_in",c:"oX",f:["vec3"],e:!1},{a:"node_in",c:"oY",f:["float"],e:!1},{a:"node_in",c:"oZ",f:["vec2"],e:!1},{a:"node_out",c:"o_",f:["float"],e:!1}],j:[{a:"txt",b:"o_ = _0_0 ; if ( oW . g != _0_0 ) { vec3 oU = normalize ( oV + nv ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( oY == _0_0 ) { o_ = dot ( o . xyz , oU ) ; o_ = sqrt ( _1_0 - o_ * o_ ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"o_ = max ( dot ( oX , oU ) , _0_0 ) ; o_ = ( _1_0 - oY ) * o_ + oY ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float os = max ( dot ( o . xyz , nv ) , _0_0 ) ; os = sqrt ( _1_0 - os * os ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float os = max ( dot ( oX , nv ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"o_ = pow ( o_ , oZ [ 0 ] ) ; o_ = o_ / ( 0.1 + os ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pa",f:["vec3"],e:!1},{a:"node_in",c:"pb",f:["vec2"],e:!1},{a:"node_in",c:"pc",f:["vec3"],e:!1},{a:"node_in",c:"pd",f:["float"],e:!1},{a:"node_in",c:"pe",f:["vec2"],e:!1},{a:"node_out",c:"pf",f:["float"],e:!1}],j:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 oU = normalize ( pa + nv ) ;".split(" ")},{a:"node_cond",
d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pg = _0_0 ; float os = _0_0 ; float ph = _0_0 ; if ( pd == _0_0 ) { pg = dot ( f . xyz , oU ) ; os = dot ( f . xyz , nv ) ; ph = dot ( f . xyz , pa ) ; pg = sqrt ( _1_0 - pg * pg ) ; os = sqrt ( _1_0 - os * os ) ; ph = sqrt ( _1_0 - ph * ph ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pg = max ( dot ( pc , oU ) , 0.01 ) ; float os = max ( dot ( pc , nv ) , 0.01 ) ; float ph = max ( dot ( pc , pa ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bj = tan ( acos ( pg ) ) ; float F = max ( pe [ 0 ] , 0.01 ) ; pf = ph * ( _1_0 / ( 4.0 * M_PI * F * F ) ) * ( exp ( - ( bj * bj ) / ( F * F ) ) / ( sqrt ( os * ph ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pi",f:["vec3"],e:!1},{a:"node_in",c:"pj",f:["vec2"],e:!1},{a:"node_in",c:"pk",f:["vec3"],e:!1},{a:"node_in",c:"pl",f:["float"],e:!1},{a:"node_in",c:"pm",f:["vec2"],e:!1},{a:"node_out",c:"pn",f:["float"],
e:!1}],j:[{a:"txt",b:"pn = _0_0 ; if ( pj . g == _1_0 ) { vec3 bL = normalize ( pi + nv ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float po = dot ( bL , f . xyz ) ; float bj = pm [ 0 ] + pm [ 1 ] ; if ( pl == _0_0 ) bj = acos ( sqrt ( _1_0 - po * po ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float bj = acos ( dot ( bL , pk ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bj < pm [ 0 ] ) pn = _1_0 ; else if ( bj >= pm [ 0 ] + pm [ 1 ] || pm [ 1 ] == _0_0 ) pn = _0_0 ; else pn = _1_0 - ( bj - pm [ 0 ] ) / pm [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",m:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],l:[{a:"node_in",c:"pr",f:["vec3"],e:!1},{a:"node_in",c:"pu",f:["vec2"],e:!1},{a:"node_in",c:"pv",f:["vec3"],e:!1},{a:"node_in",c:"pw",f:["float"],e:!1},{a:"node_in",c:"px",f:["vec2"],e:!1},{a:"node_out",c:"py",f:["float"],e:!1}],j:[{a:"txt",b:"py = _0_0 ; if ( pu . g == _1_0 ) { if ( px [ 0 ] < 1.0 || px [ 1 ] == _0_0 ) py = _0_0 ; else { if ( px [ 1 ] < 100.0 ) px [ 1 ] = sqrt ( 1.0 / px [ 1 ] ) ; else px [ 1 ] = 10.0 / px [ 1 ] ; vec3 oU = normalize ( nv + pr ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float pg = 0.0 ; if ( pw == _0_0 ) { float pB = dot ( f . xyz , oU ) ; pg = sqrt ( _1_0 - pB * pB ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float pg = ( _1_0 - pw ) * max ( dot ( pv , oU ) , _0_0 ) + pw ;".split(" ")}]}]},{a:"txt",b:"if ( pg < _0_0 ) py = _0_0 ; else { float os = max ( dot ( pv , nv ) , 0.01 ) ; float ph = dot ( pv , pr ) ; if ( ph <= 0.01 ) py = _0_0 ; else { float pC = max ( dot ( nv , oU ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * pg * os ) / pC ; float cY = ( 2.0 * pg * ph ) / pC ; float g = min ( min ( a , b ) , cY ) ; float p = sqrt ( pow ( px [ 0 ] , 2.0 ) + pow ( pC , 2.0 ) - _1_0 ) ; float lj = pow ( p - pC , 2.0 ) / pow ( p + pC , 2.0 ) * ( _1_0 + pow ( pC * ( p + pC ) - _1_0 , 2.0 ) / pow ( pC * ( p - pC ) + _1_0 , 2.0 ) ) ; float oN = acos ( pg ) ; py = max ( lj * g * exp ( - pow ( oN , 2.0 ) / ( 2.0 * pow ( px [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",m:[],l:[{a:"node_in",c:"pD",f:["vec4"],e:!1},{a:"node_in",c:"pE",f:["vec3"],e:!1},{a:"node_in",c:"pF",f:["float"],e:!1},{a:"node_in",c:"pG",f:["float"],e:!1},{a:"node_in",c:"pH",f:["vec3"],e:!1},{a:"node_in",c:"pI",f:["vec3"],e:!1},{a:"node_in",c:"pJ",f:["vec4"],e:!1},{a:"node_in",c:"pK",f:["vec3"],e:!1},{a:"node_in",c:"pL",f:["vec3"],e:!1},{a:"node_in",c:"pM",f:["vec3"],e:!1},{a:"node_in",c:"pN",f:["float"],e:!1},{a:"node_out",c:"pO",f:["vec4"],e:!1},{a:"node_out",c:"pP",
f:["vec3"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( pH , pI ) * dot ( nv , pI ) < _0_0 ) { float Bm = pJ . x ; float Bn = pJ . y ; float Bo = pJ . z ; float Bp = pJ . w ; float Bq = clamp ( abs ( dot ( pH , pI ) ) , _0_0 , _1_0 ) ; float Br = clamp ( dot ( nv , - pH ) , _0_0 , _1_0 ) ; float Bs = pow ( Br , Bn ) ; pO = pD + pN * vec4 ( pM * Bq * pow ( pK , vec3 ( Bm ) ) , _1_0 ) ; pO += Bo * mix ( vec4 ( pK , _1_0 ) , vec4 ( _1_0 ) , Bp ) * pN * vec4 ( pM * Bq * vec3 ( Bs ) , _1_0 ) ; pP = pE ; } else { pP = pE + pM * pL * pG ; pO = pD + vec4 ( pM * pK * pF , pG ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"pP = pE + pM * pL * pG ; pO = pD + vec4 ( pM * pK * pF , pG ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",m:[{a:"node_var",c:"RGB_IND",b:["0"]}],l:[{a:"node_out",c:"Bt",f:["vec3"],e:!1}],j:[{a:"txt",b:"Bt = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",m:[],l:[{a:"node_in",c:"Bu",f:["vec3"],e:!1},{a:"node_out",c:"Bv",f:["float"],e:!1}],j:[{a:"txt",b:"Bv = dot ( Bu , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",m:[],l:[{a:"node_in",c:"Bw",
f:["vec3"],e:!1},{a:"node_out",c:"Bx",f:["float"],e:!0},{a:"node_out",c:"By",f:["float"],e:!0},{a:"node_out",c:"Bz",f:["float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bx"],j:[{a:"txt",b:"Bx = Bw . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_By"],j:[{a:"txt",b:"By = Bw . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Bz"],j:[{a:"txt",b:"Bz = Bw . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",m:[],l:[{a:"node_in",c:"BA",f:["vec3"],e:!1},{a:"node_out",
c:"BB",f:["float"],e:!0},{a:"node_out",c:"BC",f:["float"],e:!0},{a:"node_out",c:"BD",f:["float"],e:!0}],j:[{a:"txt",b:"vec3 BE = jv ( BA ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BB"],j:[{a:"txt",b:"BB = BE . r ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BC"],j:[{a:"txt",b:"BC = BE . g ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BD"],j:[{a:"txt",b:"BD = BE . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",m:[],l:[{a:"node_in",c:"BF",f:["float"],e:!1},
{a:"node_in",c:"BG",f:["float"],e:!1},{a:"node_in",c:"BH",f:["float"],e:!1},{a:"node_out",c:"BI",f:["float"],e:!1}],j:[{a:"txt",b:"BI = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( BF - BH ) * BG ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",m:[],l:[{a:"node_in",c:"BJ",f:["vec3"],e:!1},{a:"node_in",c:"BK",f:["float"],e:!1},{a:"node_out",c:"BL",f:["vec3"],e:!1}],j:[{a:"txt",b:"BL = BJ ; if ( BL . x > _0_0 ) BL . x = pow ( BJ . x , BK ) ; if ( BL . y > _0_0 ) BL . y = pow ( BJ . y , BK ) ; if ( BL . z > _0_0 ) BL . z = pow ( BJ . z , BK ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",m:[],l:[{a:"node_in",c:"BM",f:["vec3"],e:!1},{a:"node_out",c:"BN",f:["vec3"],e:!1}],j:[{a:"txt",b:"BN = max ( vec3 ( _0_0 ) , BM ) ; BN = pow ( BN , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",m:[],l:[{a:"node_in",c:"BO",f:["vec3"],e:!1},{a:"node_out",c:"BP",f:["vec3"],e:!1}],j:[{a:"txt",b:"BP = max ( vec3 ( _0_0 ) , BO ) ; BP = pow ( BP , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",m:[],l:[{a:"node_out",c:"BQ",f:["vec3"],
e:!1},{a:"node_out",c:"BR",f:["vec3"],e:!1},{a:"node_out",c:"BS",f:["float"],e:!1}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BQ"],j:[{a:"txt",b:"BQ [ 2 ] = BQ [ 1 ] = BQ [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BR"],j:[{a:"txt",b:"BR [ 2 ] = BR [ 1 ] = BR [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BS"],j:[{a:"txt",b:["BS","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",m:[],l:[{a:"node_in",c:"BT",f:["vec3"],e:!1},{a:"node_out",
c:"BU",f:["vec3"],e:!0},{a:"node_out",c:"BV",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",f:["uniform","samplerCube"],e:!1}],j:[{a:"txt",b:"vec4 xX = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , BT ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BU"],j:[{a:"txt",b:"BU = xX . xyz ; bV ( BU ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_BV"],j:[{a:"txt",b:"BV = xX . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",m:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"BX",f:["vec3"],e:!0},{a:"node_in",c:"BY",f:["vec3"],e:!0},{a:"node_in",c:"BZ",f:["vec3"],e:!0},{a:"node_in",c:"B_",f:["vec3"],e:!0},{a:"node_out",c:"Ca",f:["vec3"],e:!0},{a:"node_out",c:"Cb",f:["float"],e:!0},{a:"node_out",c:"Cc",f:["vec3"],e:!0},{a:"node_out",c:"Cd",f:["float"],e:!0},{a:"node_out",c:"Ce",f:["vec3"],e:!0},{a:"node_out",c:"Cf",f:["float"],
e:!0},{a:"node_out",c:"Cg",f:["vec3"],e:!0},{a:"node_out",c:"Ch",f:["float"],e:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qD ( BX ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ca"],j:[{a:"txt",b:"Ca = xX . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bV","(","Ca",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",
g:["USE_OUT_Cb"],j:[{a:"txt",b:"Cb = xX . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qD ( BY ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cc"],j:[{a:"txt",b:"Cc = xX . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bV","(","Cc",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cd"],j:[{a:"txt",b:"Cd = xX . w ;".split(" ")}]}]}]}]},
{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qD ( BZ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ce"],j:[{a:"txt",b:"Ce = xX . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bV","(","Ce",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cf"],j:[{a:"txt",b:"Cf = xX . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",
b:"xX = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qD ( B_ ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cg"],j:[{a:"txt",b:"Cg = xX . xyz ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bV","(","Cg",")",";"]}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ch"],j:[{a:"txt",b:"Ch = xX . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",m:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],l:[{a:"node_in",c:"Ci",f:["vec3"],e:!0},{a:"node_in",c:"Cj",f:["vec3"],e:!0},{a:"node_in",c:"Ck",f:["vec3"],e:!0},{a:"node_in",c:"Cl",f:["vec3"],e:!0},{a:"node_out",c:"Cm",f:["vec3"],e:!0},{a:"node_out",c:"Cn",f:["float"],e:!0},{a:"node_out",c:"Co",f:["vec3"],e:!0},{a:"node_out",c:"Cp",f:["float"],e:!0},{a:"node_out",c:"Cq",f:["vec3"],e:!0},{a:"node_out",c:"Cr",f:["float"],e:!0},{a:"node_out",c:"Cs",f:["vec3"],e:!0},{a:"node_out",c:"Ct",f:["float"],e:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"vec4 xX = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qD ( Ci ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cm"],j:[{a:"txt",b:"Cm = normalize ( qX * ( xX . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cn"],j:[{a:"txt",b:"Cn = xX . w ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv2"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qD ( Cj ) ) ;".split(" ")},
{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Co"],j:[{a:"txt",b:"Co = normalize ( qX * ( xX . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cp"],j:[{a:"txt",b:"Cp = xX . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv3"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qD ( Ck ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cq"],j:[{a:"txt",b:"Cq = normalize ( qX * ( xX . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["USE_OUT_Cr"],j:[{a:"txt",b:"Cr = xX . w ;".split(" ")}]}]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_uv4"],j:[{a:"txt",b:"xX = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qD ( Cl ) ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cs"],j:[{a:"txt",b:"Cs = normalize ( qX * ( xX . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Ct"],j:[{a:"txt",b:"Ct = xX . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",m:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],l:[{a:"node_out",c:"Cu",f:["float"],e:!1}],j:[{a:"txt",b:"Cu = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",m:[],l:[{a:"node_in",c:"Cv",f:["vec3"],e:!1},{a:"node_in",c:"Cw",f:["vec3"],e:!1},{a:"node_out",c:"Cx",f:["vec3"],e:!1},{a:"node_out",c:"Cy",f:["float"],e:!0}],j:[{a:"txt",b:"Cx = Cv + Cw ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Cy"],j:[{a:"txt",b:"Cy = ( abs ( Cx [ 0 ] ) + abs ( Cx [ 1 ] ) + abs ( Cx [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",m:[],l:[{a:"node_in",c:"Cz",f:["vec3"],e:!1},{a:"node_in",c:"CA",f:["vec3"],e:!1},{a:"node_out",c:"CB",f:["vec3"],e:!1},{a:"node_out",c:"CC",f:["float"],e:!0}],j:[{a:"txt",b:"CB = Cz - CA ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CC"],j:[{a:"txt",b:"CC = ( abs ( CB [ 0 ] ) + abs ( CB [ 1 ] ) + abs ( CB [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",m:[],l:[{a:"node_in",c:"CD",f:["vec3"],e:!1},{a:"node_in",c:"CE",f:["vec3"],e:!1},
{a:"node_out",c:"CF",f:["vec3"],e:!1},{a:"node_out",c:"CG",f:["float"],e:!0}],j:[{a:"txt",b:"CF = CD + CE ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CG"],j:[{a:"txt",b:"CG = length ( CF ) ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CF"],j:[{a:"txt",b:"CF = normalize ( CF ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",m:[],l:[{a:"node_in",c:"CH",f:["vec3"],e:!1},{a:"node_in",c:"CI",f:["vec3"],e:!1},{a:"node_out",c:"CJ",f:["vec3"],e:!1},{a:"node_out",c:"CK",
f:["float"],e:!0}],j:[{a:"txt",b:"CJ = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CK"],j:[{a:"txt",b:"CK = dot ( CH , CI ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",m:[],l:[{a:"node_in",c:"CL",f:["vec3"],e:!1},{a:"node_in",c:"CM",f:["vec3"],e:!1},{a:"node_out",c:"CN",f:["vec3"],e:!1},{a:"node_out",c:"CO",f:["float"],e:!0}],j:[{a:"txt",b:"CN = cross ( CL , CM ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CO"],j:[{a:"txt",b:"CO = length ( CN ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",m:[],l:[{a:"node_in",c:"CP",f:["vec3"],e:!1},{a:"node_in",c:"CQ",f:["vec3"],e:!1},{a:"node_out",c:"CR",f:["vec3"],e:!1},{a:"node_out",c:"CS",f:["float"],e:!0}],j:[{a:"txt",b:"CR = normalize ( CP ) ;".split(" ")},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_CS"],j:[{a:"txt",b:"CS = length ( CP ) ;".split(" ")}]}]},{a:"txt",b:["CQ",";"]}]},{a:"node",c:"B4W_REFLECT",m:[],l:[{a:"node_in",c:"CW",f:["vec3"],e:!1},{a:"node_in",c:"CX",f:["vec3"],e:!1},{a:"node_out",c:"CY",
f:["vec3"],e:!1}],j:[{a:"txt",b:"CY = reflect ( P ( u_view_tsr_inverse , CW ) , CX ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",m:[],l:[{a:"node_in",c:"CZ",f:["vec3"],e:!1},{a:"node_out",c:"C_",f:["vec3"],e:!1}],j:[{a:"txt",b:"vec3 Em = - nv . xyz ; C_ = reflect ( Em , CZ ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",m:[],l:[{a:"node_in",c:"Da",f:["vec3"],e:!1},{a:"node_in",c:"Db",f:["float"],e:!1},{a:"node_in",c:"Dc",f:["const","float"],e:!1},{a:"node_in",c:"Dd",f:["const","float"],e:!1},{a:"node_out",
c:"De",f:["vec3"],e:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",f:["uniform","sampler2D"],e:!1}],j:[{a:"txt",b:"float bm = length ( qY ) ; if ( bm < Dd ) { vec2 bB = qD ( Da ) ; float bF = clamp ( _0_5 * ( Dd - bm ) , _0_0 , _1_0 ) ; float hh = Db * bF ; vec3 bH = normalize ( nv * qX ) ; float bI = _1_0 / Dc ; vec2 bJ = bH . xy * hh / ( Dc * bH . z ) ; float bK = _1_0 ; float bL = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bB ) . a ; for ( float bN = 1.0 ; bN <= Dc ; bN ++ ) { if ( bL < bK ) { bK -= bI ; bB -= bJ ; bL = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bB ) . a ; } } vec2 bO = bB + bJ ; float bP = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bO ) . a - ( bK + bI ) ; float bQ = bL - bK ; float bR = bQ / ( bQ - bP ) ; bB = bR * bO + ( _1_0 - bR ) * bB ; De = qC ( bB ) ; } else De = Da ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",m:[],l:[{a:"node_in",c:"Df",f:["vec3"],e:!1},{a:"node_out",c:"Dg",f:["vec3"],e:!1}],j:[{a:"txt",b:"Dg = clamp ( Df , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",m:[],l:[{a:"node_in",c:"Dh",f:["vec3"],e:!1},{a:"node_in",c:"Di",f:["float"],e:!1},{a:"node_out",c:"Dj",f:["vec3"],e:!1}],j:[{a:"txt",b:["Dj","=","Dh",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",m:[],l:[{a:"node_in",c:"Dk",f:["float"],e:!1},{a:"node_in",c:"Dl",f:["float"],e:!1},{a:"node_in",c:"Dm",f:["float"],
e:!1},{a:"node_in",c:"Dn",f:["float"],e:!1},{a:"node_in",c:"Do",f:["float"],e:!1},{a:"node_out",c:"Dp",f:["float"],e:!0},{a:"node_out",c:"Dq",f:["vec4"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dp"],j:[{a:"txt",b:["Dp","=","Dk",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["USE_OUT_Dq"],j:[{a:"txt",b:"Dq = vec4 ( Dl , Dm , Dn , Do ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",m:[],l:[{a:"node_out",c:"Dr",f:["float"],e:!1}],j:[{a:"txt",b:["Dr","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
m:[],l:[{a:"node_in",c:"Ds",f:["float"],e:!1},{a:"node_in",c:"Dt",f:["float"],e:!1},{a:"node_in",c:"Du",f:["float"],e:!1},{a:"node_out",c:"Dv",f:["float"],e:!1}],j:[{a:"txt",b:"Dv = smoothstep ( Dt , Du , Ds ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",m:[],l:[{a:"node_in",c:"Dw",f:["vec3"],e:!1},{a:"node_in",c:"Dx",f:["float"],e:!1}],j:[{a:"txt",b:"v = Dw ; D = Dx ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",m:[],l:[{a:"node_in",c:"Dy",f:["vec3"],e:!1},{a:"node_out",c:"Dz",f:["float"],e:!1}],
j:[{a:"txt",b:"Dz = ( Dy . r + Dy . g + Dy . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",m:[],l:[{a:"node_in",c:"DA",f:["float"],e:!1},{a:"node_out",c:"DB",f:["vec3"],e:!1}],j:[{a:"txt",b:"DB [ 0 ] = DA ; DB [ 1 ] = DA ; DB [ 2 ] = DA ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void E ( in vec3 nv , out vec3 v , out vec3 A , out vec3 B , out vec4 C , out float D ) { v = vec3 ( _0_0 ) ; A = vec3 ( _0_0 ) ; B = vec3 ( _0_0 ) ; C = vec4 ( _0_0 ) ; D = _0_0 ;".split(" ")},{a:"cond",d:[{a:"if",
g:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",i:11}],h:{a:"grp",d:[{a:"txt",b:"vec3 L = normalize ( e ) ; vec3 bC = L ;".split(" ")},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bC = bC ; else bC = - bC ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",d:[{a:"txt",b:["vec3","nu","=","bC",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","nu","=","L",";"]}]}}]},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",d:[{a:"txt",b:["vec3","qW","=","bC",";"]}]}}]}]}}]},{a:"cond",
d:[{a:"if",g:["CALC_TBN_SPACE"],h:{a:"grp",d:[{a:"txt",b:"vec3 N = cross ( bC , f . xyz ) * f . w ; N = normalize ( N ) ; vec3 M = cross ( N , bC ) * f . w ; mat3 qX = mat3 ( M , N , bC ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nt = c ; vec4 qY = d ; float qZ = u_emit ; float q_ = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",h:{a:"grp",d:[{a:"define",c:"PARTICLES_NODES_GLSLV",b:[""]},
{a:"node",c:"TEX_COORD_UV",m:[],l:[],j:[{a:"txt",b:["n","=","Es",";"]}]},{a:"node",c:"UV_MERGED",m:[],l:[],j:[{a:"txt",b:["n","=","Es",";"]}]},{a:"node",c:"UVMAP",m:[],l:[],j:[{a:"txt",b:["n","=","Es",";"]}]},{a:"node",c:"GEOMETRY_UV",m:[],l:[],j:[{a:"txt",b:["n","=","Es",";"]}]},{a:"node",c:"PARTICLE_INFO",m:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],l:[{a:"node_param",c:"DZ",f:["GLSL_OUT","vec4"],e:!0},{a:"node_param",c:"D_",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"Ea",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"Eb",f:["GLSL_OUT","vec3"],e:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",f:["GLSL_IN","float"],e:!0}],j:[{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_SIZE"],j:[{a:"txt",b:"DZ [ 3 ] = Er ;".split(" ")}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_AGE"],j:[{a:"txt",b:"DZ [ 1 ] = Eq ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LT"],j:[{a:"txt",b:"DZ [ 2 ] = Et ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_LOC"],j:[{a:"txt",b:["D_","=","En",";"]}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_IND"],j:[{a:"txt",b:"DZ [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",d:[{a:"node_if",g:["PART_INFO_VEL"],j:[{a:"txt",b:["Ea","=","Eo",";"]}]}]},{a:"node_cond",
d:[{a:"node_if",g:["PART_INFO_A_VEL"],j:[{a:"txt",b:["Eb","=","Ep",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void E ( in vec3 En , in vec3 Eo , in vec3 Ep , in float Eq , in float Er , in vec2 Es , in float Et ) {".split(" ")},{a:"cond",d:[{a:"if",g:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["n","=","Es",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
h:{a:"grp",d:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"PROCEDURAL_GLSLF",h:{a:"grp",d:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 Eu ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 Eu ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 Eu ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 Ev ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 Ew ( vec4 x ) { return Eu ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eT ( vec2 Ex ) { vec2 Ey = Eu ( floor ( Ex ) ) ; vec2 Ez = fract ( Ex ) ; vec4 EA = Ez . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 EB = Ez . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Ew ( Ey . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Ew ( p + Ey . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 EC = Ev ( p ) * K + K2 ; vec4 ED = Ev ( floor ( p * K ) ) * K + K2 ; vec4 EE = EA + JITTER * EC ; vec4 EF = EB + JITTER * ED ; vec4 dc = EE * EE + EF * EF ;".split(" ")},
{a:"cond",d:[{a:"if",g:[1],h:{a:"grp",d:[{a:"txt",b:"dc . xy = min ( dc . xy , dc . zw ) ; dc . x = min ( dc . x , dc . y ) ; return dc . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"dc . xy = ( dc . x < dc . y ) ? dc . xy : dc . yx ; dc . xz = ( dc . x < dc . z ) ? dc . xz : dc . zx ; dc . xw = ( dc . x < dc . w ) ? dc . xw : dc . wx ; dc . y = min ( dc . y , dc . z ) ; dc . y = min ( dc . y , dc . w ) ; return sqrt ( dc . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 km ( vec2 Ex , float EG ) { vec2 Ey = Eu ( floor ( Ex ) ) ; vec2 Ez = fract ( Ex ) ; vec4 EA = Ez . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 EB = Ez . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = Ew ( Ey . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = Ew ( p + Ey . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 EC = Ev ( p ) * K + K2 ; vec4 ED = Ev ( floor ( p * K ) ) * K + K2 ; vec4 EE = EA + JITTER * EC ; vec4 EF = EB + JITTER * ED ; vec4 EH = EE * EE + EF * EF ; EE += EG ; EF += EG ; vec4 EI = EE * EE + EF * EF ; EE += EG ; EF += EG ; vec4 EJ = EE * EE + EF * EF ; EH . xy = min ( EH . xy , EH . zw ) ; EH . x = min ( EH . x , EH . y ) ; EI . xy = min ( EI . xy , EI . zw ) ; EI . x = min ( EI . x , EI . y ) ; EJ . xy = min ( EJ . xy , EJ . zw ) ; EJ . x = min ( EJ . x , EJ . y ) ; return vec3 ( EH . x , EI . x , EJ . x ) ; } vec3 EK ( vec3 x ) { return Eu ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eI ( vec2 kf ) { const vec4 EL = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bN = floor ( kf + dot ( kf , EL . yy ) ) ; vec2 EM = kf - bN + dot ( bN , EL . xx ) ; vec2 EN ; EN = ( EM . x > EM . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 EO = EM . xyxy + EL . xxzz ; EO . xy -= EN ; bN = Eu ( bN ) ; vec3 p = EK ( EK ( bN . y + vec3 ( _0_0 , EN . y , _1_0 ) ) + bN . x + vec3 ( _0_0 , EN . x , _1_0 ) ) ; vec3 al = max ( 0.5 - vec3 ( dot ( EM , EM ) , dot ( EO . xy , EO . xy ) , dot ( EO . zw , EO . zw ) ) , _0_0 ) ; al = al * al ; al = al * al ; vec3 x = 2.0 * fract ( p * EL . www ) - _1_0 ; vec3 bL = abs ( x ) - 0.5 ; vec3 EC = floor ( x + 0.5 ) ; vec3 EP = x - EC ; al *= 1.79284291400159 - 0.85373472095314 * ( EP * EP + bL * bL ) ; vec3 g ; g . x = EP . x * EM . x + bL . x * EM . y ; g . yz = EP . yz * EO . xz + bL . yz * EO . yw ; return 130.0 * dot ( al , g ) ; } vec2 ES ( vec2 fj ) { float EH = dot ( fj , vec2 ( 12.9898 , 78.233 ) ) ; float EI = dot ( fj , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float EQ = fract ( sin ( EH ) * 43758.5453 ) * 2.0 - _1_0 ; float ER = fract ( sin ( EI ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( EQ , ER ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"REFRACTION_GLSLF",h:{a:"grp",d:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",d:[{a:"if",g:["REFRACTIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"include",o:"pack.glslf"}]}}]},{a:"include",o:"color_util.glslf"},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"float ei ( in float ct , inout vec2 eh , in vec2 dR ) { vec4 ET = GLSL_TEXTURE ( u_scene_depth , eh ) ; float ej = cs ( ET ) ; if ( ej < i ) { eh = dR ; return ct ; } else { return ej ; } return ct ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cp ( in vec3 qh , in vec2 EU ) { vec2 dR = qh . xy / qh . z ; vec2 eh = dR + EU ;".split(" ")},{a:"cond",d:[{a:"if",g:["USE_REFRACTION_CORRECTION"],h:{a:"grp",d:[{a:"txt",b:"vec4 cr = GLSL_TEXTURE_PROJ ( u_scene_depth , qh ) ; float ct = cs ( cr ) ; ei ( ct , eh , dR ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 en = GLSL_TEXTURE ( u_refractmap , eh ) . rgb ; bV ( en ) ; return en ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
h:{a:"grp",d:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ak ( vec2 bB , vec3 EV ) { return ( bB + 0.5 ) * EV . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLF",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"procedural.glslf"}]}}]},{a:"cond",d:[{a:"if",
g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"const float EW = 0.1 ; const float EX = 0.1 ; const float EY = - 0.01 ; const float EZ = 0.05 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 E_ = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 Fa = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 Fb = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 Fc = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 Fd = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 Fe = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 Ff = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 Fg = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",g:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 E_ = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 Fa = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 Fb = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 Fc = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 Fd = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 Fe = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 Ff = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 Fg = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",g:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 E_ = vec2 ( - 0.51808083 , 0.0 ) ; vec2 Fa = vec2 ( 0.5741194 , 0.0 ) ; vec2 Fb = vec2 ( - 0.68048857 , 0.0 ) ; vec2 Fc = vec2 ( 0.82934988 , 0.0 ) ; vec2 Fd = vec2 ( 0.70009436 , 0.0 ) ; vec2 Fe = vec2 ( - 0.78790467 , 0.0 ) ; vec2 Ff = vec2 ( - 0.58619489 , 0.0 ) ; vec2 Fg = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool Fi ( vec2 hW , float Fh ) { return all ( lessThanEqual ( hW , vec2 ( 1.0 + Fh ) ) ) && all ( greaterThanEqual ( hW , vec2 ( 0.0 - Fh ) ) ) ; } float Fp ( float Fj , float Fk , mat2 Fl , vec3 Fm , float Fn , PRECISION GLSL_SMPLR2D_SHDW Fo ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec2 hW , eV ; eV . x = Fj ; eV . y = Fk ; eV = Fl * eV ; hW = Fm . xy + eV * Fn / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec2 hW = Fm . xy ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"if ( ! Fi ( hW , EY ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["COMPARED_MODE"],h:{a:"grp",
d:[{a:"txt",b:"return GLSL_TEXTURE ( Fo , vec3 ( hW , Fm . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return step ( Fm . z , GLSL_TEXTURE ( Fo , hW ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float Fu ( vec3 Fm , PRECISION GLSL_SMPLR2D_SHDW Fo , float Fn ) { float Fq = 0.0 ; Fm . z = clamp ( Fm . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Fr = ES ( Fm . xy ) . x * M_PI ; float Fs = cos ( Fr ) ; float Ft = sin ( Fr ) ; mat2 Fl = mat2 ( Fs , Ft , - Ft , Fs ) ; for ( int bN = 0 ; bN < POISSON_DISK_NUM ; bN ++ ) { Fq += Fp ( E_ [ bN ] , Fd [ bN ] , Fl , Fm , Fn , Fo ) ; Fq += Fp ( Fa [ bN ] , Fe [ bN ] , Fl , Fm , Fn , Fo ) ; Fq += Fp ( Fb [ bN ] , Ff [ bN ] , Fl , Fm , Fn , Fo ) ; Fq += Fp ( Fc [ bN ] , Fg [ bN ] , Fl , Fm , Fn , Fo ) ; } return clamp ( Fq / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"return Fp ( 0.0 , 0.0 , mat2 ( 0.0 ) , Fm , Fn , Fo ) ;".split(" ")}]}}]},{a:"txt",b:"} float FD ( vec3 Fv , PRECISION GLSL_SMPLR2D_SHDW Fw , vec3 Fx , PRECISION GLSL_SMPLR2D_SHDW Fy , float Fz , float FA , float ay ) { float FB , FC ; Fv . z = clamp ( Fv . z , 0.0 , 1.0 ) ; Fx . z = clamp ( Fx . z , 0.0 , 1.0 ) ; FB = 0.0 ; FC = 0.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float Fr = ES ( Fv . xy ) . x * M_PI ; float Fs = cos ( Fr ) ; float Ft = sin ( Fr ) ; mat2 Fl = mat2 ( Fs , Ft , - Ft , Fs ) ; for ( int bN = 0 ; bN < POISSON_DISK_NUM ; bN ++ ) { FB += Fp ( E_ [ bN ] , Fd [ bN ] , Fl , Fv , Fz , Fw ) ; FB += Fp ( Fa [ bN ] , Fe [ bN ] , Fl , Fv , Fz , Fw ) ; FB += Fp ( Fb [ bN ] , Ff [ bN ] , Fl , Fv , Fz , Fw ) ; FB += Fp ( Fc [ bN ] , Fg [ bN ] , Fl , Fv , Fz , Fw ) ; } for ( int bN = 0 ; bN < POISSON_DISK_NUM ; bN ++ ) { FC += Fp ( E_ [ bN ] , Fd [ bN ] , Fl , Fx , FA , Fy ) ; FC += Fp ( Fa [ bN ] , Fe [ bN ] , Fl , Fx , FA , Fy ) ; FC += Fp ( Fb [ bN ] , Ff [ bN ] , Fl , Fx , FA , Fy ) ; FC += Fp ( Fc [ bN ] , Fg [ bN ] , Fl , Fx , FA , Fy ) ; } FB = mix ( FB , FC , ay ) ; FB /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"FB += Fp ( 0.0 , 0.0 , mat2 ( 0.0 ) , Fv , Fz , Fw ) ; FC += Fp ( 0.0 , 0.0 , mat2 ( 0.0 ) , Fx , FA , Fy ) ; FB = mix ( FB , FC , ay ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( FB , 0.0 , 1.0 ) ; } float FE ( vec2 hW ) { float a = min ( hW . x , hW . y ) ; float b = min ( 1.0 - hW . x , 1.0 - hW . y ) ; return min ( a , b ) ; } float FG ( float sZ , float FF ) { if ( FF >= 0.0 && FF <= EX ) sZ = ( sZ - 1.0 ) / EX * FF + 1.0 ; return sZ ; } float FL ( vec3 FH , vec3 FI , PRECISION GLSL_SMPLR2D_SHDW Fw , PRECISION GLSL_SMPLR2D_SHDW Fy , float Fz , float FA , float FJ , float fK ) { float sZ ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",d:[{a:"txt",b:"float FF = FE ( FH . xy ) ; if ( - fK > FJ && FF >= 0.0 && FF <= EW && Fi ( FI . xy , 0.0 ) ) { float FK = 1.0 - FF / EW ; sZ = FD ( FH , Fw , FI , Fy , Fz , FA , FK ) ; } else".split(" ")}]}}]},{a:"txt",b:"sZ = Fu ( FH , Fw , Fz ) ; return sZ ; } float FN ( vec3 FM , PRECISION GLSL_SMPLR2D_SHDW Fo , float Fn , float FJ , float fK ) { float sZ = Fu ( FM , Fo , Fn ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",d:[{a:"txt",b:"if ( - fK > FJ ) { float FF = FE ( FM . xy ) ; sZ = FG ( sZ , FF ) ; }".split(" ")}]}}]},{a:"txt",b:"return sZ ; } vec4 dA ( float fK ) { float sZ = 1.0 ;".split(" ")},{a:"cond",d:[{a:"if",g:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["vec4","FO","=","u_pcf_blur_radii",";"]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 FO = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Fv = j . xyz / j . w ; if ( j . w < 0.0 ) Fv . z = 0.0 ;".split(" ")},
{a:"cond",d:[{a:"if",g:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Fx = k . xyz / k . w ; if ( k . w < 0.0 ) Fx . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 FP = l . xyz / l . w ; if ( l . w < 0.0 ) FP . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 FQ = m . xyz / m . w ; if ( m . w < 0.0 ) FQ . z = 0.0 ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"if ( Fi ( Fv . xy , 0.0 ) ) { sZ = FL ( Fv , Fx , u_shadow_map0 , u_shadow_map1 , FO [ 0 ] , FO [ 1 ] , u_csm_center_dists [ 0 ] , fK ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"if ( Fi ( Fv . xy , EZ ) ) { sZ = FN ( Fv , u_shadow_map0 , FO [ 0 ] , u_csm_center_dists [ 0 ] , fK ) ; }".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",b:"else { if ( Fi ( Fx . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"sZ = FL ( Fx , FP , u_shadow_map1 , u_shadow_map2 , FO [ 1 ] , FO [ 2 ] , u_csm_center_dists [ 1 ] , fK ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sZ = FN ( Fx , u_shadow_map1 , FO [ 1 ] , u_csm_center_dists [ 1 ] , fK ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",
b:"else { if ( Fi ( FP . xy , 0.0 ) ) {".split(" ")},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"sZ = FL ( FP , FQ , u_shadow_map2 , u_shadow_map3 , FO [ 2 ] , FO [ 3 ] , u_csm_center_dists [ 2 ] , fK ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"sZ = FN ( FP , u_shadow_map2 , FO [ 2 ] , u_csm_center_dists [ 2 ] , fK ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"else { if ( Fi ( FQ . xy , 0.0 ) ) sZ = FN ( FQ , u_shadow_map3 , FO [ 3 ] , u_csm_center_dists [ 3 ] , fK ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float FR = Fu ( Fx , u_shadow_map1 , FO [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","FR","=","0.0",";"]}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float FS = Fu ( FP , u_shadow_map2 , FO [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","FS","=","0.0",";"]}]}}]},{a:"cond",
d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"float FT = Fu ( FQ , u_shadow_map3 , FO [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:["float","FT","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( sZ , FR , FS , FT ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ce ( inout vec3 ca ) {".split(" ")},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Fq = GLSL_TEXTURE ( u_shadow_mask , h . xy / h . z ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"ca *= Fq . a ;".split(" ")}]}}]},{a:"txt",b:["return","Fq",";"]}]}},{a:"elif",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 Fq = dA ( d . z ) ; return Fq ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SHADOW_GLSLV",h:{a:"grp",d:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"txt",b:"vec4 FX ( mat4 FU , vec4 FV , mat4 FW ) { vec2 dC = ( FU * FW [ 3 ] ) . xy ; float dD = SHADOW_TEX_RES / 2.0 ; dC = floor ( dC * dD + 0.5 ) / dD - dC ; vec4 Fm = FU * FV ; Fm . xy += dC ; Fm . xyz = 0.5 * ( Fm . xyz + Fm . w ) ; return Fm ; } void bA ( vec3 eA , vec3 FY ) {".split(" ")},{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"mat4 FW = aO ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat4 FW = aO ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 FZ = FW * vec4 ( eA + u_normal_offset * FY , 1.0 ) ; j = FX ( u_p_light_matrix0 , FZ , FW ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"FW = aO ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"FW = aO ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"FZ = FW * vec4 ( eA + u_normal_offset * FY , 1.0 ) ; k = FX ( u_p_light_matrix1 , FZ , FW ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"FW = aO ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"FW = aO ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"FZ = FW * vec4 ( eA + u_normal_offset * FY , 1.0 ) ; l = FX ( u_p_light_matrix2 , FZ , FW ) ;".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MAC_OS_SHADOW_HACK"],h:{a:"grp",d:[{a:"txt",b:"FW = aO ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"FW = aO ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"FZ = FW * vec4 ( eA + u_normal_offset * FY , 1.0 ) ; m = FX ( u_p_light_matrix3 , FZ , FW ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION1"],h:{a:"grp",d:[{a:"txt",
b:"k = FX ( u_p_light_matrix1 , FZ , FW ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION2"],h:{a:"grp",d:[{a:"txt",b:"l = FX ( u_p_light_matrix2 , FZ , FW ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["CSM_SECTION3"],h:{a:"grp",d:[{a:"txt",b:"m = FX ( u_p_light_matrix3 , FZ , FW ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKIN_GLSLV",h:{a:"grp",d:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",d:[{a:"if",g:["SKINNED"],h:{a:"grp",d:[{a:"include",o:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 Gg ( in vec4 gF , in vec4 F_ , in float Ga ) { float Gb = gF [ 0 ] * F_ [ 0 ] + gF [ 1 ] * F_ [ 1 ] + gF [ 2 ] * F_ [ 2 ] + gF [ 3 ] * F_ [ 3 ] ; if ( Gb < 0.0 ) { F_ *= - 1.0 ; Gb = - Gb ; } if ( abs ( Gb ) >= 1.0 ) return gF ; float Gc = acos ( Gb ) ; float Gd = sqrt ( 1.0 - Gb * Gb ) ; if ( abs ( Gd ) < 0.001 ) return vec4 ( gF * 0.5 + F_ * 0.5 ) ; float Ge = sin ( ( 1.0 - Ga ) * Gc ) / Gd ; float Gf = sin ( Ga * Gc ) / Gd ; return gF * Ge + F_ * Gf ; }".split(" ")}]}}]},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"vec3 Gu ( in vec3 I , in vec4 Gh , in vec4 Gi , in vec4 Gj , in vec4 Gk , in float Gl ) { vec3 Gm = pZ ( u_arm_rel_trans , u_arm_rel_quat , I ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gF = Gg ( Gh , Gi , Gl ) ; vec4 Gn = mix ( Gj , Gk , Gl ) ; vec3 Go = J ( gF , Gm ) ; vec3 Gp = Go * Gn . w + Gn . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Gq = J ( Gh , Gm ) ; vec3 Gr = J ( Gi , Gm ) ; vec3 Gs = Gq * Gj . w + Gj . xyz ; vec3 Gt = Gr * Gk . w + Gk . xyz ; vec3 Gp = mix ( Gs , Gt , Gl ) ;".split(" ")}]}}]},
{a:"txt",b:"return qb ( u_arm_rel_trans , u_arm_rel_quat , Gp ) ; } vec3 GA ( in vec3 Gv , in vec4 Gh , in vec4 Gi , in float Gl ) { vec3 Gw = qa ( u_arm_rel_trans , u_arm_rel_quat , Gv ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["SKIN_SLERP"],h:{a:"grp",d:[{a:"txt",b:"vec4 gF = Gg ( Gh , Gi , Gl ) ; vec3 Gx = J ( gF , Gw ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Gy = J ( Gh , Gw ) ; vec3 Gz = J ( Gi , Gw ) ; vec3 Gx = mix ( Gy , Gz , Gl ) ;".split(" ")}]}}]},{a:"txt",b:"return qc ( u_arm_rel_trans , u_arm_rel_quat , Gx ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Gu ( in vec3 I , in vec4 Gh , in vec4 Gj ) { vec3 Gm = pZ ( u_arm_rel_trans , u_arm_rel_quat , I ) ; vec3 Go = J ( Gh , Gm ) ; vec3 Gp = Go * Gj . w + Gj . xyz ; return qb ( u_arm_rel_trans , u_arm_rel_quat , Gp ) ; } vec3 GA ( in vec3 Gv , in vec4 Gh ) { vec3 Gw = qa ( u_arm_rel_trans , u_arm_rel_quat , Gv ) ; vec3 Gx = J ( Gh , Gw ) ; return qc ( u_arm_rel_trans , u_arm_rel_quat , Gx ) ; }".split(" ")}]}}]},{a:"txt",b:"void W ( inout vec3 I , inout vec3 M , inout vec3 N , inout vec3 L ) {".split(" ")},
{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:["float","GB","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iR = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 GC = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 GD = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 GE = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 GF = a_influence ; for ( int bN = 0 ; bN < 4 ; bN ++ ) { int GG = int ( GF [ bN ] ) ; float GH = fract ( GF [ bN ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",
b:"GC += GH * GA ( M , u_quatsb [ GG ] , u_quatsa [ GG ] , GB ) ; GD += GH * GA ( N , u_quatsb [ GG ] , u_quatsa [ GG ] , GB ) ; GE += GH * GA ( L , u_quatsb [ GG ] , u_quatsa [ GG ] , GB ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"iR += GH * Gu ( I , u_quatsb [ GG ] , u_transb [ GG ] ) ; GE += GH * GA ( L , u_quatsb [ GG ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"GC += GH * GA ( M , u_quatsb [ GG ] ) ; GD += GH * GA ( N , u_quatsb [ GG ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"int GG = int ( GF [ 0 ] ) ; float GH = fract ( GF [ 0 ] ) ; iR += GH * Gu ( I , u_quatsb [ GG ] , u_quatsa [ GG ] , u_transb [ GG ] , u_transa [ GG ] , GB ) ; GG = int ( GF [ 1 ] ) ; GH = fract ( GF [ 1 ] ) ; iR += GH * Gu ( I , u_quatsb [ GG ] , u_quatsa [ GG ] , u_transb [ GG ] , u_transa [ GG ] , GB ) ; GG = int ( GF [ 2 ] ) ; GH = fract ( GF [ 2 ] ) ; iR += GH * Gu ( I , u_quatsb [ GG ] , u_quatsa [ GG ] , u_transb [ GG ] , u_transa [ GG ] , GB ) ; GG = int ( GF [ 3 ] ) ; GH = fract ( GF [ 3 ] ) ; iR += GH * Gu ( I , u_quatsb [ GG ] , u_quatsa [ GG ] , u_transb [ GG ] , u_transa [ GG ] , GB ) ;".split(" ")}]}}]},
{a:"txt",b:"I = iR ; L = GE ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"M = GC ; N = GD ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int GI = int ( a_influence [ 0 ] - 1.0 ) ; if ( GI > - 1 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["FRAMES_BLENDING"],h:{a:"grp",d:[{a:"txt",b:"I = Gu ( I , u_quatsb [ GI ] , u_quatsa [ GI ] , u_transb [ GI ] , u_transa [ GI ] , GB ) ; M = GA ( M , u_quatsb [ GI ] , u_quatsa [ GI ] , GB ) ; N = GA ( N , u_quatsb [ GI ] , u_quatsa [ GI ] , GB ) ; L = GA ( L , u_quatsb [ GI ] , u_quatsa [ GI ] , GB ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"I = Gu ( I , u_quatsb [ GI ] , u_transb [ GI ] ) ; L = GA ( L , u_quatsb [ GI ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"M = GA ( M , u_quatsb [ GI ] ) ; N = GA ( N , u_quatsb [ GI ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",h:{a:"grp",d:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",o:"std.glsl"},{a:"include",o:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 GJ ( vec3 jy , vec3 jz , float ay , float jY ) { float jA = ay * jY ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE",
"MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jB ( jz , jy , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jC ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jD ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jF ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jG ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jH ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jy , jz , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","HUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jP ( jz , jy , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jQ ( jz , jy , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE",
"VALUE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jR ( jz , jy , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jS ( jz , jy , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jz , jy , jA ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jz , jy , jA ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float GK ( float jW , float jX , float ay , float jY ) { vec3 jy = vec3 ( jW ) , jz = vec3 ( jX ) ; float jA = ay * jY ;".split(" ")},{a:"cond",d:[{a:"if",g:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jB ( jz , jy , jA ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jC ( jy , jz , jA ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",
d:[{a:"txt",b:"return jD ( jy , jz , jA ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jZ ( jW , jX , jA , jY ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return j_ ( jW , jX , jA , jY ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return ka ( jW , jX , jA , jY ) ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jI ( jy , jz , jA ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jJ ( jy , jz , jA ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jK ( jy , jz , jA ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jL ( jy , jz , jA ) . x ;".split(" ")}]}},{a:"elif",
g:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jU ( jz , jy , jA ) . x ;".split(" ")}]}},{a:"elif",g:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"return jV ( jz , jy , jA ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dK ( vec3 dG , vec3 dH , vec4 dJ , float dF , vec3 dI ) { float GL = 1.0 ; GL = dJ . a ;".split(" ")},{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"GL = fq ( dJ ) ;".split(" ")}]}}]},{a:"cond",
d:[{a:"if",g:["MTEX_NEGATIVE"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"dJ = vec4 ( vec3 ( 1.0 ) - dJ . rgb , dJ . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"GL = 1.0 - GL ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT"],h:{a:"grp",d:[{a:"txt",b:"dJ = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"GL = dJ . a ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_HORIZ"],h:{a:"grp",d:[{a:"txt",b:"dG = GJ ( dJ . rgb , dG , GL , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:["float","GM","=","0.0",";"]},{a:"cond",d:[{a:"if",g:["WO_SKYREAL"],h:{a:"grp",d:[{a:"txt",b:"if ( dot ( dI , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],
h:{a:"grp",d:[{a:"txt",b:"GM = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",d:[{a:"if",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"else GM = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["WOMAP_ZENUP"],h:{a:"grp",d:[{a:"txt",b:"GM = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",g:["WOMAP_ZENDOWN"],h:{a:"grp",d:[{a:"txt",b:"GM = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( GM != 0.0 ) dH = GJ ( dJ . rgb , dH , GL , GM ) ;".split(" ")}]}}]}]}}]},{a:"cond",d:[{a:"if",g:["WOMAP_BLEND"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",d:[{a:"txt",b:"GL = dot ( dJ . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dF = GK ( u_sky_tex_dvar , dF , GL , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["WO_SKYBLEND"],h:{a:"grp",d:[{a:"txt",b:"vec3 dE = mix ( dG , dH , dF ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:["vec3","dE","=","dG",";"]}]}}]},{a:"txt",b:["return","dE",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"STD_ENUMS_GLSL",h:{a:"grp",d:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",d:[{a:"if",g:["CONSTANTS_HACK"],h:{a:"grp",d:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"TO_WORLD_GLSLV",h:{a:"grp",d:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",o:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 aU ( vec3 GN , mat3 H ) { vec4 GO = vec4 ( H [ 1 ] [ 1 ] , H [ 1 ] [ 2 ] , H [ 2 ] [ 0 ] , H [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec4 GP = cF ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec4 GP = cF ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"GO = pS ( GP , GO ) ; GO = kg ( GO ) ; mat3 aV = cD ( ) ; aV [ 0 ] = GN ; aV = cH ( GO , aV ) ; return aV ; }".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 GR ( vec3 kI , vec3 GN ) { vec3 GQ = kI - GN ; GQ . z = 0.0 ; GQ = normalize ( GQ ) ; vec4 GO = pX ( GQ , TOWARD_VECTOR ) ; mat3 aV = cD ( ) ; aV [ 0 ] = GN ; aV = cH ( GO , aV ) ; return aV ; }".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BILLBOARD_JITTERED"],h:{a:"grp",d:[{a:"txt",b:"mat3 ad ( in vec3 GS , float GT , float GU , float GV , vec3 aN , mat3 O ) { float GW = fract ( length ( aN ) / 0.17 ) ; float GX = GV + GW / 10.0 ; float GY = GW ; if ( GV != 0.0 ) GY /= GV ; GS *= 1.0 + 0.5 * sin ( GT ) ; float GZ = length ( GS ) * GU * sin ( 2.0 * 3.14 * GT * GX + GY ) ; vec4 G_ = cF ( TOWARD_VECTOR , GZ ) ; vec4 Ha = vec4 ( O [ 1 ] [ 1 ] , O [ 1 ] [ 2 ] , O [ 2 ] [ 0 ] , O [ 2 ] [ 1 ] ) ; Ha = pS ( Ha , G_ ) ; O = cH ( Ha , O ) ; return O ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ac ( in vec3 kI , in vec3 Z , in mat3 H ) {".split(" ")},{a:"cond",d:[{a:"if",g:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 kX = aU ( Z , H ) ;".split(" ")}]}},{a:"elif",g:["BILLBOARD_RANDOM"],h:{a:"grp",d:[{a:"txt",b:"float GW = fract ( ( Z . x * 1.43 - Z . z * 0.123 + Z . y * 6.1 ) ) ; float Hb = 2.0 * M_PI * GW ; vec4 Hc = vec4 ( H [ 1 ] [ 1 ] , H [ 1 ] [ 2 ] , H [ 2 ] [ 0 ] , H [ 2 ] [ 1 ] ) ; float Hd = asin ( 2.0 * ( Hc . x * Hc . y - Hc . z * Hc . w ) ) ; float gW = Hd - Hb ; if ( gW < 0.0 ) gW = 2.0 * M_PI + gW ; float He = Hb ; if ( gW <= MAX_BILLBOARD_ANGLE ) He += gW ; else if ( gW <= M_PI - MAX_BILLBOARD_ANGLE ) He += MAX_BILLBOARD_ANGLE * ( 2.0 * gW - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gW <= M_PI + MAX_BILLBOARD_ANGLE ) He += gW - M_PI ; else if ( gW <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) He += MAX_BILLBOARD_ANGLE * ( 2.0 * gW - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else He += gW - 2.0 * M_PI ; vec4 Hf = cF ( UP_VECTOR , He ) ; mat3 kX ; kX [ 0 ] = Z ; kX [ 1 ] [ 0 ] = 1.0 ; kX = cH ( Hf , kX ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",d:[{a:"txt",b:"mat3 kX = GR ( kI , Z ) ;".split(" ")}]}}]},{a:"txt",b:["return","kX",";","}"]},{a:"cond",d:[{a:"if",g:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"mat3 _ ( in vec3 kI , in vec3 Z , in mat3 H , in mat3 O ) { mat3 kX = ac ( kI , Z , H ) ; O [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; kX = aL ( kX , O ) ; return kX ; }".split(" ")}]}}]},
{a:"txt",b:"ae af ( in vec3 eA , in vec3 Hg , in vec3 Hh , in vec3 Hi , in vec3 Hj , in vec3 Hk , in mat3 O ) { eA = Y ( O , eA ) ; Hg = Y ( O , Hg ) ; Hh = P ( O , Hh ) ; Hi = P ( O , Hi ) ; Hj = P ( O , Hj ) ; Hk = P ( O , Hk ) ; return kY ( ae ( eA , Hg , Hh , Hi , Hj , Hk , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",d:[{a:"cond",d:[{a:"ifndef",c:"WIND_BENDING_GLSLV",h:{a:"grp",d:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",o:"std.glsl"},{a:"cond",d:[{a:"if",g:["WIND_BEND"],h:{a:"grp",d:[{a:"txt",b:"void Hx ( inout vec3 aZ , in vec3 Hl , in float Hm , in float Hn , in float eH , in vec3 GS , in float Ho , in mat4 bv ) {".split(" ")},{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",
{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Hp = ( bv * vec4 ( aZ , 1.0 ) ) . xyz ; vec3 Hq = ( bv * vec4 ( Hl , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hp = aZ ; vec3 Hq = Hl ;".split(" ")}]}}]},{a:"txt",b:"float dd = length ( Hq ) ; float Hr = Hn * ( 1.0 + 0.1 * fract ( dd ) ) ; float Hs = Hm * Ho * ( 1.0 + sin ( 2.0 * 3.14 * eH * Hr + dd ) ) ; float Ht = ( Hp . z - Hq . z ) * abs ( Hs ) ; Ht += 1.0 ; Ht *= Ht ; Ht = Ht * Ht - Ht ; vec3 Hu = Hp ; Hu . xy += GS . xy * Ht * sign ( Hs ) ; vec3 Hv = Hu - Hq ; if ( all ( equal ( Hv , vec3 ( 0.0 ) ) ) ) aZ = Hl ; else {".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"Hv = ( bv * vec4 ( Hv , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float Hw = length ( Hp - Hq ) ; aZ = Hl + normalize ( Hv ) * Hw ; } }".split(" ")},{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"vec4 Hy ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 Hz ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 HA ( vec4 x ) { return Hy ( Hz ( x ) ) ; } void HM ( inout vec3 aZ , in float eH , in vec3 L , in vec3 GS , in vec3 Hl , in float HB , in float HC , in float HD , in vec3 HE , in mat4 bv ) { float HF ; float HG ; float HH ; vec2 HI ; vec4 HJ ; vec2 HK ; vec3 HL ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"vec3 Hp = ( bv * vec4 ( aZ , 1.0 ) ) . xyz ; vec3 Hq = ( bv * vec4 ( Hl , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 Hp = aZ ; vec3 Hq = Hl ;".split(" ")}]}}]},{a:"txt",b:"HF = dot ( Hq , vec3 ( 1.0 ) ) ; HG = HF + HE . g ; HH = dot ( Hp , vec3 ( HE . g ) ) ; HI = ( eH + vec2 ( HH , HG ) ) ; HJ = ( ( fract ( ( HI . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( GS ) * HB ; HJ = HA ( HJ ) ; HK = HJ . xz + HJ . yw ; HK . y = 0.5 - HK . y ; HL = HK . xxy * HE . rrb * vec3 ( HC * L . x , HC * L . y , HD ) ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"HL = ( bv * vec4 ( HL , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["aZ","+=","HL",";","}"]}]}}]},{a:"txt",b:"void ai ( inout vec3 I , inout vec3 X , in vec3 L , in mat4 bv ) { vec3 HN = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"vec3 HO = X ; vec3 HP = a_emitter_center ;".split(" ")},
{a:"cond",d:[{a:"if",g:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",i:2},"BILLBOARD",{a:"logical_and_expr",i:2}],h:{a:"grp",d:[{a:"txt",b:"HP = ( bv * vec4 ( HP , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"vec3 HO = I ; vec3 HP = X ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["MAIN_BEND_COL"],h:{a:"grp",d:[{a:"cond",d:[{a:"if",g:["DETAIL_BEND"],h:{a:"grp",d:[{a:"txt",b:"HM ( HO , u_time , L , HN , HP , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , bv ) ;".split(" ")}]}}]},
{a:"txt",b:"Hx ( HO , HP , au_wind_bending_amp , au_wind_bending_freq , u_time , HN , a_bending_col_main , bv ) ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"Hx ( HO , HP , au_wind_bending_amp , au_wind_bending_freq , u_time , HN , 1.0 , bv ) ;".split(" ")}]}}]},{a:"cond",d:[{a:"if",g:["BEND_CENTER_ONLY"],h:{a:"grp",d:[{a:"txt",b:"I += HO - X ; X = HO ;".split(" ")}]}},{a:"else",h:{a:"grp",d:[{a:"txt",b:"I = HO ; X = HP ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.animation=function(a,q){var e=q("__animation"),d=q("__armature"),b=q("__obj_util"),g=q("__print"),l=q("__tsr");a.SLOT_0=e.SLOT_0;a.SLOT_1=e.SLOT_1;a.SLOT_2=e.SLOT_2;a.SLOT_3=e.SLOT_3;a.SLOT_4=e.SLOT_4;a.SLOT_5=e.SLOT_5;a.SLOT_6=e.SLOT_6;a.SLOT_7=e.SLOT_7;a.SLOT_ALL=e.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=e.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=e.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=e.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=e.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=e.OBJ_ANIM_TYPE_SOUND;
a.OBJ_ANIM_TYPE_PARTICLES=e.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=e.OBJ_ANIM_TYPE_MATERIAL;a.AB_CYCLIC=e.AB_CYCLIC;a.AB_FINISH_RESET=e.AB_FINISH_RESET;a.AB_FINISH_STOP=e.AB_FINISH_STOP;var w=l.create();a.is_animated=function(a){return e.is_animated(a)};a.get_anim_names=function(a){return e.sC(a)?e.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.BL(a,b)};a.apply=function(a,b,d){if(d>e.SLOT_7)g.error("Can't apply animation to slot "+
d+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{d=d||e.SLOT_0;if(e.is_animated(a)){var l=e.get_slot_num_by_anim(a,b);if(-1!=l&&l!=d){g.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+l+'").');return}}e.EE(a,b)?e.apply(a,null,b,d):g.error('No fcurves in action "'+b+'"')}};a.apply_ext=function(a,b,d){if(d>e.SLOT_7)g.error("Can't apply animation to slot "+d+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{d=d||
e.SLOT_0;var l=b[0];if(e.is_animated(a)){var c=e.get_slot_num_by_anim(a,l);if(-1!=c&&c!=d){g.error('Animation "'+l+'" is already applied to object "'+a.name+'" (slot "'+c+'").');return}}e.EE(a,l)?e.apply(a,b.slice(1),l,d):g.error('No fcurves in action "'+l+'"')}};a.remove=function(a){e.remove(a)};a.remove_slot_animation=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.remove_slot_animation(a,b))};a.apply_def=function(a){e.apply_def(a)};a.play=function(a,b,d){e.is_animated(a)?(d=d||e.SLOT_0,e.play(a,
b,d),e.tQ(a,0,d,!0)):g.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.stop(a,b))};a.is_play=function(a,b){if(!e.is_animated(a))return!1;b=b||e.SLOT_0;return e.is_play(a,b)};a.set_frame=function(a,b,d){e.is_animated(a)&&(d=d||e.SLOT_0,e.set_frame(a,b,d))};a.set_first_frame=function(a,b){e.is_animated(a)&&e.set_first_frame(a,b)};a.set_last_frame=function(a,b){if(e.is_animated(a)){b=b||e.SLOT_0;var d=e.get_anim_start_frame(a,b),g=e.get_anim_length(a,
b);e.set_frame(a,d+g-e.AF,b)}};a.get_frame=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return e.cB(a,b)};a.set_speed=function(a,b,d){e.is_animated(a)&&(d=d||e.SLOT_0,e.set_speed(a,b||1,d))};a.get_speed=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return a.ba[b]?e.get_speed(a,b):0};a.get_anim_start_frame=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.ba[b])?e.get_anim_start_frame(a,b):-1};a.get_anim_length=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.ba[b])?
e.get_anim_length(a,b):-1};a.set_behavior=function(a,b,d){e.is_animated(a)&&(d=d||e.SLOT_0,e.set_behavior(a,b,d))};a.get_behavior=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.get_behavior(a,b)};a.apply_smoothing=function(a,b,d,g){g=g||e.SLOT_0;e.is_animated(a)&&e.apply_smoothing(a,b,d,g)};a.frame_to_sec=function(a){return e.frame_to_sec(a)};a.get_bone_translation=function(a,e,l){g.kb("get_bone_translation","armature.get_bone_tsr");if(!b.is_armature(a))return null;if(!d.Wn(a,
e))return g.error('There is no bone: "',e,'" in "',a.name,'".'),null;l||(l=new Float32Array(3));d.get_bone_tsr(a,e,!1,!1,w);l[0]=w[0];l[1]=w[1];l[2]=w[2];return l};a.get_first_armature_object=function(){g.Ec("get_first_armature_object() deprecated");return null};a.get_slot_num_by_anim=function(a,b){return e.is_animated(a)&&b?e.get_slot_num_by_anim(a,b):-1};a.get_anim_type=function(a,b){return e.is_animated(a)?e.get_anim_type(a,b):null};a.apply_to_first_empty_slot=function(a,b){return e.apply_to_first_empty_slot(a,
b)};a.get_skel_mix_factor=function(a){return a.k.Dg};a.set_skel_mix_factor=function(a,d,l){b.is_armature(a)?(d=Math.min(Math.max(d,0),1),a.k.Dg!=d&&e.set_skel_mix_factor(a,d,l||0)):g.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,q){var e=q("__anchors");q("__print");a.attach_move_cb=e.attach_move_cb;a.detach_move_cb=e.detach_move_cb;a.is_anchor=e.is_anchor;a.get_element_id=e.get_element_id;a.update=function(){e.update(!0)}};b4w.module.armature=function(a,q){var e=q("__armature"),d=q("__obj_util"),b=q("__transform"),g=q("__print");a.get_bone_tsr=function(a,b,f){if(!d.is_armature(a))return null;if(!e.Wn(a,b))return g.error('There is no bone: "',b,'" in "',a.name,'".'),null;f||(f=new Float32Array(8));e.get_bone_tsr(a,b,!1,!1,f);return f};a.get_bone_tsr_rel=function(a,b,f){if(!d.is_armature(a))return null;if(!e.Wn(a,b))return g.error('There is no bone: "',b,'" in "',a.name,'".'),null;f||(f=new Float32Array(8));e.get_bone_tsr(a,
b,!1,!0,f);return f};a.set_bone_tsr=function(a,q,f){d.is_armature(a)&&(e.Wn(a,q)?(e.set_bone_tsr(a,q,f,!1),b.B(a)):g.error('There is no bone: "',q,'" in "',a.name,'".'))};a.set_bone_tsr_rel=function(a,q,f){d.is_armature(a)&&(e.Wn(a,q)?(e.set_bone_tsr(a,q,f,!0),b.B(a)):g.error('There is no bone: "',q,'" in "',a.name,'".'))}};b4w.module.assets=function(a,q){var e=q("__assets");a.AT_ARRAYBUFFER=e.AT_ARRAYBUFFER;a.AT_JSON=e.AT_JSON;a.AT_TEXT=e.AT_TEXT;a.AT_AUDIOBUFFER=e.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=e.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=e.AT_AUDIO_ELEMENT;a.enqueue=function(a,b,g,l){if(a.length)if(a.id)e.enqueue(a,b,g,l);else{for(var q=[],f=0;f<a.length;f++){var n=a[f];q.push({id:n[0],type:n[1],url:n[2],Be:n.Be?n.Be:"GET",jj:null,Wh:null,Wb:n[3]})}e.enqueue(q,b,g,l)}}};b4w.module.camera=function(a,q){function e(a,b){r.kb("camera.set_pivot","camera.target_set_trans_pivot");d.is_target_camera(a)?(y.copy(b,a.k.pivot),c.B(a),n.sync_transform(a)):r.error("set_pivot(): Wrong object or camera move style")}var d=q("__camera");q("__config");var b=q("__constraints"),g=q("__container"),l=q("__mat4"),w=q("__math"),f=q("__obj_util"),n=q("__physics"),r=q("__print"),v=q("__scenes"),c=q("__transform"),m=q("__tsr"),p=q("__util"),y=q("__vec3"),E=q("__vec4"),u=q("__quat"),z=new Float32Array(2),
x=new Float32Array(3),I=new Float32Array(3),B=new Float32Array(4),G=u.create();new Float32Array(9);var A={},J={};a.MS_STATIC=d.MS_STATIC;a.MS_TARGET_CONTROLS=d.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=d.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=d.MS_HOVER_CONTROLS;a.static_setup=function(a,b){if(f.is_camera(a)){d.kq(a);a.k.hb=d.MS_STATIC;if(b){var e=b.pos||m.get_trans_view(a.k.n);b.look_at?d.set_look_at(a,e,b.look_at):c.set_translation(a,e)}c.B(a);n.sync_transform(a);d.im(a)}else r.error("static_setup(): Wrong camera object")};
a.static_set_look_at=function(a,b,e){d.is_static_camera(a)?(b=b||m.get_trans_view(a.k.n),e?d.set_look_at(a,b,e):c.set_translation(a,b),c.B(a),n.sync_transform(a)):r.error("static_set_look_at(): Wrong camera object or camera move style")};a.static_set_rotation=function(a,b){d.is_static_camera(a)?(c.set_rotation(a,b),c.B(a),n.sync_transform(a)):r.error("static_set_rotation(): Wrong camera object or camera move style")};a.static_get_rotation=function(a,b){if(!d.is_static_camera(a))return r.error("static_get_rotation(): Wrong camera object or camera move style"),
null;b=b||new Float32Array(4);return c.get_rotation(a,b)};a.eye_setup=function(a,b){if(f.is_camera(a))if(b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=typeof b.horiz_rot_lim.right))r.error("eye_setup(): Wrong horizontal limits object.");else if(b&&b.vert_rot_lim&&("number"!=typeof b.vert_rot_lim.down||"number"!=typeof b.vert_rot_lim.up))r.error("eye_setup(): Wrong vertical limits object.");else{d.kq(a);a.k.hb=d.MS_EYE_CONTROLS;if(b){var e=b.pos||m.get_trans_view(a.k.n);d.jD(a,
e,b.look_at,b.horiz_rot_lim,b.vert_rot_lim)}c.B(a);n.sync_transform(a);d.im(a)}else r.error("eye_setup(): Wrong camera object")};a.eye_set_look_at=function(a,e,f){d.is_eye_camera(a)?(e=e||m.get_trans_view(a.k.n),f?d.VO(a,e,f):c.set_translation(a,e),b.correct_up(a,a.k.Ie,!0),c.B(a),n.sync_transform(a)):r.error("eye_set_look_at(): Wrong camera object or camera move style")};a.eye_rotate=function(a,b,e,f,g){d.is_eye_camera(a)?(d.rotate_eye_camera(a,b,e,f||!1,g||!1),c.B(a),n.sync_transform(a)):r.error("eye_rotate(): Wrong camera object or camera move style")};
a.eye_set_vertical_limits=function(a,b){d.is_eye_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.hD(a,b),c.B(a),n.sync_transform(a)):r.error("eye_set_vertical_limits(): Incorrect limits object."):r.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.eye_get_vertical_limits=function(a,b,c){if(!d.is_eye_camera(a))return r.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.fa?(b=b||{},c?(b.down=a.fa.Sl,b.up=a.fa.hn):
(b.down=a.fa.down,b.up=a.fa.up),b.camera_space=c||!1,b):null};a.eye_set_horizontal_limits=function(a,b){d.is_eye_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.eD(a,b),c.B(a),n.sync_transform(a)):r.error("eye_set_horizontal_limits(): Incorrect limits object."):r.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.eye_get_horizontal_limits=function(a,b,c){if(!d.is_eye_camera(a))return r.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.Ya?(b=b||{},c?(b.left=a.Ya.pm,b.right=a.Ya.Lm):(b.left=a.Ya.left,b.right=a.Ya.right),b.camera_space=c||!1,b):null};a.target_setup=function(a,b){if(f.is_camera(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){r.error("target_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.qp&&("number"!=typeof b.qp.min_y||"number"!=typeof b.qp.max_y||b.qp.min_y>b.qp.max_y))r.error("target_setup(): Wrong pivot limits object");else{d.kq(a);a.k.hb=d.MS_TARGET_CONTROLS;var e=b.pos||m.get_trans_view(a.k.n);d.lD(a,e,b.pivot,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.qp,b.use_panning||!1);c.B(a);n.sync_transform(a);d.im(a)}}else r.error("target_setup(): Wrong vertical limits object");else r.error("target_setup(): Wrong horizontal limits object");
else r.error("target_setup(): Wrong camera object")};a.target_rotate=function(a,b,e,f,g){d.is_target_camera(a)?(d.rotate_target_camera(a,b,e,f||!1,g||!1),c.B(a),n.sync_transform(a)):r.error("target_rotate(): Wrong camera object or camera move style")};a.target_set_trans_pivot=function(a,b,e){d.is_target_camera(a)?(b=b||m.get_trans_view(a.k.n),e=e||a.k.pivot,d.set_trans_pivot(a,b,e),c.B(a),n.sync_transform(a)):r.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.target_set_pivot_translation=
function(a,b){d.is_target_camera(a)?(d.bP(a,b),c.B(a),n.sync_transform(a)):r.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.target_set_distance=function(a,b){if(d.is_target_camera(a)){var e=c.Bm(a,a.k.pivot),f=Math.max(0,b);c.move_local(a,0,0,f-e);c.B(a);n.sync_transform(a)}else r.error("target_set_distance(): Wrong camera object or camera move style")};a.target_get_distance=function(a){return d.is_target_camera(a)?c.Bm(a,a.k.pivot):(r.error("target_get_distance(): Wrong camera object or camera move style"),
0)};a.target_zoom_object=function(a,b){if(d.is_target_camera(a)){var e=c.get_object_center(b,!1,x),k=c.get_object_size(b),g=v.get_active(),g=f.ea(a,g).W[0],g=d.YA(g)/2,k=k/Math.sin(g),g=c.Bm(a,e);d.set_trans_pivot(a,m.get_trans_view(a.k.n),e);c.B(a);c.move_local(a,0,0,k-g);c.B(a);n.sync_transform(a)}else r.error("target_zoom_object(): Wrong camera object or camera move style")};a.target_get_pivot=function(a,b){if(!d.is_target_camera(a))return r.error("target_get_pivot(): Wrong camera object or camera move style"),
null;b=b||new Float32Array(3);y.copy(a.k.pivot,b);return b};a.target_set_distance_limits=function(a,b){if(d.is_target_camera(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){r.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}d.KO(a,b);c.B(a);n.sync_transform(a)}else r.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.target_get_distance_limits=function(a,b){if(!d.is_target_camera(a))return r.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var c=a.k;return c.fb?(b=b||{},b.min=c.fb.min,b.max=c.fb.max,b):null};a.target_set_vertical_limits=function(a,b){d.is_target_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.hD(a,b),c.B(a),n.sync_transform(a)):r.error("target_set_vertical_limits(): Wrong limits object"):r.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.target_get_vertical_limits=function(a,b,c){if(!d.is_target_camera(a))return r.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.fa?(b=b||{},c?(b.down=a.fa.Sl,b.up=a.fa.hn):(b.down=a.fa.down,b.up=a.fa.up),b.camera_space=c||!1,b):null};a.target_set_horizontal_limits=function(a,b){d.is_target_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.eD(a,b),c.B(a),n.sync_transform(a)):r.error("target_set_horizontal_limits(): Wrong limits object"):r.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.target_get_horizontal_limits=function(a,b,c){if(!d.is_target_camera(a))return r.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.Ya?(b=b||{},c?(b.left=a.Ya.pm,b.right=a.Ya.Lm):(b.left=a.Ya.left,b.right=a.Ya.right),b.camera_space=c||!1,b):null};a.target_set_pivot_limits=function(a,b){d.is_target_camera(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?r.error("target_set_pivot_limits(): Wrong limits object"):(d.YO(a,b),c.B(a),n.sync_transform(a)):r.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.target_get_pivot_limits=function(a,b){if(!d.is_target_camera(a))return r.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var c=a.k;return c.Cd?(b=b||{},b.min_z=c.Cd.min_z,b.max_z=c.Cd.max_z,b):null};a.target_pan_pivot=function(a,b,e){if(d.is_target_camera(a)){var f=a.k;f.use_panning&&(x[0]=b,x[1]=-e,x[2]=0,m.transform_dir_vec3(x,f.n,x),y.add(f.pivot,x,f.pivot),b=m.get_trans_view(f.n),y.add(b,x,b),c.B(a),n.sync_transform(a))}else r.error("target_pan_pivot(): wrong object")};a.target_switch_panning=function(a,b){if(!d.is_target_camera(a))return r.error("target_switch_panning(): Wrong camera object or camera move style"),
null;a.k.use_panning=b};a.hover_setup_rel=function(b,e){a.hover_setup(b,{pos:e.pos,pivot:e.pivot});var f="undefined"==typeof e.dist_interval?0:Math.max(e.dist_interval,0),k="undefined"==typeof e.angle_interval?0:Math.max(e.angle_interval,0),g="undefined"==typeof e.t?.5:p.clamp(e.t,0,1),m=a.hover_get_distance_limits(b,A);m.min=Math.max(m.min-g*f,0);m.max+=(1-g)*f;f=a.hover_get_vertical_limits(b,J);f.down=p.clamp(f.down+g*k,-Math.PI/2,0);f.up=p.clamp(f.up-(1-g)*k,-Math.PI/2,0);d.hover_set_distance_limits(b,
m);d.hover_set_vertical_limits(b,f);c.B(b);n.sync_transform(b);d.im(b)};a.hover_setup=function(a,b){if(f.is_camera(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){r.error("hover_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<
b.hover_angle_lim.up))r.error("hover_setup(): Wrong hover angle limits object");else if(b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max))r.error("hover_setup(): Wrong horizontal translation limits object");else if(b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max))r.error("hover_setup(): Wrong vertical translation limits object");
else{d.kq(a);a.k.hb=d.MS_HOVER_CONTROLS;var e=b.pos||m.get_trans_view(a.k.n);d.kD(a,e,b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1);c.B(a);n.sync_transform(a);d.im(a)}}else r.error("hover_setup(): Wrong camera object")};a.hover_rotate=function(a,b,e,f,g){d.is_hover_camera(a)?(d.rotate_hover_camera(a,b,e,f||!1,g||!1),c.B(a),n.sync_transform(a)):r.error("hover_rotate(): Wrong camera object or camera move style")};a.hover_set_pivot_translation=function(a,
b){d.is_hover_camera(a)?(d.set_hover_pivot(a,b),c.B(a),n.sync_transform(a)):r.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.hover_get_pivot=function(a,b){if(!d.is_hover_camera(a))return r.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);y.copy(a.k.Hb,b);return b};a.hover_get_distance=function(a){return d.is_hover_camera(a)?c.Bm(a,a.k.Hb):(r.error("hover_get_distance(): Wrong camera object or camera move style"),
0)};a.hover_set_vertical_limits=function(a,b){d.is_hover_camera(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?r.error("hover_set_vertical_limits(): Wrong limits object"):(d.hover_set_vertical_limits(a,b),c.B(a),n.sync_transform(a)):r.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.hover_get_vertical_limits=function(a,b){if(!d.is_hover_camera(a))return r.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var c=a.k;
b=b||{};b.down=c.fa.down;b.up=c.fa.up;return b};a.hover_set_distance_limits=function(a,b){d.is_hover_camera(a)?"number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max?r.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),d.hover_set_distance_limits(a,b),c.B(a),n.sync_transform(a)):r.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.hover_get_distance_limits=function(a,b){if(!d.is_hover_camera(a))return r.error("hover_get_distance_limits(): Wrong camera object or camera move style"),
null;var c=a.k;b=b||{};b.min=c.fb.min;b.max=c.fb.max;return b};a.hover_set_vert_trans_limits=function(a,b){d.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?r.error("hover_set_vert_trans_limits(): Wrong limits object"):(d.eP(a,b),c.B(a),n.sync_transform(a)):r.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.hover_get_vert_trans_limits=function(a,b){if(!d.is_hover_camera(a))return r.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),
null;var c=a.k;return c.kc?(b=b||{},b.min=c.kc.min,b.max=c.kc.max,b):null};a.hover_set_horiz_trans_limits=function(a,b){d.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?r.error("hover_set_horiz_trans_limits(): Wrong limits object"):(d.PO(a,b),c.B(a),n.sync_transform(a)):r.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.hover_get_horiz_trans_limits=function(a,b){if(!d.is_hover_camera(a))return r.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),
null;var c=a.k;return c.jc?(b=b||{},b.min=c.jc.min,b.max=c.jc.max,b):null};a.hover_switch_horiz_rotation=function(a,b){if(!d.is_hover_camera(a))return r.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Lg=b};a.is_static_camera=d.is_static_camera;a.is_target_camera=d.is_target_camera;a.is_eye_camera=d.is_eye_camera;a.is_hover_camera=d.is_hover_camera;a.set_move_style=function(a,b){if(!f.is_camera(a))return r.error("set_move_style(): Wrong camera object"),!1;
if(b!=d.MS_STATIC&&b!=d.MS_EYE_CONTROLS&&b!=d.MS_TARGET_CONTROLS&&b!=d.MS_HOVER_CONTROLS)return r.error("set_move_style(): Wrong move style"),!1;d.set_move_style(a,b);c.B(a);n.sync_transform(a);return!0};a.get_move_style=function(a){return f.is_camera(a)?d.get_move_style(a):(r.error("get_move_style(): Wrong camera object"),null)};a.set_translation=function(a,b){if(f.is_camera(a)){var e=a.k;if(d.is_target_camera(a)){var k=m.get_trans_view(e.n),k=y.subtract(b,k,x);y.add(k,e.pivot,e.pivot)}else d.is_hover_camera(a)&&
(k=m.get_trans_view(e.n),k=y.subtract(b,k,x),y.add(k,e.Hb,e.Hb));c.set_translation(a,b);c.B(a);n.sync_transform(a)}else r.error("set_translation(): Wrong camera object")};a.get_translation=function(a,b){if(!f.is_camera(a))return r.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return c.get_translation(a,b)};a.rotate_camera=function(a,b,e,k,g){f.is_camera(a)?(k=k||!1,g=g||!1,d.is_target_camera(a)?d.rotate_target_camera(a,b,e,k,g):d.is_eye_camera(a)?d.rotate_eye_camera(a,
b,e,k,g):d.is_hover_camera(a)?d.rotate_hover_camera(a,b,e,k,g):d.is_static_camera(a)?r.warn("rotate_camera(): not supported for STATIC cameras"):r.error("rotate_camera(): Wrong camera move style"),c.B(a),n.sync_transform(a)):r.error("rotate_camera(): Wrong camera object")};a.set_velocities=function(a,b){if(f.is_camera(a)){var c=a.k;"number"==typeof b.trans&&(c.Fj=p.clamp(b.trans,0,Infinity));"number"==typeof b.rot&&(c.Ej=p.clamp(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.Gj=p.clamp(b.zoom,0,.99))}else r.error("set_velocities(): Wrong camera object")};
a.get_velocities=function(a,b){if(!f.is_camera(a))return r.error("get_velocities(): Wrong camera object"),null;var c=a.k;b=b||{};b.trans=c.Fj;b.rot=c.Ej;b.zoom=c.Gj;return b};a.is_look_up=function(a){if(!f.is_camera(a))return r.error("is_look_up(): Wrong camera object"),!1;a=m.get_quat_view(a.k.n);return 0<=p.quat_to_dir(a,p.AXIS_MZ,x)[1]};a.get_camera_angles=function(a,b){if(!f.is_camera(a))return r.error("get_camera_angles(): Wrong camera object"),null;b=b||new Float32Array(2);d.get_camera_angles(a,
b);return b};a.get_camera_angles_char=function(a,b){if(!f.is_camera(a))return r.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);d.get_camera_angles_char(a,b);return b};a.get_camera_angles_dir=function(a,b){b=b||new Float32Array(2);var c=y.normalize(a,x),c=p.jx(p.AXIS_MZ,c,G);p.correct_cam_quat_up(c,!0);d.Av(c,b);return b};a.set_stereo_distance=function(a,b){if(f.is_camera(a))for(var c=v.get_active(),c=f.ea(a,c).W,e=0;e<c.length;e++){var g=c[e];g.type!=d.Ac&&g.type!=
d.Kc&&g.type!=d.ne&&g.type!=d.oe||d.aP(g,b,g.De)}else r.error("set_stereo_distance(): Wrong camera object")};a.get_stereo_distance=function(a){if(!f.is_camera(a))return r.error("get_stereo_distance(): Wrong camera object"),0;var b=v.get_active();a=f.ea(a,b).W;for(b=0;b<a.length;b++){var c=a[b];if(c.type==d.Ac||c.type==d.Kc)return c.uj}return 0};a.set_eye_distance=function(a,b){if(f.is_camera(a)){var c=v.get_active(),c=f.ea(a,c).W;d.set_eye_distance(c,b)}else r.error("set_eye_distance(): Wrong camera object")};
a.get_eye_distance=function(a){if(!f.is_camera(a))return r.error("get_eye_distance(): Wrong camera object"),0;var b=v.get_active();a=f.ea(a,b).W;for(b=0;b<a.length;b++){var c=a[b];if(c.type==d.Ac||c.type==d.Kc||c.type==d.ne||c.type==d.oe)return c.De}return 0};a.set_vertical_axis=function(a,b){f.is_camera(a)?(y.copy(b,a.k.Ie),c.B(a),n.sync_transform(a)):r.error("set_vertical_axis(): Wrong camera object")};a.get_vertical_axis=function(a,b){if(f.is_camera(a))return b||(b=y.create()),y.copy(a.k.Ie,b),
b;r.error("get_vertical_axis(): Wrong camera object")};a.translate_view=function(a,b,c,e){if(f.is_camera(a)){var g=v.get_active();a=f.ea(a,g).W;for(g=0;g<a.length;g++){var m=a[g];m.Xb||d.rj(m,m.pb);var n=x;n[0]=-b;n[1]=-c;n[2]=0;l.translate(m.lb,n,m.lb);l.rotateZ(m.lb,e,m.lb);d.Ez(m);d.Bu(m)}}else r.error("translate_view(): Wrong camera object")};a.get_view_vector=function(a,b){if(!f.is_camera(a))return r.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=m.get_quat_view(a.k.n);
p.quat_to_dir(c,p.AXIS_MZ,b);return b};a.get_fov=function(a){if(!f.is_camera(a))return r.error("get_fov(): Wrong camera object"),0;var b=v.get_active();a=f.ea(a,b).W;return p.deg_to_rad(a[0].xd)};a.set_fov=function(a,b){if(f.is_camera(a))for(var c=v.get_active(),c=f.ea(a,c).W,e=0;e<c.length;e++){var g=c[e];g.xd=p.rad_to_deg(b);g.Xb||d.rj(g,g.pb);d.Ez(g);d.Bu(g)}else r.error("set_fov(): Wrong camera object")};a.set_hmd_fov=function(a,b,c){var e;if(!(e=f.is_camera(a)))a:{if(f.is_camera(a)){e=v.get_active();
e=f.ea(a,e).W;for(var g=0;g<e.length;g++){var m=e[g];if(m.type==d.ne||m.type==d.oe){e=!0;break a}}}else r.error("is_hmd_camera(): Wrong camera object");e=!1}e?b&&c&&d.set_hmd_fov(a,b,c):r.error("set_hmd_fov(): Wrong camera object")};a.correct_up=function(a,d,e){f.is_camera(a)?(d=d||a.k.Ie,b.correct_up(a,d,e||!1),c.B(a),n.sync_transform(a)):r.error("correct_up(): Wrong camera object")};a.set_ortho_scale=function(a,b){if(f.is_camera(a)&&d.is_ortho_camera(a)){var c=a.k;if(d.is_target_camera(a)){var e=
m.get_trans_view(c.n),e=y.dist(e,c.pivot);c.Ti=b/2*c.Si/e}else d.is_hover_camera(a)?(e=m.get_trans_view(c.n),e=y.distance(e,c.Hb),c.Ti=b/2*c.Si/e):(c=v.get_active(),f.ea(a,c).W[0].top=b/2);d.wQ(a)}else r.error("set_ortho_scale(): Wrong camera object")};a.get_ortho_scale=function(a){if(!f.is_camera(a)||!d.is_ortho_camera(a))return r.error("get_ortho_scale(): Wrong camera object"),0;var b=v.get_active();return 2*f.ea(a,b).W[0].top};a.is_ortho_camera=function(a){return f.is_camera(a)?d.is_ortho_camera(a):
(r.error("is_ortho_camera(): Wrong camera object"),!1)};a.calc_ray=function(a,b,e,k){if(!f.is_camera(a))return r.error("calc_ray(): Wrong camera object"),null;var l=v.get_active(),n=f.ea(a,l).W[0];k&&3==k.length?r.Ec('dest parameter in the function "calc_ray" should be type of parametric line.'):k=k||new Float32Array(6);switch(n.type){case d.od:case d.Ag:case d.Ac:case d.Kc:var q=Math.tan(n.xd*Math.PI/360),u=q*n.pb,l=x;b=g.Uq(b,e,z,n);l[0]=(2*b[0]/n.width-1)*u;l[1]=(1-2*b[1]/n.height)*q;l[2]=-1;m.transform_dir_vec3(l,
a.k.n,l);y.normalize(l,l);3==k.length?y.copy(l,k):(a=c.get_translation(a,I),w.set_pline_initial_point(k,a),w.set_pline_directional_vec(k,l));return k;case d.Ud:return l=x,b=g.Uq(b,e,z,n),l[0]=(2*b[0]/n.width-1)*n.top*n.pb,l[1]=(1-2*b[1]/n.height)*n.top,l[2]=0,m.transform_vec3(l,a.k.n,l),y.copy(l,k),a=m.get_quat_view(a.k.n,B),y.transformQuat(p.AXIS_MZ,a,l),w.set_pline_directional_vec(k,l),k;default:return r.error("calc_ray(): Non-compatible camera"),k}};a.project_point=function(a,b,c){if(!f.is_camera(a))return r.error("project_point(): Wrong camera object"),
null;c=c||new Float32Array(2);return d.project_point(a,b,c)};a.has_distance_limits=function(a){return(d.is_target_camera(a)||d.is_hover_camera(a))&&null!==a.k.fb};a.has_vertical_rot_limits=function(a){return(d.is_eye_camera(a)||d.is_target_camera(a)||d.is_hover_camera(a))&&null!==a.k.fa};a.has_vertical_limits=function(a){r.kb("has_vertical_limits","has_vertical_rot_limits");return d.is_target_camera(a)||d.is_eye_camera(a)?null!==a.k.fa:(r.error("has_vertical_limits(): Wrong camera object"),!1)};a.has_horizontal_rot_limits=
function(a){return(d.is_target_camera(a)||d.is_eye_camera(a))&&null!==a.k.Ya};a.has_horizontal_limits=function(a){r.kb("has_horizontal_limits","has_horizontal_rot_limits");return d.is_target_camera(a)||d.is_eye_camera(a)?null!==a.k.Ya:(r.error("has_horizontal_limits(): Wrong camera object"),!1)};a.has_vertical_trans_limits=function(a){return d.is_hover_camera(a)&&null!==a.k.kc};a.has_horizontal_trans_limits=function(a){return d.is_hover_camera(a)&&null!==a.k.jc};a.move_pivot=function(a,b,e){r.kb("move_pivot",
"target_pan_pivot");if(d.is_target_camera(a)){var f=a.k;if(f.use_panning){var g=m.get_trans_view(f.n),l=y.subtract(g,f.pivot,I);x[0]=b;x[1]=0;x[2]=e;y.scale(x,y.len(l),x);m.transform_dir_vec3(x,f.n,x);y.add(f.pivot,x,f.pivot);y.add(g,x,g);c.B(a);n.sync_transform(a)}}else r.error("move_pivot(): wrong object")};a.set_velocity_params=function(a,b){r.kb("set_velocity_params","set_velocities");if(f.is_camera(a)){var c=a.k;c.Fj=p.clamp(b[0],0,Infinity);c.Ej=p.clamp(b[1],0,Infinity);c.Gj=p.clamp(b[2],0,
.99)}else r.error("set_velocity_params(): Wrong camera object")};a.get_velocity_params=function(a,b){r.kb("get_velocity_params","get_velocities");if(!f.is_camera(a))return r.error("get_velocity_params(): Wrong camera object"),null;b=b||new Float32Array(3);var c=a.k;b[0]=c.Fj;b[1]=c.Ej;b[2]=c.Gj;return b};a.clear_horizontal_limits=function(a){r.Ec('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');
f.is_camera(a)?d.is_target_camera(a)||d.is_eye_camera(a)?a.k.Ya=null:d.is_hover_camera(a)&&(a.k.jc=null):r.error("clear_horizontal_limits(): Wrong camera object")};a.clear_vertical_limits=function(a){r.Ec('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');f.is_camera(a)?d.is_target_camera(a)||d.is_eye_camera(a)?a.k.fa=null:d.is_hover_camera(a)&&(a.k.kc=
null):r.error("clear_vertical_limits(): Wrong camera object")};a.clear_hover_angle_limits=function(){r.Ec("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};a.set_look_at=function(a,e,f,k){r.Mg("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);k=k||a.k.Ie;d.set_look_at(a,e,f);b.correct_up(a,k,!0);c.B(a);n.sync_transform(a)};a.rotate_eye_camera=function(a,b,e,f,g){r.Mg("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);
d.is_eye_camera(a)?(d.rotate_eye_camera(a,b,e,f,g),c.B(a),n.sync_transform(a)):r.error("rotate_eye_camera(): wrong object")};a.rotate_target_camera=function(a,b,e,f,g){r.Mg("camera.rotate_target_camera",["camera.target_rotate","camera.rotate_camera"]);d.is_target_camera(a)?(d.rotate_target_camera(a,b,e,f,g),c.B(a),n.sync_transform(a)):r.error("rotate_target_camera(): wrong object")};a.set_trans_pivot=function(a,b,e){r.kb("camera.set_trans_pivot","camera.target_set_trans_pivot");d.is_target_camera(a)?
(d.set_trans_pivot(a,b,e),c.B(a),n.sync_transform(a)):r.error("set_trans_pivot(): Wrong object or camera move style")};a.zoom_object=function(a,b){r.kb("camera.zoom_object","camera.target_zoom_object");if(d.is_target_camera(a)){c.get_object_center(b,!1,x);e(a,x);c.B(a);var g=c.get_object_size(b),k=v.get_active(),k=f.ea(a,k).W[0],k=d.YA(k)/2,g=g/Math.sin(k),k=c.Bm(a,x);c.move_local(a,0,0,g-k);c.B(a);n.sync_transform(a)}else r.error("zoom_object(): wrong object")};a.set_pivot=e;a.rotate_hover_camera=
function(a,b,e,f,g){r.kb("camera.rotate_hover_camera","camera.hover_rotate");d.is_hover_camera(a)?(d.rotate_hover_camera(a,b,e,f,g),c.B(a),n.sync_transform(a)):r.error("rotate_hover_camera(): wrong object")};a.get_hover_cam_pivot=function(a,b){r.kb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!d.is_hover_camera(a))return r.error("get_hover_cam_pivot(): wrong object"),null;b||(b=new Float32Array(3));y.copy(a.k.Hb,b);return b};a.get_eye=function(a,b){r.kb("camera.get_eye","camera.get_translation");
return f.is_camera(a)?d.get_eye(a,b):(r.error("get_eye(): Wrong object"),null)};a.get_pivot=function(a,b){r.kb("camera.get_pivot","camera.target_get_pivot");if(!d.is_target_camera(a))return r.error("get_pivot(): Wrong object or camera move style"),null;b||(b=new Float32Array(3));y.copy(a.k.pivot,b);return b};a.hover_cam_set_translation=function(a,b){r.kb("camera.hover_cam_set_translation","camera.set_translation");if(d.is_hover_camera(a)){var e=a.k,f=m.get_trans_view(e.n),f=y.subtract(b,f,x);y.add(f,
e.Hb,e.Hb);c.set_translation(a,b);c.B(a);n.sync_transform(a)}else r.error("hover_cam_set_translation(): wrong object")};a.set_hover_pivot=function(a,b){r.kb("camera.set_hover_pivot","camera.hover_set_pivot_translation");d.is_hover_camera(a)?(d.set_hover_pivot(a,b),c.B(a),n.sync_transform(a)):r.error("set_hover_pivot(): Wrong object or camera move style")};a.get_hover_angle_limits=function(a,b){r.kb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!d.is_hover_camera(a))return r.error("get_hover_angle_limits(): wrong object"),
null;b=b||new Float32Array(2);b[0]=a.k.fa.down;b[1]=a.k.fa.up;return b};a.get_cam_dist_limits=function(a,b){r.Mg("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);if(!d.is_hover_camera(a)&&!d.is_target_camera(a))return r.error("get_cam_dist_limits(): wrong object"),null;if(a.k.fb)b=b||new Float32Array(2),b[0]=a.k.fb.max,b[1]=a.k.fb.min;else return null;return b};a.apply_vertical_limits=function(b,e,f,k){r.Mg("camera.apply_vertical_limits",["camera.eye_set_vertical_limits",
"camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);if(d.is_target_camera(b)){var g=A;g.down=e;g.up=f;g.camera_space=k==c.SPACE_LOCAL;a.target_set_vertical_limits(b,g)}else d.is_eye_camera(b)?(g=A,g.down=e,g.up=f,g.camera_space=k==c.SPACE_LOCAL,a.eye_set_vertical_limits(b,g)):d.is_hover_camera(b)?(g=A,g.min=e,g.max=f,a.hover_set_vert_trans_limits(b,g)):r.error("apply_vertical_limits(): wrong object")};a.apply_hover_angle_limits=function(b,c,d){r.kb("camera.apply_hover_angle_limits",
"camera.hover_set_vertical_limits");A.down=c;A.up=d;a.hover_set_vertical_limits(b,A)};a.apply_distance_limits=function(b,c,e){r.Mg("camera.apply_distance_limits",["camera.target_set_distance_limits","camera.hover_set_distance_limits"]);if(d.is_target_camera(b)){var f=A;f.min=c;f.max=e;a.target_set_distance_limits(b,f)}else d.is_hover_camera(b)?(f=A,f.min=c,f.max=e,a.hover_set_distance_limits(b,f)):r.error("apply_distance_limits(): wrong object")};a.clear_distance_limits=function(b){r.kb("camera.clear_distance_limits",
"camera.target_set_distance_limits");a.target_set_distance_limits(b,null)};a.get_vertical_limits=function(a,b){r.Mg("camera.get_vertical_limits",["camera.eye_get_vertical_limits","camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!d.is_target_camera(a)&&!d.is_eye_camera(a)&&!d.is_hover_camera(a))return r.error("get_vertical_limits(): wrong object"),null;var c=a.k;b=b||new Float32Array(2);if(d.is_eye_camera(a)||d.is_target_camera(a)){if(c.fa)return b[0]=c.fa.down,b[1]=c.fa.up,
b}else if(d.is_hover_camera(a)&&c.kc)return b[0]=c.kc.min,b[1]=c.kc.max,b;return null};a.apply_horizontal_limits=function(b,e,f,k){r.Mg("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits","camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(d.is_target_camera(b)){var g=A;g.left=e;g.right=f;g.camera_space=k==c.SPACE_LOCAL;a.target_set_horizontal_limits(b,g)}else d.is_eye_camera(b)?(g=A,g.left=e,g.right=f,g.camera_space=k==c.SPACE_LOCAL,a.eye_set_horizontal_limits(b,
g)):d.is_hover_camera(b)?(g=A,g.min=e,g.max=f,a.hover_set_horiz_trans_limits(b,g)):r.error("apply_horizontal_limits(): wrong object")};a.get_horizontal_limits=function(a,b){r.Mg("camera.get_horizontal_limits",["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!d.is_target_camera(a)&&!d.is_eye_camera(a)&&!d.is_hover_camera(a))return r.error("get_horizontal_limits(): wrong object"),null;var c=a.k;b=b||new Float32Array(2);if(d.is_eye_camera(a)||
d.is_target_camera(a)){if(c.Ya)return b[0]=c.Ya.left,b[1]=c.Ya.right,b}else if(d.is_hover_camera(a)&&c.jc)return b[0]=c.jc.min,b[1]=c.jc.max,b;return null};a.get_frustum_planes=function(a,b){if(!f.is_camera(a))return r.error("get_frustum_planes(): Wrong camera object"),null;var c=v.get_active(),c=f.ea(a,c).W[0].Og;E.copy(c.left,b.left);E.copy(c.right,b.right);E.copy(c.top,b.top);E.copy(c.bottom,b.bottom);E.copy(c.near,b.near);E.copy(c.far,b.far);return b}};b4w.module.config=function(a,q){var e=q("__config"),d=q("__compat"),b=q("__debug"),g=q("__data"),l=q("__print");a.P_LOW=e.P_LOW;a.P_HIGH=e.P_HIGH;a.P_ULTRA=e.P_ULTRA;a.P_CUSTOM=e.P_CUSTOM;a.P_AUTO=e.P_AUTO;a.set=e.set;a.get=e.get;a.reset=e.reset;a.reset_limits=e.reset_limits;a.get_std_assets_path=e.get_std_assets_path;a.apply_quality=function(a){g.is_primary_loaded()?l.error("Cannot change quality profile after a scene is loaded."):(e.set("quality",a),b.Dr()&&(e.apply_quality(),d.dD(b.Dr(),!1)))}};b4w.module.controls=function(a,q){var e=q("__controls"),d=q("__print");a.CT_POSITIVE=e.CT_POSITIVE;a.CT_CONTINUOUS=e.CT_CONTINUOUS;a.CT_TRIGGER=e.CT_TRIGGER;a.CT_SHOT=e.CT_SHOT;a.CT_LEVEL=e.CT_LEVEL;a.CT_CHANGE=e.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=54;a.KEY_7=55;
a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_MULT=106;a.KEY_ADD=107;a.KEY_SUB=109;a.KEY_DEC_POINT=
110;a.KEY_DIV=111;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=e.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=e.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=e.PL_MULTITOUCH_MOVE_PAN;a.PL_MULTITOUCH_MOVE_ROTATE=e.PL_MULTITOUCH_MOVE_ROTATE;a.default_AND_logic_fun=e.default_AND_logic_fun;
a.default_OR_logic_fun=e.default_OR_logic_fun;a.create_gamepad_btn_sensor=e.create_gamepad_btn_sensor;a.create_gamepad_axis_sensor=e.create_gamepad_axis_sensor;a.create_custom_sensor=e.create_custom_sensor;a.create_keyboard_sensor=e.create_keyboard_sensor;a.create_collision_sensor=function(a,d,l){return e.create_collision_sensor(a,d||"ANY",l||!1)};a.create_collision_impulse_sensor=e.create_collision_impulse_sensor;a.create_ray_sensor=function(a,d,l,q,f,n,r){return e.create_ray_sensor(a,d,l,q||"ANY",
f||!1,n||!1,r||!1)};a.create_mouse_click_sensor=e.create_mouse_click_sensor;a.create_mouse_wheel_sensor=e.create_mouse_wheel_sensor;a.create_mouse_move_sensor=e.create_mouse_move_sensor;a.create_plock_mouse_sensor=e.create_plock_mouse_sensor;a.create_plock_sensor=e.create_plock_sensor;a.create_touch_move_sensor=e.create_touch_move_sensor;a.create_touch_zoom_sensor=e.create_touch_zoom_sensor;a.create_touch_rotate_sensor=e.create_touch_rotate_sensor;a.create_touch_click_sensor=e.create_touch_click_sensor;
a.create_motion_sensor=e.create_motion_sensor;a.create_vertical_velocity_sensor=e.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=e.create_gyro_angles_sensor;a.create_gyro_quat_sensor=e.create_gyro_quat_sensor;a.create_gyro_delta_sensor=e.create_gyro_delta_sensor;a.create_hmd_quat_sensor=e.create_hmd_quat_sensor;a.create_hmd_position_sensor=e.create_hmd_position_sensor;a.create_timer_sensor=function(a,d){return e.create_timer_sensor(a,d||!1)};a.reset_timer_sensor=e.reset_timer_sensor;
a.create_elapsed_sensor=e.create_elapsed_sensor;a.create_timeline_sensor=e.create_timeline_sensor;a.create_selection_sensor=function(a,d){return e.create_selection_sensor(a,d||!1)};a.create_callback_sensor=function(a,d){return e.create_callback_sensor(a,d||0)};a.set_custom_sensor=function(a,d){e.CO(a,d)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=e.get_sensor_value;a.get_sensor_payload=e.get_sensor_payload;a.create_sensor_manifold=function(a,d,l,q,f,n,r){f=f||e.default_AND_logic_fun;
e.create_sensor_manifold(a,d,l,q,f,n,void 0===r?null:r)};a.create_kb_sensor_manifold=function(a,d,l,q,f,n){q=e.create_keyboard_sensor(q);e.create_sensor_manifold(a,d,l,[q],e.default_AND_logic_fun,f,void 0===n?null:n)};a.check_sensor_manifolds=function(a){return e.check_sensor_manifold(a,null)};a.check_sensor_manifold=e.check_sensor_manifold;a.remove_sensor_manifold=e.remove_sensor_manifold;a.reset=e.reset;a.register_keyboard_events=function(){d.Ec("controls.register_keyboard_events() deprecated")};
a.register_mouse_events=function(){d.Ec("controls.register_mouse_events() deprecated")};a.register_wheel_events=function(){d.Ec("controls.register_wheel_events() deprecated")};a.register_touch_events=function(){d.Ec("controls.register_touch_events() deprecated")};a.register_device_orientation=function(){d.Ec("controls.register_device_orientation() deprecated")};a.unregister_keyboard_events=function(){d.Ec("controls.unregister_keyboard_events() deprecated")};a.unregister_mouse_events=function(){d.Ec("controls.unregister_mouse_events() deprecated")};
a.unregister_wheel_events=function(){d.Ec("controls.unregister_wheel_events() deprecated")};a.unregister_touch_events=function(){d.Ec("controls.unregister_touch_events() deprecated")};a.unregister_device_orientation=function(){d.Ec("controls.unregister_device_orientation() deprecated")};a.set_plock_smooth_factor=e.set_plock_smooth_factor};b4w.module.constraints=function(a,q){var e=q("__camera"),d=q("__constraints"),b=q("__obj_util"),g=q("__physics"),l=q("__print"),w=q("__transform");a.append_stiff=function(a,b,e,l,c){c=c||1;b instanceof Array&&2==b.length?d.zH(a,b[0],b[1],e,l,c):d.$y(a,b,e,l,c);w.B(a);g.sync_transform(a)};a.append_semi_stiff=function(a,b,e,l){d.xH(a,b,e,l);w.B(a);g.sync_transform(a)};a.append_semi_stiff_cam=function(a,b,r,q,c,m,p,y){e.is_eye_camera(a)?(c=c||-Math.PI/2,m=m||Math.PI/2,p=p||Math.PI/2,y=y||-Math.PI/2,
d.wH(a,b,r,q,c,m,p,y),w.B(a),g.sync_transform(a)):l.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_semi_soft_cam=function(a,b,r,q){if(e.is_eye_camera(a)){if(!q||0>q)q=.25;d.vH(a,b,r,q);w.B(a);g.sync_transform(a)}else l.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_stiff_trans=function(a,b,e){d.BH(a,b,e);w.B(a);g.sync_transform(a)};a.append_copy_trans=function(a,b,e){d.oH(a,b,e);w.B(a);
g.sync_transform(a)};a.append_stiff_trans_rot=function(a,b,e,l){d.CH(a,b,e,l);w.B(a);g.sync_transform(a)};a.append_track=function(a,b){3==b.length?d.GH(a,b):d.FH(a,b);w.B(a);g.sync_transform(a)};a.append_follow=function(a,b,e,l){3==b.length?d.sH(a,b,e,l):d.rH(a,b,e,l);w.B(a);g.sync_transform(a)};a.append_stiff_viewport=function(a,b,e){d.append_stiff_viewport(a,b,e);w.B(a);g.sync_transform(a)};a.remove=function(a){a.Tb&&d.remove(a)};a.get_parent=function(a){l.kb("constraints.get_parent","objects.get_parent");
return b.get_parent(a)}};b4w.module.container=function(a,q){var e=q("__container"),d=q("__print");a.get_canvas=e.get_canvas;a.get_canvas_hud=e.get_canvas_hud;a.get_container=e.get_container;a.insert_to_container=function(a,g){2!=arguments.length?d.error("insert_to_container(): two arguments required"):a&&g&&e.insert_to_container(a,g)};a.set_canvas_offsets=e.set_canvas_offsets;a.update_canvas_offsets=e.update_canvas_offsets;a.client_to_canvas_coords=e.client_to_canvas_coords;a.force_offsets_updating=e.force_offsets_updating;
a.resize=function(a,g,l){a&&g||d.warn("Wrong canvas container dimensions: "+a+"x"+g+". Zero dimensions aren't allowed. Resized to: "+e.Wt+"x"+e.Vt+".");e.resize(a,g,l)};a.resize_to_container=function(a){e.resize_to_container(a||!1)}};b4w.module.data=function(a,q){var e=q("__data"),d=q("__loader");q("__print");a.load=e.load;a.unload=function(a){e.unload(a|0)};a.set_debug_resources_root=e.set_debug_resources_root;a.is_primary_loaded=e.is_primary_loaded;a.is_idle=d.Hk;a.load_and_add_new=e.load;a.cleanup=a.unload;a.activate_media=e.activate_media};b4w.module.debug=function(a,q){function e(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function d(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;z.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.wv.ALL_OPS-a.wv.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.wv,e=c.aR,f=g(c.mK),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";z.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);z.groupCollapsed("directives");for(var h=c.tb.Gi.slice().sort(),f=0;f<h.length;f++){var k=h[f];z.Zd(k[0],k[1])}z.groupEnd();z.groupCollapsed("node elements");h=c.tb.ig;for(f=0;f<h.length;f++)z.Zd(h[f]);z.groupEnd();z.groupCollapsed("vert source");z.Zd(c.ZQ);z.groupEnd();z.groupCollapsed("vert translated source");z.Zd(c.$Q);z.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];z.groupCollapsed("vert ops stats");for(var m in e)-1==f.indexOf(m)&&z.Zd(m,e[m]);
z.groupEnd();z.groupCollapsed("vert assembly");z.Zd(c.YQ);z.groupEnd();z.groupCollapsed("frag source");z.Zd(c.lL);z.groupEnd();z.groupCollapsed("frag translated source");z.Zd(c.mL);z.groupEnd();z.groupCollapsed("frag ops stats");for(m in d)-1==f.indexOf(m)&&z.Zd(m,d[m]);z.groupEnd();z.groupCollapsed("frag assembly");z.Zd(c.cL);z.groupEnd();z.groupEnd()}}function g(a){for(var b=[],c=I.Mo(),d=0;d<c.length;d++)for(var e=c[d],f=y.Gb(e,"MESH",y.DATA_ID_ALL),h=0;h<f.length;h++){var k=E.ea(f[h],e);if(k&&
k.T.length)for(var k=k.T,g=0;g<k.length;g++){var m=k[g];if(m.nb==a)for(var l=0;l<m.lc.length;l++){var n=m.lc[l];-1==b.indexOf(n)&&b.push(n)}}}return b}function l(a,b){function c(){F.push(c);D=b;return a.apply(a,arguments)}return c}function w(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var f=q("__config"),n=q("__compat"),r=q("__controls"),
v=q("__container"),c=q("__debug"),m=q("__extensions"),p=q("__loader"),y=q("__objects"),E=q("__obj_util"),u=q("__physics"),z=q("__print"),x=q("__renderer"),I=q("__scenes"),B=q("__scenegraph"),G=q("__sfx"),A=q("__shaders"),J=q("__subscene"),t=q("__textures"),h=q("__util"),C=q("__vec3"),k=f.A,F=[],D="",aa=!0,M=new Float32Array(2);a.DV_NONE=c.DV_NONE;a.DV_OPAQUE_WIREFRAME=c.DV_OPAQUE_WIREFRAME;a.DV_TRANSPARENT_WIREFRAME=c.DV_TRANSPARENT_WIREFRAME;a.DV_FRONT_BACK_VIEW=c.DV_FRONT_BACK_VIEW;a.DV_BOUNDINGS=
c.DV_BOUNDINGS;a.DV_CLUSTERS_VIEW=c.DV_CLUSTERS_VIEW;a.DV_BATCHES_VIEW=c.DV_BATCHES_VIEW;a.DV_RENDER_TIME=c.DV_RENDER_TIME;a.physics_stats=function(){u.uK()};a.physics_id=function(a){z.log("O",u.ZK(a));for(var b=u.zL().gc.oa,c=0;c<b.length;c++){var d=b[c];d.C.Y==a&&z.log("B",d)}};a.visible_objects=function(){for(var a=I.get_active(),b=y.Gb(a,"MESH",y.DATA_ID_ALL),a=[I.Ja(a,J.Bb),I.Ja(a,J.zc),I.Ja(a,J.Ed)],c=0;c<a.length;c++){var d=a[c],e=subs.La;if(e.length){z.group(d.type,"DYNAMIC");for(var f=0;f<
b.length;f++){var h=b[f],k=h.k;if("DYNAMIC"==k.type)for(var g=!1,m=0;m<e.length;m++){for(var l=e[m].oa,n=0;n<l.length;n++){var p=l[n];if(p.Lb&&p.Th==k){z.Zd(h.name,h);g=!0;break}}if(g)break}}z.groupEnd();z.groupCollapsed(d.type,"STATIC");for(f=0;f<b.length;f++)if(h=b[f],k=h.k,"DYNAMIC"!=k.type)for(g=!1,m=0;m<e.length;m++){l=e[m].oa;for(n=0;n<l.length;n++)if(p=l[n],p.Lb&&p.Th==k){z.Zd(h.name,h);g=!0;break}if(g)break}z.groupEnd()}}};a.object_info=function(a){for(var b=I.get_active(),c=y.Gb(b,"MESH",
y.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];if(e.name==a){z.log("Object",e);for(var f=I.zv(b),h=0;h<f.length;h++){for(var k=f[h],g=[],m=k.La,l=0;l<m.length;l++)for(var n=m[l].oa,p=0;p<n.length;p++)n[p].Th==e.k&&g.push(n[p]);z.log("Subscene "+k.type,g)}}}};a.objects_stat=function(){var a=I.get_active();console.log("Armatures: "+y.Gb(a,"ARMATURE",y.DATA_ID_ALL).length);console.log("Cameras: "+y.Gb(a,"CAMERA",y.DATA_ID_ALL).length);console.log("Curves: "+y.Gb(a,"CURVE",y.DATA_ID_ALL).length);console.log("Empties: "+
y.Gb(a,"EMPTY",y.DATA_ID_ALL).length);console.log("Lamps: "+y.Gb(a,"LAMP",y.DATA_ID_ALL).length);console.log("Meshes: "+y.Gb(a,"MESH",y.DATA_ID_ALL).length);console.log("Speakers: "+y.Gb(a,"SPEAKER",y.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=I.get_active(),b=[I.Ja(b,J.Bb),I.Ja(b,J.zc),I.Ja(b,J.Ed)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.La,e=0;e<d.length;e++)for(var f=d[e].oa,h=0;h<f.length;h++){var k=f[h].qa;k&&(a+=k.num_vertices)}}return a};a.num_triangles=function(){for(var a=
0,b=I.get_active(),b=[I.Ja(b,J.Bb),I.Ja(b,J.zc),I.Ja(b,J.Ed)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.La,e=0;e<d.length;e++)for(var f=d[e].oa,h=0;h<f.length;h++){var k=f[h].qa;k&&(a+=k.num_triangles)}}return a};a.num_draw_calls=function(){for(var a=I.get_active(),b=I.Ex(a,[J.Bb,J.zc,J.Ed,J.nd,J.Ne]),c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.La,f=0;f<e.length;f++)c+=e[f].oa.length;a=I.Ex(a,[J.Sc,J.me]);for(d=0;d<a.length;d++)for(e=a[d],e=e.La,f=0;f<e.length;f++)c+=6*e[f].oa.length;return c};
a.num_shaders=function(){return h.No(A.aB())};a.geometry_stats=function(){for(var a=I.get_active(),b=I.zv(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=J.Al&&d.type!=J.Me)for(var e=d.La,f=0;f<e.length;f++)for(var h=e[f].oa,k=0;k<h.length;k++){var g=h[k].qa,m=h[k].Th;g&&(d.type!=J.Le&&d.type!=J.Nf||m.Dm||m.Cm)&&(a[g.id]=g)}}var c=b=0,l;for(l in a)d=a[l].ha,d.Nl&&(c+=d.Nl/1048576),b+=d.Pl/1048576;return{vbo_memory:b,ibo_memory:c}};a.num_textures=function(){for(var a=[],b=0,c=I.get_active(),c=[I.Ja(c,
J.Bb),I.Ja(c,J.zc),I.Ja(c,J.Ed)],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.La,f=0;f<e.length;f++)for(var h=e[f].oa,k=0;k<h.length;k++){var g=h[k].qa;if(g)for(var g=g.X,m=0;m<g.length;m++){var l=g[m];if("IMAGE"===l.source||"ENVIRONMENT_MAP"===l.source){var n=l.ib;-1===a.indexOf(n)&&(a.push(n),l=l.width*l.height*4/1048576/l.ko,l*=1.3333,b+=l)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=I.get_active(),c=I.zv(c),d=0;d<c.length;d++){var e=c[d];if(e.type!=
J.Al){var f=e.p,h=[f.bc,f.ue];h.push.apply(h,e.gh);for(e=0;e<h.length;e++){var k=h[e];t.mm(k)&&-1==a.indexOf(k)&&(a.push(k),b+=f.width*f.height*t.fM(k))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=I.get_active();(a=I.Ja(a,J.Bb))&&I.aC(a.p,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=I.get_active(),b=I.Ja(a,J.Bb),a=I.Ex(a,[J.Jc]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,
0,1];break;default:e=[1,0,1]}I.aC(d.p,b,e)}};a.scenegraph_to_dot=function(){for(var a=I.Mo(),b=0;b<a.length;b++)z.log("\n"+B.rK(I.Fv(a[b])))};a.scenes_to_dot=function(){};a.loading_graph_to_dot=function(){z.log("\n"+p.jM())};a.controls_info=r.debug;a.object_distance=function(a,b){var c=m_tsr.get_trans_view(a.k.n),d=m_tsr.get_trans_view(b.k.n);return C.dist(c,d)};a.msg=c.msg;a.fbmsg=c.fbmsg;a.print_telemetry=c.print_telemetry;a.plot_telemetry=c.plot_telemetry;a.fbres=function(a,b){function d(){c.fbmsg("FBRES",
a());setTimeout(d,b)}b||(b=16);d()};a.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),k=new Float32Array([0,-1,0]),g=new Float32Array([0,0,-1]);if(!h.Bi(a,h.Oy))throw"Wrong VEC3_IDENT";if(!h.Bi(b,h.yl))throw"Wrong QUAT4_IDENT";if(!h.Bi(c,h.AXIS_X))throw"Wrong AXIS_X";if(!h.Bi(d,h.AXIS_Y))throw"Wrong AXIS_Y";if(!h.Bi(e,h.AXIS_Z))throw"Wrong AXIS_Z";if(!h.Bi(f,
h.AXIS_MX))throw"Wrong AXIS_MX";if(!h.Bi(k,h.AXIS_MY))throw"Wrong AXIS_MY";if(!h.Bi(g,h.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=G.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==G.Iv(c)&&G.mute(c,!0)}};a.check_finite=function(a){c.check_finite(a)};a.set_debug_params=function(a){var b=I.get_active();if(b=I.Ja(b,J.Me)){if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case c.DV_NONE:case c.DV_OPAQUE_WIREFRAME:case c.DV_TRANSPARENT_WIREFRAME:case c.DV_FRONT_BACK_VIEW:case c.DV_BOUNDINGS:case c.DV_CLUSTERS_VIEW:case c.DV_BATCHES_VIEW:case c.DV_RENDER_TIME:I.HO(b,
a.debug_view_mode);break;default:z.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&I.GO(b,a.debug_colors_seed);"number"==typeof a.mO&&I.$O(b,a.mO);"object"==typeof a.wireframe_edge_color&&I.gP(b,h.f32(a.wireframe_edge_color))}else z.error("Debugging is not available on the scene.")};a.get_error_quantity=function(){return z.ML()};a.get_warning_quantity=function(){return z.hM()};a.clear_errors_warnings=function(){return z.clear_errors_warnings()};a.analyze_shaders=
function(a){var f=A.aB(),h=0,k;for(k in f)a&&-1===k.indexOf(a)||h++;var h="of "+h+" analyzing...",g={};for(k in f)if(!a||-1!==k.indexOf(a)){var l=f[k],p;var r=l.Jt;p=l.zr;var q=m.JL();if(q){var t=q.getTranslatedShaderSource(r),q=q.getTranslatedShaderSource(p);if(n.detect_mobile())var t=t.replace("#version","#version 300 //"),q=q.replace("#version","#version 300 //"),u=d("/analyze_shader/vert_gles",t),v=d("/analyze_shader/frag_gles",q);else t=t.replace("#version","#version 400 //"),q=q.replace("#version",
"#version 400 //"),u=d("/analyze_shader/vert",t),v=d("/analyze_shader/frag",q);var y=e(u),w=e(v);p={ZQ:c.Dr().getShaderSource(r),$Q:t,YQ:u,aR:y,lL:c.Dr().getShaderSource(p),mL:q,cL:v,wv:w}}else z.error("WEBGL_debug_shaders extension not found"),p=void 0;t=l.tb;r=t.ug+" + "+t.Ye;p.mK=l;p.tb=t;l=g[r]=g[r]||[];l.push(p);z.Zd(h)}for(r in g)z.group("%c"+r,"color: #800"),l=g[r],b(l),z.groupEnd()};a.fake_load=c.fake_load;a.test_performance=function(b){if(A.Rz())if(m.Cv()){var d=k.gl_debug;k.gl_debug=!0;
var e=B.BJ();I.TA(null,e);for(var f=B.Pb(e,J.xn),h=f.p,e=0;5>e;e++)x.Tl(f);k.gl_debug=d;window.setTimeout(function(){c.aO(f);var a=f.Ue;b(a,h.width*h.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.test_performance(b)},100)};a.calc_vbo_garbage_byte_size=c.calc_vbo_garbage_byte_size;a.show_vbo_garbage_info=c.show_vbo_garbage_info;a.start_debug=function(a){F=[];aa=!0;a=q(a);for(var b in a)"function"===typeof a[b]&&(a[b]=l(a[b],b))};a.check_debug_result=function(){return aa};
a.test=function(a,b){try{return b(),!0}catch(c){return aa=!1,console.error(a+" test was failed. ",c),!1}};a.pix=function(a){var b=v.pB(),c=v.oB(),d=b/2,e=c/2;v.resize(b,c,!1);b=I.get_active().q.Ma;(c=B.$K(b))||h.r("Couldn't find onscreen subscene");b=c.p;d=v.Uq(d,e,M,c.p);d[1]=b.height-d[1];d=x.$w(b.xe,d[0],d[1]);w(a,d,1)};a.eqs=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+D;};a.eqv=w;a.eqf=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";
c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.eq=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=q(a);for(var b in a)-1==F.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.ok=function(a){if(!Boolean(a))throw"Wrong result. Function: "+D;}};b4w.module.geometry=function(a,q){var e=q("__batch"),d=q("__geometry"),b=q("__print"),g=q("__renderer"),l=q("__util");a.extract_vertex_array=function(a,f,g){if(!d.dm(a))return b.error("Wrong object:",a.name),null;if(a=e.Oa(a,f,"MAIN")){if((f=a.ha)&&f.Cb&&f.Cb[g])return d.RK(f,g);b.error("Attribute not found:"+g);return null}b.error("Wrong material:",f);return null};a.extract_index_array=function(a,f){if(!d.dm(a))return b.error("Wrong object:",a.name),null;var g=e.Oa(a,f,"MAIN");if(g){if((g=g.ha)&&
g.Cb)return g.Ad;b.error("Buffer data not found");return null}b.error("Wrong material:",f);return null};a.update_vertex_array=function(a,f,g,l){if(d.dm(a)){var q=d.Mi(g),q=d.bB(q);if(q!=l.constructor)b.error("Wrong input array type '"+l.constructor.name+"' for the given attribute. Should be '"+q.name+"'.");else for(var q=["MAIN","SHADOW","COLOR_ID"],c=0;c<q.length;c++){var m=e.Oa(a,f,q[c]);m&&(m=m.ha)&&m.Cb&&m.Cb[g]&&d.lE(m,g,0,l)}}else b.error("Wrong object:",a.name)};a.override_geometry=function(a,
f,n,r,q){if(d.dm(a))if(n instanceof Uint16Array||n instanceof Uint32Array)if(r instanceof Float32Array)for(var c=["MAIN","SHADOW","COLOR_ID"],m=0;m<c.length;m++){var p=c[m],y=e.Oa(a,f,p);if(y){var E=y.ha;if(E){d.mE(E,y.Xf,n);var u={},z;for(z in E.Cb){var x=E.Cb[z],x=r.length/3*x.Vb,p=d.Mi(z);u[p]||(u[p]=0);u[p]+=x}p=d.tM(u);E.Db=p;u={};for(z in E.Cb)switch(x=E.Cb[z],p=d.Mi(z),u[p]||(u[p]=0),z){case "a_position":d.iq(E.Db,"a_position",r,u[p]);x.offset=u[p];x.length=r.length;u[p]+=x.length;break;case "a_tbn_quat":var I;
q&&(I=d.Bz(n,r,r));var B=d.Az(n,r,I);x.length=r.length/3*x.Vb;for(var G=new Float32Array(x.length),A=0;A<G.length;A+=4)G[A]=1,G[A+3]=1;B=l.gen_tbn_quats(B,G);d.iq(E.Db,"a_tbn_quat",B,u[p]);x.offset=u[p];u[p]+=x.length;break;default:x.offset=u[p],x.length=r.length/3*x.Vb,B=new (d.bB(p))(x.length),d.iq(E.Db,z,B,u[p]),u[p]+=x.length}d.dy(E);g.ou(y);(y=e.Xe(a,y))&&y.ha&&(y.ha=E)}}}else b.error("Wrong positions_array type");else b.error("Wrong ibo_array type");else b.error("Wrong object:",a.name)};a.set_shape_key_value=
function(a,e,g){d.check_shape_keys(a)?d.Qv(a,e)?d.az(a,e,parseFloat(g)):b.error("Wrong key name:",e):b.error("Wrong object:",a.name)};a.check_shape_keys=function(a){return d.check_shape_keys(a)};a.get_shape_keys_names=function(a){return d.check_shape_keys(a)?d.get_shape_keys_names(a):(b.error("Wrong object:",a.name),null)};a.get_shape_key_value=function(a,e){return d.check_shape_keys(a)?d.Qv(a,e)?d.get_shape_key_value(a,e):(b.error("Wrong key name:",e),null):(b.error("Wrong object:",a.name),null)};
a.draw_line=function(a,f,l){l=l||!1;if(f instanceof Float32Array){if(a=e.Ev(a))d.draw_line(a,f,l),g.ou(a)}else b.error("Wrong positions type")}};b4w.module.hud=function(a,q){var e=q("__hud");q("__print");a.draw_mixer_strip=e.draw_mixer_strip;a.plot_array=e.plot_array};b4w.module.input=function(a,q){function e(a){var d=b.get_device_by_type_element(b.DEVICE_HMD);if(!d||!d.og)return!1;if(p)return!0;var e=b.get_vector_param(d,b.cF,c),l=b.get_vector_param(d,b.dF,m);g.set_hmd_fov(a,e,l);if(e=b.get_value_param(d,u))l=r.get_active(),a=f.ea(a,l).W,g.set_eye_distance(a,e);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.get_value_param(b.HMD_WEBVR_TYPE)!==b.HMD_WEBVR1&&(a.distortion_coefs=[d.distortion_coefs[0],d.distortion_coefs[1]],a.chromatic_aberration_coefs=
[d.chromatic_aberration_coefs[0],d.chromatic_aberration_coefs[1],d.chromatic_aberration_coefs[2],d.chromatic_aberration_coefs[3]],d.rn||(d.ui&&d.Pi&&d.wi?a.base_line_factor=(d.ui-d.wi)/d.Pi:d.wi||(a.base_line_factor=d.ui/d.Pi)),d.Jh&&d.tl&&!d.rn&&(a.inter_lens_factor=d.Jh/d.tl),y.enabled||(e=1+d.distortion_coefs[0]+d.distortion_coefs[1],r.hC(e,e)));r.set_hmd_params(a);w.resize_to_container(!0);b.reset_device(d);return p=!0}function d(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=q("__input"),g=q("__camera"),l=q("__config"),w=q("__container"),f=q("__obj_util"),n=q("__print"),r=q("__scenes"),v=q("__vec4"),c=v.create(),m=v.create(),p=!1,y=l.ro,E=l.A;a.GMPD_BUTTON_12=b.GMPD_BUTTON_12;a.GMPD_BUTTON_13=b.GMPD_BUTTON_13;a.GMPD_BUTTON_15=b.GMPD_BUTTON_15;a.GMPD_BUTTON_14=b.GMPD_BUTTON_14;a.GMPD_BUTTON_3=b.GMPD_BUTTON_3;a.GMPD_BUTTON_0=b.GMPD_BUTTON_0;a.GMPD_BUTTON_1=b.GMPD_BUTTON_1;a.GMPD_BUTTON_2=
b.GMPD_BUTTON_2;a.GMPD_BUTTON_5=b.GMPD_BUTTON_5;a.GMPD_BUTTON_7=b.GMPD_BUTTON_7;a.GMPD_BUTTON_4=b.GMPD_BUTTON_4;a.GMPD_BUTTON_6=b.GMPD_BUTTON_6;a.GMPD_BUTTON_8=b.GMPD_BUTTON_8;a.GMPD_BUTTON_9=b.GMPD_BUTTON_9;a.GMPD_BUTTON_10=b.GMPD_BUTTON_10;a.GMPD_BUTTON_11=b.GMPD_BUTTON_11;a.GMPD_BUTTON_16=b.GMPD_BUTTON_16;a.GMPD_BUTTON_17=b.GMPD_BUTTON_17;a.GMPD_BUTTON_18=b.GMPD_BUTTON_18;a.GMPD_BUTTON_19=b.GMPD_BUTTON_19;a.GMPD_BUTTON_20=b.GMPD_BUTTON_20;a.GMPD_BUTTON_21=b.GMPD_BUTTON_21;a.GMPD_BUTTON_22=b.GMPD_BUTTON_22;
a.GMPD_BUTTON_23=b.GMPD_BUTTON_23;a.GMPD_BUTTON_24=b.GMPD_BUTTON_24;a.GMPD_BUTTON_25=b.GMPD_BUTTON_25;a.GMPD_AXIS_0=b.GMPD_AXIS_0;a.GMPD_AXIS_1=b.GMPD_AXIS_1;a.GMPD_AXIS_2=b.GMPD_AXIS_2;a.GMPD_AXIS_3=b.GMPD_AXIS_3;a.GMPD_AXIS_4=b.GMPD_AXIS_4;a.GMPD_AXIS_5=b.GMPD_AXIS_5;a.GMPD_AXIS_6=b.GMPD_AXIS_6;a.GMPD_AXIS_7=b.GMPD_AXIS_7;a.GMPD_AXIS_8=b.GMPD_AXIS_8;a.GMPD_AXIS_9=b.GMPD_AXIS_9;a.GMPD_AXIS_10=b.GMPD_AXIS_10;a.GMPD_AXIS_11=b.GMPD_AXIS_11;a.HMD_ORIENTATION_QUAT=b.HMD_ORIENTATION_QUAT;a.HMD_POSITION=
b.HMD_POSITION;a.HMD_WEBVR_TYPE=b.HMD_WEBVR_TYPE;a.HMD_WEBVR_DESKTOP=b.HMD_WEBVR_DESKTOP;a.HMD_WEBVR_MOBILE=b.HMD_WEBVR_MOBILE;a.HMD_NON_WEBVR=b.HMD_NON_WEBVR;a.HMD_WEBVR1=b.HMD_WEBVR1;var u=b.HMD_EYE_DISTANCE;a.HMD_EYE_DISTANCE=u;a.HMD_DISTORTION=b.HMD_DISTORTION;a.HMD_BASELINE_DIST=b.HMD_BASELINE_DIST;a.HMD_SCREEN_LENSE_DIST=b.HMD_SCREEN_LENSE_DIST;a.HMD_SCREEN_WIDTH=b.HMD_SCREEN_WIDTH;a.HMD_SCREEN_HEIGHT=b.HMD_SCREEN_HEIGHT;a.HMD_BEVEL_SIZE=b.HMD_BEVEL_SIZE;a.MOUSE_LOCATION=b.MOUSE_LOCATION;a.MOUSE_DOWN_WHICH=
b.MOUSE_DOWN_WHICH;a.MOUSE_UP_WHICH=b.MOUSE_UP_WHICH;a.MOUSE_WHEEL=b.MOUSE_WHEEL;a.KEYBOARD_UP=b.KEYBOARD_UP;a.KEYBOARD_DOWN=b.KEYBOARD_DOWN;a.TOUCH_START=b.TOUCH_START;a.TOUCH_MOVE=b.TOUCH_MOVE;a.TOUCH_END=b.TOUCH_END;a.GYRO_ORIENTATION_QUAT=b.GYRO_ORIENTATION_QUAT;a.GYRO_ORIENTATION_ANGLES=b.GYRO_ORIENTATION_ANGLES;var z={};z[b.DEVICE_HMD]=[b.HMD_ORIENTATION_QUAT,b.HMD_POSITION];z[b.DEVICE_MOUSE]=[b.MOUSE_LOCATION];var x={};x[b.DEVICE_HMD]=[b.HMD_WEBVR_TYPE];var I={};I[b.DEVICE_MOUSE]=[b.MOUSE_LOCATION,
b.MOUSE_DOWN_WHICH,b.MOUSE_UP_WHICH,b.MOUSE_WHEEL];I[b.DEVICE_KEYBOARD]=[b.KEYBOARD_UP,b.KEYBOARD_DOWN];I[b.DEVICE_TOUCH]=[b.TOUCH_START,b.TOUCH_MOVE,b.TOUCH_END];I[b.DEVICE_GYRO]=[b.GYRO_ORIENTATION_QUAT,b.GYRO_ORIENTATION_ANGLES];var B={};B[b.DEVICE_HMD]=[b.HMD_DISTORTION,b.HMD_EYE_DISTANCE,b.HMD_BASELINE_DIST,b.HMD_SCREEN_LENSE_DIST,b.HMD_SCREEN_WIDTH,b.HMD_SCREEN_HEIGHT,b.HMD_BEVEL_SIZE];a.DEVICE_GYRO=b.DEVICE_GYRO;a.DEVICE_HMD=b.DEVICE_HMD;a.DEVICE_MOUSE=b.DEVICE_MOUSE;a.DEVICE_KEYBOARD=b.DEVICE_KEYBOARD;
a.DEVICE_TOUCH=b.DEVICE_TOUCH;a.can_use_device=b.can_use_device;a.get_device_by_type_element=b.get_device_by_type_element;a.switch_prevent_default=function(a,c){a&&b.switch_prevent_default(a,c)};a.register_device=function(){n.Ec("input.register_device() deprecated")};a.reset_device=function(a){a&&a.type==b.DEVICE_HMD?b.reset_device(a):n.error("reset_device is undefined for device.")};a.get_vector_param=function(a,c,d){if(a&&a.type in z&&0<=z[a.type].indexOf(c))return b.get_vector_param(a,c,d);n.error("device hasn't param: ",
c)};a.get_value_param=function(a,c){if(a&&a.type in x&&0<=x[a.type].indexOf(c))return b.get_value_param(a,c);n.error("device hasn't param: ",c)};a.attach_param_cb=function(a,c,d){d=d||null;if(a&&a.type in I&&0<=I[a.type].indexOf(c))return b.attach_param_cb(a,c,d);n.error("device hasn't param: ",c)};a.detach_param_cb=function(a,c,d){d=d||null;if(a&&a.type in I&&0<=I[a.type].indexOf(c))return b.detach_param_cb(a,c,d);n.error("device hasn't param: ",c)};a.set_config=function(a,c,d){if(a&&a.type in B&&
0<=B[a.type].indexOf(c))return b.set_config(a,c,d);n.error("device hasn't config: ",c)};a.request_fullscreen_hmd=function(){if(r.va()){var a=r.bm(r.get_active());if(a&&(e(a),a=b.get_device_by_type_element(b.DEVICE_HMD))){var c=a.nf;c&&!c.isPresenting&&(c.capabilities.canPresent?(a=w.get_canvas(),c.requestPresent([{source:a}]).then(function(){if(!E.is_mobile_device){var a=c.getEyeParameters("left"),b=c.getEyeParameters("right");w.resize(2*Math.max(a.renderWidth,b.renderWidth),Math.max(a.renderHeight,
b.renderHeight),!1)}},function(){n.error("HMD fullscreen request failed.")})):n.error("HMD fullscreen request failed."))}}};a.enable_split_screen=e;a.disable_split_screen=function(){var a=b.get_device_by_type_element(b.DEVICE_HMD);if(!(p||a&&a.og))return!1;r.set_hmd_params({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);r.hC(a,a);w.resize_to_container(!0);return!0};a.set_gamepad_key=function(a,c,e){d();switch(a){case 0:a=b.oq;break;case 1:a=b.Xt;break;case 2:a=b.Yt;break;
case 3:a=b.Zt;break;default:a=b.oq}a=b.get_device_by_type_element(a);b.set_config(a,c,e)};a.get_pressed_gmpd_btn=b.get_pressed_gmpd_btn;a.get_moved_gmpd_axis=b.get_moved_gmpd_axis;a.check_enable_gamepad_indices=d};b4w.module.lights=function(a,q){function e(a){for(var d=f.get_active(),e=g.Gb(d,"LAMP",g.DATA_ID_ALL),l=0;l<e.length;l++){var p=e[l];if("SUN"==p.$a.type){var q=p;break}}if(!q)w.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){e=v.deg_to_rad(180-a.hor_position);a=v.deg_to_rad(90-a.vert_position);l=q.k;n.set_rotation_euler(q,[a,0,e]);e=new Float32Array(3);p=r.get_quat_view(l.n);v.quat_to_dir(p,v.AXIS_Z,e);l=r.get_trans_view(l.n);l=c.length(l);
c.copy(e,m);c.scale(m,l,m);n.set_translation(q,m);n.B(q);e=q.$a;if(e.AA){var y=d.world.light_settings.environment_energy,l=d.world.horizon_color,p=d.world.zenith_color,A=Math.cos(Math.abs(a));a=Math.max(Math.min(3*A,1),0)*e.sA;y*=Math.max(A,.1);b.set_light_energy(e,a);f.set_environment_colors(d,y,l,p)}f.jn(q,d)}}function d(a){if(l.is_lamp(a))return a.$a.type;w.error("get_light_type(): Wrong object");return!1}var b=q("__lights"),g=q("__objects"),l=q("__obj_util"),w=q("__print"),f=q("__scenes"),n=q("__transform"),
r=q("__tsr"),v=q("__util"),c=q("__vec3"),m=new Float32Array(3),p,y=60;a.get_lamps=function(a){var b=f.get_active(),b=g.Gb(b,"LAMP",g.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.$a.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=f.get_active(),a=g.Gb(a,"LAMP",g.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.$a.type){b=d;break}}return b?(b=b.$a.direction,a=v.rad_to_deg(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=v.rad_to_deg(Math.atan2(b[2],
Math.sqrt(b[0]*b[0]+b[1]*b[1]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=e;a.set_day_time=function(a){for(var b=f.get_active(),b=g.Gb(b,"LAMP",g.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];if("SUN"==d.$a.type){var m=d;break}}m?(m=-Math.cos(a/12*Math.PI)*y,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=m,e(b)):w.error("There is no sun on the scene")};a.set_date=function(a){(p=a.getDate())?1582==p&&10==a.kT&&4<a.qK&&15>a.qK&&w.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):
w.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){y=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(l.is_lamp(a))var b=a.$a;else return w.error("get_light_params(): Wrong object"),null;if(a=d(a))switch(a){case "SPOT":var c={light_type:a,light_color:new Float32Array(3),light_energy:b.Ve,light_spot_blend:b.Qp,light_spot_size:b.fl,light_distance:b.distance};c.light_color.set(b.color);break;case "POINT":c={light_type:a,light_color:new Float32Array(3),light_energy:b.Ve,
light_distance:b.distance};c.light_color.set(b.color);break;default:c={light_type:a,light_color:new Float32Array(3),light_energy:b.Ve},c.light_color.set(b.color)}return c?c:null};a.get_light_type=d;a.set_light_params=function(a,c){if(l.is_lamp(a)){var d=a.$a,e=f.get_active(),g=!1;"number"==typeof c.light_energy&&b.set_light_energy(d,c.light_energy);"object"==typeof c.light_color&&b.set_light_color(d,c.light_color);"number"==typeof c.light_spot_blend&&(b.SO(d,c.light_spot_blend),g=!0);"number"==typeof c.light_spot_size&&
(b.TO(d,c.light_spot_size),g=!0);"number"==typeof c.light_distance&&(b.RO(d,c.light_distance),g=!0);f.jn(a,e);g&&f.bQ(e)}else w.error("set_light_params(): Wrong object")};a.get_light_energy=function(a){return l.is_lamp(a)?a.$a.Ve:(w.error("get_light_energy(): Wrong object"),0)};a.set_light_energy=function(a,c){if(l.is_lamp(a)){var d=f.get_active();b.set_light_energy(a.$a,c);f.jn(a,d)}else w.error("set_light_energy(): Wrong object")};a.get_light_color=function(a,b){if(!l.is_lamp(a))return w.error("get_light_color(): Wrong object"),
null;b=b||new Float32Array(3);b.set(a.$a.color);return b};a.set_light_color=function(a,c){if(l.is_lamp(a)){var d=f.get_active();b.set_light_color(a.$a,c);f.jn(a,d)}else w.error("set_light_color(): Wrong object")}};b4w.module.logic_nodes=function(a,q){var e=q("__logic_nodes");a.append_custom_callback=function(a,b){e.qH(a,b)};a.remove_custom_callback=function(a){e.fO(a)};a.run_entrypoint=function(a,b){e.xO(a,b)}};b4w.module.material=function(a,q){function e(a,b){for(var c=a.G[0].T,d=0;d<c.length;d++){var e=c[d];if(-1<e.lc.indexOf(b)&&"MAIN"==e.type)return!0}return!1}function d(a,b){var c=g.Oa(a,b,"MAIN");return Boolean(c&&c.Nd[0])}function b(a,b){var c=g.Oa(a,b,"MAIN");return Boolean(c&&c.Nd[1])}var g=q("__batch"),l=q("__config"),w=q("__obj_util"),f=q("__print"),n=q("__shaders"),r=q("__util"),v=q("__scenes"),c=l.A;a.inherit_material=function(a,b,c,d){w.dg(c)&&w.dg(a)?g.inherit_material(a,b,c,d):f.error("Wrong or batched object(s)")};
a.get_materials_names=function(a){var b=[];a=a.G;for(var c=0;c<a.length;c++)for(var d=a[c].T,e=0;e<d.length;e++)for(var f=0;f<d[e].lc.length;f++)-1==b.indexOf(d[e].lc[f])&&b.push(d[e].lc[f]);return b};a.set_diffuse_color=function(a,b,c){var d=g.Oa(a,b,"MAIN");d?(d.ud.set(c),(a=g.Xe(a,b,"MAIN"))&&a.ud.set(c)):f.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_color=function(a,b){var c=g.Oa(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.ud);return d}f.error('Couldn\'t get property "diffuse_color"!')};
a.set_diffuse_intensity=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.Kg=c,a=g.Xe(a,b,"MAIN"))a.Kg=c}else f.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.Kg;f.error('Couldn\'t get property "diffuse_intensity"!')};a.set_specular_color=function(a,b,c){var d=g.Oa(a,b,"MAIN");d?(d.Jf.set(c),(a=g.Xe(a,b,"MAIN"))&&a.Jf.set(c)):f.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=g.Oa(a,
b,"MAIN");if(c){var d=Array(3);d[0]=c.Jf[0];d[1]=c.Jf[1];d[2]=c.Jf[2];return d}f.error('Couldn\'t get property "specular_color"!')};a.set_specular_color_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.bi=c,a=g.Xe(a,b,"MAIN"))a.bi=c}else f.error('Couldn\'t set property "specular_color_factor"!')};a.get_specular_color_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.bi;f.error('Couldn\'t get property "specular_color_factor"!')};a.set_specular_intensity=function(a,b,c){d(a,b)||f.error('Property "specular_intensity" is missing!');
g.Oa(a,b,"MAIN").Nd[0]=c;(a=g.Xe(a,b,"MAIN"))&&(a.Nd[0]=c)};a.get_specular_intensity=function(a,b){d(a,b)||f.error('Property "specular_intensity" is missing!');return g.Oa(a,b,"MAIN").Nd[0]};a.check_specular_intensity=d;a.set_specular_hardness=function(a,c,d){b(a,c)||f.error('Property "specular_hardness" is missing!');g.Oa(a,c,"MAIN").Nd[1]=d;(a=g.Xe(a,c,"MAIN"))&&(a.Nd[1]=d)};a.get_specular_hardness=function(a,c){b(a,c)||f.error('Property "specular_hardness" is missing!');return g.Oa(a,c,"MAIN").Nd[1]};
a.check_specular_hardness=b;a.set_emit_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.Yf=c,a=g.Xe(a,b,"MAIN"))a.Yf=c}else f.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.Yf;f.error('Couldn\'t get property "emit_factor"!')};a.set_ambient_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.Qf=c,a=g.Xe(a,b,"MAIN"))a.Qf=c}else f.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=
g.Oa(a,b,"MAIN");if(c)return c.Qf;f.error('Couldn\'t get property "ambient_factor"!')};a.set_diffuse_color_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.Jg=c,a=g.Xe(a,b,"MAIN"))a.Jg=c}else f.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.Jg;f.error('Couldn\'t get property "diffuse_color_factor"!')};a.set_alpha_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.Bg=c,a=g.Xe(a,b,"MAIN"))a.Bg=c}else f.error('Couldn\'t set property "alpha_factor"!')};
a.get_alpha_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.Bg;f.error('Couldn\'t get property "alpha_factor"!')};a.get_material_extended_params=function(a,b){if(!a||!b)return f.error("missing arguments in get_material_params"),null;if(!e(a,b))return null;var c=g.Oa(a,b,"MAIN");if(!c)return null;var d={};"MAIN"==c.type&&(d.reflect_factor=c.reflect_factor,d.fresnel=c.Ze[2],d.fresnel_factor=5*(1-c.Ze[3]),d.parallax_scale=c.parallax_scale,d.parallax_steps=g.gd(c,"PARALLAX_STEPS")[1]);return d};
a.get_water_material_params=function(a,b){if(!a||!b)return f.error("missing arguments in get_water_material_params"),null;if(!e(a,b))return null;var d=g.Oa(a,b,"MAIN");if(!d||!d.mh)return null;if(!d)return f.error("material not found"),null;var l={};if("MAIN"==d.type){if(c.Mm){var n=l.shallow_water_col=Array(3);n[0]=d.shallow_water_col[0];n[1]=d.shallow_water_col[1];n[2]=d.shallow_water_col[2];n=l.shore_water_col=Array(3);n[0]=d.shore_water_col[0];n[1]=d.shore_water_col[1];n[2]=d.shore_water_col[2];
l.shallow_water_col_fac=d.shallow_water_col_fac;l.shore_water_col_fac=d.shore_water_col_fac}l.foam_factor=d.foam_factor;l.norm_uv_velocity=d.Kj;l.absorb_factor=g.gd(d,"ABSORB")[1];l.sss_strength=g.gd(d,"SSS_STRENGTH")[1];l.sss_width=g.gd(d,"SSS_WIDTH")[1];l.dst_noise_scale0=g.gd(d,"DST_NOISE_SCALE_0")[1];l.dst_noise_scale1=g.gd(d,"DST_NOISE_SCALE_1")[1];l.dst_noise_freq0=g.gd(d,"DST_NOISE_FREQ_0")[1];l.dst_noise_freq1=g.gd(d,"DST_NOISE_FREQ_1")[1];l.dir_min_shore_fac=g.gd(d,"DIR_MIN_SHR_FAC")[1];
l.dir_freq=g.gd(d,"DIR_FREQ")[1];l.dir_noise_scale=g.gd(d,"DIR_NOISE_SCALE")[1];l.dir_noise_freq=g.gd(d,"DIR_NOISE_FREQ")[1];l.dir_min_noise_fac=g.gd(d,"DIR_MIN_NOISE_FAC")[1];l.dst_min_fac=g.gd(d,"DST_MIN_FAC")[1];l.waves_hor_fac=g.gd(d,"WAVES_HOR_FAC")[1]}return l};a.set_material_extended_params=function(a,b,c){if(a&&b&&c)if(e(a,b)){var d=g.Oa(a,b,"MAIN");if(d){var l=[d];(d=g.Xe(a,b,"MAIN"))&&l.push(d);for(a=0;a<l.length;a++)d=l[a],"number"==typeof c.material_reflectivity&&(d.reflect_factor=c.material_reflectivity),
"number"==typeof c.material_fresnel&&(d.Ze[2]=c.material_fresnel),"number"==typeof c.material_fresnel_factor&&(d.Ze[3]=1-c.material_fresnel_factor/5),"number"==typeof c.material_parallax_scale&&(d.parallax_scale=c.material_parallax_scale),"number"==typeof c.material_parallax_steps&&(b=n.F(parseFloat(c.material_parallax_steps)),g.ab(d,"PARALLAX_STEPS",b),g.oc(d),v.MC(d))}else f.error("material not found")}else f.error("setting material params is not possible");else f.error("missing arguments in set_material_params")};
a.set_water_material_params=function(a,b,d){if(a&&b&&d)if(e(a,b)){var l=g.Oa(a,b,"MAIN");if(l){var r=[l];(l=g.Xe(a,b,"MAIN"))&&r.push(l);for(a=0;a<r.length;a++)l=r[a],c.Mm&&("object"==typeof d.shallow_water_col&&l.shallow_water_col.set(d.shallow_water_col),"number"==typeof d.shallow_water_col_fac&&(l.shallow_water_col_fac=d.shallow_water_col_fac),"object"==typeof d.shore_water_col&&l.shore_water_col.set(d.shore_water_col),"number"==typeof d.shore_water_col_fac&&(l.shore_water_col_fac=d.shore_water_col_fac)),
c.shore_smoothing&&l.qn&&("boolean"==typeof d.shore_smoothing&&(d.shore_smoothing?g.ab(l,"SHORE_SMOOTHING",1):g.ab(l,"SHORE_SMOOTHING",0)),"number"==typeof d.absorb_factor&&(b=n.F(parseFloat(d.absorb_factor)),g.ab(l,"ABSORB",b))),"number"==typeof d.foam_factor&&c.Yl&&(l.foam_factor=d.foam_factor),"number"==typeof d.norm_uv_velocity&&(l.Kj=d.norm_uv_velocity),c.water_dynamic&&l.water_dynamic&&("boolean"==typeof d.water_dynamic&&(d.water_dynamic?g.ab(l,"DYNAMIC",1):g.ab(l,"DYNAMIC",0)),"number"==typeof d.waves_height&&
(b=n.F(parseFloat(d.waves_height)),g.ab(l,"WAVES_HEIGHT",b)),"number"==typeof d.waves_length&&(b=n.F(parseFloat(d.waves_length)),g.ab(l,"WAVES_LENGTH",b)),"number"==typeof d.sss_strength&&(b=n.F(parseFloat(d.sss_strength)),g.ab(l,"SSS_STRENGTH",b)),"number"==typeof d.sss_width&&(b=n.F(parseFloat(d.sss_width)),g.ab(l,"SSS_WIDTH",b)),"number"==typeof d.dst_noise_scale0&&(b=n.F(parseFloat(d.dst_noise_scale0)),g.ab(l,"DST_NOISE_SCALE_0",b)),"number"==typeof d.dst_noise_scale1&&(b=n.F(parseFloat(d.dst_noise_scale1)),
g.ab(l,"DST_NOISE_SCALE_1",b)),"number"==typeof d.dst_noise_freq0&&(b=n.F(parseFloat(d.dst_noise_freq0)),g.ab(l,"DST_NOISE_FREQ_0",b)),"number"==typeof d.dst_noise_freq1&&(b=n.F(parseFloat(d.dst_noise_freq1)),g.ab(l,"DST_NOISE_FREQ_1",b)),"number"==typeof d.dir_min_shore_fac&&(b=n.F(parseFloat(d.dir_min_shore_fac)),g.ab(l,"DIR_MIN_SHR_FAC",b)),"number"==typeof d.dir_freq&&(b=n.F(parseFloat(d.dir_freq)),g.ab(l,"DIR_FREQ",b)),"number"==typeof d.dir_noise_scale&&(b=n.F(parseFloat(d.dir_noise_scale)),
g.ab(l,"DIR_NOISE_SCALE",b)),"number"==typeof d.dir_noise_freq&&(b=n.F(parseFloat(d.dir_noise_freq)),g.ab(l,"DIR_NOISE_FREQ",b)),"number"==typeof d.dir_min_noise_fac&&(b=n.F(parseFloat(d.dir_min_noise_fac)),g.ab(l,"DIR_MIN_NOISE_FAC",b)),"number"==typeof d.dst_min_fac&&(b=n.F(parseFloat(d.dst_min_fac)),g.ab(l,"DST_MIN_FAC",b)),"number"==typeof d.waves_hor_fac&&(b=n.F(parseFloat(d.waves_hor_fac)),g.ab(l,"WAVES_HOR_FAC",b))),g.oc(l),v.MC(l)}else f.error("material not found")}else f.error("setting water material params is not possible");
else f.error("missing arguments in set_water_material_params")};a.set_line_params=function(a,b){var c=g.Ev(a);c?(r.yf(b.color)&&c.ud.set(b.color),r.yf(b.width)&&(c.qm=b.width)):f.error("Couldn't set line params!")};a.get_line_params=function(a){if(a=g.Ev(a))return{color:new Float32Array(a.ud),width:a.qm};f.error("Couldn't get line params");return null};a.set_nodemat_value=function(a,b,c){if(w.dg(a)){var d=b[0],e=g.Oa(a,d,"MAIN");if(null===e)return f.error('Material "'+d+'" was not found in the object "'+
a.name+'".'),null;e=g.Pg(e.ff,b);if(null===e)return f.error('Value node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),null;g.set_nodemat_value(a,d,e,c)}else f.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_value=function(a,b){if(!w.dg(a))return f.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var c=b[0],d=g.Oa(a,c,"MAIN");if(null===d)return f.error('Material "'+c+'" was not found in the object "'+
a.name+'".'),null;c=g.Pg(d.ff,b);return null===c?(f.error('Value node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),null):g.get_nodemat_value(d,c)};a.set_nodemat_rgb=function(a,b,c,d,e){if(w.dg(a)){var l=b[0],n=g.Oa(a,l,"MAIN");null===n?f.error('Material "'+l+'" was not found in the object "'+a.name+'".'):(n=g.Pg(n.ef,b),null===n?f.error('RGB node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'):g.set_nodemat_rgb(a,l,n,c,d,e))}else f.error('The type of the object "'+
a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_rgb=function(a,b,c){if(!w.dg(a))return f.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var d=b[0],e=g.Oa(a,d,"MAIN");if(null===e)return f.error('Material "'+d+'" was not found in the object "'+a.name+'".'),null;d=g.Pg(e.ef,b);if(null===d)return f.error('RGB node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),null;c||(c=new Float32Array(3));return g.get_nodemat_rgb(e,d,c)}};b4w.module.math=function(a,q){var e=q("__vec3"),d=q("__util"),b=q("__math"),g=new Float32Array(3);a.create_pline_from_points=function(a,d){var f=new Float32Array(6);b.set_pline_initial_point(f,a);e.subtract(d,a,g);b.set_pline_directional_vec(f,g);return f};a.create_pline_from_point_vec=function(a,d){var e=new Float32Array(6);b.set_pline_initial_point(e,point1);b.set_pline_directional_vec(e,d);return e};a.create_pline=function(){return new Float32Array(6)};a.get_pline_directional_vec=b.get_pline_directional_vec;
a.get_pline_initial_point=b.get_pline_initial_point;a.set_pline_initial_point=b.set_pline_initial_point;a.set_pline_directional_vec=b.set_pline_directional_vec;a.line_plane_intersect=d.line_plane_intersect;a.calc_pline_point=b.calc_pline_point;a.point_plane_dist=b.point_plane_dist};b4w.module.particles=function(a,q){var e=q("__particles"),d=q("__print");a.set_size=function(a,g,l){e.zm(a)?e.set_size(a,g,l):d.error('"',a.name,'" has no particle systems')};a.set_normal_factor=function(a,g,l){e.zm(a)?e.set_normal_factor(a,g,l):d.error('"',a.name,'" has no particle systems')};a.set_factor=function(a,g,l){e.zm(a)?(l=Math.min(l,1),l=Math.max(l,0),e.set_factor(a,g,l)):d.error('"',a.name,'" has no particle systems')}};b4w.module.physics=function(a,q){function e(a,b,d,e){return l.BK(a,e[d[0]],e[d[1]],e[d[2]])}function d(a,b,d,e,c){b=Math.abs(a[2]-b[2]);return b<c&&w.FM(a,d,e)?b:Number.MAX_VALUE}q("__config");var b=q("__physics"),g=q("__print"),l=q("__util"),w=q("__navmesh");q("__vec3");new Float32Array(3);a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){b.ka(a)?b.enable_simulation(a):g.error("No physics for object "+a.name)};a.disable_simulation=function(a){b.ka(a)?b.disable_simulation(a):
g.error("No physics for object "+a.name)};a.has_physics=function(a){return b.ka(a)};a.has_simulated_physics=function(a){return b.has_simulated_physics(a)};a.has_dynamic_physics=function(a){return b.has_dynamic_physics(a)};a.set_gravity=function(a,d){b.ka(a)?b.set_gravity(a,d):g.error("No physics for object "+a.name)};a.set_transform=function(a,d,e){b.ka(a)?b.set_transform(a,d,e):g.error("No physics for object "+a.name)};a.sync_transform=function(a){b.ka(a)?b.sync_transform(a):g.error("No physics for object "+
a.name)};a.apply_velocity=function(a,d,e,l){b.ka(a)?b.apply_velocity(a,d,e,l):g.error("No physics for object "+a.name)};a.apply_velocity_world=function(a,d,e,l){b.ka(a)?b.apply_velocity_world(a,d,e,l):g.error("No physics for object "+a.name)};a.apply_force=function(a,d,e,l){b.ka(a)?b.apply_force(a,d,e,l,!1):g.error("No physics for object "+a.name)};a.apply_force_world=function(a,d,e,l){b.ka(a)?b.apply_force(a,d,e,l,!0):g.error("No physics for object "+a.name)};a.apply_torque=function(a,d,e,l){b.ka(a)?
b.apply_torque(a,d,e,l):g.error("No physics for object "+a.name)};a.vehicle_throttle=function(a,d){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_throttle(a,l.clamp(d,-1,1))):g.error("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,d,e){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");d=l.clamp(d,0,1);var q=a.v.Ul;-1==e||1==e?q=Math.max(-1,Math.min(q+e*d,1)):0==e&&0<=q?(q-=d,q=Math.max(0,q)):0==e&&0>q?
(q+=d,q=Math.min(0,q)):g.error("Wrong steering direction");b.vehicle_throttle(a,l.clamp(q,-1,1))}else g.error("No physics for object "+a.name)};a.vehicle_steer=function(a,d){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_steer(a,l.clamp(d,-1,1))):g.error("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,d,e){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");d=l.clamp(d,0,1);var q=a.v.Wm;-1==e||1==e?q=Math.max(-1,
Math.min(q+e*d,1)):0==e&&0<=q?(q-=d,q=Math.max(0,q)):0==e&&0>q?(q+=d,q=Math.min(0,q)):g.error("Wrong steering direction");b.vehicle_steer(a,l.clamp(q,-1,1))}else g.error("No physics for object "+a.name)};a.vehicle_brake=function(a,d){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_brake(a,l.clamp(d,0,1))):g.error("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,d){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");
d=l.clamp(d,-1,1);var e=a.v.Qn;b.vehicle_brake(a,l.clamp(e+e*d,0,1))}else g.error("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return b.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return b.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!b.ka(a))return g.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.He.name;g.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!b.ka(a))return g.error("No physics for object "+
a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.v.Ul;g.error("Wrong object");return null};a.get_vehicle_steering=function(a){if(!b.ka(a))return g.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.v.Wm;g.error("Wrong object")};a.get_vehicle_brake=function(a){if(!b.ka(a))return g.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.v.Qn;g.error("Wrong object")};a.get_vehicle_speed=
function(a){if(!b.ka(a))return g.error("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return b.get_vehicle_speed(a);g.error("Wrong object")};a.is_character=function(a){return b.is_character(a)};a.set_character_move_dir=function(a,d,e){b.ka(a)?b.set_character_move_dir(a,d,e):g.error("No physics for object "+a.name)};a.set_character_move_type=function(a,d){b.ka(a)?b.set_character_move_type(a,d):g.error("No physics for object "+a.name)};a.set_character_walk_velocity=
function(a,d){b.ka(a)?b.set_character_walk_velocity(a,d):g.error("No physics for object "+a.name)};a.set_character_run_velocity=function(a,d){b.ka(a)?b.set_character_run_velocity(a,d):g.error("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,d){b.ka(a)?b.set_character_fly_velocity(a,d):g.error("No physics for object "+a.name)};a.character_jump=function(a){b.ka(a)?b.character_jump(a):g.error("No physics for object "+a.name)};a.character_rotation_inc=function(a,d,e){b.ka(a)?
b.character_rotation_inc(a,d,e):g.error("No physics for object "+a.name)};a.set_character_rotation=function(a,d,e){b.ka(a)?b.set_character_rotation(a,d,e):g.error("No physics for object "+a.name)};a.set_character_rotation_v=function(a,d){b.ka(a)?b.set_character_rotation_v(a,d):g.error("No physics for object "+a.name)};a.set_character_rotation_h=function(a,d){b.ka(a)?b.set_character_rotation_h(a,d):g.error("No physics for object "+a.name)};a.append_collision_test=function(a,d,e,l){b.ka(a)?b.append_collision_test(a,
d||"ANY",e,l||!1):g.error("No physics for object "+a.name)};a.remove_collision_test=function(a,d,e){b.ka(a)?b.remove_collision_test(a,d||"ANY",e):g.error("No physics for object "+a.name)};a.apply_collision_impulse_test=function(a,d){b.ka(a)?b.apply_collision_impulse_test(a,d):g.error("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){b.ka(a)?b.clear_collision_impulse_test(a):g.error("No physics for object "+a.name)};a.append_ray_test=function(a,d,e,l,c,m){a=a||null;if(null==
a||b.ka(a))return b.append_ray_test(a,d,e,l||"ANY",c,m||!1,!1,!1,!1);g.error("No physics for object "+a.name)};a.append_ray_test_ext=function(a,d,e,l,c,m,p,q,w){a=a||null;if(null==a||b.ka(a))return b.append_ray_test(a,d,e,l||"ANY",c,m||!1,p||!1,q||!1,w||!1);g.error("No physics for object "+a.name)};a.remove_ray_test=function(a){b.JB(a)?b.remove_ray_test(a):g.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,d,e){b.JB(a)?b.change_ray_test_from_to(a,d,e):g.error("Wrong ray test ID")};
a.apply_constraint=function(a,d,e,l,c,m,p,q,w,u){b.ka(d)&&b.ka(c)?b.apply_constraint(a,d,e,l,c,m,p,q,w,u):g.error("Wrong objects")};a.clear_constraint=function(a){b.ka(a)&&b.mM(a)?b.clear_constraint(a):g.error("Wrong object")};a.pull_to_constraint_pivot=function(a,d,e,l,c,m){b.ka(a)&&b.ka(l)?b.pull_to_constraint_pivot(a,d,e,l,c,m):g.error("Wrong objects")};a.navmesh_get_island=function(a,d,l){l||(l=e);if(b.ka(a)){var q=a.C.fp;return q?w.navmesh_get_island(q,d,l):(g.error(a.name+" is not a navigation mesh object"),
null)}g.error("No physics for object "+a.name)};a.navmesh_find_path=function(a,l,r,q){if(b.ka(a)){var c=a.C.fp;if(!c)return g.error(a.name+" is not a navigation mesh object"),null;q=q||{};a={};a.do_not_pull_string=Boolean(q.do_not_pull_string);a.distance_to_closest=q.distance_to_closest||e;a.distance_to_farthest=q.distance_to_farthest||d;a.island=q.island||0;a.allowed_distance=q.allowed_distance||Number.MAX_VALUE;a.return_normals=q.return_normals||!1;return w.navmesh_find_path(c,l,r,a)}g.error("No physics for object "+
a.name)}};b4w.module.rgb=function(a,q){q("__print");var e=q("__util"),d=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,d,e){var q=new Float32Array(3);q[0]=a;q[1]=d;q[2]=e;return q};a.set=function(a,d,e,q){q[0]=a;q[1]=d;q[2]=e;return q};a.css_to_rgb=function(a,d,l,q){q=q||new Float32Array(3);q[0]=a/255;q[1]=d/255;q[2]=l/255;e.FD(q,q);return q};a.rgb_to_css=function(a){a=e.hw(a,d);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=
function(a){function g(a){a=Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=e.hw(a,d);return"#"+g(a[0])+g(a[1])+g(a[2])}};
b4w.module.rgba=function(a,q){q("__print");var e=q("__util"),d=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,d,e,q){var f=new Float32Array(4);f[0]=a;f[1]=d;f[2]=e;f[3]=q;return f};a.set=function(a,d,e,q,f){f[0]=a;f[1]=d;f[2]=e;f[3]=q;return f};a.css_to_rgba=function(a,d,l,q,f){f=f||new Float32Array(4);f[0]=a/255;f[1]=d/255;f[2]=l/255;f[3]=q;e.FD(f,f);return f};a.rgba_to_css=function(a){var g=e.hw(a,d);return[Math.round(255*g[0]),Math.round(255*
g[1]),Math.round(255*g[2]),a[3]]}};b4w.module.scenes=function(a,q){var e=q("__batch"),d=q("__camera"),b=q("__data"),g=q("__graph"),l=q("__objects"),w=q("__obj_util"),f=q("__print"),n=q("__scenes"),r=q("__subscene"),v=q("__util");a.DATA_ID_ALL=l.DATA_ID_ALL;a.set_active=function(a){var b=n.Mo();n.set_active(v.keysearch("name",a,b))};a.get_active=function(){return n.va()?n.get_active().name:""};a.get_scenes=function(){for(var a=n.Mo(),b=[],d=0;d<a.length;d++)b.push(a[d].name);return b};a.get_active_camera=function(){if(n.va())return n.bm(n.get_active());
f.error("No active scene");return!1};a.get_object_by_name=function(a,b){var d=l.cc(l.au,a,b|0,!0);if(d)return d;f.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,d){if(a=l.cc(l.$t,a,b,d|0))return a;f.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var d=l.cc(l.yc,a,b|0);if(d)return d;f.error("get object "+a+": not found")};a.get_world_by_name=function(a,b){var d=l.get_world_by_name(a,b|0);if(d)return d;f.error("get object "+a+": not found")};
a.get_object_data_id=function(a){return w.get_object_data_id(a)};a.pick_object=l.pick_object;a.outlining_is_enabled=function(a){return a&&a.k&&a.k.nc};a.set_outline_intensity=function(a,b){a&&a.k&&a.k.nc?l.set_outline_intensity(a,b):f.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.k&&a.k.nc)return a.k.lg;f.error("get_outline_intensity(): wrong object")};a.apply_outline_anim=function(a,b,d,e){a&&a.k&&a.k.nc?l.apply_outline_anim(a,b,d,e):f.error("apply_outline_anim(): wrong object")};
a.apply_outline_anim_def=function(a){if(a&&a.k&&a.k.nc){var b=a.k.Wg;l.apply_outline_anim(a,b.dj,b.ej,b.fj)}else f.error("apply_outline_anim_def(): wrong object")};a.clear_outline_anim=function(a){a&&a.k&&a.k.nc?l.clear_outline_anim(a):f.error("clear_outline_anim(): wrong object")};a.set_outline_color=n.set_outline_color;a.get_outline_color=function(a){var b=n.get_active();if(b=n.Ja(b,r.xl))return a=a||new Float32Array(3),a.set(b.Vh),a};a.set_hmd_params=function(a){n.va()?a&&(!a.distortion_coefs||
a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),n.set_hmd_params(a)):f.error("No active scene")};a.get_shadow_params=function(){if(!n.va())return f.error("No active scene"),!1;var a=
n.get_active(),b=n.Ja(a,r.Jc);if(!b)return null;var d=a.q.bd,e=n.Ja(a,r.Bb),g=n.Ja(a,r.Oe),l={};l.csm_resolution=d.csm_resolution;l.self_shadow_polygon_offset=b.self_shadow_polygon_offset;g&&(l.self_shadow_normal_offset=g.self_shadow_normal_offset);l.enable_csm=d.enable_csm;l.csm_num=d.csm_num;l.csm_first_cascade_border=d.csm_first_cascade_border;l.first_cascade_blur_radius=d.first_cascade_blur_radius;l.csm_last_cascade_border=d.csm_last_cascade_border;l.last_cascade_blur_radius=d.last_cascade_blur_radius;
l.fade_last_cascade=d.fade_last_cascade;l.blend_between_cascades=d.blend_between_cascades;d.enable_csm?(l.csm_borders=n.IL(a,e.p),l.blur_radii=new Float32Array(d.csm_num),l.blur_radii.set(e.p.Fm.subarray(0,d.csm_num))):(l.csm_borders=null,l.blur_radii=null);return l};a.set_shadow_params=function(a){if(n.va()){var b=n.get_active();"number"==typeof a.self_shadow_polygon_offset&&g.la(b.q.Ma,function(b,d){d.type==r.Jc&&(d.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var l=n.Ja(b,r.Oe);l&&
("number"==typeof a.self_shadow_normal_offset&&(l.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(l.pcf_blur_radius=a.pcf_blur_radius));var q=n.Ja(b,r.zc);q&&("number"==typeof a.self_shadow_normal_offset&&(q.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(q.pcf_blur_radius=a.pcf_blur_radius),q.ra=!0);q=b.q.bd;"number"==typeof a.csm_first_cascade_border&&(q.csm_first_cascade_border=a.csm_first_cascade_border);"number"==
typeof a.first_cascade_blur_radius&&(q.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(q.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(q.last_cascade_blur_radius=a.last_cascade_blur_radius);if(l){for(var v=l.La,u=0;u<v.length;u++)for(var z=v[u].oa,x=0;x<z.length;x++){var I=z[x];if(I.Th.cd){var B=I.qa;e.cz(B,q);e.oc(B);r.Cc(l,I)}}l.ra=!0}l=w.ea(b.ri,b).W;for(u=0;u<l.length;u++)d.by(l[u],q);n.lx(b)}else f.error("No active scene")};
a.get_environment_colors=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active();return n.get_environment_colors(a)};a.set_environment_colors=function(a,b,d){if(n.va()){var e=n.get_active(),g=n.Ja(e,r.Bb);n.set_environment_colors(e,a||0==a?parseFloat(a):g.$f,b||0==b?b:g.Jd,d||0==d?d:g.Rd)}else f.error("No active scene")};a.get_fog_color_density=function(a){if(!n.va())return f.error("No active scene"),!1;var b=n.get_active();return n.get_fog_color_density(b,a)};a.set_fog_color_density=
function(a){if(n.va()){var b=n.get_active();n.set_fog_color_density(b,a)}else f.error("No active scene")};a.get_fog_params=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active(),b={};b.Fo=n.QL(a);b.fog_depth=n.OL(a);b.fog_start=n.RL(a);b.fog_height=n.PL(a);return b};a.set_fog_params=function(a){if(n.va()){var b=n.get_active();"number"==typeof a.Fo&&n.bD(b,a.Fo);"number"==typeof a.fog_depth&&n.$C(b,a.fog_depth);"number"==typeof a.fog_start&&n.cD(b,a.fog_start);"number"==typeof a.fog_height&&
n.aD(b,a.fog_height)}else f.error("No active scene")};a.get_ssao_params=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active();return n.get_ssao_params(a)};a.set_ssao_params=function(a){if(n.va()){var b=n.get_active();n.set_ssao_params(b,a)}else f.error("No active scene")};a.get_color_correction_params=function(){if(!n.va())return f.error("No active scene"),null;var a=n.get_active(),a=n.Ja(a,r.Tt);if(!a)return null;var b={};b.brightness=a.brightness;b.contrast=a.contrast;
b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(n.va()){var b=n.get_active();if(b=n.Ja(b,r.Tt))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.ra=!0}else f.error("No active scene")};a.get_sky_params=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active();
return n.get_sky_params(a)};a.set_sky_params=function(a){if(n.va()){var b=n.get_active();n.set_sky_params(b,a)}else f.error("No active scene")};a.get_dof_params=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active();return n.Ja(a,r.vn)?n.get_dof_params(a):null};a.set_dof_params=function(a){if(n.va()){var b=n.get_active();n.set_dof_params(b,a)}else f.error("No active scene")};a.get_god_rays_params=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active();
return n.Ja(a,r.oi)?n.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(n.va()){var b=n.get_active();n.set_god_rays_params(b,a)}else f.error("No active scene")};a.get_bloom_params=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active();return n.Ja(a,r.tn)?n.get_bloom_params(a):null};a.set_bloom_params=function(a){if(n.va()){var b=n.get_active();n.set_bloom_params(b,a)}else f.error("No active scene")};a.get_glow_material_params=function(){if(!n.va())return f.error("No active scene"),
!1;var a=n.get_active();return n.Ja(a,r.wn)?n.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(n.va()){var b=n.get_active();n.set_glow_material_params(b,a)}else f.error("No active scene")};a.get_wind_params=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active();return n.get_wind_params(a)};a.set_wind_params=function(a){if(n.va()){var b=n.get_active();l.set_wind_params(b,a)}else f.error("No active scene")};a.get_water_surface_level=function(a,b){if(!n.va())return f.error("No active scene"),
0;var d=n.get_active();return d.q.xc?n.get_water_surface_level(d,a,b):(f.error("No water parameters on the active scene"),0)};a.set_water_params=function(a){if(n.va()){var b=n.get_active();n.set_water_params(b,a)}else f.error("No active scene")};a.get_water_mat_params=function(a){if(n.va()){var b=n.get_active();n.get_water_mat_params(b,a)}else f.error("No active scene")};a.update_scene_materials_params=function(){if(n.va()){var a=n.get_active();n.rE(a)}else f.error("No active scene")};a.hide_object=
function(a,b){b=b||!1;!w.is_mesh(a)&&!w.is_empty(a)||w.is_dynamic(a)?b?n.Vn(a,!0):n.Lz(a,!0):f.error("show/hide is only supported for dynamic objects.")};a.show_object=function(a,b){b=b||!1;!w.is_mesh(a)&&!w.is_empty(a)||w.is_dynamic(a)?b?n.Vn(a,!1):n.Lz(a,!1):f.error("show/hide is only supported for dynamic objects.")};a.is_hidden=function(a){if(w.dg(a)||w.is_empty(a)||w.is_lamp(a))return n.is_hidden(a);f.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.is_visible=
function(a){return a.k.is_visible};a.check_object=function(a){f.kb("scenes.check_object","scenes.check_object_by_name");return n.va()?l.GN(a,n.get_active()):(f.error("No active scene"),!1)};a.check_object_by_name=function(a,b){return l.cc(l.au,a,b|0,!0)?!0:!1};a.check_object_by_dupli_name=function(a,b,d){return l.cc(l.$t,a,b,d|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return l.cc(l.yc,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var d=n.get_active();a||(a="ALL");b||0===b||(b=l.DATA_ID_ALL);
return l.kB(d,a,b)};a.get_object_name=function(a){return a?a.Sk:(f.error("Wrong object name"),"")};a.get_object_name_hierarchy=function(a){if(!a)return f.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Sk),a=w.get_dg_parent(a);return b.reverse()};a.get_object_type=function(a){return a&&a.type?a.type:(f.error("Wrong object"),"UNDEFINED")};a.get_object_dg_parent=function(a){f.kb("scenes.get_object_dg_parent","objects.get_dg_parent");return w.get_dg_parent(a)};a.get_object_children=function(a){return a.se.slice(0)};
a.get_first_character=function(){return l.get_first_character(n.get_active())};a.get_shore_dist=function(a,b){b||0===b||(b=1);if(!n.va())return f.error("No active scene"),!1;var d=n.get_active();return n.get_shore_dist(d,a,b)};a.get_cam_water_depth=function(){return n.get_cam_water_depth()};a.get_type_mesh_object=function(a){return w.is_mesh(a)?a.k.type:null};a.get_meta_tags=function(){if(!n.va())return f.error("No active scene"),!1;var a=n.get_active();return n.get_meta_tags(a)};a.append_object=
function(a,b){if(a.k.$r){if(b)var d=n.Mo(),d=v.keysearch("name",b,d);else d=n.get_active();n.append_object(d,a,!0)}else f.error('object "'+a.name+'" has been created not by coping.')};a.remove_object=function(a){(w.is_mesh(a)||w.is_empty(a))&&w.is_dynamic(a)?(l.Ds(a,!1,a.k.as,!1,!1),b.ZN(a),l.Ds(a,!0,!0,!0,!0),l.remove_object(a)):f.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.marker_frame=function(a){var b=n.get_active();if(b.timeline_markers&&a in b.timeline_markers)return n.marker_frame(b,
a);f.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=n.get_active();return(a=n.Ja(a,r.yg))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=n.get_active();(b=n.Ja(b,r.yg))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):f.error("The motion blur subscene doesn't exist.")};a.can_select_objects=function(){var a=n.get_active();
return Boolean(n.Ja(a,r.Le))}};b4w.module.sfx=function(a,q){var e=q("__obj_util"),d=q("__scenes"),b=q("__sfx"),g=q("__print");a.play=function(a,d,e){b.play(a,d||0,e||0)};a.play_def=function(a){b.play_def(a)};a.is_play=function(a){return b.is_playing(a)};a.is_playing=function(a){return b.is_playing(a)};a.stop=function(a){b.stop(a)};a.pause=function(a){b.vP(a)};a.resume=function(a){b.xP(a)};a.loop_stop=function(a,d,e){b.loop_stop(a,d||0,e||!1)};a.playrate=function(a,d){b.playrate(a,d)};a.get_playrate=function(a){return b.get_playrate(a)};
a.cyclic=function(a,d){b.cyclic(a,d)};a.is_cyclic=function(a){return b.is_cyclic(a)};a.listener_reset_speed=function(){b.listener_stride()};a.listener_stride=function(){b.listener_stride()};a.speaker_reset_speed=function(a){b.speaker_stride(a)};a.speaker_stride=function(a){b.speaker_stride(a)};a.get_volume=function(a){return a&&"object"===typeof a?b.get_volume(a):b.$L()};a.set_volume=function(a,d){a&&"object"===typeof a?b.set_volume(a,d):b.WO(d)};a.mute=function(a,d){a&&"object"===typeof a?b.mute(a,
d):b.AN(d)};a.is_muted=function(a){return a&&"object"===typeof a?b.is_muted(a):b.DM()};a.get_speaker_objects=function(){return b.get_speaker_objects().slice(0)};a.check_active_speakers=b.check_active_speakers;a.set_compressor_params=function(a){b.set_compressor_params(d.get_active(),a)};a.get_compressor_params=function(){return b.get_compressor_params(d.get_active())};a.duck=function(a,d,e){a&&"object"===typeof a?b.duck(a,d,e):b.FK(d,e)};a.unduck=function(a){a&&"object"===typeof a?b.unduck(a):b.$P()};
a.apply_playlist=b.apply_playlist;a.clear_playlist=b.clear_playlist;a.detect_audio_container=b.detect_audio_container;a.detect_video_container=b.detect_video_container;a.set_positional_params=b.set_positional_params;a.get_positional_params=b.get_positional_params;a.set_filter_params=b.set_filter_params;a.get_filter_params=b.get_filter_params;a.get_filter_freq_response=b.get_filter_freq_response;a.get_duration=function(a){if(a&&e.is_speaker(a))return b.get_duration(a);g.error('Object "'+(a?a.name:
void 0)+'" is not a valid speaker')}};b4w.module.textures=function(a,q){var e=q("__print"),d=q("__scenes"),b=q("__textures"),g=q("__obj_util"),l=q("__assets");a.play_video=function(a,f){f||(f=0);d.get_active().b4w_use_nla&&b.ky(a,f)?e.error("NLA texture can't be controlled directly through API."):b.play_video(a,f)||e.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,f){f||(f=0);d.get_active().b4w_use_nla&&b.ky(a,f)?e.error("NLA texture can't be controlled directly through API."):b.pause_video(a,f)||e.error('Texture with name "'+
a+'" not found!')};a.reset_video=function(a,f){f||(f=0);d.get_active().b4w_use_nla&&b.ky(a,f)?e.error("NLA texture can't be controlled directly through API."):b.reset_video(a,f)||e.error('Texture with name "'+a+'" not found!')};a.get_canvas_ctx=function(a,d){if(g.is_mesh(a)){var l=b.FL(a,d);if(l)return l;e.error("Couldn't find canvas texture with this name: "+d)}else e.error("Object must be type of mesh.");return null};a.update_canvas_ctx=function(a,d){if(g.is_mesh(a)){if(b.nQ(a,d))return!0;e.error("Couldn't find canvas texture with this name: "+
d)}else e.error("Object must be type of mesh.");return!1};a.change_image=function(a,d,g,q){q=q||function(){};l.enqueue([{id:g,type:l.AT_IMAGE_ELEMENT,url:g,Be:"GET",jj:null,Wh:null,rT:null}],function(g){g?b.change_image(a,d,g)?q(!0):(e.error("Couldn't find texture with this name: "+d),q(!1)):q(!1)},null,null)};a.get_texture_names=function(a){if(g.is_mesh(a))return b.get_texture_names(a);e.error("Object must be type of mesh.")}};b4w.module.time=function(a,q){var e=q("__time");a.set_timeout=e.set_timeout;a.clear_timeout=e.clear_timeout;a.get_timeline=e.get_timeline;a.animate=e.animate;a.clear_animation=e.clear_animation};b4w.module.transform=function(a,q){var e=q("__obj_util"),d=q("__physics"),b=q("__print"),g=q("__quat"),l=q("__transform"),w=q("__tsr"),f=q("__util"),n=w.create(),r=new Float32Array(3),v=new Float32Array(4);a.SPACE_LOCAL=l.SPACE_LOCAL;a.SPACE_WORLD=l.SPACE_WORLD;a.set_translation=function(a,f,g,n){e.is_dynamic(a)?(r[0]=f,r[1]=g,r[2]=n,l.set_translation(a,r),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel=function(a,f,g,n){e.is_dynamic(a)?(r[0]=
f,r[1]=g,r[2]=n,l.set_translation_rel(a,r),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,f){e.is_dynamic(a)?(l.set_translation(a,f),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel_v=function(a,f){e.is_dynamic(a)?(l.set_translation_rel(a,f),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_obj_rel=function(a,g,n,q,v){e.is_dynamic(a)?
(r[0]=g,r[1]=n,r[2]=q,g=w.get_trans_view(v.k.n),v=w.get_quat_view(v.k.n),f.transform_vec3(r,1,v,g,r),l.set_translation(a,r),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));l.get_translation(a,b);return b};a.get_translation_rel=function(a,b){b||(b=new Float32Array(3));l.get_translation_rel(a,b);return b};a.set_rotation=function(a,f,g,n,q){e.is_dynamic(a)?(v[0]=f,v[1]=g,v[2]=n,v[3]=q,l.set_rotation(a,v),l.B(a),
d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel=function(a,f,g,n,q){e.is_dynamic(a)?(v[0]=f,v[1]=g,v[2]=n,v[3]=q,l.set_rotation_rel(a,v),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_v=function(a,f){e.is_dynamic(a)?(l.set_rotation(a,f),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel_v=function(a,f){e.is_dynamic(a)?(l.set_rotation_rel(a,f),l.B(a),
d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_rotation=function(a,b){b||(b=new Float32Array(4));l.get_rotation(a,b);return b};a.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));l.get_rotation_rel(a,b);return b};a.set_rotation_euler=function(a,f,g,n){e.is_dynamic(a)?(r[0]=f,r[1]=g,r[2]=n,l.set_rotation_euler(a,r),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_rotation_euler=function(a,b){b||(b=new Float32Array(3));
l.get_rotation_euler(a,b);return b};a.get_rotation_euler_rel=function(a,b){b||(b=new Float32Array(3));l.get_rotation_euler_rel(a,b);return b};a.set_rotation_euler_rel=function(a,f,g,n){e.is_dynamic(a)?(r[0]=f,r[1]=g,r[2]=n,l.set_rotation_euler_rel(a,r),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,f){e.is_dynamic(a)?(l.set_rotation_euler(a,f),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel_v=
function(a,f){e.is_dynamic(a)?(l.set_rotation_euler_rel(a,f),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,d){e.is_dynamic(a)?(l.set_scale(a,d),l.B(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale_rel=function(a,d){e.is_dynamic(a)?(l.set_scale_rel(a,d),l.B(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_scale=function(a){return l.get_scale(a)};a.get_scale_rel=function(a){return l.get_scale_rel(a)};a.empty_reset_transform=
function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var f=0;f<a.se.length;f++)if(!e.is_dynamic(a.se[f])){b.error('Wrong object: "'+a.se[f].name+'" is not dynamic.');return}l.set_translation(a,[0,0,0]);l.set_rotation(a,[0,0,0,1]);l.set_scale(a,1);l.B(a);d.sync_transform(a)}};a.get_object_size=function(a){return e.is_mesh(a)?l.get_object_size(a):(b.error("Wrong object: "+a.name),0)};a.get_object_center=function(a,d,f){if(!e.is_mesh(a))return b.error("Wrong object: "+a.name),null;
f||(f=new Float32Array(3));return l.get_object_center(a,d,f)};a.move_local=function(a,f,g,n){e.is_dynamic(a)?(l.move_local(a,f,g,n),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_x_local=function(a,m){if(e.is_dynamic(a)){var n=g.setAxisAngle(f.AXIS_X,m,v);l.hx(a,n);l.B(a);d.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_y_local=function(a,m){if(e.is_dynamic(a)){var n=g.setAxisAngle(f.AXIS_MY,m,v);l.hx(a,n);l.B(a);
d.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_z_local=function(a,m){if(e.is_dynamic(a)){var n=g.setAxisAngle(f.AXIS_Z,m,v);l.hx(a,n);l.B(a);d.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return l.get_object_bounding_box(a)};a.set_tsr=function(a,f){e.is_dynamic(a)?(l.set_tsr(a,f),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr_rel=function(a,
f){e.is_dynamic(a)?(l.set_tsr_rel(a,f),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_tsr=function(a,b){b||(b=new Float32Array(8));l.get_tsr(a,b);return b};a.get_tsr_rel=function(a,b){b||(b=new Float32Array(8));l.get_tsr_rel(a,b);return b};a.distance=function(a,b){return l.distance(a,b)};a.set_matrix=function(a,f){e.is_dynamic(a)?(w.from_mat4(f,n),l.set_tsr(a,n),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_matrix_rel=
function(a,f){e.is_dynamic(a)?(w.from_mat4(f,n),l.set_tsr_rel(a,n),l.B(a),d.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_matrix=function(a,b){b||(b=new Float32Array(16));l.get_tsr(a,n);w.to_mat4(n,b);return b};a.get_matrix_rel=function(a,b){b||(b=new Float32Array(16));l.get_tsr_rel(a,n);w.to_mat4(n,b);return b}};b4w.module.tsr=function(a,q){function e(a,b,d,n){n||(n=g.create());e(a,b,d,n);return n}var d=q("__mat4"),b=q("__print"),g=q("__tsr");a.create=g.create;a.from_values=g.from_values;a.copy=g.copy;a.identity=g.identity;a.create_sep=function(a,d,f,g){b.kb("create_sep","set_sep");return e(a,d,f,g)};a.set_sep=g.set_sep;a.set_trans=g.set_trans;a.set_scale=g.set_scale;a.set_transcale=g.set_transcale;a.set_quat=g.set_quat;a.get_trans_view=g.get_trans_view;a.get_scale=g.get_scale;a.get_quat_view=g.get_quat_view;
a.invert=g.invert;a.to_mat4=function(a,b){b||(b=d.create());g.to_mat4(a,b);return b};a.from_mat4=g.from_mat4;a.multiply=g.multiply;a.transform_vec3=g.transform_vec3;a.transform_vec3_inv=g.transform_vec3_inv;a.transform_vectors=g.transform_vectors;a.transform_dir_vectors=g.transform_dir_vectors;a.transform_dir_vec3=g.transform_dir_vec3;a.transform_tangents=g.transform_tangents;a.translate=g.translate;a.interpolate=function(a,b,d,e){e||(e=g.create());g.interpolate(a,b,d,e);return e}};b4w.module.util=function(a,q){var e=q("__compat"),d=q("__obj_util"),b=q("__print"),g=q("__quat"),l=q("__util"),w=q("__vec3"),f=new Float32Array(6);a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.XYX=l.XYX;a.YZY=l.YZY;a.ZXZ=l.ZXZ;a.XZX=l.XZX;a.YXY=l.YXY;a.ZYZ=l.ZYZ;a.XYZ=l.XYZ;a.YZX=l.YZX;a.ZXY=l.ZXY;a.XZY=l.XZY;a.YXZ=l.YXZ;a.ZYX=
l.ZYX;a.f32=function(a){return l.f32(a||0)};a.assert=l.assert;a.keyfind=l.keyfind;a.keysearch=l.keysearch;a.matrix_to_quat=function(a){return l.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));return l.euler_to_quat(a,b)};a.ordered_angles_to_quat=function(a,b,d){d||(d=g.create());return l.ordered_angles_to_quat(a,b,d)};a.quat_to_ordered_angles=function(a,b,d){d||(d=w.create());return l.quat_to_ordered_angles(a,b,d)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));
return l.quat_to_euler(a,b)};a.sign=l.sign;a.clamp=l.clamp;a.quat_to_dir=l.quat_to_dir;a.ground_project_quat=function(a,b){return l.quat_project(a,l.AXIS_MZ,l.AXIS_Z,l.AXIS_Y,b)};a.cam_quat_to_mesh_quat=function(a,b){return l.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,d,e,c,f){return 0!=w.dot(e,c)?(b.error("Wrong in-plane direction"),null):l.quat_project(a,d,e,c,f)};a.hash_code=l.hash_code;a.smooth=l.smooth;a.smooth_v=l.smooth_v;a.is_vector=l.is_vector;a.correct_cam_quat_up=l.correct_cam_quat_up;
a.quat_to_angle_axis=l.quat_to_angle_axis;a.random_from_array=l.random_from_array;a.horizontal_direction=l.horizontal_direction;a.line_plane_intersect=function(a,d,e,c,g){b.kb("util.line_plane_intersect","math.line_plane_intersect");f[0]=e[0];f[1]=e[1];f[2]=e[2];f[3]=c[0];f[4]=c[1];f[5]=c[2];return l.line_plane_intersect(a,d,f,g)};a.is_mesh=function(a){b.kb("util.is_mesh","objects.is_mesh");return d.is_mesh(a)};a.is_armature=function(a){b.kb("util.is_armature","objects.is_armature");return d.is_armature(a)};
a.angle_wrap_0_2pi=l.angle_wrap_0_2pi;a.angle_wrap_periodic=l.angle_wrap_periodic;a.smooth_step=l.smooth_step;a.lerp=l.lerp;a.deg_to_rad=l.deg_to_rad;a.rad_to_deg=l.rad_to_deg;a.dir_to_quat=l.dir_to_quat;a.is_ie11=e.is_ie11;a.gen_tbn_quats=l.gen_tbn_quats};"object"==typeof module&&module.qv&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,q){q("__print");var e=q("__version");a.version=e.version;a.version_str=e.version_str;a.type=e.type;a.date=e.date;a.date_str=e.date_str};"object"==typeof module&&module.qv&&b4w.module.version(exports);b4w.module.objects=function(a,q){var e=q("__geometry"),d=q("__objects"),b=q("__batch"),g=q("__obj_util"),l=q("__print"),w=q("__scenes");a.get_meta_tags=function(a){if(a)return d.get_meta_tags(a)};a.copy=function(a,b,q){return g.is_mesh(a)?g.is_dynamic(a)?e.dm(a)||e.check_shape_keys(a)||!q?-1==d.Gb(w.get_active(),"MESH",d.DATA_ID_ALL).indexOf(a)?(l.error('object "'+a.name+'" does not belong to the active scene.'),!1):d.copy(a,b||"",q):(l.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),
!1):(l.error('object "'+a.name+'" is not dynamic.'),!1):(l.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,d,e){l.kb("set_nodemat_value","material.set_nodemat_value");if(g.dg(a)){var q=d[0],c=b.Oa(a,q,"MAIN");if(null===c)return l.error('Material "'+q+'" was not found in the object "'+a.name+'".'),null;c=b.Pg(c.ff,d);if(null===c)return l.error('Value node "'+d[d.length-1]+'" was not found in the object "'+a.name+'".'),null;b.set_nodemat_value(a,q,c,e)}else l.error('The type of the object "'+
a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_value=function(a,d){l.kb("get_nodemat_value","material.get_nodemat_value");if(!g.dg(a))return l.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var e=d[0],q=b.Oa(a,e,"MAIN");if(null===q)return l.error('Material "'+e+'" was not found in the object "'+a.name+'".'),null;e=b.Pg(q.ff,d);return null===e?(l.error('Value node "'+d[d.length-1]+'" was not found in the object "'+a.name+'".'),null):b.get_nodemat_value(q,
e)};a.set_nodemat_rgb=function(a,d,e,q,c){l.kb("set_nodemat_rgb","material.set_nodemat_rgb");if(g.dg(a)){var m=d[0],p=b.Oa(a,m,"MAIN");null===p?l.error('Material "'+m+'" was not found in the object "'+a.name+'".'):(p=b.Pg(p.ef,d),null===p?l.error('RGB node "'+d[d.length-1]+'" was not found in the object "'+a.name+'".'):b.set_nodemat_rgb(a,m,p,e,q,c))}else l.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_rgb=function(a,d,e){l.kb("get_nodemat_rgb","material.get_nodemat_rgb");
if(!g.dg(a))return l.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var q=d[0],c=b.Oa(a,q,"MAIN");if(null===c)return l.error('Material "'+q+'" was not found in the object "'+a.name+'".'),null;q=b.Pg(c.ef,d);if(null===q)return l.error('RGB node "'+d[d.length-1]+'" was not found in the object "'+a.name+'".'),null;e||(e=new Float32Array(3));return b.get_nodemat_rgb(c,q,e)};a.update_boundings=function(a){g.is_mesh(a)?e.dm(a)||e.check_shape_keys(a)?d.update_boundings(a):
l.error('object "'+a.name+'" has not dynamic geometry.'):l.error('The type of the object "'+a.name+'" is not "MESH".')};a.get_parent=g.get_parent;a.get_dg_parent=g.get_dg_parent;a.is_mesh=g.is_mesh;a.is_armature=g.is_armature;a.is_speaker=g.is_speaker;a.is_camera=g.is_camera;a.is_lamp=g.is_lamp;a.is_empty=g.is_empty;a.is_line=g.is_line;a.is_world=g.is_world;a.get_selectable_objects=function(){return d.get_selectable_objects()};a.get_outlining_objects=function(){return d.get_outlining_objects()};a.is_dynamic=
g.is_dynamic};b4w.module.main=function(a,q){function e(){}function d(){}function b(){}function g(){window.performance||(M.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(M.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});qa.gD(0)}function l(a,b){for(var c=null,d=b?Ea:Ha,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,H)}catch(h){}if(c)break}c&&x.yK(c);return c}function w(a,b,c){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();M.error("WebGL context lost");n()},!1);J.jf(c);var e=J.get_renderer_info();e&&M.log("%cRENDERER INFO:","color: #00a",c.getParameter(e.UNMASKED_VENDOR_WEBGL)+", "+c.getParameter(e.UNMASKED_RENDERER_WEBGL));L.jf(c);t.jf(c);O.jf(c);U.jf(c);A.jf(c);I.jf(c);G.hP(a);I.init(a,b);T.iD(a.width,a.height,1);N.init();d=p();v()}function f(){e=function(){}}function n(){r()||(ua=performance.now()/1E3,N.pause(),aa.pause(),O.pause(),y.pause())}function r(){return ca<ua}function v(){var a=
"HMD"===ma.stereo&&h.qB();a?a.requestAnimationFrame(v):K(v);var b=performance.now()/1E3;pa||(pa=b);var c=b-pa;if(!(c<1/ma.max_fps)){for(var e=qa.get_timeline(),f=0;f<X.length;f++)X[f](e,c);r()||(ca>pa&&(c-=ca-Math.max(ua,pa)),e+=c,qa.gD(e),A.update(),u.update(),G.update(),m(e,c),d(c));pa=b;a&&a.isPresenting&&a.submitFrame()}}function c(a,b,c){if(V)if(V.QP)V.QP(a,b,c);else{c=atob(V.toDataURL(b,c).split(",")[1]);for(var d=new Uint8Array(c.length),e=0;e<c.length;e++)d[e]=c.charCodeAt(e);a(new Blob([d],
{type:b||"image/png"}))}}function m(a,b){if(G.is_primary_loaded()&&(C.reset(),fa.update(b),F.update(a,b),k.update(a,b),N.update(a,b),b&&E.update(b),G.is_primary_loaded()&&(aa.update(a,b),G.is_primary_loaded()&&(h.update(a),B.update(a,b),G.is_primary_loaded()&&(y.update(!1),D.update(a,b),ha.update(),e(b,a),G.is_primary_loaded()))))){T.update(a,b);y.uE();var d=ka.callback;d&&(ka.SB&&URL.revokeObjectURL(ka.uu),c(function(a){ka.uu=URL.createObjectURL(a);d(ka.uu)},ka.format,ka.quality),ka.callback=null,
ka.format="image/png",ka.quality=1)}}function p(){var a=60,c=0,d=ma.LA,e=ma.dL;return function(f){f<1/ma.max_fps||(a=W.smooth(1/f,a,f,d),f=aa.SL(),c=(c+1)%e,0==c&&b(Math.round(a),f))}}var y=q("__anchors"),E=q("__animation"),u=q("__assets"),z=q("__config"),x=q("__compat"),I=q("__container"),B=q("__controls"),G=q("__data"),A=q("__debug"),J=q("__extensions"),t=q("__geometry"),h=q("__input"),C=q("__hud"),k=q("__nla"),F=q("__logic_nodes"),D=q("__objects"),aa=q("__physics"),M=q("__print"),L=q("__renderer"),
T=q("__scenes"),N=q("__sfx"),U=q("__shaders"),O=q("__textures"),qa=q("__time"),fa=q("__transform"),W=q("__util"),R=q("__version"),ha=q("__particles"),H=z.context,ma=z.A,V=null,ia=null,pa=0,ua=0,ca=0,X=[],ka={callback:null,format:"image/png",quality:1,uu:"",SB:!1,nA:!1},Ha=["webgl","experimental-webgl"],Ea=["webgl2","experimental-webgl2"],da=null,K=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
function(a){return window.setTimeout(a,1E3/ma.max_fps)}}();a.init=function(a,b){z.XO();M.dP(ma.console_verbose);var c=R.version_str()+" "+R.type()+" ("+R.date_str()+")";M.log("%cINIT ENGINE","color: #00a",c);M.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;g();V=a;b?(C.init(b),ia=b):(z.A.show_hud_debug_info=!1,z.S.vs=!1);x.JH();x.Hu("Chrome")||x.Hu("Firefox")||(ma.Sb=!1);c=l(a,ma.Sb);!c&&ma.Sb&&(ma.Sb=!1,c=l(a,!1));if(!c)return null;M.log("%cINIT WEBGL "+
(ma.Sb?"2":"1"),"color: #00a");da=c;w(V,ia,c);z.apply_quality();x.dD(c,!0);U.aN();ma.em&&(a.style["touch-action"]="none");M.log("%cSET PRECISION:","color: #00a",ma.precision);return c};a.resize=function(a,b,c){M.kb("main.resize","container.resize");I.resize(a,b,c)};a.set_fps_callback=function(a){b=a};a.clear_fps_callback=function(){b=function(){}};a.set_render_callback=function(a){e=a};a.clear_render_callback=function(){f()};a.global_timeline=function(){M.kb("main.global_timeline","time.get_timeline");
return qa.get_timeline()};a.pause=n;a.resume=function(){r()&&(ca=performance.now()/1E3,N.resume(),aa.resume(),O.play(!0),y.resume())};a.is_paused=r;a.reset=function(){G.unload(0);G.reset();J.reset();L.reset();t.reset();O.rO();U.reset();A.reset();I.reset();G.reset();I.reset();qa.reset();N.reset();ia=V=null;ca=ua=pa=0;b=function(){};d=function(){};e=function(){};X.length=0;da=null};a.canvas_data_url=function(a,b,c,d){ka.nA="undefined"===typeof d?d:!0;ka.SB=ka.nA;ka.callback=a;ka.format=b||ka.format;
ka.quality=c||ka.quality};a.get_canvas_elem=function(){M.kb("main.get_canvas_elem","container.get_canvas");return V};a.detect_mobile=function(){return x.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<X.length;b++)if(X[b]==a)return;X.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<X.length;b++)if(X[b]==a){X.splice(b,1);break}};a.get_renderer_info=function(){var a=J.get_renderer_info();return a?{vendor:da.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:da.getParameter(a.UNMASKED_RENDERER_WEBGL)}:
null}};b4w.module.nla=function(a,q){var e=q("__nla"),d=q("__time"),b=q("__print"),g=q("__util");a.set_frame=function(a){a=g.clamp(a,e.get_frame_start(),e.get_frame_end());e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.set_frame(a,d.get_timeline())};a.get_frame=function(){return e.get_frame(d.get_timeline())};a.stop=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.Bx()};a.play=function(a){e.check_logic_nodes()?b.error("The active scene is using NLA script."):
e.CC(a)};a.is_play=function(){return e.is_play()};a.get_frame_start=function(){return e.get_frame_start()};a.get_frame_end=function(){return e.get_frame_end()};a.check_nla=function(){return e.check_nla()};a.check_nla_scripts=function(){return e.check_logic_nodes()};a.check_logic_nodes=function(){return e.check_logic_nodes()};a.set_range=function(a,d){e.check_logic_nodes()?b.error("The active scene is using NLA script."):(d=parseFloat(d)||e.get_frame_end(),a=parseFloat(a)||e.get_frame_end(),d=g.clamp(d,
e.get_frame_start(),e.get_frame_end()),a=g.clamp(a,e.get_frame_start(),d),e.set_range(a,d))};a.reset_range=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.reset_range()};a.set_cyclic=function(a){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.set_cyclic(a)};a.clear_callback=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.clear_callback()}};b4w.module.app=function(a,q){function e(){var a=C.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=C.is_paused(),C.pause()):a||C.resume()},!1)}function d(){var a=0,b=G.get_container(),c=C.is_paused(),d=!0;C.append_loop_cb(function(){if(0==a%10){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=C.is_paused()),C.pause(),d=!1):c||d||(C.resume(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);
f||(F.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",e.style.left=0,e.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(e);if(!C.init(e,a))return c&&u("Browser could not initialize WebGL",
"For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",d),!1;a&&G.insert_to_container(a,"LAST");return!0}function g(a,b){a?(b&&(document.getElementById(b).style.display="block"),N=document.getElementById(a)):(N=document.createElement("div"),N.innerHTML=0,N.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",G.insert_to_container(N,"JUST_AFTER_CANVAS"))}function l(a,b){var c=
String(a);b&&(c+="/"+String(b));N.innerHTML=c}function w(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function f(a,b,c){var d=Math.max(x.hover_get_distance(a),1),e=aa.get_rotation(a,H);b=M.quat_to_dir(e,b,R);b[2]=0;L.normalize(b,b);L.scale(b,d*c,b);c=aa.get_translation(a,ha);L.add(c,b,c);x.set_translation(a,c)}function n(a,b){var c=x.hover_get_vertical_limits(a,V);if(c.up!=c.down){var d=x.get_camera_angles(a,W)[1],c=(c.down-d)/(c.down-c.up),d=x.hover_get_distance_limits(a,
V),c=Math.max(c,2/d.max);x.hover_rotate(a,0,c*b)}}function r(a,b,c,d){aa.move_local(a,5*b,5*c,5*d)}function v(a,b,c){var d=x.target_get_distance(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));aa.move_local(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function c(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function m(a,b,d,e,f){f?(f=x.target_get_pivot(a,R),a=x.get_translation(a),a=L.dist(f,a)+e,e=0<b?c(b,-d,a,e):c(-b,d/(1-d),a,e)):e-=2*b*d;return e}function p(a,b,c,d,e){function g(a,b,c,d){if(1==
c){x.get_velocities(a,V);var e=I?.003*V.trans:.003*V.rot;c=A.get_sensor_value(a,b,0);A.get_sensor_payload(a,b,0).gesture===A.PL_SINGLE_TOUCH_MOVE?(Na+="X"==d?-c*e:0,lb+="Y"==d?-c*e:0):A.get_sensor_payload(a,b,0).gesture===A.PL_MULTITOUCH_MOVE_PAN&&(a=I?.003*V.rot:7.5E-4*V.trans,Ra+="X"==d?-c*a:0,Wa+="Y"==d?-c*a:0)}}function l(a){x.get_velocities(a,V);mb-=.05*V.zoom}function p(a){x.get_velocities(a,V);Ga-=.002*V.trans}function q(a){x.get_velocities(a,V);mb+=.05*V.zoom}function t(a){x.get_velocities(a,
V);Ga+=.002*V.trans}function u(a,b,c,d){if(1==c){c=A.get_sensor_value(a,b,1);x.get_velocities(a,V);if(I)e=.003*V.trans,f=7.5E-4*V.rot;else var e=.003*V.rot,f=7.5E-4*V.trans;if(1===A.get_sensor_payload(a,b,0).which)Ja+="X"==d?-c*e:0,Ka+="Y"==d?-c*e:0;else if(2===A.get_sensor_payload(a,b,0).which||3===A.get_sensor_payload(a,b,0).which)sb+="X"==d?-c*f:0,Ma+="Y"==d?-c*f:0}}function w(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function F(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function z(a){return a[0]&&(a[1]||
-.1>a[2])}function C(a){return a[0]&&(a[1]||.1<a[2])}function H(a){return a[0]&&(a[1]||a[2]||a[3])}function G(a,b,c){if(1==c)switch(c=A.get_sensor_value(a,b,0),x.get_velocities(a,V),b){case "FORWARD":N?oa[0]=1:I?(b=x.get_camera_angles(a,W)[1],b=Math.abs(b)>=Math.PI/4?M.AXIS_Y:M.AXIS_MZ,f(a,b,.5*V.trans*c)):J?v(a,-V.zoom,c):r(a,0,0,-V.trans*c);break;case "BACKWARD":N?oa[0]=-1:I?(b=x.get_camera_angles(a,W)[1],b=Math.abs(b)>=Math.PI/4?M.AXIS_MY:M.AXIS_Z,f(a,b,.5*V.trans*c)):J?v(a,V.zoom,c):r(a,0,0,V.trans*
c);break;case "UP":I?n(a,30*-V.zoom*c):N||r(a,0,V.trans*c,0);break;case "DOWN":I?n(a,30*V.zoom*c):N||r(a,0,-V.trans*c,0);break;case "LEFT":N?oa[1]=1:I?f(a,M.AXIS_MX,.5*V.trans*c):r(a,-V.trans*c,0,0);break;case "RIGHT":N?oa[1]=-1:I?f(a,M.AXIS_X,.5*V.trans*c):r(a,V.trans*c,0,0);break;case "ROT_LEFT":J?x.target_rotate(a,.75*-V.rot*c,0):x.eye_rotate(a,.75*V.rot*c,0);break;case "ROT_RIGHT":J?x.target_rotate(a,.75*V.rot*c,0):x.eye_rotate(a,.75*-V.rot*c,0);break;case "ROT_UP":J?x.target_rotate(a,0,.75*-V.rot*
c):x.eye_rotate(a,0,.75*V.rot*c);break;case "ROT_DOWN":J?x.target_rotate(a,0,.75*V.rot*c):x.eye_rotate(a,0,.75*-V.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":N&&(oa[0]=0);break;case "LEFT":case "RIGHT":N&&(oa[1]=0)}N&&(k.set_character_move_dir(N,oa[0],oa[1]),a=x.get_camera_angles_char(a,fa),k.set_character_rotation(N,a[0],a[1]))}U=a;O=b;qa=c;var E=D.get_active_camera();y(E);var J=!1,N=null,I=!1;switch(x.get_move_style(E)){case x.MS_TARGET_CONTROLS:J=!a;break;case x.MS_EYE_CONTROLS:N=D.get_first_character();
break;case x.MS_STATIC:return;case x.MS_HOVER_CONTROLS:I=!0}var V=x.get_velocities(E,ma);a=A.create_elapsed_sensor();if(k.has_simulated_physics(E)){var sa=A.create_collision_sensor(E,null,!0);A.create_sensor_manifold(E,"CAMERA_COLLISION",A.CT_POSITIVE,[sa],null,function(a,b){var c=A.get_sensor_payload(a,b,0).coll_dist;if(0>c){var d=A.get_sensor_payload(a,b,0).coll_norm,e=R;L.scale(d,-.25*c,e);c=aa.get_translation(a,ha);L.add(c,e,c);aa.set_translation_v(a,c)}})}if(N){var sa=aa.get_translation(E),S=
aa.get_rotation(E),S=M.cam_quat_to_mesh_quat(S);sa[2]-=.5;k.set_transform(N,sa,S);B.append_stiff_trans(E,N,[0,0,.5]);var oa=new Float32Array(2),wa=!0;k.set_character_move_type(N,k.CM_FLY);A.create_kb_sensor_manifold(E,"TOGGLE_CHAR_MOVE_TYPE",A.CT_SHOT,A.KEY_C,function(){wa=!wa;k.set_character_move_type(N,wa?k.CM_FLY:k.CM_WALK)})}var Da=h.check_enable_gamepad_indices(),sa=Da.length?Da[Da.length-1]:0,La,ba,la,Z,rb,xa;b?La=ba=la=Z=rb=xa=b=sa=A.create_custom_sensor(0):(La=A.create_keyboard_sensor(A.KEY_W),
ba=A.create_keyboard_sensor(A.KEY_S),la=A.create_keyboard_sensor(A.KEY_A),Z=A.create_keyboard_sensor(A.KEY_D),rb=A.create_keyboard_sensor(A.KEY_R),xa=A.create_keyboard_sensor(A.KEY_F),b=A.create_gamepad_btn_sensor(h.GMPD_BUTTON_6,sa),sa=A.create_gamepad_btn_sensor(h.GMPD_BUTTON_7,sa));var Ia=A.create_keyboard_sensor(A.KEY_UP),Qa=A.create_keyboard_sensor(A.KEY_DOWN),ga=A.create_keyboard_sensor(A.KEY_LEFT),Nb=A.create_keyboard_sensor(A.KEY_RIGHT),S=A.create_gamepad_axis_sensor(h.GMPD_AXIS_0,Da),ra=
A.create_gamepad_axis_sensor(h.GMPD_AXIS_1,Da),Q=A.create_gamepad_axis_sensor(h.GMPD_AXIS_2,Da),Da=A.create_gamepad_axis_sensor(h.GMPD_AXIS_3,Da);I||(A.create_sensor_manifold(E,"FORWARD",A.CT_CONTINUOUS,[a,La,ra],z,G),A.create_sensor_manifold(E,"BACKWARD",A.CT_CONTINUOUS,[a,ba,ra],C,G));J?(A.create_sensor_manifold(E,"ROT_UP",A.CT_CONTINUOUS,[a,Ia,rb,Da],w,G),A.create_sensor_manifold(E,"ROT_DOWN",A.CT_CONTINUOUS,[a,Qa,xa,Da],F,G),A.create_sensor_manifold(E,"ROT_LEFT",A.CT_CONTINUOUS,[a,ga,la,Q],w,
G),A.create_sensor_manifold(E,"ROT_RIGHT",A.CT_CONTINUOUS,[a,Nb,Z,Q],F,G)):I?(A.create_sensor_manifold(E,"LEFT",A.CT_CONTINUOUS,[a,ga,la,S],w,G),A.create_sensor_manifold(E,"RIGHT",A.CT_CONTINUOUS,[a,Nb,Z,S],F,G),A.create_sensor_manifold(E,"FORWARD",A.CT_CONTINUOUS,[a,Ia,La,ra],w,G),A.create_sensor_manifold(E,"BACKWARD",A.CT_CONTINUOUS,[a,Qa,ba,ra],F,G),A.create_sensor_manifold(E,"UP",A.CT_CONTINUOUS,[a,xa,Da],C,G),A.create_sensor_manifold(E,"DOWN",A.CT_CONTINUOUS,[a,rb,Da],z,G)):(A.create_sensor_manifold(E,
"UP",A.CT_CONTINUOUS,[a,rb,b],H,G),A.create_sensor_manifold(E,"DOWN",A.CT_CONTINUOUS,[a,xa,sa],H,G),A.create_sensor_manifold(E,"LEFT",A.CT_CONTINUOUS,[a,la,S],z,G),A.create_sensor_manifold(E,"RIGHT",A.CT_CONTINUOUS,[a,Z,S],C,G),A.create_sensor_manifold(E,"ROT_UP",A.CT_CONTINUOUS,[a,Ia,Da],z,G),A.create_sensor_manifold(E,"ROT_DOWN",A.CT_CONTINUOUS,[a,Qa,Da],C,G),A.create_sensor_manifold(E,"ROT_LEFT",A.CT_CONTINUOUS,[a,ga,Q],z,G),A.create_sensor_manifold(E,"ROT_RIGHT",A.CT_CONTINUOUS,[a,Nb,Q],C,G));
if(!c){var Sa=0;c=A.create_mouse_wheel_sensor(d);var Fa=0,Da=A.create_touch_zoom_sensor(d);A.create_sensor_manifold(E,"MOUSE_WHEEL",A.CT_LEVEL,[c],null,function(a,b,c){1==c&&(b=A.get_sensor_value(a,b,0),x.get_velocities(a,V),J||I?Sa=m(a,b,V.zoom,Sa,J):(V.trans*=1+b*V.zoom,x.set_velocities(a,V)))});A.create_sensor_manifold(E,"TOUCH_ZOOM",A.CT_LEVEL,[Da],null,function(a,b,c){1==c&&(c=A.get_sensor_value(a,b,0),x.get_velocities(a,V),A.get_sensor_payload(a,b,0)===A.PL_MULTITOUCH_MOVE_ZOOM&&(Fa=m(a,c,.03*
V.zoom,Fa,J)))});A.create_sensor_manifold(E,"ZOOM_INTERPOL",A.CT_POSITIVE,[a],null,function(a,b){if(J||I)if(1E-5<Math.abs(Sa)||1E-5<Math.abs(Fa)){var c=A.get_sensor_value(a,b,0),d=M.smooth(Sa,0,c,.1*T);Sa-=d;c=M.smooth(Fa,0,c,.15*T);Fa-=c;I?n(a,-(d+c)):(d=x.target_get_distance(a)+d+c,d=Math.max(d,.001),x.target_set_distance(a,d))}else Fa=Sa=0})}var Ja=0,Ka=0,sb=0,Ma=0,Ga=0,mb=0;J?(A.create_sensor_manifold(E,"GMPD_PAN_Y_POS",A.CT_CONTINUOUS,[b],null,q),A.create_sensor_manifold(E,"GMPD_PAN_Y_NEG",A.CT_CONTINUOUS,
[sa],null,l),A.create_sensor_manifold(E,"GMPD_PAN_X_POS",A.CT_CONTINUOUS,[S],function(a){return-.1>a[0]},p),A.create_sensor_manifold(E,"GMPD_PAN_X_NEG",A.CT_CONTINUOUS,[S],function(a){return.1<a[0]},t)):I&&(A.create_sensor_manifold(E,"GMPD_PAN_X_POS",A.CT_CONTINUOUS,[Q],function(a){return-.1>a[0]},p),A.create_sensor_manifold(E,"GMPD_PAN_X_NEG",A.CT_CONTINUOUS,[Q],function(a){return.1<a[0]},t));if(e){e=A.create_mouse_move_sensor("X",window);c=A.create_mouse_move_sensor("Y",window);b=A.create_mouse_click_sensor(d);
var sa=A.create_mouse_click_sensor(window),dc=!1,S=function(a){a[2]?dc=!0:a[0]||(dc=!1);return dc&&a[0]};A.create_sensor_manifold(E,"MOUSE_X",A.CT_POSITIVE,[sa,e,b],S,u,"X");A.create_sensor_manifold(E,"MOUSE_Y",A.CT_POSITIVE,[sa,c,b],S,u,"Y");e=h.get_device_by_type_element(h.DEVICE_MOUSE,window);h.switch_prevent_default(e,!1)}else e=A.create_mouse_move_sensor("X",d),c=A.create_mouse_move_sensor("Y",d),b=A.create_mouse_click_sensor(d),A.create_sensor_manifold(E,"MOUSE_X",A.CT_POSITIVE,[b,e],null,u,
"X"),A.create_sensor_manifold(E,"MOUSE_Y",A.CT_POSITIVE,[b,c],null,u,"Y");var Na=0,lb=0,Ra=0,Wa=0;e=A.create_touch_move_sensor("X",d);d=A.create_touch_move_sensor("Y",d);A.create_sensor_manifold(E,"TOUCH_X",A.CT_POSITIVE,[e],null,g,"X");A.create_sensor_manifold(E,"TOUCH_Y",A.CT_POSITIVE,[d],null,g,"Y");A.create_sensor_manifold(E,"ROT_TRANS_INTERPOL",A.CT_POSITIVE,[a],null,function(a,b){if(1E-5<Math.abs(Ja)||1E-5<Math.abs(Ka)||1E-5<Math.abs(Na)||1E-5<Math.abs(lb)||1E-5<Math.abs(sb)||1E-5<Math.abs(Ma)||
1E-5<Math.abs(Ra)||1E-5<Math.abs(Wa)||1E-5<Math.abs(Ga)||1E-5<Math.abs(mb)){var c=A.get_sensor_value(a,b,0),d=M.smooth(Ja,0,c,.08*T),e=M.smooth(Ka,0,c,.08*T);Ja-=d;Ka-=e;var h=M.smooth(Na,0,c,.12*T),g=M.smooth(lb,0,c,.12*T);Na-=h;lb-=g;var l=M.smooth(sb,0,c,.08*T),m=M.smooth(Ma,0,c,.08*T);sb-=l;Ma-=m;var n=M.smooth(Ra,0,c,.12*T),p=M.smooth(Wa,0,c,.12*T);Ra-=n;Wa-=p;var q=M.smooth(Ga,0,c,.08*T),c=M.smooth(mb,0,c,.08*T);Ga-=q;mb-=c;J?(x.target_rotate(a,d+h,e+g),e=x.target_get_distance(a),x.target_pan_pivot(a,
e*(l+n+q),e*(m+p+c))):I?(d+h&&f(a,M.AXIS_X,.2*(d+h)),e+g&&(m=x.get_camera_angles(a,W)[1],f(a,Math.abs(m)>Math.PI/4?M.AXIS_MY:M.AXIS_Z,.2*(e+g))),x.hover_rotate(a,l+n+q,0)):(x.eye_rotate(a,.5*(d+h),.5*(e+g)),N&&(l=x.get_camera_angles_char(a,fa),k.set_character_rotation(N,l[0],l[1])))}});A.create_kb_sensor_manifold(E,"DEC_STEREO_DIST",A.CT_SHOT,A.KEY_LEFT_SQ_BRACKET,function(a){var b=x.get_stereo_distance(a);x.set_stereo_distance(a,.9*b)});A.create_kb_sensor_manifold(E,"INC_STEREO_DIST",A.CT_SHOT,A.KEY_RIGHT_SQ_BRACKET,
function(a){var b=x.get_stereo_distance(a);x.set_stereo_distance(a,1.1*b)})}function y(a){var b=x.get_move_style(a),c=A.create_callback_sensor(function(){var c=x.get_move_style(a),d=c!=b;b=c;return d});A.create_sensor_manifold(a,"CHANGE_MOVE_STYLE",A.CT_POSITIVE,[c],null,function(){E();p(U,O,qa)})}function E(){var a=D.get_active_camera();A.check_sensor_manifold(a,"TOGGLE_CHAR_MOVE_TYPE")&&D.get_first_character()&&B.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
c=0;c<b.length;c++)A.remove_sensor_manifold(a,b[c])}function u(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),h=document.createElement("div");if(d)for(var k=0;k<d.length;k++){var g=document.getElementById(d[k]);g&&g.parentNode.removeChild(g)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";h.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;h.innerHTML=
b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(h);document.body.appendChild(e)}function z(a,b,c,d,e){function f(){var k=performance.now()-h;e(b+k*(c-b)/d);(k>=d||!a.parentNode)&&C.remove_loop_cb(f)}var h=performance.now();C.append_loop_cb(f)}q("animation");var x=q("camera"),I=q("config"),B=q("constraints"),G=q("container"),A=q("controls"),J=q("data"),t=q("debug"),h=q("input"),C=q("main"),k=q("physics"),F=q("print"),
D=q("scenes"),aa=q("transform"),M=q("util"),L=q("vec3"),T=1,N=null,U=!1,O=!1,qa=!1,fa=new Float32Array(2),W=new Float32Array(2),R=new Float32Array(3),ha=new Float32Array(3);new Float32Array(3);var H=new Float32Array(4),ma={},V={};a.init=function(a){function c(){var a=b(m,M,x,n),f=G.get_canvas();if(a){var u=G.get_container();G.resize_to_container();z&&(g(p,r),C.set_fps_callback(l));w&&(e(),d());q&&C.append_loop_cb(function(){u.style.height=u.clientWidth/q+"px"});k&&C.append_loop_cb(function(){G.resize_to_container()});
H&&C.append_loop_cb(function(){G.force_offsets_updating()});v&&I.reset_limits();B==I.P_AUTO?t.test_performance(function(a,b){0==a?(F.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),I.apply_quality(I.P_HIGH)):1.5>b?(F.log("QUALITY TEST RESULT: LOW ("+b.toFixed(1)+" GB/s)"),I.apply_quality(I.P_LOW)):(F.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),I.apply_quality(I.P_HIGH));h(f,!0)}):h(f,!0)}else h(f,!1)}function f(a){a.keyCode==A.KEY_P&&(C.is_paused()?C.resume():C.pause())}function h(){}
a=a||{};var k=!1,m=null,n=null,p=null,q=0,r=null,u=!0,v=!1,w=!0,x=!0,y=!1,z=!1,D=!1,H=!1,B=I.get("quality"),E;for(E in a)switch(E){case "canvas_container_id":m=a.canvas_container_id;break;case "callback":h=a.callback;break;case "autoresize":k=a.autoresize;break;case "show_hud_debug_info":D=a.show_hud_debug_info;break;case "sfx_mix_mode":y=a.sfx_mix_mode;break;case "show_fps":z=a.show_fps;break;case "track_container_position":H=a.track_container_position;break;case "fps_wrapper_id":r=a.fps_wrapper_id;
break;case "fps_elem_id":p=a.fps_elem_id;break;case "error_purge_elements":n=a.error_purge_elements;break;case "report_init_failure":x=a.report_init_failure;break;case "pause_invisible":w=a.pause_invisible;break;case "key_pause_enabled":u=a.key_pause_enabled;break;case "force_container_ratio":q=a.force_container_ratio;break;case "min_capabilities":v=a.min_capabilities;break;case "quality":B=a.quality;break;default:I.set(E,a[E])}B!=I.P_AUTO&&I.set("quality",B);u&&document.addEventListener("keydown",
f,!1);I.set("show_hud_debug_info",D);I.set("sfx_mix_mode",y);var M=D||y||null;"complete"==document.readyState?window.setTimeout(c,0):window.addEventListener("load",c,!1);window.addEventListener("unload",function(){J.cleanup()},!1)};a.resize_to_container=function(){F.kb("app.resize_to_container","container.resize_to_container");G.resize_to_container()};a.set_onclick=function(a,b){var c=w(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=function(a,b){var c=w(a);c.addEventListener("change",
function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=function(a,b){var c=w(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=p;a.disable_camera_controls=E;a.set_camera_move_style=function(a){F.Mg("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup","camera.hover_setup_rel"]);var b=D.get_active_camera();x.set_move_style(b,a)};a.enable_object_controls=function(a){function b(a){return a[0]&&
(a[1]||a[2])}function c(a,b,e){if(1==e)switch(e=A.get_sensor_value(a,b,0),b){case "FORWARD":d?k.vehicle_throttle(a,1):aa.move_local(a,0,-1*e,0);break;case "BACKWARD":d?k.vehicle_throttle(a,-1):aa.move_local(a,0,1*e,0);break;case "LEFT":d?k.vehicle_steer(a,-1):aa.move_local(a,1*e,0,0);break;case "RIGHT":d?k.vehicle_steer(a,1):aa.move_local(a,-1*e,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&k.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&k.vehicle_steer(a,0)}}var d=k.is_vehicle_chassis(a)||
k.is_vehicle_hull(a),e=A.create_elapsed_sensor(),f=A.create_keyboard_sensor(A.KEY_W),h=A.create_keyboard_sensor(A.KEY_S),g=A.create_keyboard_sensor(A.KEY_A),l=A.create_keyboard_sensor(A.KEY_D),m=A.create_keyboard_sensor(A.KEY_UP),n=A.create_keyboard_sensor(A.KEY_DOWN),p=A.create_keyboard_sensor(A.KEY_LEFT),q=A.create_keyboard_sensor(A.KEY_RIGHT);A.create_sensor_manifold(a,"FORWARD",A.CT_CONTINUOUS,[e,f,m],b,c);A.create_sensor_manifold(a,"BACKWARD",A.CT_CONTINUOUS,[e,h,n],b,c);A.create_sensor_manifold(a,
"LEFT",A.CT_CONTINUOUS,[e,g,p],b,c);A.create_sensor_manifold(a,"RIGHT",A.CT_CONTINUOUS,[e,l,q],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)A.remove_sensor_manifold(a,b[c])};a.enable_controls=function(){F.Ec("app.enable_controls() deprecated")};a.disable_controls=function(){F.Ec("app.disable_controls() deprecated")};a.enable_debug_controls=function(){A.create_kb_sensor_manifold(null,"CAMERA_SHOT",A.CT_SHOT,A.KEY_K,function(){t.make_camera_frustum_shot()});
A.create_kb_sensor_manifold(null,"LIGHT_SHOT",A.CT_SHOT,A.KEY_L,function(){t.make_light_frustum_shot()});A.create_kb_sensor_manifold(null,"TELEMETRY",A.CT_SHOT,A.KEY_T,function(){t.plot_telemetry()})};a.request_fullscreen=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",
d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?
a.requestFullScreen():F.error("B4W App: request fullscreen method is not supported")};a.exit_fullscreen=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof a&&F.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.check_fullscreen=function(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?
!0:!1};a.report_app_error=u;a.get_url_params=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,b,c,d,e,f,h,k){function g(e){a&&(l[b]=f+e+h,c>d&&e<=d||c<d&&e>=d)&&(l[b]=f+d+h,k())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";h=
h||"";k=k||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;z(a,c,d,e,g)}};a.attr_animate=function(a,b,c,d,e,f){function h(e){a&&(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},z(a,c,d,e,h))};a.queue_animate=function(b){if(b.length){var c=b.shift(),d=c.elem,
e=c.prop,f=c.from,h=c.to,k=c.duration,g=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.queue_animate(b)};"css"==c.type?a.css_animate(d,e,f,h,k,g,l,m):"attr"==c.type&&a.attr_animate(d,e,f,h,k,m)}};a.set_camera_smooth_factor=function(a){T=a};a.get_camera_smooth_factor=function(){return T}};b4w.module.camera_anim=function(a,q){function e(a,b,c,e,f){c=r.angle_wrap_0_2pi(b-c);c=Math.min(c,2*Math.PI-c);b=r.angle_wrap_0_2pi(e-b);b=Math.min(b,2*Math.PI-b);if(1E-6>Math.abs(c)||1E-6>2*Math.PI-Math.abs(c))c=0;if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;d.is_eye_camera(a)?(f[0]=b,f[1]=c):(f[0]=c,f[1]=b);return f}var d=q("camera"),b=q("controls"),g=q("print"),l=q("scenes"),w=q("time"),f=q("transform"),n=q("tsr"),r=q("util"),v=q("vec3");q("quat");var c=new Float32Array(2),m=new Float32Array(2),
p=new Float32Array(3),y=new Float32Array(3),E=new Float32Array(3);new Float32Array(4);var u=n.create(),z=n.create(),x=n.create(),I={},B=!1,G=!1,A=!1,J=!1;a.track_to_target=function(a,e,l,k,n,q,u,x){if(d.is_eye_camera(a)){if(r.is_vector(e))var z=e;else z=p,f.get_object_center(e,!1,z);l=l||1;k=k||2;n=n||1;q=q||1;var A=f.get_translation(a,y);e=v.subtract(z,A,E);var z=d.get_camera_angles(a,c),B=d.get_camera_angles_dir(e,m),G=B[0]-z[0],J=B[1]-z[1],I=Math.abs(Math.acos(Math.cos(G)*Math.cos(J))/l),fa=v.length(e)*
(1-1/k),W=function(a){return 6*a*(1-a)},R=w.get_timeline(),ha=0,H=function(){b.remove_sensor_manifold(a,"TRACK_TO_TARGET");u&&u()};l=b.create_timeline_sensor();k=b.create_elapsed_sensor();b.create_sensor_manifold(a,"TRACK_TO_TARGET",b.CT_CONTINUOUS,[l,k],null,function(c,e,h){d.is_eye_camera(c)?1==h&&(h=b.get_sensor_value(c,e,0)-R,e=b.get_sensor_value(c,e,1),h<I?(h=W(h/I),d.eye_rotate(a,h*G*e/I,h*J*e/I)):h<I+n?(0==ha&&(d.eye_rotate(a,B[0],B[1],!0,!0),ha++),h=W(h-I/n),e=h*fa*e/n,f.move_local(c,0,0,
-e)):h<I+n+q?1>=ha&&(d.eye_rotate(a,B[0],B[1],!0,!0),d.eye_set_look_at(a,A),f.move_local(c,0,0,-fa),x&&x(),ha++):h<I+n+q+n?(2>=ha&&(d.eye_rotate(a,B[0],B[1],!0,!0),d.eye_set_look_at(a,A),f.move_local(c,0,0,-fa),ha++),h=W(h-I-n-q/n),e=h*fa*e/n,f.move_local(c,0,0,e)):(d.eye_rotate(a,B[0],B[1],!0,!0),d.eye_set_look_at(a,A),H())):H()})}else g.error("track_to_target(): Wrong camera object or camera move style")};a.auto_rotate=function(a,f,n){function k(f,h,k){if(1==k)if(k=d.get_move_style(f),k==d.MS_STATIC)p();
else if(k!=d.MS_TARGET_CONTROLS&&k!=d.MS_EYE_CONTROLS||!d.has_horizontal_rot_limits(f))u=null,h=b.get_sensor_value(f,h,0),d.rotate_camera(f,h*a,0);else{k=k==d.MS_EYE_CONTROLS?d.eye_get_horizontal_limits(f,I):d.target_get_horizontal_limits(f,I);if(null===u||k.left!=u.left||k.right!=u.right){u=u||{};u.left=k.left;u.right=k.right;v=Math.min(.2,r.angle_wrap_0_2pi(u.right-u.left)/2);k=q;var g=u,l=d.get_camera_angles(k,c)[0];k=e(k,l,g.left,g.right,m);w=a*Math.min(1,k[0]/.2,k[1]/.2)}h=b.get_sensor_value(f,
h,0);k=d.get_camera_angles(f,c)[0];k=e(f,k,u.left,u.right,m);k[1]>v&&k[0]>v?w=r.sign(w)*a:k[1]<v?w-=Math.pow(a,2)/.4*h:k[0]<v&&(w+=Math.pow(a,2)/.4*h);d.rotate_camera(f,h*w,0)}}function p(){b.remove_sensor_manifold(q,"AUTO_ROTATE");b.remove_sensor_manifold(q,"DISABLE_AUTO_ROTATE");f()}f=f||function(){};var q=l.get_active_camera();if(d.is_static_camera(q))g.error("auto_rotate(): Wrong camera move style");else{var u={},v=0,w=0;if(b.check_sensor_manifold(q,"AUTO_ROTATE"))p();else{var x=b.create_mouse_move_sensor("X"),
y=b.create_mouse_move_sensor("Y"),z=b.create_mouse_click_sensor(),A=b.create_touch_move_sensor(),B=b.create_touch_zoom_sensor(),G=b.create_elapsed_sensor();n=n?b.create_mouse_wheel_sensor():b.create_custom_sensor(0);b.create_sensor_manifold(q,"DISABLE_AUTO_ROTATE",b.CT_LEVEL,[x,y,z,A,B,n],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},p);b.create_sensor_manifold(q,"AUTO_ROTATE",b.CT_CONTINUOUS,[G],function(a){return a[0]},k)}}};a.is_auto_rotate=function(){var a=l.get_active_camera();
return b.check_sensor_manifold(a,"AUTO_ROTATE")};a.check_auto_rotate=function(){var a=l.get_active_camera();return d.get_move_style(a)==d.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,b,c,e,l){if(d.get_move_style(a)!=d.MS_STATIC)g.error("move_camera_to_point(): wrong camera type");else if(!B)if(a)if(b){c=c||1;e=e||.01;var m=r.is_vector(a)?a:f.get_tsr(a,u),q=r.is_vector(b)?b:f.get_tsr(b,z);b=v.distance(n.get_trans_view(m),n.get_trans_view(q))/c;c=r.quat_to_dir(n.get_quat_view(m),r.AXIS_MZ,p);
var G=r.quat_to_dir(n.get_quat_view(q),r.AXIS_MZ,y);c=Math.min(Math.abs(v.dot(c,G)),1);e=1E3*Math.max(b,Math.acos(c)/e);B=!0;var E=w.animate(0,1,e,function(b){var c=n.interpolate(m,q,r.smooth_step(b),x);A?(w.clear_animation(E),B=A=!1):(f.set_tsr(a,c),1==b&&(B=!1,l&&l()))})}else g.error("move_camera_to_point(): you must specify the point object");else g.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,b,c,e,f){if(d.get_move_style(a)==d.MS_STATIC)g.error("rotate_camera(): not supported for STATIC cameras");
else if(!G)if(a)if(b||c){G=!0;var l=0,m=0,n=0!=b?b:c,p=w.animate(0,n,e||1E3,function(e){J?(w.clear_animation(p),G=J=!1):(l-=e,m-=e,c&&b?d.rotate_camera(a,l,m):c?d.rotate_camera(a,0,m):b&&d.rotate_camera(a,l,0),m=l=e,e==n&&(G=!1,f&&f()))})}else g.error("rotate_camera(): you must specify the rotation angle");else g.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){A=!0};a.stop_cam_rotating=function(){J=!0};a.is_moving=function(){return B};a.is_rotating=function(){return G}};b4w.module.gp_conf=function(a,q){function e(){k.length=0;for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)a[b]&&k.push(a[b]);return k}function d(a){var b=y.get(a+"_gmpd_stngs","b4w");if(b){var b=JSON.parse(b),c;for(c in b)p.set_gamepad_key(a,c,b[c])}else c=JSON.stringify(u),y.set(a+"_gmpd_stngs",c,"b4w")}function b(a){M=!0;var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),
e=document.createElement("div"),f=document.createElement("div"),h=document.createElement("div"),k=document.createElement("div"),g=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),q=document.createElement("div"),r=document.createElement("div"),t=document.createElement("div"),u=document.createElement("div"),v=document.createElement("div"),w=document.createElement("div"),x=document.createElement("div"),y=document.createElement("div"),B=document.createElement("div"),
C=document.createElement("div"),G=document.createElement("div"),J=document.createElement("div");A=b;b.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+
"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;";c.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+
"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;";d.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;";e.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;";f.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;";h.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;";k.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;";g.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;";l.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;";m.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;";q.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;top: 51px;position: absolute;";r.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;";t.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;";u.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;";v.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;";w.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>')+
"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;";x.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;";y.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;";B.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;";C.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>')+
"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;";G.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;";J.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;";b.appendChild(G);b.appendChild(J);c.appendChild(d);c.appendChild(e);c.appendChild(f);c.appendChild(h);b.appendChild(c);k.appendChild(g);k.appendChild(l);k.appendChild(m);k.appendChild(q);b.appendChild(k);b.appendChild(r);b.appendChild(t);b.appendChild(u);b.appendChild(v);b.appendChild(w);b.appendChild(x);b.appendChild(y);a.appendChild(b);b.appendChild(B);b.appendChild(C);F.length=0;z.length=0;D.length=0;aa.length=0;F.push(m,
l,q,g,w,x,B,y,u,v,r,t,d,f,h,e,C);z.push('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',
'<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>');
D.push(r,r,t,t);aa.push(G,J);for(a=0;a<F.length;a++)F[a].setAttribute("id","pad_btn_"+a),F[a].setAttribute("data-colorstate","B"),F[a].setAttribute("data-key",a),F[a].setAttribute("data-svgid",a);G.setAttribute("id","pad_left_axis");G.setAttribute("data-colorstate","GR");G.setAttribute("data-key",p.GMPD_AXIS_0);G.setAttribute("data-svgid",z.length);J.setAttribute("id","pad_right_axis");J.setAttribute("data-colorstate","GR");J.setAttribute("data-key",p.GMPD_AXIS_2);J.setAttribute("data-svgid",z.length+
1);z.push('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',
'<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>');
n(F,E);n(aa,"#e6e6e6")}function g(a){return[m.create_gamepad_btn_sensor(p.GMPD_BUTTON_0,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_1,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_2,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_3,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_4,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_5,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_6,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_7,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_8,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_9,
a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_10,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_11,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_12,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_13,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_14,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_15,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_16,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_17,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_18,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_19,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_20,
a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_21,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_22,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_23,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_24,a),m.create_gamepad_btn_sensor(p.GMPD_BUTTON_25,a)]}function l(a){return[m.create_gamepad_axis_sensor(p.GMPD_AXIS_0,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_1,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_2,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_3,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_4,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_5,
a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_6,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_7,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_8,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_9,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_10,a),m.create_gamepad_axis_sensor(p.GMPD_AXIS_11,a)]}function w(a,b){var c=document.createElement("input");c.style.cssText="display: inline-block;position = relative;";c.setAttribute("type","radio");c.setAttribute("name","choice");var d=document.createElement("label");d.textContent=
b;d.style.cssText="position = relative;display: inline-block;color: white;";a.appendChild(c);a.appendChild(d);return c}function f(a){G.removeChild(A);A=null;switch(a){case "PAD":h.checked=!0;b(G);break;case "WHEEL":t.checked=!0;var c=G;M=!1;var d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),k=document.createElement("div"),g=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),q=document.createElement("div"),
r=document.createElement("div"),u=document.createElement("div"),v=document.createElement("div"),w=document.createElement("div"),x=document.createElement("div"),y=document.createElement("div"),B=document.createElement("div"),C=document.createElement("div"),J=document.createElement("div"),L=document.createElement("div"),I=document.createElement("div"),K=document.createElement("div"),Ba=document.createElement("div"),za=document.createElement("div"),va=document.createElement("div"),P=document.createElement("div");
a=document.createElement("div");var Y=document.createElement("div"),na=document.createElement("div"),ea=document.createElement("div"),Aa=document.createElement("div"),ja=document.createElement("div");A=d;var ta="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>')+
"');width: 19px;height: 19px;background-size: 100% 100%;";d.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+
"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;";e.style.cssText=ta+"top: 132px;left: 331px;";f.style.cssText=ta+"top: 122px;left: 315px;";k.style.cssText=ta+"top: 122px;left: 347px;";g.style.cssText=ta+"top: 113px;left: 331px;";l.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+
btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;";m.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;";q.style.cssText=ta+"top: 107px;left: 141px;";r.style.cssText=ta+"top: 107px;left: 90px;";u.style.cssText=ta+"top: 185px;left: 321px;";v.style.cssText=ta+"top: 185px;left: 340px;";w.style.cssText=ta+"top: 179px;left: 358px;";x.style.cssText=ta+"top: 178px;left: 303px;";y.style.cssText=ta+"top: 210px;left: 299px;";B.style.cssText=ta+"top: 279px;left: 299px;";C.style.cssText=ta+"top: 210px;left: 321px;";J.style.cssText=ta+
"top: 279px;left: 321px;";L.style.cssText=ta+"top: 210px;left: 344px;";I.style.cssText=ta+"top: 278px;left: 344px;";K.style.cssText=ta+"top: 124px;left: 147px;";Ba.style.cssText=ta+"top: 138px;left: 133px;";za.style.cssText=ta+"top: 124px;left: 82px;";va.style.cssText=ta+"top: 138px;left: 96px;";P.style.cssText=ta+"top: 278px;left: 367px;";ta="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>')+
"');width: 19px;height: 46px;background-size: 100% 100%;";a.style.cssText=ta+"top: 291px;left: 50px;";Y.style.cssText=ta+"top: 291px;left: 111px;";na.style.cssText=ta+"top: 291px;left: 171px;";ea.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>')+
"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;";Aa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>')+
"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;";ja.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>')+
"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;";c.appendChild(d);d.appendChild(a);d.appendChild(Y);d.appendChild(na);d.appendChild(ea);d.appendChild(Aa);d.appendChild(ja);d.appendChild(e);d.appendChild(f);d.appendChild(k);d.appendChild(g);d.appendChild(l);d.appendChild(m);d.appendChild(q);d.appendChild(r);d.appendChild(u);d.appendChild(v);d.appendChild(w);d.appendChild(x);d.appendChild(y);d.appendChild(B);d.appendChild(C);d.appendChild(J);d.appendChild(L);d.appendChild(I);
d.appendChild(K);d.appendChild(Ba);d.appendChild(za);d.appendChild(va);d.appendChild(P);F.length=0;z.length=0;D.length=0;aa.length=0;F.push(e,f,k,g,l,m,q,r,u,v,w,x,y,B,C,J,L,I,K,Ba,za,va,P);z.push('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>');
aa.push(ea,a,na,Y,Aa,ja);for(c=0;c<F.length;c++)F[c].setAttribute("id","wheel_btn_"+c),F[c].setAttribute("data-colorstate","B"),F[c].setAttribute("data-key",c),F[c].setAttribute("data-svgid",c);for(c=0;c<aa.length;c++)F[c].setAttribute("id","wheel_axis_"+c),F[c].setAttribute("data-colorstate","GR");ea.setAttribute("data-key",p.GMPD_AXIS_0);ea.setAttribute("data-svgid",z.length);a.setAttribute("data-key",p.GMPD_AXIS_1);a.setAttribute("data-svgid",z.length+1);na.setAttribute("data-key",p.GMPD_AXIS_2);
na.setAttribute("data-svgid",z.length+2);Y.setAttribute("data-key",p.GMPD_AXIS_3);Y.setAttribute("data-svgid",z.length+3);Aa.setAttribute("data-key",p.GMPD_AXIS_4);Aa.setAttribute("data-svgid",z.length+4);ja.setAttribute("data-key",p.GMPD_AXIS_5);ja.setAttribute("data-svgid",z.length+5);z.push('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>');
n(F,E);n(aa,"#e6e6e6")}}function n(a,b){function c(a){a=a.target;if(!(0>x||"G"==a.dataset.fk))if(0!=B){if("R"==a.dataset.fk&&(I=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",B=0),"B"==a.dataset.fk||"GR"==a.dataset.fk){var d=parseFloat(I.dataset.qt);I.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(z[d])+"')";I.setAttribute("data-colorstate",a.dataset.fk);I=a;d=parseFloat(a.dataset.qt);a.style.backgroundImage="url('data:image/svg+xml;base64,"+
btoa(z[d].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R")}}else{var d=parseFloat(a.dataset.qt),e="B"==a.dataset.fk?1:2;B=e;a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(z[d].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R");document.getElementById("action_label").textContent=1==e?"Now press the button on the device":"Now move the axis on the device";I=a}}for(var d=0;d<a.length;d++)a[d].addEventListener("click",c,!1)}function r(a){var b=document.createElement("label");
b.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;";b.textContent=a;return b}function v(){var a=window.innerWidth,b=window.innerHeight;G.style.zoom=750>=b&&400<b||750>=a&&400<a?"0.5":400>=a||400>=b?"0.3":"1"}var c=q("container"),m=q("controls"),p=q("input"),y=q("storage"),E=/#5276cf/g,u={};u[p.GMPD_BUTTON_12]=p.GMPD_BUTTON_12;u[p.GMPD_BUTTON_13]=
p.GMPD_BUTTON_13;u[p.GMPD_BUTTON_15]=p.GMPD_BUTTON_15;u[p.GMPD_BUTTON_14]=p.GMPD_BUTTON_14;u[p.GMPD_BUTTON_3]=p.GMPD_BUTTON_3;u[p.GMPD_BUTTON_0]=p.GMPD_BUTTON_0;u[p.GMPD_BUTTON_1]=p.GMPD_BUTTON_1;u[p.GMPD_BUTTON_2]=p.GMPD_BUTTON_2;u[p.GMPD_BUTTON_5]=p.GMPD_BUTTON_5;u[p.GMPD_BUTTON_7]=p.GMPD_BUTTON_7;u[p.GMPD_BUTTON_4]=p.GMPD_BUTTON_4;u[p.GMPD_BUTTON_6]=p.GMPD_BUTTON_6;u[p.GMPD_BUTTON_8]=p.GMPD_BUTTON_8;u[p.GMPD_BUTTON_9]=p.GMPD_BUTTON_9;u[p.GMPD_BUTTON_10]=p.GMPD_BUTTON_10;u[p.GMPD_BUTTON_11]=p.GMPD_BUTTON_11;
u[p.GMPD_BUTTON_16]=p.GMPD_BUTTON_16;var z=[],x=-1,I=null,B=0,G=null,A=null,J=null,t=null,h=null,C=null,k=[],F=[],D=[],aa=[],M=!0,L={};L[p.GMPD_AXIS_0]=-2;L[p.GMPD_AXIS_1]=-2;L[p.GMPD_AXIS_2]=-2;L[p.GMPD_AXIS_3]=-2;L[p.GMPD_AXIS_4]=-2;L[p.GMPD_AXIS_5]=-2;L[p.GMPD_AXIS_6]=-2;L[p.GMPD_AXIS_7]=-2;L[p.GMPD_AXIS_8]=-2;L[p.GMPD_AXIS_9]=-2;L[p.GMPD_AXIS_10]=-2;L[p.GMPD_AXIS_11]=-2;a.show=function(){var a=document.createElement("div");G=a;a.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);";
c.insert_to_container(a,"LAST");b(a);var k=document.createElement("div");k.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var n=document.createElement("div");n.innerHTML="Select a device";n.style.cssText="color: #fff;display: inline-block;";k.appendChild(n);for(n=0;4>n;n++){var q=g(n),u=function(){return!0},
A=function(a,b){if(b==x)for(var c=0;c<F.length;c++){var d=F[c],e=m.get_sensor_value(a,b,c),f=c;if(0==B){if(e&&"B"==d.dataset.fk){var h=z[f];d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(h.replace(E,"#00ff00"))+"')";d.setAttribute("data-colorstate","G")}e||"B"==d.dataset.fk||(h=z[f],d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(h)+"')",d.setAttribute("data-colorstate","B"))}else e=p.get_pressed_gmpd_btn(x),0<=e&&I&&1==B&&(d=I.dataset.key,p.set_gamepad_key(x,d,e),f=
y.get(x+"_gmpd_stngs","b4w")||"{}",f=JSON.parse(f),f[d]=e,y.set(x+"_gmpd_stngs",JSON.stringify(f),"b4w"),I=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",B=0)}};m.create_sensor_manifold(null,n,m.CT_CONTINUOUS,q,u,A)}0<e().length&&(x=0);var W=[],n=document.createElement("div");n.style.cssText="margin-top: 20px;";for(q=0;4>q;q++)A=r(q),q==x&&(A.style.backgroundColor="green",J=A),d(q),n.appendChild(A),A.setAttribute("data-device_type",
"PAD"),W.push(A),A.addEventListener("click",function(a){var b=e();a=a.target;for(var c=0;c<b.length;c++)W[c]==a&&(x=c,J=a,d(x),f(a.dataset.oS))},!1);k.appendChild(n);C=document.createElement("label");C.style.cssText="position: relative;display: block;color: white;";k.appendChild(C);n=document.createElement("div");n.style.cssText="margin-top: 20px;";q=w(n,"Pad");A=w(n,"Wheel");q.setAttribute("checked","true");q.onchange=function(){f("PAD");J&&J.setAttribute("data-device_type","PAD")};A.onchange=function(){f("WHEEL");
J&&J.setAttribute("data-device_type","WHEEL")};q.setAttribute("id","test");h=q;t=A;q=document.createElement("label");q.style.cssText+="color: #fff;display: block;";n.appendChild(q);q.textContent="Click on the buttons & arrows to setup your controller";q.setAttribute("id","action_label");k.appendChild(n);a.appendChild(k);a=m.create_elapsed_sensor();m.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",m.CT_CONTINUOUS,[a],u,function(){var a=e(),b=a.length;-1==x&&a.length&&(x=a[0].index,J=W[x]);for(var c=
0;c<W.length;c++)c<b?(W[c].textContent=a[c].index,W[c]==J?(W[c].style.backgroundColor="green",C.textContent="Selected device: "+a[c].index+". Data: "+a[c].id):W[c].style.backgroundColor="blue"):W[c].style.backgroundColor="black";b||(x=-1,C.textContent="")});for(n=0;4>n;n++)q=l(n),u=function(){return!0},A=function(a,b){if(b=="AXES"+x){for(var c=0;c<D.length;c+=2){var d=D[c],e=a,f=b,h=c,k=20*m.get_sensor_value(e,f,h),e=20*m.get_sensor_value(e,f,h+1);d.style.transform="translate3d("+k+"px, "+e+"px, 0px) rotate(0rad)"}if(M)for(c=
0;12>c;c+=2){if(e=a,f=b,d=c,!(d+1>2*aa.length)){k=m.get_sensor_value(e,f,d);e=m.get_sensor_value(e,f,d+1);if(-2<L[d]){var g=k-L[d],l=e-L[d+1],f=aa[Math.floor(d/2)],h=f.dataset.qt;0==B?f.style.backgroundImage=g||l?"url('data:image/svg+xml;base64,"+btoa(z[h].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(z[h])+"')":2==B&&(g=p.get_moved_gmpd_axis(x),0<=g&&(0!=g%2&&g--,B=0,f.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(z[h])+"')",f=parseFloat(I.dataset.key),
p.set_gamepad_key(x,f,g),p.set_gamepad_key(x,f+1,g+1),I=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"))}L[d]=k;L[d+1]=e}}else for(c=0;12>c;c++)d=c,d>=aa.length||(k=m.get_sensor_value(a,b,d),-2<L[d]&&(h=k-L[d],e=aa[d],f=e.dataset.qt,0==B?e.style.backgroundImage=h?"url('data:image/svg+xml;base64,"+btoa(z[f].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(z[f])+"')":2==B&&(h=p.get_moved_gmpd_axis(x),0<=h&&(B=
0,e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(z[f])+"')",p.set_gamepad_key(x,parseFloat(I.dataset.key),h),I=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"))),L[d]=k)}},m.create_sensor_manifold(null,"AXES"+n,m.CT_CONTINUOUS,q,u,A);v();window.addEventListener("resize",v)};a.hide=function(){B=0;x=-1;h=t=I=J=null;D.length=0;F.length=0;aa.length=0;c.get_container().removeChild(G);G=null;m.remove_sensor_manifold(null,
"UPDATE_GAMEPAD_DATA");for(var a=0;4>a;a++)m.remove_sensor_manifold(null,a),m.remove_sensor_manifold(null,"AXES"+a);window.removeEventListener("resize",v)};a.update=function(){for(var a=0;4>a;a++)d(a)}};b4w.module.gyroscope=function(a,q){function e(a){var e=b.create_gyro_angles_sensor(),g=b.create_gyro_quat_sensor(),q=!0;b.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",b.CT_CONTINUOUS,[e,g],null,function(a,e,g){if(0<g)if(d.is_eye_camera(a))e=b.get_sensor_payload(a,e,1),g=f.transformQuat(w.AXIS_MY,e,v),d.set_vertical_axis(a,g),l.set_rotation_v(a,e);else{r=b.get_sensor_payload(a,e,0);q&&(n[0]=r[0],n[1]=r[1],n[2]=r[2],q=!1);g=e=0;0==window.orientation&&(e=r[1]-n[1],g=r[0]-n[0],r[1]>m&&r[1]<c&&(g=0));
if(180==window.orientation){e=r[1]-n[1];0>r[1]&&(e=-e);g=n[0]-r[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;r[1]>-c&&r[1]<-m&&(g=0)}if(-90==window.orientation){e=r[0]-n[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;g=n[1]-r[1];if(r[0]>p||r[0]<y)g=0}if(90==window.orientation){e=n[0]-r[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;g=r[1]-n[1];if(r[0]>p||r[0]<y)g=0}d.rotate_camera(a,g,e);n[0]=r[0];n[1]=r[1];n[2]=r[2]}})}var d=q("camera"),b=q("controls"),g=q("scenes"),l=q("transform"),w=q("util"),f=q("vec3"),n=new Float32Array(3),
r=new Float32Array(3),v=f.create(),c=w.deg_to_rad(110),m=w.deg_to_rad(70),p=w.deg_to_rad(70),y=-w.deg_to_rad(70);a.enable_camera_rotation=function(){var a=g.get_active_camera();e(a)};a.disable_camera_rotation=function(){var a=g.get_active_camera();b.remove_sensor_manifold(a,"CAMERA_ROTATE_GYRO")}};b4w.module.hmd_conf=function(a,q){function e(a){a=a.target.value;var b=A[a],c;for(c in B)if(c in b){var d=document.getElementById(c+"_slider");d&&(d.disabled="custom"!==a,d.value=b[c]);if(d=document.getElementById(c+"_number"))d.disabled="custom"!==a,d.value=b[c]}}function d(){v.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING");g();w();E&&(E=!1,r.get_container().removeChild(u),document.head.removeChild(z),z=x=u=null)}function b(){g(!0);w();for(var a in B){var b=document.getElementById(a+"_slider");
b&&(b.value=B[a]);if(b=document.getElementById(a+"_number"))b.value=B[a]}}function g(a){var b=navigator.userAgent||navigator.vendor||window.opera,c=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,d=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,e=0,f=0,g=0;a:{var l=t;if(1==l.format&&l.devices&&l.devices.length)for(var n=0;n<l.devices.length;n++){var q=l.devices[n];if(q.rules&&("ios"==q.type&&G||"android"==q.type)){for(var r=!1,u=0;u<q.rules.length;u++){var v=
q.rules[u],w=c,x=d;if(v.ua&&0<=b.indexOf(v.ua)||!v.ua&&v.res&&v.res[0]&&v.res[1]&&Math.min(w,x)==Math.min(v.res[0],v.res[1])&&Math.max(w,x)==Math.max(v.res[0],v.res[1])){r=!0;break}}if(r){b=n;break a}}}else m.error("DPDB isn't correct.");b=-1}-1!=b&&(g=t.devices[b],f=g.dpi[1]||g.dpi,e=Math.round(25.4*c/(g.dpi[0]||g.dpi)),f=Math.round(25.4*d/f),g=Math.round(g.bw));c=p.get("hmd_conf","b4w");c=JSON.parse(c?c:"{}");a?(B.first_distortion=.34,B.second_distortion=.55,B.bevel_size=g||4,B.screen_width=e||
110,B.screen_height=f||65,B.screen_lense=50,B.ipd=64,B.baseline=32):(B.first_distortion="first_distortion"in c?parseFloat(c.first_distortion):.34,B.second_distortion="second_distortion"in c?parseFloat(c.second_distortion):.55,B.bevel_size="bevel_size"in c?parseFloat(c.bevel_size):g||4,B.screen_width="screen_width"in c?parseFloat(c.screen_width):e||110,B.screen_height="screen_height"in c?parseFloat(c.screen_height):f||65,B.screen_lense="screen_lense"in c?parseFloat(c.screen_lense):50,B.ipd="ipd"in
c?parseFloat(c.ipd):64,B.baseline="baseline"in c?parseFloat(c.baseline):32);I=!0}function l(){p.set("hmd_conf",JSON.stringify(B),"b4w");d()}function w(){if(I){var a=c.get_device_by_type_element(c.DEVICE_HMD);a&&(c.set_config(a,c.HMD_DISTORTION,[B.first_distortion,B.second_distortion]),c.get_value_param(a,c.HMD_WEBVR_TYPE)!=c.HMD_WEBVR_DESKTOP&&(c.set_config(a,c.HMD_BEVEL_SIZE,.001*B.bevel_size),c.set_config(a,c.HMD_SCREEN_WIDTH,.001*B.screen_width),c.set_config(a,c.HMD_SCREEN_HEIGHT,.001*B.screen_height),
c.set_config(a,c.HMD_SCREEN_LENSE_DIST,.001*B.screen_lense),c.set_config(a,c.HMD_EYE_DISTANCE,.001*B.ipd),c.set_config(a,c.HMD_BASELINE_DIST,.001*B.baseline)));I=!1}}function f(a){var b=a.target.id.split("_"),b=b.splice(0,b.length-1).join("_");b in B&&B[b]!=a.target.value&&(I=!0,B[b]=a.target.value,document.getElementById(b+"_slider").value=a.target.value,document.getElementById(b+"_number").value=a.target.value)}function n(a,b){var c=document.createElement("button");c.onclick=a;c.style.cssText="display: inline-block;";
c.innerHTML=b;return c}var r=q("container"),v=q("controls"),c=q("input"),m=q("print"),p=q("storage"),y=q("util"),E=!1,u=null,z=null,x=null,I=!0,B={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},G=/iPad|iPhone|iPod/.test(navigator.platform),A={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",type:1,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,
second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},J=[{label:"Tray to lens-center distance.",km:!0,J:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",km:!0,J:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",km:!0,J:[{id:"screen_lense",max:"100",step:"1"}]},
{label:"Screen height.",km:!0,J:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",km:!0,J:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",km:!0,J:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",J:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];a.check=function(){return c.can_use_device(c.DEVICE_HMD)};a.show=function(a){z=document.createElement("style");z.innerHTML="html{-webkit-tap-highlight-color:rgba(0,0,0,0);}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{width:100%;height:8.4px;cursor:pointer;box-shadow:0 0 10px 0 rgba(50,50,50,1);background:#000;border-radius:1.3px;border:.2px solid #010101}input[type=range]::-webkit-slider-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer;-webkit-appearance:none;margin-top:-14px}input[type=range]:focus::-webkit-slider-runnable-track{background:#000}input[type=range]::-moz-range-track{width:100%;height:8.4px;cursor:pointer;box-shadow:0 0 10px 0 rgba(50,50,50,1);background:#000;border-radius:1.3px;border:.2px solid #010101}input[type=range]::-moz-range-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer}input[type=range]::-ms-track{width:100%;height:8.4px;cursor:pointer;background:0 0;border-color:transparent;color:transparent}input[type=range]::-ms-fill-lower{background:#000;border:.2px solid #010101;border-radius:2.6px;box-shadow:0 0 10px 0 rgba(50,50,50,1)}input[type=range]::-ms-fill-upper{background:#000;border:.2px solid #010101;border-radius:2.6px;box-shadow:0 0 10px 0 rgba(50,50,50,1)}input[type=range]::-ms-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer}.text_label,.value_label{display:inline-block;text-decoration:none;height:30px;line-height:28px;position:relative;text-align:center;font-family:Arial;font-size:15px}input[type=range]:focus::-ms-fill-lower{background:#000}input[type=range]:focus::-ms-fill-upper{background:#000}.text_label{float:left;color:#fff;width:auto;padding:0 10px;background-color:#000;border:3px solid #fff;border-radius:15px;box-shadow:0 0 10px 0 rgba(50,50,50,1);margin-right:15px}.input_text,.value_label{border:3px solid #fff;background-color:#000;color:#fff;box-shadow:0 0 10px 0 rgba(50,50,50,1)}.value_label{right:0;width:40px;border-radius:15px;margin-left:15px}.slider{position:relative;cursor:pointer}.border{position:relative;width:100%;height:50px}.input_slider,.input_text{margin:13.8px 0;-webkit-appearance:none;width:50%;position:relative;display:inline-block}.input_text{border-radius:4px;padding-left:4px}.input_slider,_:-moz-tree-row(hover){-webkit-appearance:none;width:50%;margin:-4.8px 0;position:relative;display:inline-block}:root .input_slider,_:-ms-fullscreen{-webkit-appearance:none;width:50%;margin:-2.8px 0;position:relative;display:inline-block}button,select{display:block}button{background-color:#000;color:#fff;width:100px;border:3px solid #fff;text-align:center;font-family:Arial;border-radius:15px;box-shadow:0 0 10px 0 rgba(50,50,50,1);font-size:15px;line-height:30px;margin-right:10px}select{clear:both}";
document.head.appendChild(z);var m=c.get_device_by_type_element(c.DEVICE_HMD);if(!E&&m){E=!0;g();var k=r.get_container(),q=c.get_device_by_type_element(c.DEVICE_MOUSE,k);c.switch_prevent_default(q,!1);q=c.get_device_by_type_element(c.DEVICE_TOUCH,k);c.switch_prevent_default(q,!1);u=document.createElement("div");u.aS=a;k.appendChild(u);x=document.createElement("div");u.appendChild(x);x.style.cssText="position: absolute;background-color: #fff;left: 10px;top: 10px;right: 10px;bottom: 10px;bottom: 10px;min-width: 300px;overflow: auto;padding: 10px;border: 1px solid #ddd;border-radius: 4px;bottom: 10px;";
a=p.get("hmd_conf","b4w");a=JSON.parse(a?a:"{}").profile||"custom";k=document.createElement("div");q=document.createElement("label");q.innerHTML="Profile: ";q.className="text_label";k.appendChild(q);q=document.createElement("select");k.appendChild(q);k.style.cssText="margin: 20px 0;padding: 10px;";var t=c.get_device_by_type_element(c.DEVICE_HMD);if(t)for(var G in A)if(0==A[G].type||c.get_value_param(t,c.HMD_WEBVR_TYPE)==c.HMD_WEBVR_DESKTOP^1==A[G].type){var M=document.createElement("option");M.value=
G;M.text=A[G].name;q.appendChild(M)}q.value=a;y.is_ie11()?q.onchange=e:q.oninput=e;x.appendChild(k);for(G=0;G<J.length;G++)if(c.get_value_param(m,c.HMD_WEBVR_TYPE)!=c.HMD_WEBVR_DESKTOP||!J[G].km){a=J[G];k=document.createElement("div");q=document.createElement("label");q.className="text_label";q.textContent=a.label;k.appendChild(q);k.style.cssText="margin: 20px 0;float: left;display: inline-block;width: 50%;border: 1px solid #ddd;box-sizing: border-box;-webkit-box-sizing: border-box;padding: 10px;";
for(q=0;q<a.J.length;q++){t=a.J[q];M=document.createElement("div");M.style.cssText+="clear: both; margin-bottom: 10px;";var L=document.createElement("input");L.className="input_slider";L.setAttribute("id",t.id+"_slider");L.setAttribute("type","range");L.setAttribute("min","0.00");L.setAttribute("step",t.step);L.setAttribute("value",B[t.id]);L.setAttribute("max",t.max);L.style.cssText="float: left;";M.appendChild(L);var I=document.createElement("input");I.className="input_text";I.setAttribute("id",
t.id+"_number");I.setAttribute("type","number");I.setAttribute("min","0.00");I.setAttribute("step",t.step);I.setAttribute("value",B[t.id]);I.setAttribute("max",t.max);M.appendChild(I);y.is_ie11()?(L.onchange=f,I.onchange=f):(L.oninput=f,I.oninput=f);k.appendChild(M)}x.appendChild(k)}m=document.createElement("div");G=n(l,"SAVE");a=n(d,"CANCEL");k=n(b,"RESET");m.style.clear="both";m.appendChild(G);m.appendChild(a);m.appendChild(k);x.appendChild(m);m=v.create_timeline_sensor();v.create_sensor_manifold(null,
"UPDATE_HMD_RENDERING",v.CT_CONTINUOUS,[m],null,w)}};a.hide=d;a.reset=b;a.update=function(){g();w()};var t={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,
443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},
{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,
401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,
255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",
rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},
{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],
dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],
dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,
136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],
dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},
{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,
328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3}]}};b4w.module.hmd=function(a,q){function e(a,e){if(e){var h=w.get_active_camera();if(h){d.is_eye_camera(h)||(m=d.is_target_camera(h),p=d.is_hover_camera(h),y=d.is_static_camera(h),d.eye_setup(h));var h=b.create_elapsed_sensor(),q=!1;b.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",b.CT_CONTINUOUS,[h,e],null,function(e,h,m){if(0<m&&(m=w.get_active_camera())&&(!q&&g.enable_split_screen(m)&&(v=f.get_rotation(m,v),q=!0),q&&d.is_eye_camera(m)&&(e=b.get_sensor_payload(e,h,1))))if(1==a){e=l.multiply(A,e,G);
var p=r.transformQuat(n.AXIS_MY,e,E);d.set_vertical_axis(m,p);f.set_rotation_v(m,e)}else if(2==a||3==a){h=f.get_rotation(m,I);h=l.invert(h,I);var t=l.multiply(v,h,I);h=d.get_vertical_axis(m,E);Math.abs(h[2])<Math.PI/4?p=r.cross(h,n.AXIS_MY,u):Math.abs(h[1])<Math.PI/4&&(p=r.cross(h,n.AXIS_Z,u));r.normalize(p,p);var t=r.transformQuat(p,t,z),y=r.dot(h,t),t=r.scaleAndAdd(t,h,-y,z);r.normalize(t,t);h=r.cross(h,p,E);p=Math.acos(n.clamp(r.dot(p,t),0,1));h=n.sign(r.dot(t,h));c+=p*h;p=l.setAxisAngle(n.AXIS_Z,
-c,I);3!=a&&(h=n.quat_project(e,n.AXIS_MZ,n.AXIS_Z,n.AXIS_Y,B),h=l.invert(h,B),e=l.multiply(h,e,B));e=l.multiply(p,e,x);p=r.transformQuat(n.AXIS_MY,e,E);d.set_vertical_axis(m,p);f.set_rotation_v(m,e);l.copy(e,v)}})}}}var d=q("camera"),b=q("controls"),g=q("input"),l=q("quat"),w=q("scenes"),f=q("transform"),n=q("util"),r=q("vec3"),v=l.create(),c=0,m=!1,p=!1,y=!1,E=r.create(),u=r.create(),z=r.create(),x=l.create(),I=l.create(),B=l.create(),G=l.create(),A=l.create();a.HMD_NONE_MOUSE_ALL_AXES=0;a.HMD_ALL_AXES_MOUSE_NONE=
1;a.HMD_ROLL_PITCH_MOUSE_YAW=2;a.HMD_ALL_AXES_MOUSE_YAW=3;a.enable_hmd=function(a){var c=null;if(c=g.get_device_by_type_element(g.DEVICE_HMD))c=g.get_value_param(c,g.HMD_WEBVR_TYPE)==g.HMD_WEBVR_DESKTOP||g.get_value_param(c,g.HMD_WEBVR_TYPE)==g.HMD_WEBVR1?b.create_hmd_quat_sensor():b.create_gyro_quat_sensor(),e(a,c)};a.check_browser_support=function(){return Boolean(g.can_use_device(g.DEVICE_HMD))};a.get_hmd_device=function(){return null};a.reset=function(){g.reset_device(g.DEVICE_HMD)};a.disable_hmd=
function(){b.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA");g.disable_split_screen();var a=w.get_active_camera();m?d.target_setup(a):p?d.hover_setup(a):y&&d.static_setup(a);d.set_vertical_axis(a,n.AXIS_Z);var c=f.get_rotation(a,x);f.set_rotation_v(a,c)};a.set_rotate_quat=function(a){l.copy(a,A)};a.get_rotate_quat=function(a){l.copy(A,a);return a}};b4w.module.fps=function(a,q){function e(a,b,c){var d=I.get_active_camera();u.eye_rotate(d,b,c);a&&(b=u.get_camera_angles_char(d,fa),x.set_character_rotation(a,b[0],b[1]))}function d(a,b,c,d){if(.01<Math.abs(M[0])||.01<Math.abs(M[1]))c=z.get_sensor_value(a,b,0),b=B.smooth(M[0],0,c,.2*L),c=B.smooth(M[1],0,c,.2*L),M[0]-=b,M[1]-=c,d(a,-b*T,-c*T)}function b(a){var b=document.createElement("div");b.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
b.setAttribute("id","B4W_DEFAULT_BTN_1");var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
c.setAttribute("id","B4W_DEFAULT_BTN_2");a.appendChild(b);a.appendChild(c)}function g(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function l(a,b){if(g(a)&&!G.detect_mobile()){var c=z.create_plock_mouse_sensor(a),f=O?O:z.create_plock_sensor(a);O=f;z.create_sensor_manifold(b,"FPS_PLOCK",z.CT_CONTINUOUS,[c,f],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=z.get_sensor_payload(a,b,0),e(a,-b.coords[0]*T,-b.coords[1]*T))});z.create_sensor_manifold(null,
"FPS_ACTIVATE_PLOCK",z.CT_TRIGGER,[f],function(a){return a[0]},function(b,c,d){0<d?qa.mv&&qa.mv(a):qa.iv&&qa.iv(a)})}else{if(G.detect_mobile())var c=z.create_touch_move_sensor("XY",a),f=z.create_touch_click_sensor(a),h=4;else{var c=z.create_mouse_move_sensor("XY",a),f=z.create_mouse_click_sensor(a),h=2,k=I.get_active_camera(),l=z.create_elapsed_sensor(),m=z.create_gamepad_axis_sensor(J.GMPD_AXIS_2),n=z.create_gamepad_axis_sensor(J.GMPD_AXIS_3);z.create_sensor_manifold(b,"FPS_CAM_ROT",z.CT_CONTINUOUS,
[l,m,n],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var d=z.get_sensor_value(a,b,0);c=z.get_sensor_value(a,b,1);var e=z.get_sensor_value(a,b,2);b=2.5*d;e=.05>Math.abs(e)?0:e;d=u.get_camera_angles(k,fa);e=d[1]-e*b;c=-(.05>Math.abs(c)?0:c)*b;e=B.clamp(e,D,aa);u.eye_rotate(k,c,e,!1,!0);x.set_character_rotation(a,d[0]+c+Math.PI,0)}})}var p=0,q=0;z.create_sensor_manifold(null,"FPS_DRAG_PRESS",z.CT_SHOT,[f],function(a){return a[0]},function(a,b,c){1==c&&(a=z.get_sensor_payload(a,
b,0).coords,p=a[0],q=a[1])});z.create_sensor_manifold(null,"FPS_DRAG_MOVE",z.CT_CONTINUOUS,[c,f],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=z.get_sensor_payload(a,b,0).coords,M[0]+=(a[0]-p)*h,M[1]+=(a[1]-q)*h,p=a[0],q=a[1])});c=z.create_elapsed_sensor();z.create_sensor_manifold(b,"FPS_SMOOTH_DRAG",z.CT_CONTINUOUS,[c],null,d,e)}}function w(a){k.enable_hmd(k.HMD_ALL_AXES_MOUSE_NONE);a.addEventListener("mousedown",function(){J.request_fullscreen_hmd()},!1)}function f(a){var b=z.create_elapsed_sensor(),
c=I.get_active_camera();z.create_sensor_manifold(a,"FPS_CHARECTER_VR_ROT",z.CT_CONTINUOUS,[b],null,function(a){var b=u.get_camera_angles_char(c,fa)[0];x.set_character_rotation(a,b,0)})}function n(){var a=k.check_browser_support()&&!G.detect_mobile(),b=J.get_device_by_type_element(J.DEVICE_HMD);b&&(a=a&&J.get_value_param(b,J.HMD_WEBVR_TYPE)==J.HMD_WEBVR1);return a}function r(a,c,d){function e(a){a=0<a?1:a;l=-(0>a?-1:a);a=m+n;var b=k+l;x.set_character_move_dir(c,a,b);d&&d(a,b);h(a,b)}function f(a){a=
0<a?1:a;n=-(0>a?-1:a);a=m+n;var b=k+l;x.set_character_move_dir(c,a,b);d&&d(a,b);h(a,b)}function h(a,b){var c=g.Ml.id;a||b?0==c&&p(g,1):p(g,0)}G.detect_mobile()&&b(a.parentElement?a.parentElement:a);var g=y(c),k=0,l=0,m=0,n=0;a=[z.KEY_W,J.GMPD_BUTTON_12];var q=[z.KEY_S,J.GMPD_BUTTON_13];G.detect_mobile()&&(a.push("B4W_DEFAULT_BTN_1"),q.push("B4W_DEFAULT_BTN_2"));E(1,a,function(a){m=a;a=m+n;var b=k+l;x.set_character_move_dir(c,a,b);d&&d(a,b);h(a,b)});E(1,q,f);E(1,[z.KEY_D,J.GMPD_BUTTON_15],e);E(1,[z.KEY_A,
J.GMPD_BUTTON_14],function(a){k=a;a=m+n;var b=k+l;x.set_character_move_dir(c,a,b);d&&d(a,b);h(a,b)});E(1,[z.KEY_SPACE],function(a){0<a&&x.character_jump(c)});E(3,[J.GMPD_AXIS_0],e);E(3,[J.GMPD_AXIS_1],f);E(1,[z.KEY_SHIFT],function(a){m+n+k+l?0<a?p(g,2):p(g,1):p(g,0)});E(1,[z.KEY_C],function(a){0<a&&(1==U.Ml.id?p(g,3):p(g,1))})}function v(a,b,c,d){a.L.push({id:b,mu:c,Gz:d,Fz:null,Du:null})}function c(a){for(var b=[],c=0;c<a.L;c++){var d=a.L[c].id;if(0<=b.indexOf(d))return;b.push(d)}for(c=0;c<a.L;c++)for(var d=
a.L[c],e=0;e<d.mu.length;e++)if(0>b.indexOf(d.mu[e]))return}function m(a,b){for(var c=null,d=0;d<a.L.length;d++)if(a.L[d].id==b){c=a.L[d];break}return c}function p(a,b){if(!a.bN){var c=a.Ml,d=c.id;if(0<=c.mu.indexOf(b)){var e=!0;c.Fz&&(e=c.Fz(d,b));e&&(a.Ml=m(a,b),c.Gz&&c.Gz(d,b),c.Du&&c.Du(d,b))}}}function y(a){function b(c,d){switch(d){case 0:case 1:x.set_character_move_type(a,x.CM_WALK);break;case 2:x.set_character_move_type(a,x.CM_RUN);break;case 3:x.set_character_move_type(a,x.CM_FLY);break;
case 4:x.set_character_move_type(a,x.CM_CLIMB)}}var d=U={L:[],Ml:null,bN:!1};v(d,0,[1,3,4],b);v(d,1,[2,3,4,0],b);v(d,2,[1,3,4,0],b);v(d,3,[1],b);v(d,4,[1,2,0],b);c(d);d.Ml=m(d,0);return U}function E(a,b,c){function d(){}function e(){return!1}for(var f=[],h=0;h<b.length;h++)if("number"==typeof b[h])300>b[h]?f.push(z.create_keyboard_sensor(b[h])):326>b[h]?f.push(z.create_gamepad_btn_sensor(b[h])):f.push(z.create_gamepad_axis_sensor(b[h]));else if("string"==typeof b[h]){var g=document.getElementById(b[h]);
g?f.push(z.create_touch_click_sensor(g)):F.error("Couldn't find element with "+b[h]+" ID.")}b=z.CT_SHOT;switch(a){case 1:b=z.CT_TRIGGER;e=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};d=function(a,b,d){0<d?c(1):c(0)};break;case 2:b=z.CT_TRIGGER;e=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};d=function(a,b,d){0>d?c(1):c(0)};break;case 3:b=z.CT_CONTINUOUS,e=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},d=function(a,b,d,e){if(0<
d)for(d=0;d<e;d++){var f=z.get_sensor_value(a,b,d);if(.05<Math.abs(f)){c(f);break}}else c(0)}}z.create_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+N.toString(),b,f,e,d,f.length);N++}var u=q("camera"),z=q("controls"),x=q("physics"),I=q("scenes"),B=q("util"),G=q("main"),A=q("container"),J=q("input"),t=q("transform"),h=q("constraints"),C=q("vec3"),k=q("hmd"),F=q("__print"),D=(-Math.PI+.1)/2,aa=(Math.PI-.1)/2,M=new Float32Array(2),L=1,T=4E-4,N=0,U=null,O=null,qa={mv:null,iv:null},fa=new Float32Array(2),
W=new Float32Array(3),R=new Float32Array(3);new Float32Array(3);a.CS_STAY=0;a.CS_WALK=1;a.CS_RUN=2;a.CS_FLY=3;a.CS_CLIMB=4;a.AT_PRESSED=1;a.AT_RELEASED=2;a.AT_CONTINUOUS=3;a.bind_action=E;a.enable_fps_controls=function(a,b,c){a=a||I.get_first_character();b=b||A.get_canvas();if(a){c=c||null;var d=a,e=I.get_active_camera(),g=t.get_translation(e,W),k=t.get_translation(d,R);C.subtract(g,k,g);h.append_stiff_trans(e,d,g);e=u.get_camera_angles_char(e,fa);x.set_character_rotation(d,e[0],e[1]);d=b;e=a;n()?
(w(d),f(e)):l(d,e);r(b,a,c)}};a.disable_fps_controls=function(a,b){a=a||I.get_first_character();b=b||A.get_container();if(a){for(var c=0;c<N;c++)z.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+c.toString());c=a;g(b)&&!G.detect_mobile()&&(z.remove_sensor_manifold(c,"FPS_PLOCK"),z.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!g(b)||G.detect_mobile())z.remove_sensor_manifold(c,"FPS_CAM_ROT"),z.remove_sensor_manifold(c,"FPS_DRAG_PRESS"),z.remove_sensor_manifold(c,"FPS_DRAG_MOVE"),
z.remove_sensor_manifold(c,"FPS_SMOOTH_DRAG");c=a;n()&&z.remove_sensor_manifold(c,"FPS_CHARECTER_VR_ROT");c=b;if(G.detect_mobile()){var d=document.getElementById("B4W_DEFAULT_BTN_1"),e=document.getElementById("B4W_DEFAULT_BTN_2");d&&c.removeChild(d);e&&c.removeChild(e)}}};a.set_character_state_changing_cb=function(a,b){m(U,a).Du=b};a.set_cam_smooth_factor=function(a){z.set_plock_smooth_factor(a);L=a};a.set_cam_sensitivity=function(a){T=a/2E5};a.set_plock_enable_cb=function(a){qa.mv=a};a.set_plock_disable_cb=
function(a){qa.iv=a};a.get_character_state=function(){return U.Ml.id}};b4w.module.mixer=function(a,q){function e(){z=u.length=0;x=d();I=new Float32Array(x.length);B=new Float32Array(x.length);var a=p.get_speaker_objects();if(a.length){u.push(b());for(var c=0;c<a.length;c++)u.push(l(a[c]));u.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function d(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function b(){var a=g("MASTER"),b=p.get_compressor_params();b&&(a.U.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.U.push(["KNEE",b.knee,0,40,40,!1]),a.U.push(["RATIO",b.ratio,1,20,20,!1]),a.U.push(["ATTACK",b.attack,0,1,1E3,!1]),a.U.push(["RELEASE",b.release,0,1,1E3,!1]));a.U.push(["VOLUME",p.get_volume(null),0,1,50,!1]);a.mute=p.is_muted(null)?1:0;a.If=-1;return a}function g(a){return{id:a,U:[],Oj:0,mute:-1,If:-1,Nb:null}}function l(a){var b=g(m.get_object_name(a));b.mute=p.is_muted(a)?
1:0;b.If=0;b.Nb=a;return b}function w(a){if(a.Nb){a.U.length=0;var b=p.get_positional_params(a.Nb);b&&(a.U.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.U.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.U.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=p.get_filter_params(a.Nb))a.U.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.U.push(["EQ_Q",b.Q,0,10,100,!1]),a.U.push(["EQ_GAIN",b.gain,-70,30,100,!1]);a.U.push(["VOLUME",p.get_volume(a.Nb),0,1,50,!1]);y.clamp(a.Oj,0,a.U.length-1)}}function f(a){for(var b=
0;b<u.length;b++){var c=u[b];if(c!=a&&1==c.If)return!0}return!1}function n(a){for(var b=0;b<u.length;b++){var c=u[b];c!=a&&0==c.mute&&0==c.If&&p.mute(c.Nb,!1)}}function r(){if(0==u.length)return[0,-1];var a=8*Math.floor(z/8),b=a+7,a=y.clamp(a,0,u.length-1),b=y.clamp(b,0,u.length-1);return[a,b]}var v=q("controls"),c=q("hud"),m=q("scenes"),p=q("sfx"),y=q("__util"),E="SWITCH_STRIP SWITCH_STRIP_HOLD SWITCH_PARAM INC_DEC INC_DEC_HOLD MUTE_SOLO".split(" "),u=[],z=0,x=null,I=null,B=null;a.enable_mixer_controls=
function(){function a(b,c,d){if(1==d){var e=Boolean(v.get_sensor_value(b,c,0))?-1:1,f=u[z];if(f)switch(d=f.U[f.Oj],d[1]=d[5]?d[1]*Math.pow(d[3]/d[2],e/d[4]):d[1]+(d[3]-d[2])/d[4]*e,d[1]=y.clamp(d[1],d[2],d[3]),d[0]){case "VOLUME":"MASTER"!=f.id?p.set_volume(f.Nb,d[1]):p.set_volume(null,d[1]);break;case "DIST_REF":e=p.get_positional_params(f.Nb);e.dist_ref=d[1];p.set_positional_params(f.Nb,e);break;case "ATTENUATION":e=p.get_positional_params(f.Nb);e.attenuation=d[1];p.set_positional_params(f.Nb,e);
break;case "DIST_MAX":e=p.get_positional_params(f.Nb);e.dist_max=d[1];p.set_positional_params(f.Nb,e);break;case "EQ_FREQ":e=p.get_filter_params(f.Nb);e.freq=d[1];p.set_filter_params(f.Nb,e);break;case "EQ_Q":e=p.get_filter_params(f.Nb);e.Q=d[1];p.set_filter_params(f.Nb,e);break;case "EQ_GAIN":e=p.get_filter_params(f.Nb);e.gain=d[1];p.set_filter_params(f.Nb,e);break;case "THRESHOLD":f=p.get_compressor_params();f.threshold=d[1];p.set_compressor_params(f);break;case "KNEE":f=p.get_compressor_params();
f.knee=d[1];p.set_compressor_params(f);break;case "RATIO":f=p.get_compressor_params();f.ratio=d[1];p.set_compressor_params(f);break;case "ATTACK":f=p.get_compressor_params();f.attack=d[1];p.set_compressor_params(f);break;case "RELEASE":f=p.get_compressor_params();f.release=d[1];p.set_compressor_params(f);break;default:y.r("Unknown strip param")}"INC_DEC"==c?v.reset_timer_sensor(b,c,2,.35):v.reset_timer_sensor(b,c,2,.05)}else v.reset_timer_sensor(b,c,2,10)}function b(a,c,d){if(1==d){d=Boolean(v.get_sensor_value(a,
c,0))?-1:1;if(u.length){1==d&&z<u.length-1?z++:-1==d&&0<z&&z--;d=r();for(var e=d[0];e<=d[1];e++)w(u[e])}"SWITCH_STRIP"==c?v.reset_timer_sensor(a,c,2,.15+.3):v.reset_timer_sensor(a,c,2,.15)}else v.reset_timer_sensor(a,c,2,10)}e();var d=v.create_keyboard_sensor(v.KEY_NUM4),g=v.create_keyboard_sensor(v.KEY_NUM6),h=v.create_keyboard_sensor(v.KEY_NUM8),l=v.create_keyboard_sensor(v.KEY_NUM2),k=v.create_keyboard_sensor(v.KEY_ADD),m=v.create_keyboard_sensor(v.KEY_SUB),q=v.create_keyboard_sensor(v.KEY_NUM7),
E=v.create_keyboard_sensor(v.KEY_NUM9),M=v.create_timer_sensor(.15,!0),L=v.create_timer_sensor(.05,!0),d=[d,g,M];v.create_sensor_manifold(null,"SWITCH_STRIP",v.CT_TRIGGER,d,function(a){return a[0]||a[1]},b);v.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",v.CT_SHOT,d,function(a){return(a[0]||a[1])&&a[2]},b);v.create_sensor_manifold(null,"SWITCH_PARAM",v.CT_SHOT,[h,l],function(a){return a[0]||a[1]},function(a,b){var c=Boolean(v.get_sensor_value(a,b,0))?-1:1,d=u[z];d&&(1==c&&d.Oj<d.U.length-1?d.Oj++:
-1==c&&0<d.Oj&&d.Oj--)});h=[m,k,L];v.create_sensor_manifold(null,"INC_DEC",v.CT_TRIGGER,h,function(a){return a[0]||a[1]},a);v.create_sensor_manifold(null,"INC_DEC_HOLD",v.CT_SHOT,h,function(a){return(a[0]||a[1])&&a[2]},a);v.create_sensor_manifold(null,"MUTE_SOLO",v.CT_SHOT,[q,E],function(a){return a[0]||a[1]},function(a,b){if(Boolean(v.get_sensor_value(a,b,0))){var c=u[z];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,p.mute(c.Nb,!0),1==c.If&&(c.If=0,f(c)||n(c))):(c.mute=0,f(c)||p.mute(c.Nb,!1)):
0==c.mute?(c.mute=1,p.mute(null,!0)):(c.mute=0,p.mute(null,!1)))}else if((c=u[z])&&0<=c.If)if(0==c.If){c.If=1;p.mute(c.Nb,!1);1==c.mute&&(c.mute=0);for(var d=0;d<u.length;d++){var e=u[d];e!=c&&0==e.mute&&0==e.If&&p.mute(e.Nb,!0)}}else c.If=0,f(c)?p.mute(c.Nb,!0):n(c)});q=v.create_elapsed_sensor();v.create_sensor_manifold(null,"MIXER_DRAW",v.CT_CONTINUOUS,[q],null,function(){if(u[z])for(var a=r(),b=a[0];b<=a[1];b++){var d=u[b];c.draw_mixer_strip(d.id,b==z,b%8,d.U,d.Oj,d.mute,d.If);if(d.Nb&&p.get_filter_params(d.Nb)){p.get_filter_freq_response(d.Nb,
x,I,B);for(d=0;d<I.length;d++)I[d]=20*Math.log(I[d])/Math.LN10;c.plot_array("EQ",b%8,I,20,2E4,-10,10)}}});q=v.create_timer_sensor(1,!0);v.create_sensor_manifold(null,"MIXER_UPDATE",v.CT_TRIGGER,[q],null,function(){for(var a=r(),b=a[0];b<=a[1];b++)w(u[b])})};a.disable_mixer_controls=function(){for(var a=0;E.length;a++)v.remove_sensor_manifold(null,E[a])}};b4w.module.npc_ai=function(a,q){function e(a,b){var c=b.destination,d=b.qu,e=x;m.get_translation(b.collider,e);var g=0,l=e[2];c[2]=l;switch(b.type){case t:if(b.random&&b.lj){c[0]=(12*Math.random()-6)*b.speed+d[0];c[1]=-(12*Math.random()-6)*b.speed+d[1];var n=A,d=I,q=b.speed,u=b.rot_speed;m.get_rotation(b.collider,n);p.transformQuat(E.AXIS_MY,n,d);d[2]=0;p.normalize(d,d);n=.5*q/Math.sin(u/2);e=p.dist(c,e);e<2*n&&p.scaleAndAdd(c,d,2*n-e,c);b.lj=!1}b.Mv&&(g=b.Mv-l,e=b.speed*a,g>e?g=e:g<-e&&(g=-e));b.li=
g;break;case h:case C:b.mn?g=b.mn:b.li&&(g=b.li,b.type==C&&(g*=a)),b.random&&b.lj&&(b.type==C?(b.speed=Math.random()+.1,e=b.qN-b.wN):e=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=10*Math.random()-5+d[1],c[2]=l-(Math.random()*e-.5*e),b.lj=!1)}g&&(c[2]=l+g);var c=z,e=x,n=I,g=J,u=b.rig,d=b.collider,l=b.destination,v=b.speed,y=b.actions,W=f.get_current_anim_name(u);if(!f.is_play(u)||!y.So||-1==y.So.indexOf(W)){m.get_translation(d,c);var q=l[0]-c[0],R=l[1]-c[1],q=Math.sqrt(q*q+R*R);if(q>
2*v*a)b.state=20,E.horizontal_direction(l,c,n),y=b.rig,f.is_animated(y)&&(u=b.speed,v=f.get_frame(y),y=f.get_anim_length(y),u*=y/24*(1-v/y),.9>q/u&&p.scaleAndAdd(l,n,u-q,l)),q=A,u=B,m.get_rotation(b.collider,q),p.transformQuat(E.AXIS_MY,q,e),u[0]=e[0],u[1]=e[1],u[2]=0,p.normalize(u,u),v=p.dot(u,n),y=a/(Math.abs(Math.acos(v))/Math.PI)*b.rot_speed*b.ix,r.rotationTo(u,n,g),r.rotationTo(E.AXIS_MY,u,q),1<=Math.abs(v)?r.copy(q,g):(r.multiply(g,q,g),r.slerp(q,g,Math.min(y,1),g)),n=a,b.type!=h&&(n=Math.max(n,
1/60),q=G,u=A,r.setAxisAngle(E.AXIS_X,-Math.asin(-e[2]),u),r.setAxisAngle(E.AXIS_X,-Math.atan(b.li/(b.speed*n)),q),r.slerp(u,q,n,q),r.multiply(g,q,g)),m.set_rotation_v(d,g),e=I,d=B,E.quat_to_dir(g,E.AXIS_MY,e),p.scale(e,b.speed*a,d),p.add(d,c,d),d[2]=b.type!=t?(l[2]-c[2])*a*.1+c[2]:l[2],m.set_translation_v(b.collider,d);else if(b.type==t)y.move?W&&-1!=y.move.indexOf(W)&&f.is_play(u)?b.state=20:(b.state=10,b.lj=!0):(b.state=10,b.lj=!0);else if(b.type==C||b.type==h)b.lj=!0;if(w(b)&&(c=b.rig,!f.is_play(c))){g=
null;switch(b.state){case 10:g=b.actions;g=g.So?E.random_from_array(g.So):null;break;case 20:g=f.get_current_anim_name(b.rig),e=l=b.actions,e.Qh&&-1==e.Qh.indexOf(g)&&e.move&&-1!=e.move.indexOf(g)&&.33<Math.random()?(l=b.actions,g=l.Qh[l.move.indexOf(g)]):(e=b.actions,e.move&&(-1!=e.move.indexOf(g)||!e.Qh&&!e.Yi||!e.Yi&&!g||e.Qh&&-1!=e.Qh.indexOf(g)||e.Yi&&-1!=e.Yi.indexOf(g))?(l=b.actions,l.Qh?(e=l.Qh.indexOf(g),-1!=e?(g=e+1,g=g<l.move.length?g:0,g=l.move[g]):g=-1!=l.move.indexOf(g)?g:E.random_from_array(l.move)):
g=E.random_from_array(l.move)):(e=b.actions,g=e.Yi&&-1==e.Yi.indexOf(g)&&e.move&&-1==e.move.indexOf(g)?E.random_from_array(l.Yi):null))}g&&(f.apply(c,g),f.set_behavior(c,f.AB_FINISH_RESET),f.set_frame(c,0),f.play(c))}}}function d(a,b,c,d){if(d)if(1==c)switch(d.type){case h:a:{for(var e=0;3>e;e++)if(c=n.get_sensor_payload(a,b,e).hit_fract){b=c;break a}b=void 0}e=100*b;d.li=e<d.min_height?10:e>d.max_height?-10:0;break;case t:a=n.get_sensor_payload(a,b,0);d.Mv=a.hit_pos[2];break;case C:a=n.get_sensor_payload(a,
b,0),"CLOSE_GROUND"==b?(d.li=100*a.hit_fract-1,d.li=.1>d.li?.05:0):"CLOSE_WATER"==b&&(d.mn=100*e,d.mn=d.mn<d.wN?-.02:d.mn>d.qN?.02:0)}else d.li=0}function b(){for(var a=0;a<u.length;a++){var b=u[a];g(b);l(b);f.get_current_anim_name(b.rig)&&f.play(b.rig)}}function g(a){var b=p.create(),c=a.collider;switch(a.type){case h:var e=n.create_ray_sensor(c,b,[0,0,-100],"TERRAIN",!0,!0),f=n.create_ray_sensor(c,b,[0,0,-100],"STONE",!0,!0),b=n.create_ray_sensor(c,b,[0,0,-100],"WATER",!0,!0),e=[e,f,b];n.create_sensor_manifold(c,
"CLOSE_GROUND",n.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},d,a);break;case t:e=n.create_ray_sensor(c,[0,0,1],[0,0,-99],"TERRAIN",!0,!0);e=[e];n.create_sensor_manifold(c,"CLOSE_GROUND",n.CT_CONTINUOUS,e,null,d,a);break;case C:e=n.create_ray_sensor(c,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),b=n.create_ray_sensor(c,b,[0,0,100],"WATER",!0,!0),e=[e],n.create_sensor_manifold(c,"CLOSE_WATER",n.CT_CONTINUOUS,[b],null,d,a),n.create_sensor_manifold(c,"CLOSE_GROUND",n.CT_CONTINUOUS,e,null,d,a)}}function l(a){function b(c,
d,e){1==e?(p.copy(a.qu,a.destination),a.ix=4):a.ix=1}var c=a.collider;if(a.type==t){var d=n.create_collision_sensor(c,"CONSTRUCTION",!1);n.create_sensor_manifold(c,"CONSTRUCTION_COLL",n.CT_CONTINUOUS,[d],null,b)}}function w(a){var b=a.rig;if(!f.is_play(b))return!0;b=f.get_current_anim_name(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.So)return!1;if(-1==c.So.indexOf(b))break;break;case 20:if(!c.move||-1!=c.move.indexOf(b)||c.Yi&&-1!=c.Yi.indexOf(b)||c.Qh&&-1!=c.Qh.indexOf(b))return!1;
break;default:return!1}return!0}var f=q("animation"),n=q("controls"),r=q("quat"),v=q("scenes"),c=q("time"),m=q("transform"),p=q("vec3"),y=q("print"),E=q("util"),u=[];new Float32Array(9);var z=new Float32Array(3),x=new Float32Array(3),I=new Float32Array(3),B=new Float32Array(3),G=new Float32Array(4),A=new Float32Array(4),J=new Float32Array(4),t=a.NT_WALKING=10,h=a.NT_FLYING=20,C=a.NT_SWIMMING=30;a.new_event_track=function(a){var b={obj:null,rig:null,collider:null,empty:null,type:t,state:10,actions:{},
qu:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],vr:[],delay:[],random:!0,lj:!0,Mv:0,li:0,mn:0,ix:1,speed:1,rot_speed:.1,max_height:0,min_height:0};if("object"!=typeof a.obj)y.error("Can't create event track. Wrong object.");else if("object"!=typeof a.rig)y.error("Can't create event track. Wrong rig object");else if("object"!=typeof a.collider)y.error("Can't create event track. Wrong collider object");else{b.obj=a.obj;b.collider=a.collider;b.rig=a.rig;m.get_translation(a.collider,
b.qu);"object"==typeof a.actions&&(b.actions=a.actions);"boolean"==typeof a.random&&(b.random=a.random);"number"==typeof a.type&&(b.type=a.type);"number"==typeof a.speed&&(b.speed=a.speed);"number"==typeof a.rot_speed&&(b.rot_speed=a.rot_speed);"number"==typeof a.max_height&&(b.max_height=a.max_height);"number"==typeof a.min_height&&(b.min_height=a.min_height);if(!b.random){for(var c=0;c<a.path.length;c++)b.start[c]=-1,b.ended[c]=!1,b.vr[c]=!1;b.path=a.path;b.delay=a.delay}a=a.actions;var c=f.get_current_anim_name(b.rig),
d;for(d in a)for(var e=a[d],h=0;h<e.length;h++)f.apply(b.rig,e[h]);c&&f.apply(b.rig,c);u.push(b)}};a.enable_animation=function(){if(u.length){b();var a=n.create_elapsed_sensor();n.create_sensor_manifold(u[0].collider,"ELAPSED",n.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,b,d){if(1==d)for(a=n.get_sensor_value(a,b,0),b=0;b<u.length;b++){d=u[b];var f=a;if(v.is_visible(d.obj))if(d.random)e(f,d);else{for(var h=c.get_timeline(),g=0;g<d.path.length;g++)if(!d.ended[g]){d.vr[g]||(d.vr[g]=!0,d.destination[0]=
d.path[g][0],d.destination[1]=d.path[g][1],d.destination[2]=d.path[g][2],d.start[g]=h+d.delay[g]);if(h<d.start[g])break;e(f,d);d.ended[g]=d.lj;break}a:{for(f=0;f<d.path.length;f++)if(0==d.ended[f]){f=!1;break a}f=!0}if(f)for(f=0;f<d.path.length;f++)d.vr[f]=!1,d.ended[f]=!1}}})}};a.disable_animation=function(){if(!(0>=u.length))for(var a=0;a<u.length;a++){var b=u[a];n.check_sensor_manifolds(b.collider)&&n.remove_sensor_manifold(b.collider);f.is_play(b.rig)&&f.stop(b.rig)}}};b4w.module.mouse=function(a,q){function e(){1==t&&(t=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);c.remove_sensor_manifold(y.get_active_camera(),"SMOOTH_PL")}function d(a){2==t&&(t=0);a.removeEventListener("mousedown",g,!1);a.removeEventListener("mouseup",l,!1);a.removeEventListener("mousemove",b,!1);c.remove_sensor_manifold(y.get_active_camera(),"SMOOTH_DRAG")}function b(a){A()&&(B[0]+=2*(a.clientX-x),B[1]+=
2*(a.clientY-I),x=a.clientX,I=a.clientY);a.preventDefault()}function g(a){x=a.clientX;I=a.clientY;a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function l(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function w(a,b,d,e){if(.01<Math.abs(B[0])||.01<Math.abs(B[1]))b=c.get_sensor_value(a,b,0),a=E.smooth(B[0],0,b,.1*z),b=E.smooth(B[1],0,b,.1*z),B[0]-=a,B[1]-=b,e(4E-4*-a,4E-4*-b)}function f(a,b){var c=y.get_first_character(),d=y.get_active_camera();
r.eye_rotate(d,a,b);c&&(d=r.get_camera_angles_char(d,G),m.set_character_rotation(c,d[0],d[1]))}function n(a){a=v.client_to_canvas_coords(a.clientX,a.clientY,G);(a=y.pick_object(a[0],a[1]))?(y.outlining_is_enabled(a)&&y.set_outline_intensity(a,1),y.outlining_is_enabled(J)&&a!=J&&y.set_outline_intensity(J,0)):y.outlining_is_enabled(J)&&y.set_outline_intensity(J,0);J=a}var r=q("camera"),v=q("container"),c=q("controls"),m=q("physics"),p=q("print"),y=q("scenes"),E=q("util"),u=q("main"),z=1,x=0,I=0,B=new Float32Array(2),
G=new Float32Array(2),A=null,J=null,t=0;a.request_pointerlock=function(a,b,e,g,l,m){function n(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){d(a);a.addEventListener("mousemove",g,!1);var f=y.get_active_camera();if(!c.check_sensor_manifold(f,"SMOOTH_PL")){var l=c.create_elapsed_sensor();c.create_sensor_manifold(f,"SMOOTH_PL",c.CT_CONTINUOUS,[l],null,w,m)}b()}else a.removeEventListener("mousemove",g,!1),t=0,document.removeEventListener("pointerlockchange",
n,!1),document.removeEventListener("webkitpointerlockchange",n,!1),document.removeEventListener("mozpointerlockchange",n,!1),e()}if(1!=t){t=1;b=b||function(){};e=e||function(){};m=m||f;l=l||function(){return!0};g=g||function(a){if(l()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;B[0]+=b;B[1]+=a}};document.addEventListener("pointerlockchange",
n,!1);document.addEventListener("webkitpointerlockchange",n,!1);document.addEventListener("mozpointerlockchange",n,!1);var q=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof q?q.apply(a):p.error("Pointer lock is not available")}};a.exit_pointerlock=e;a.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b,d){2!=t&&(t=2,e(),A=b||function(){return!0},
d=d||f,a.addEventListener("mousedown",g,!1),a.addEventListener("mouseup",l,!1),a=y.get_active_camera(),c.check_sensor_manifold(a,"SMOOTH_DRAG")||(b=c.create_elapsed_sensor(),c.create_sensor_manifold(a,"SMOOTH_DRAG",c.CT_CONTINUOUS,[b],null,w,d)))};a.exit_mouse_drag=d;a.enable_mouse_hover_outline=function(){u.detect_mobile()||v.get_canvas().addEventListener("mousemove",n)};a.disable_mouse_hover_outline=function(){u.detect_mobile()||(v.get_canvas().removeEventListener("mousemove",n),J&&y.set_outline_intensity(J,
0))};a.get_coords_x=function(a,b){var c=b?a.targetTouches:a.touches;return"clientX"in a?a.clientX:c&&"clientX"in c[0]?c[0].clientX:-1};a.get_coords_y=function(a,b){var c=b?a.targetTouches:a.touches;return"clientY"in a?a.clientY:c&&"clientY"in c[0]?c[0].clientY:-1};a.set_plock_smooth_factor=function(a){z=a};a.get_plock_smooth_factor=function(){return z}};b4w.module.preloader=function(a,q){var e=q("container"),d,b,g,l,w,f,n,r,v=null;a.create_preloader=function(a){var f="#000",n="#5276cf",q="#fff",r="#fff",u;for(u in a)switch(u){case "container_color":f=a.container_color;break;case "bar_color":n=a.bar_color;break;case "frame_color":q=a.frame_color;break;case "font_color":r=a.font_color}a=document.createElement("div");u=a.cloneNode();var v=a.cloneNode(),w=a.cloneNode(),I=e.get_container();v.appendChild(u);v.appendChild(w);a.appendChild(v);I.appendChild(a);
a.style.cssText="background-color: "+f+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";v.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+q+";";u.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+n+";height: 100%;";w.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+
r+";";d=u;b=w;g=a;l="DEFAULT"};a.create_simple_preloader=function(a){var e=null,f=null,n="#bf9221",q="#000",r;for(r in a)switch(r){case "canvas_container_id":e=a.canvas_container_id;break;case "background_container_id":f=a.background_container_id;break;case "bg_color":q=a.bg_color;break;case "bar_color":n=a.bar_color}a=document.createElement("div");r=document.createElement("div");a.id="simple_preloader_container";var z=document.createElement("div"),x=document.createElement("div"),f=document.getElementById(f);
v=document.getElementById(e);a.style.cssText="z-index: 4;background-color: "+q+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";r.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";z.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+n+";border-radius: 0px;";x.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
r.appendChild(z);r.appendChild(x);a.appendChild(r);document.body.appendChild(a);l="SIMPLE";g=a;d=z;b=x;w=f};a.create_rotation_preloader=function(a){var d=null,e=null,n="rgba(0,0,0,0)",q="",r="",z="rgba(0,0,0,0)",x;for(x in a)switch(x){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "frame_bg_color":n=a.frame_bg_color;break;case "bg_color":z=a.bg_color;break;case "frame_class":q=a.frame_class;break;case "anim_elem_class":r=
a.anim_elem_class}a=document.createElement("div");x=document.createElement("div");var I=document.createElement("div"),B=document.createElement("div"),e=document.getElementById(e);v=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+z+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";x.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+n+";";I.style.cssText=
"position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";B.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";I.className=r;x.appendChild(I);x.className=q;x.appendChild(B);a.appendChild(x);v.appendChild(a);l="ROTATION";g=a;f=I;b=B;w=e};a.create_advanced_preloader=function(a){var e=a.preloader_width,e=e/(e-a.img_width),f=
document.getElementById(a.preloader_bar_id),q=document.getElementById(a.fill_band_id),E=document.getElementById(a.preloader_caption_id),u=document.getElementById(a.preloader_container_id),z=document.getElementById(a.background_container_id);v=document.getElementById(a.canvas_container_id);l="ADVANCED";d=f;n=q;r=e;b=E;g=u;w=z};a.update_preloader=function(a){b.innerHTML=a+"%";"SIMPLE"==l?d.style.width=a+"%":"ADVANCED"==l?(d.style.width=a/r+"%",n.style.width=100-a+"%"):"ROTATION"==l?f.style.transform=
"rotate("+a+"deg)":"DEFAULT"==l&&(d.style.width=a+"%");100==a&&(g.parentNode.removeChild(g),w&&w.parentNode.removeChild(w))}};b4w.module.storage=function(a,q){function e(a){return g[a?a:b]?JSON.parse(g[a?a:b]):{}}var d=q("__print"),b="b4w",g=null;a.init=function(a){a?"b4w"!==a?b=a:d.error("b4w prefix denied"):d.warn("Prefix should be a string. Last declared storage prefix will be used.")};a.set=function(a,d,l){var q=e(l);q[a]=String(d);g[l?l:b]=JSON.stringify(q)};a.cleanup=function(a){delete g[a?a:b]};a.get=function(a,b){var d=e(b);return d[a]?d[a]:""};a.debug=function(a){d.log(e(a?a:b))};try{g=window.localStorage;try{g.tmp=
null,delete g.tmp}catch(l){d.warn("localStorage quota is limited. Disabling localStorage"),g=null}}catch(w){d.warn("Applying chrome localStorage bug workaround"),g=null}g||(d.warn("localStorage is not available, initializing temporary storage"),g={})};b4w.module.screenshooter=function(a,q){var e=q("main");a.shot=function(a,b){a=a||"image/png";e.canvas_data_url(function(b){var e=window.document.createElement("a");document.body.appendChild(e);e.style.display="none";e.href=b;e.download="screenshot."+a.split("/")[1];e.click();document.body.removeChild(e)},a,b||1,!0)}};
