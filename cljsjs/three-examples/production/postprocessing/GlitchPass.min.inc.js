THREE.GlitchPass=function(a){THREE.Pass.call(this);void 0===THREE.DigitalGlitch&&console.error("THREE.GlitchPass relies on THREE.DigitalGlitch");var b=THREE.DigitalGlitch;this.uniforms=THREE.UniformsUtils.clone(b.uniforms);void 0==a&&(a=64);this.uniforms.tDisp.value=this.generateHeightmap(a);this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader});this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);this.scene=new THREE.Scene;
this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null);this.quad.frustumCulled=!1;this.scene.add(this.quad);this.goWild=!1;this.curF=0;this.generateTrigger()};
THREE.GlitchPass.prototype=Object.assign(Object.create(THREE.Pass.prototype),{constructor:THREE.GlitchPass,render:function(a,b,e,c,d){this.uniforms.tDiffuse.value=e.texture;this.uniforms.seed.value=Math.random();this.uniforms.byp.value=0;0==this.curF%this.randX||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=THREE.Math.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=THREE.Math.randFloat(-1,1),this.uniforms.seed_y.value=THREE.Math.randFloat(-1,1),this.uniforms.distortion_x.value=
THREE.Math.randFloat(0,1),this.uniforms.distortion_y.value=THREE.Math.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=THREE.Math.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=THREE.Math.randFloat(0,1),this.uniforms.distortion_y.value=THREE.Math.randFloat(0,1),this.uniforms.seed_x.value=THREE.Math.randFloat(-.3,.3),this.uniforms.seed_y.value=THREE.Math.randFloat(-.3,.3)):0==this.goWild&&
(this.uniforms.byp.value=1);this.curF++;this.quad.material=this.material;this.renderToScreen?a.render(this.scene,this.camera):a.render(this.scene,this.camera,b,this.clear)},generateTrigger:function(){this.randX=THREE.Math.randInt(120,240)},generateHeightmap:function(a){for(var b=new Float32Array(a*a*3),e=a*a,c=0;c<e;c++){var d=THREE.Math.randFloat(0,1);b[3*c+0]=d;b[3*c+1]=d;b[3*c+2]=d}a=new THREE.DataTexture(b,a,a,THREE.RGBFormat,THREE.FloatType);a.needsUpdate=!0;return a}});