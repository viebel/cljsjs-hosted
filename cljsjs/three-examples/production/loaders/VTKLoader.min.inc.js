THREE.VTKLoader=function(u){this.manager=void 0!==u?u:THREE.DefaultLoadingManager};
Object.assign(THREE.VTKLoader.prototype,THREE.EventDispatcher.prototype,{load:function(u,J,K,L){var E=this,F=new THREE.FileLoader(E.manager);F.setResponseType("arraybuffer");F.load(u,function(u){J(E.parse(u))},K,L)},parse:function(u){function J(h){var n=[],f=[],d=[],g=[],b,a=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,p=/^(\d+)\s+([\s\d]*)/,y=/^POINTS /,G=/^POLYGONS /,q=/^TRIANGLE_STRIPS /,u=/^POINT_DATA[ ]+(\d+)/,c=/^CELL_DATA[ ]+(\d+)/,m=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,
l=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,k=!1,w=!1,t=!1,A=!1,r=!1,z=!1,C=!1;h=h.split("\n");for(var v in h){var B=h[v];if(k)for(;null!==(b=a.exec(B));){var x=parseFloat(b[1]),e=parseFloat(b[2]),D=parseFloat(b[3]);f.push(x,e,D)}else if(w){if(null!==(b=p.exec(B))&&(x=parseInt(b[1]),e=b[2].split(/\s+/),3<=x)){var D=parseInt(e[0]),H,I,M=1;for(b=0;b<x-2;++b)H=parseInt(e[M]),I=parseInt(e[M+1]),n.push(D,H,I),M++}}else if(t){if(null!==(b=p.exec(B))&&(x=parseInt(b[1]),e=b[2].split(/\s+/),3<=x))for(b=0;b<x-2;b++)1===
b%2?(D=parseInt(e[b]),H=parseInt(e[b+2]),I=parseInt(e[b+1])):(D=parseInt(e[b]),H=parseInt(e[b+1]),I=parseInt(e[b+2])),n.push(D,H,I)}else if(A||r)if(z)for(;null!==(b=a.exec(B));)x=parseFloat(b[1]),e=parseFloat(b[2]),b=parseFloat(b[3]),d.push(x,e,b);else if(C)for(;null!==(b=a.exec(B));)x=parseFloat(b[1]),e=parseFloat(b[2]),b=parseFloat(b[3]),g.push(x,e,b);null!==G.exec(B)?(w=!0,t=k=!1):null!==y.exec(B)?(w=!1,k=!0,t=!1):null!==q.exec(B)?(k=w=!1,t=!0):null!==u.exec(B)?(A=!0,t=w=k=!1):null!==c.exec(B)?
(r=!0,t=w=k=!1):null!==m.exec(B)?(z=!0,t=w=k=C=!1):null!==l.exec(B)&&(C=!0,t=w=k=z=!1)}v="point";d.length===n.length&&(v="cell");if("point"===v)a=new THREE.BufferGeometry,a.setIndex(new THREE.BufferAttribute(new Uint32Array(n),1)),a.addAttribute("position",new THREE.BufferAttribute(new Float32Array(f),3)),d.length===f.length&&a.addAttribute("color",new THREE.BufferAttribute(new Float32Array(d),3)),g.length===f.length&&a.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(g),3));else{a=
new THREE.Geometry;g=n.length/3;v=f.length/3;for(b=0;b<v;++b)x=f[3*b+0],e=f[3*b+1],D=f[3*b+2],a.vertices.push(new THREE.Vector3(x,e,D));for(v=0;v<g;++v)f=n[3*v+0],p=n[3*v+1],y=n[3*v+2],a.faces.push(new THREE.Face3(f,p,y));if(d.length===3*g)for(v=0;v<g;++v)n=a.faces[v],x=d[3*v+0],e=d[3*v+1],b=d[3*v+2],n.color=(new THREE.Color).setRGB(x,e,b)}return a}function K(h){function n(b,c){for(var a=c,d=b[a],f=[];10!==d;)f.push(String.fromCharCode(d)),a++,d=b[a];return{start:c,end:a,next:a+1,parsedString:f.join("")}}
var f,d,g,b,a,p=new Uint8Array(h),y=new DataView(h);h=[];for(var u=[],q=[],E=[],c=0;;){c=n(p,c);f=c.parsedString;if(0===f.indexOf("POINTS")){E.push(f);b=parseInt(f.split(" ")[1],10);f=12*b;h=new Float32Array(3*b);d=c.next;for(g=0;g<b;g++)h[3*g]=y.getFloat32(d,!1),h[3*g+1]=y.getFloat32(d+4,!1),h[3*g+2]=y.getFloat32(d+8,!1),d+=12;c.next=c.next+f+1}else if(0===f.indexOf("TRIANGLE_STRIPS")){b=parseInt(f.split(" ")[1],10);q=parseInt(f.split(" ")[2],10);f=4*q;var q=new Uint32Array(3*q-9*b),m=0;d=c.next;
for(g=0;g<b;g++){var l=y.getInt32(d,!1),k=[];d+=4;for(a=0;a<l;a++)k.push(y.getInt32(d,!1)),d+=4;for(a=0;a<l-2;a++)a%2?(q[m++]=k[a],q[m++]=k[a+2],q[m++]=k[a+1]):(q[m++]=k[a],q[m++]=k[a+1],q[m++]=k[a+2])}c.next=c.next+f+1}else if(0===f.indexOf("POLYGONS")){b=parseInt(f.split(" ")[1],10);q=parseInt(f.split(" ")[2],10);f=4*q;q=new Uint32Array(3*q-9*b);m=0;d=c.next;for(g=0;g<b;g++){l=y.getInt32(d,!1);k=[];d+=4;for(a=0;a<l;a++)k.push(y.getInt32(d,!1)),d+=4;for(a=1;a<l-1;a++)q[m++]=k[0],q[m++]=k[a],q[m++]=
k[a+1]}c.next=c.next+f+1}else if(0===f.indexOf("POINT_DATA")){b=parseInt(f.split(" ")[1],10);c=n(p,c.next);f=12*b;u=new Float32Array(3*b);d=c.next;for(g=0;g<b;g++)u[3*g]=y.getFloat32(d,!1),u[3*g+1]=y.getFloat32(d+4,!1),u[3*g+2]=y.getFloat32(d+8,!1),d+=12;c.next+=f}c=c.next;if(c>=p.byteLength)break}p=new THREE.BufferGeometry;p.setIndex(new THREE.BufferAttribute(q,1));p.addAttribute("position",new THREE.BufferAttribute(h,3));u.length===h.length&&p.addAttribute("normal",new THREE.BufferAttribute(u,3));
return p}function L(h,n){var f=h.length,d=new Float32Array(f+n.length);d.set(h);d.set(n,f);return d}function E(h,n){var f=h.length,d=new Int32Array(f+n.length);d.set(h);d.set(n,f);return d}function F(h){function n(b){var c={};if(1===b.nodeType){if(b.attributes&&0<b.attributes.length){c.attributes={};for(var a=0;a<b.attributes.length;a++){var e=b.attributes.item(a);c.attributes[e.nodeName]=e.nodeValue.trim()}}}else 3===b.nodeType&&(c=b.nodeValue.trim());if(b.hasChildNodes())for(a=0;a<b.childNodes.length;a++){var d=
b.childNodes.item(a),e=d.nodeName;"undefined"===typeof c[e]?(d=n(d),""!==d&&(c[e]=d)):("undefined"===typeof c[e].push&&(c[e]=[c[e]]),d=n(d),""!==d&&c[e].push(d))}return c}function f(b){var c="undefined"!==typeof Uint8Array?Uint8Array:Array,a,e=[],d=64;for(a=0;a<d;a++);for(a=0;a<d;++a)e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;e[45]=62;e[95]=63;var f,g,d=b.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");g="\x3d"===b[d-2]?2:"\x3d"===
b[d-1]?1:0;var c=new c(3*d/4-g),d=0<g?d-4:d,k=0;for(a=0;a<d;a+=4)f=e[b.charCodeAt(a)]<<18|e[b.charCodeAt(a+1)]<<12|e[b.charCodeAt(a+2)]<<6|e[b.charCodeAt(a+3)],c[k++]=(f&16711680)>>16,c[k++]=(f&65280)>>8,c[k++]=f&255;2===g?(f=e[b.charCodeAt(a)]<<2|e[b.charCodeAt(a+1)]>>4,c[k++]=f&255):1===g&&(f=e[b.charCodeAt(a)]<<10|e[b.charCodeAt(a+1)]<<4|e[b.charCodeAt(a+2)]>>2,c[k++]=f>>8&255,c[k++]=f&255);return c}function d(a,c){var d=0;"UInt64"===b.attributes.header_type?d=8:"UInt32"===b.attributes.header_type&&
(d=4);if("binary"===a.attributes.format&&c){var e,g,k,h,m,n;if("Float32"===a.attributes.type)var l=new Float32Array;else"Int64"===a.attributes.type&&(l=new Int32Array);g=f(a["#text"]);e=g[0];for(h=1;h<d-1;h++)e|=g[h]<<h*d;h=(e+3)*d;m=[];n=h+(0<h%3?3-h%3:0);m.push(n);k=3*d;for(h=0;h<e;h++){for(var q=g[h*d+k],p=1;p<d-1;p++)q|=g[h*d+k+p]<<8*p;n+=q;m.push(n)}for(h=0;h<m.length-1;h++)e=(new Zlib.Inflate(g.slice(m[h],m[h+1]),{resize:!0,verify:!0})).decompress(),e=e.buffer,"Float32"===a.attributes.type?
(e=new Float32Array(e),l=L(l,e)):"Int64"===a.attributes.type&&(e=new Int32Array(e),l=E(l,e));delete a["#text"];"Float32"===a.attributes.type?"binary"===a.attributes.format&&(c||(l=l.filter(function(a,b){if(0!==b)return!0}))):"Int64"===a.attributes.type&&"binary"===a.attributes.format&&(c||(l=l.filter(function(a,b){if(0!==b)return!0})),l=l.filter(function(a,b){if(1!==b%2)return!0}))}else"binary"!==a.attributes.format||c?e=a["#text"]?a["#text"].split(/\s+/).filter(function(a){if(""!==a)return a}):(new Int32Array(0)).buffer:
(e=f(a["#text"]),e=e.slice(d).buffer),delete a["#text"],"Float32"===a.attributes.type?l=new Float32Array(e):"Int32"===a.attributes.type?l=new Int32Array(e):"Int64"===a.attributes.type&&(l=new Int32Array(e),"binary"===a.attributes.format&&(l=l.filter(function(a,b){if(1!==b%2)return!0})));return l}var g=null;if(window.DOMParser)try{g=(new DOMParser).parseFromString(h,"text/xml")}catch(v){g=null}else if(window.ActiveXObject)try{if(g=new ActiveXObject("Microsoft.XMLDOM"),g.async=!1,!g.loadXML())throw Error(g.parseError.reason+
g.parseError.srcText);}catch(v){g=null}else throw Error("Cannot parse xml string!");var b=n(g.documentElement);h=[];var g=[],a=[];if(b.PolyData){for(var p=b.PolyData.Piece,u=b.attributes.hasOwnProperty("compressor"),G=["PointData","Points","Strips","Polys"],q=0,F=G.length;q<F;){var c=p[G[q]];if(c&&c.DataArray){for(var m="[object Array]"===Object.prototype.toString.call(c.DataArray)?c.DataArray:[c.DataArray],l=0,k=m.length;l<k;)"#text"in m[l]&&0<m[l]["#text"].length&&(m[l].text=d(m[l],u)),l++;switch(G[q]){case "PointData":var k=
parseInt(p.attributes.NumberOfPoints),w=c.attributes.Normals;if(0<k)for(c=0,l=m.length;c<l;c++)if(w===m[c].attributes.Name){var t=m[c].attributes.NumberOfComponents,g=new Float32Array(k*t);g.set(m[c].text,0)}break;case "Points":k=parseInt(p.attributes.NumberOfPoints);0<k&&(t=c.DataArray.attributes.NumberOfComponents,h=new Float32Array(k*t),h.set(c.DataArray.text,0));break;case "Strips":l=parseInt(p.attributes.NumberOfStrips);if(0<l)for(m=new Int32Array(c.DataArray[0].text.length),k=new Int32Array(c.DataArray[1].text.length),
m.set(c.DataArray[0].text,0),k.set(c.DataArray[1].text,0),a=l+m.length,a=new Uint32Array(3*a-9*l),c=t=0;c<l;c++){for(var A=[],r=0,w=k[c],z=0;r<w-z;r++)A.push(m[r]),0<c&&(z=k[c-1]);r=0;w=k[c];for(z=0;r<w-z-2;r++)r%2?(a[t++]=A[r],a[t++]=A[r+2],a[t++]=A[r+1]):(a[t++]=A[r],a[t++]=A[r+1],a[t++]=A[r+2]),0<c&&(z=k[c-1])}break;case "Polys":if(l=parseInt(p.attributes.NumberOfPolys),0<l)for(m=new Int32Array(c.DataArray[0].text.length),k=new Int32Array(c.DataArray[1].text.length),m.set(c.DataArray[0].text,0),
k.set(c.DataArray[1].text,0),a=l+m.length,a=new Uint32Array(3*a-9*l),z=c=A=t=0;c<l;){for(var C=[],r=0,w=k[c];r<w-z;)C.push(m[A++]),r++;for(r=1;r<w-z-1;)a[t++]=C[0],a[t++]=C[r],a[t++]=C[r+1],r++;c++;z=k[c-1]}}}q++}p=new THREE.BufferGeometry;p.setIndex(new THREE.BufferAttribute(a,1));p.addAttribute("position",new THREE.BufferAttribute(h,3));g.length===h.length&&p.addAttribute("normal",new THREE.BufferAttribute(g,3));return p}}function N(h){var n="";h=new Uint8Array(h);for(var f=0,d=h.length;d--;)n+=
String.fromCharCode(h[f++]);return n}var O=THREE.LoaderUtils.decodeText(new Uint8Array(u,0,250)).split("\n");return-1!==O[0].indexOf("xml")?F(N(u)):O[2].includes("ASCII")?J(N(u)):K(u)}});