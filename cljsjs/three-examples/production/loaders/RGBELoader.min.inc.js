THREE.HDRLoader=THREE.RGBELoader=function(f){this.manager=void 0!==f?f:THREE.DefaultLoadingManager};THREE.RGBELoader.prototype=Object.create(THREE.DataTextureLoader.prototype);
THREE.RGBELoader.prototype._parser=function(f){var n=function(c,b){switch(c){case 1:console.error("THREE.RGBELoader Read Error: "+(b||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(b||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(b||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(b||""))}return-1},r=function(c,b,d){b=b?b:1024;for(var k=c.pos,e=-1,g=0,f="",a=String.fromCharCode.apply(null,new Uint16Array(c.subarray(k,k+128)));0>(e=a.indexOf("\n"))&&
g<b&&k<c.byteLength;)f+=a,g+=a.length,k+=128,a+=String.fromCharCode.apply(null,new Uint16Array(c.subarray(k,k+128)));return-1<e?(!1!==d&&(c.pos+=g+e+1),f+a.slice(0,e)):!1},m=function(c,b,d){var k,e,g,f,a,h,m,l,q=d,p;if(8>b||32767<b||2!==c[0]||2!==c[1]||c[2]&128)return new Uint8Array(c);if(b!==(c[2]<<8|c[3]))return n(3,"wrong scanline width");d=new Uint8Array(4*b*d);if(!d||!d.length)return n(4,"unable to allocate buffer space");e=k=0;m=4*b;p=new Uint8Array(4);for(a=new Uint8Array(m);0<q&&e<c.byteLength;){if(e+
4>c.byteLength)return n(1);p[0]=c[e++];p[1]=c[e++];p[2]=c[e++];p[3]=c[e++];if(2!=p[0]||2!=p[1]||(p[2]<<8|p[3])!=b)return n(3,"bad rgbe scanline format");for(h=0;h<m&&e<c.byteLength;){g=c[e++];(l=128<g)&&(g-=128);if(0===g||h+g>m)return n(3,"bad scanline data");if(l)for(f=c[e++],l=0;l<g;l++)a[h++]=f;else a.set(c.subarray(e,e+g),h),h+=g,e+=g}g=b;for(l=0;l<g;l++)h=0,d[k]=a[l+h],h+=b,d[k+1]=a[l+h],h+=b,d[k+2]=a[l+h],h+=b,d[k+3]=a[l+h],k+=4;q--}return d},q=new Uint8Array(f);q.pos=0;f=function(c){var b,
d,f=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,e=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,g=/^\s*FORMAT=(\S+)\s*$/,m=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,a={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(c.pos>=c.byteLength||!(b=r(c)))return n(1,"no header found");if(!(d=b.match(/^#\?(\S+)$/)))return n(3,"bad initial token");a.valid|=1;a.programtype=d[1];for(a.string+=b+"\n";;){b=r(c);if(!1===b)break;a.string+=b+"\n";if("#"===b.charAt(0))a.comments+=b+"\n";
else{if(d=b.match(f))a.gamma=parseFloat(d[1],10);if(d=b.match(e))a.exposure=parseFloat(d[1],10);if(d=b.match(g))a.valid|=2,a.format=d[1];if(d=b.match(m))a.valid|=4,a.height=parseInt(d[1],10),a.width=parseInt(d[2],10);if(a.valid&2&&a.valid&4)break}}return a.valid&2?a.valid&4?a:n(3,"missing image size specifier"):n(3,"missing format specifier")}(q);if(-1!==f){var t=f.width,u=f.height,m=m(q.subarray(q.pos),t,u);if(-1!==m)return{width:t,height:u,data:m,header:f.string,gamma:f.gamma,exposure:f.exposure,
format:THREE.RGBEFormat,type:THREE.UnsignedByteType}}return null};