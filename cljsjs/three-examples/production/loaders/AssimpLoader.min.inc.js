THREE.AssimpLoader=function(p){this.manager=void 0!==p?p:THREE.DefaultLoadingManager};
THREE.AssimpLoader.prototype={constructor:THREE.AssimpLoader,crossOrigin:"Anonymous",load:function(p,H,x,I){var r=this,J=THREE.LoaderUtils.extractUrlBase(p),D=new THREE.FileLoader(this.manager);D.setResponseType("arraybuffer");D.load(p,function(p){H(r.parse(p,J))},x,I)},setCrossOrigin:function(p){this.crossOrigin=p},parse:function(p,H){function x(a,b){var e=new THREE.Bone;e.matrix.copy(a.matrix);e.matrixWorld.copy(a.matrixWorld);e.position.copy(a.position);e.quaternion.copy(a.quaternion);e.scale.copy(a.scale);
b.nodeCount++;e.name="bone_"+a.name+b.nodeCount.toString();b.nodeToBoneMap[a.name]||(b.nodeToBoneMap[a.name]=[]);b.nodeToBoneMap[a.name].push(e);for(var c in a.children){var d=x(a.children[c],b);d&&e.add(d)}return e}function I(a,b){for(var e=[],c=0;c<a.length;c++)e.push({i:a[c],w:b[c]});for(e.sort(function(a,b){return b.w-a.w});4>e.length;)e.push({i:0,w:0});4<e.length&&(e.length=4);for(var d=0,c=0;4>c;c++)d+=e[c].w*e[c].w;d=Math.sqrt(d);for(c=0;4>c;c++)e[c].w/=d,a[c]=e[c].i,b[c]=e[c].w}function r(a,
b){if(0==a.name.indexOf("bone_"+b))return a;for(var e in a.children){var c=r(a.children[e],b);if(c)return c}}function J(){this.mMaterialIndex=this.mNumBones=this.mNumFaces=this.mNumVertices=this.mPrimitiveTypes=0;this.mVertices=[];this.mNormals=[];this.mTangents=[];this.mBitangents=[];this.mColors=[[]];this.mTextureCoords=[[]];this.mFaces=[];this.mBones=[];this.hookupSkeletons=function(a,b){if(0!=this.mBones.length){for(var e=[],c=[],d=a.findNode(this.mBones[0].mName);d.mParent&&d.mParent.isBone;)d=
d.mParent;d=d.toTHREE(a);d=x(d,a);this.threeNode.add(d);for(var g=0;g<this.mBones.length;g++){var f=r(d,this.mBones[g].mName);if(!f){d=a.findNode(this.mBones[g].mName);if(!d)return;d=d.toTHREE(a);d=x(d,a);this.threeNode.add(d);f=r(d,this.mBones[g].mName)}e.push(f);c.push(this.mBones[g].mOffsetMatrix.toTHREE())}e=new THREE.Skeleton(e,c);this.threeNode.bind(e,new THREE.Matrix4);this.threeNode.material.skinning=!0}};this.toTHREE=function(a){if(this.threeNode)return this.threeNode;var b=new THREE.BufferGeometry;
a=a.mMaterials[this.mMaterialIndex]?a.mMaterials[this.mMaterialIndex].toTHREE(a):new THREE.MeshLambertMaterial;b.setIndex(new THREE.BufferAttribute(new Uint32Array(this.mIndexArray),1));b.addAttribute("position",new THREE.BufferAttribute(this.mVertexBuffer,3));this.mNormalBuffer&&0<this.mNormalBuffer.length&&b.addAttribute("normal",new THREE.BufferAttribute(this.mNormalBuffer,3));this.mColorBuffer&&0<this.mColorBuffer.length&&b.addAttribute("color",new THREE.BufferAttribute(this.mColorBuffer,4));
this.mTexCoordsBuffers[0]&&0<this.mTexCoordsBuffers[0].length&&b.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(this.mTexCoordsBuffers[0]),2));this.mTexCoordsBuffers[1]&&0<this.mTexCoordsBuffers[1].length&&b.addAttribute("uv1",new THREE.BufferAttribute(new Float32Array(this.mTexCoordsBuffers[1]),2));this.mTangentBuffer&&0<this.mTangentBuffer.length&&b.addAttribute("tangents",new THREE.BufferAttribute(this.mTangentBuffer,3));this.mBitangentBuffer&&0<this.mBitangentBuffer.length&&b.addAttribute("bitangents",
new THREE.BufferAttribute(this.mBitangentBuffer,3));if(0<this.mBones.length){for(var e=[],c=[],d=0;d<this.mBones.length;d++)for(var g=0;g<this.mBones[d].mWeights.length;g++){var f=this.mBones[d].mWeights[g];f&&(e[f.mVertexId]||(e[f.mVertexId]=[]),c[f.mVertexId]||(c[f.mVertexId]=[]),e[f.mVertexId].push(f.mWeight),c[f.mVertexId].push(parseInt(d)))}for(d in c)I(c[d],e[d]);for(var f=[],h=[],d=0;d<e.length;d++)for(g=0;4>g;g++)e[d]&&c[d]?(f.push(e[d][g]),h.push(c[d][g])):(f.push(0),h.push(0));b.addAttribute("skinWeight",
new THREE.BufferAttribute(new Float32Array(f),4));b.addAttribute("skinIndex",new THREE.BufferAttribute(new Float32Array(h),4))}var k;0==this.mBones.length&&(k=new THREE.Mesh(b,a));0<this.mBones.length&&(k=new THREE.SkinnedMesh(b,a));return this.threeNode=k}}function D(){this.mNumIndices=0;this.mIndices=[]}function V(){this.z=this.y=this.x=0;this.toTHREE=function(){return new THREE.Vector3(this.x,this.y,this.z)}}function W(){this.a=this.b=this.g=this.r=0;this.toTHREE=function(){return new THREE.Color(this.r,
this.g,this.b,1)}}function X(){this.w=this.z=this.y=this.x=0;this.toTHREE=function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}}function Y(){this.mWeight=this.mVertexId=0}function K(){this.data=[];this.toString=function(){var a="";this.data.forEach(function(b){a+=String.fromCharCode(b)});return a.replace(/[^\x20-\x7E]+/g,"")}}function Z(){this.mTime=0;this.mValue=null}function aa(){this.mTime=0;this.mValue=null}function N(){this.mName="";this.mTransformation=[];this.mNumMeshes=this.mNumChildren=
0;this.mMeshes=[];this.mChildren=[];this.toTHREE=function(a){if(this.threeNode)return this.threeNode;var b=new THREE.Object3D;b.name=this.mName;b.matrix=this.mTransformation.toTHREE();for(var e=0;e<this.mChildren.length;e++)b.add(this.mChildren[e].toTHREE(a));for(e=0;e<this.mMeshes.length;e++)b.add(a.mMeshes[this.mMeshes[e]].toTHREE(a));this.threeNode=b;b.matrix.decompose(b.position,b.quaternion,b.scale);return b}}function ba(){this.mName="";this.mOffsetMatrix=this.mNumWeights=0}function ca(){this.mKey=
"";this.mIndex=this.mSemantic=0;this.mData=[];this.mType=this.mDataLength=0;this.dataAsColor=function(){var a=(new Uint8Array(this.mData)).buffer,b=new DataView(a),a=b.getFloat32(0,!0),e=b.getFloat32(4,!0),b=b.getFloat32(8,!0);return new THREE.Color(a,e,b)};this.dataAsFloat=function(){var a=(new Uint8Array(this.mData)).buffer;return(new DataView(a)).getFloat32(0,!0)};this.dataAsBool=function(){var a=(new Uint8Array(this.mData)).buffer;return!!(new DataView(a)).getFloat32(0,!0)};this.dataAsString=
function(){var a=new K;a.data=this.mData;return a.toString()};this.dataAsMap=function(){var a=new K;a.data=this.mData;a=a.toString();a=a.replace(/\\/g,"/");-1!=a.indexOf("/")&&(a=a.substr(a.lastIndexOf("/")+1));return O.load(a)}}function da(){this.mNumProperties=this.mNumAllocated=0;this.mProperties=[];this.toTHREE=function(a){this.mProperties[0].dataAsString();a=new THREE.MeshPhongMaterial;for(var b=0;b<this.mProperties.length;b++)if("float"==t[this.mProperties[b].mKey]&&(a[A[this.mProperties[b].mKey]]=
this.mProperties[b].dataAsFloat()),"color"==t[this.mProperties[b].mKey]&&(a[A[this.mProperties[b].mKey]]=this.mProperties[b].dataAsColor()),"bool"==t[this.mProperties[b].mKey]&&(a[A[this.mProperties[b].mKey]]=this.mProperties[b].dataAsBool()),"string"==t[this.mProperties[b].mKey]&&(a[A[this.mProperties[b].mKey]]=this.mProperties[b].dataAsString()),"map"==t[this.mProperties[b].mKey]){var e=this.mProperties[b];1==e.mSemantic&&(a.map=this.mProperties[b].dataAsMap());6==e.mSemantic&&(a.normalMap=this.mProperties[b].dataAsMap());
10==e.mSemantic&&(a.lightMap=this.mProperties[b].dataAsMap());8==e.mSemantic&&(a.alphaMap=this.mProperties[b].dataAsMap())}a.ambient.r=.53;a.ambient.g=.53;a.ambient.b=.53;a.color.r=1;a.color.g=1;a.color.b=1;return a}}function P(a,b,e){var c=new THREE.Vector3,d=1-e;c.x=a.x*e+b.x*d;c.y=a.y*e+b.y*d;c.z=a.z*e+b.z*d;return c}function ea(a,b,e){return a.clone().slerp(b,1-e)}function L(a,b,e,c){if(1==a.length)return a[0].mValue.toTHREE();for(var d=Infinity,g=null,f=null,h=0;h<a.length;h++){var k=Math.abs(a[h].mTime-
b);k<d&&a[h].mTime<=b&&(d=k,g=a[h],f=a[h+1])}return g?(f||(f=a[0].clone(),f.mTime+=e),a=f.mTime-g.mTime,b=g.mTime-b,b/=a,c(g.mValue.toTHREE(),f.mValue.toTHREE(),b)):null}function fa(){this.mNodeName="";this.mNumScalingKeys=this.mNumRotationKeys=this.mNumPositionKeys=0;this.mPositionKeys=[];this.mRotationKeys=[];this.mScalingKeys=[];this.mPostState=this.mPreState="";this.init=function(a){function b(b){b.mTime/=a}a||(a=1);this.mPositionKeys.forEach(b);this.mRotationKeys.forEach(b);this.mScalingKeys.forEach(b)};
this.sortKeys=function(){function a(a,e){return a.mTime-e.mTime}this.mPositionKeys.sort(a);this.mRotationKeys.sort(a);this.mScalingKeys.sort(a)};this.getLength=function(){return Math.max(Math.max.apply(null,this.mPositionKeys.map(function(a){return a.mTime})),Math.max.apply(null,this.mRotationKeys.map(function(a){return a.mTime})),Math.max.apply(null,this.mScalingKeys.map(function(a){return a.mTime})))};this.toTHREE=function(a,b){this.sortKeys();for(var e=this.getLength(),c=new l.KeyFrameTrack,d=
0;d<e;d+=.05){var g=new THREE.Matrix4,f=d,h=L(this.mPositionKeys,f,e,P),k=L(this.mScalingKeys,f,e,P),m=L(this.mRotationKeys,f,e,ea);g.compose(h,m,k);g=new l.KeyFrame(f,g);c.addKey(g)}c.target=a.findNode(this.mNodeName).toTHREE();e=[c];if(a.nodeToBoneMap[this.mNodeName])for(d=0;d<a.nodeToBoneMap[this.mNodeName].length;d++)g=c.clone(),g.target=a.nodeToBoneMap[this.mNodeName][d],e.push(g);return e}}function ga(){this.mName="";this.mNumChannels=this.mTicksPerSecond=this.mDuration=0;this.mChannels=[];
this.toTHREE=function(a){var b=new l.Animation,e;for(e in this.mChannels){this.mChannels[e].init(this.mTicksPerSecond);var c=this.mChannels[e].toTHREE(a),d;for(d in c)c[d].init(),b.addTrack(c[d])}b.length=Math.max.apply(null,b.tracks.map(function(a){return a.length}));return b}}function ha(){this.mHeight=this.mWidth=0;this.texAchFormatHint=[];this.pcData=[]}function ia(){this.mName="";this.mAngleOuterCone=this.mAngleInnerCone=this.mAttenuationQuadratic=this.mAttenuationLinear=this.mAttenuationConstant=
this.mType=0;this.mColorAmbient=this.mColorSpecular=this.mColorDiffuse=null}function ja(){this.mName="";this.mUp=this.mLookAt=this.mPosition=null;this.mAspect=this.mClipPlaneFar=this.mClipPlaneNear=this.mHorizontalFOV=0}function ka(){this.mNumCameras=this.mNumLights=this.mNumTextures=this.mNumAnimations=this.mNumMaterials=this.mNumMeshes=this.mFlags=0;this.mRootNode=null;this.mMeshes=[];this.mMaterials=[];this.mAnimations=[];this.mLights=[];this.mCameras=[];this.nodeToBoneMap={};this.findNode=function(a,
b){b||(b=this.mRootNode);if(b.mName==a)return b;for(var e=0;e<b.mChildren.length;e++){var c=this.findNode(a,b.mChildren[e]);if(c)return c}return null};this.toTHREE=function(){this.nodeCount=0;for(var a in this.mMeshes){var b=this.mMeshes[a],e;for(e in b.mBones){var c=this.findNode(b.mBones[e].mName);c&&(c.isBone=!0)}}a=this.mRootNode.toTHREE(this);for(var d in this.mMeshes)this.mMeshes[d].hookupSkeletons(this,a);if(0<this.mAnimations.length)var g=this.mAnimations[0].toTHREE(this);return{object:a,
animation:g}}}function la(){this.elements=[[],[],[],[]];this.toTHREE=function(){for(var a=new THREE.Matrix4,b=0;4>b;++b)for(var e=0;4>e;++e)a.elements[4*b+e]=this.elements[e][b];return a}}function m(a){var b=a.getFloat32(a.readOffset,!0);a.readOffset+=4;return b}function E(a){var b=a.getFloat64(a.readOffset,!0);a.readOffset+=8;return b}function F(a){var b=a.getUint16(a.readOffset,!0);a.readOffset+=2;return b}function k(a){var b=a.getUint32(a.readOffset,!0);a.readOffset+=4;return b}function n(a){var b=
a.getUint32(a.readOffset,!0);a.readOffset+=4;return b}function G(a){var b=new V;b.x=m(a);b.y=m(a);b.z=m(a);return b}function M(a){var b=new W;b.r=m(a);b.g=m(a);b.b=m(a);return b}function B(a){var b=new K,e=k(a);a.ReadBytes(b.data,1,e);return b.toString()}function Q(a){for(var b=new la,e=0;4>e;++e)for(var c=0;4>c;++c)b.elements[e][c]=m(a);return b}function R(a){var b=new Z;b.mTime=E(a);b.mValue=G(a);return b}function y(a,b,e){return a.Seek(sizeof(b)*e,v)}function w(a){if(!a)throw"asset failed";}function S(a,
b,e){var c=n(a);w(4668==c);n(a);c=new N;c.mParent=b;c.mDepth=e;c.mName=B(a);c.mTransformation=Q(a);c.mNumChildren=k(a);c.mNumMeshes=k(a);if(c.mNumMeshes)for(c.mMeshes=[],b=0;b<c.mNumMeshes;++b)c.mMeshes[b]=k(a);if(c.mNumChildren)for(c.mChildren=[],b=0;b<c.mNumChildren;++b){var d=S(a,c,e++);c.mChildren[b]=d}return c}function T(a,b){var e=n(a);w(4665==e);n(a);b.mFlags=k(a);b.mNumMeshes=k(a);b.mNumMaterials=k(a);b.mNumAnimations=k(a);b.mNumTextures=k(a);b.mNumLights=k(a);b.mNumCameras=k(a);b.mRootNode=
new N;b.mRootNode=S(a,null,0);if(b.mNumMeshes)for(b.mMeshes=[],e=0;e<b.mNumMeshes;++e){b.mMeshes[e]=new J;var c=a,d=b.mMeshes[e],g=n(c);w(4663==g);n(c);d.mPrimitiveTypes=k(c);d.mNumVertices=k(c);d.mNumFaces=k(c);d.mNumBones=k(c);d.mMaterialIndex=k(c);d.mNumUVComponents=[];g=k(c);g&1&&(q?y(c,d.mVertices,d.mNumVertices):(d.mVertices=[],d.mVertexBuffer=c.subArray32(c.readOffset,c.readOffset+12*d.mNumVertices),c.Seek(12*d.mNumVertices,v)));g&2&&(q?y(c,d.mNormals,d.mNumVertices):(d.mNormals=[],d.mNormalBuffer=
c.subArray32(c.readOffset,c.readOffset+12*d.mNumVertices),c.Seek(12*d.mNumVertices,v)));g&4&&(q?(y(c,d.mTangents,d.mNumVertices),y(c,d.mBitangents,d.mNumVertices)):(d.mTangents=[],d.mTangentBuffer=c.subArray32(c.readOffset,c.readOffset+12*d.mNumVertices),c.Seek(12*d.mNumVertices,v),d.mBitangents=[],d.mBitangentBuffer=c.subArray32(c.readOffset,c.readOffset+12*d.mNumVertices),c.Seek(12*d.mNumVertices,v)));for(var f=0;1>f&&g&65536<<f;++f)q?y(c,d.mColors[f],d.mNumVertices):(d.mColors[f]=[],d.mColorBuffer=
c.subArray32(c.readOffset,c.readOffset+16*d.mNumVertices),c.Seek(16*d.mNumVertices,v));d.mTexCoordsBuffers=[];for(f=0;4>f&&g&256<<f;++f)if(d.mNumUVComponents[f]=k(c),q)y(c,d.mTextureCoords[f],d.mNumVertices);else{d.mTextureCoords[f]=[];d.mTexCoordsBuffers[f]=[];for(var h=0;h<d.mNumVertices;h++)d.mTexCoordsBuffers[f].push(m(c)),d.mTexCoordsBuffers[f].push(m(c)),m(c)}if(q)k(c);else for(d.mFaces=[],d.mIndexArray=[],f=0;f<d.mNumFaces;++f){h=d.mFaces[f]=new D;h.mNumIndices=F(c);h.mIndices=[];for(g=0;g<
h.mNumIndices;++g)h.mIndices[g]=65536>d.mNumVertices?F(c):k(c);if(3===h.mNumIndices)d.mIndexArray.push(h.mIndices[0]),d.mIndexArray.push(h.mIndices[1]),d.mIndexArray.push(h.mIndices[2]);else if(4===h.mNumIndices)d.mIndexArray.push(h.mIndices[0]),d.mIndexArray.push(h.mIndices[1]),d.mIndexArray.push(h.mIndices[2]),d.mIndexArray.push(h.mIndices[2]),d.mIndexArray.push(h.mIndices[3]),d.mIndexArray.push(h.mIndices[0]);else throw Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");
}if(d.mNumBones)for(d.mBones=[],g=0;g<d.mNumBones;++g){d.mBones[g]=new ba;var f=c,l=d.mBones[g],h=n(f);w(4666==h);n(f);l.mName=B(f);l.mNumWeights=k(f);l.mOffsetMatrix=Q(f);if(q)y(f,l.mWeights,l.mNumWeights);else{l.mWeights=[];for(var h=l.mWeights,l=l.mNumWeights,u=0;u<l;u++){var p=h,z=u,x=f,r=new Y;r.mVertexId=k(x);r.mWeight=m(x);p[z]=r}}}}if(b.mNumMaterials)for(b.mMaterials=[],e=0;e<b.mNumMaterials;++e)if(b.mMaterials[e]=new da,c=a,d=b.mMaterials[e],g=n(c),w(4669==g),n(c),d.mNumAllocated=d.mNumProperties=
k(c),d.mNumProperties)for(d.mProperties&&delete d.mProperties,d.mProperties=[],g=0;g<d.mNumProperties;++g)d.mProperties[g]=new ca,f=c,h=d.mProperties[g],l=n(f),w(4670==l),n(f),h.mKey=B(f),h.mSemantic=k(f),h.mIndex=k(f),h.mDataLength=k(f),h.mType=k(f),h.mData=[],f.ReadBytes(h.mData,1,h.mDataLength);if(b.mNumAnimations)for(b.mAnimations=[],e=0;e<b.mNumAnimations;++e)if(b.mAnimations[e]=new ga,c=a,d=b.mAnimations[e],g=n(c),w(4667==g),n(c),d.mName=B(c),d.mDuration=E(c),d.mTicksPerSecond=E(c),d.mNumChannels=
k(c),d.mNumChannels)for(d.mChannels=[],g=0;g<d.mNumChannels;++g){d.mChannels[g]=new fa;h=c;f=d.mChannels[g];l=n(h);w(4664==l);n(h);f.mNodeName=B(h);f.mNumPositionKeys=k(h);f.mNumRotationKeys=k(h);f.mNumScalingKeys=k(h);f.mPreState=k(h);f.mPostState=k(h);if(f.mNumPositionKeys)if(q)y(h,f.mPositionKeys,f.mNumPositionKeys);else for(f.mPositionKeys=[],l=h,u=f.mPositionKeys,p=f.mNumPositionKeys,z=0;z<p;z++)u[z]=R(l);if(f.mNumRotationKeys)if(q)y(h,f.mRotationKeys,f.mNumRotationKeys);else for(f.mRotationKeys=
[],l=h,u=f.mRotationKeys,p=f.mNumRotationKeys,z=0;z<p;z++){var x=u,r=z,t=l,A=new aa;A.mTime=E(t);var C=new X;C.w=m(t);C.x=m(t);C.y=m(t);C.z=m(t);A.mValue=C;x[r]=A}if(f.mNumScalingKeys)if(q)y(h,f.mScalingKeys,f.mNumScalingKeys);else for(f.mScalingKeys=[],l=f.mScalingKeys,f=f.mNumScalingKeys,u=0;u<f;u++)l[u]=R(h)}if(b.mNumTextures)for(b.mTextures=[],e=0;e<b.mNumTextures;++e)b.mTextures[e]=new ha,c=a,d=b.mTextures[e],g=n(c),w(4662==g),n(c),d.mWidth=k(c),d.mHeight=k(c),c.ReadBytes(d.achFormatHint,1,4),
q||(d.mHeight?(d.pcData=[],c.ReadBytes(d.pcData,1,d.mWidth*d.mHeight*4)):(d.pcData=[],c.ReadBytes(d.pcData,1,d.mWidth)));if(b.mNumLights)for(b.mLights=[],e=0;e<b.mNumLights;++e)b.mLights[e]=new ia,c=a,d=b.mLights[e],g=n(c),w(4661==g),n(c),d.mName=B(c),d.mType=k(c),1!=d.mType&&(d.mAttenuationConstant=m(c),d.mAttenuationLinear=m(c),d.mAttenuationQuadratic=m(c)),d.mColorDiffuse=M(c),d.mColorSpecular=M(c),d.mColorAmbient=M(c),3==d.mType&&(d.mAngleInnerCone=m(c),d.mAngleOuterCone=m(c));if(b.mNumCameras)for(b.mCameras=
[],e=0;e<b.mNumCameras;++e)b.mCameras[e]=new ja,c=a,d=b.mCameras[e],g=n(c),w(4660==g),n(c),d.mName=B(c),d.mPosition=G(c),d.mLookAt=G(c),d.mUp=G(c),d.mHorizontalFOV=m(c),d.mClipPlaneNear=m(c),d.mClipPlaneFar=m(c),d.mAspect=m(c)}function ma(a){a.readOffset=0;a.Seek=function(b,e){e==v&&(a.readOffset+=b);1==e&&(a.readOffset=b)};a.ReadBytes=function(a,e,c){e*=c;for(c=0;c<e;c++){var d=c,g=this.getUint8(this.readOffset);this.readOffset+=1;a[d]=g}};a.subArray32=function(a,e){var c=this.buffer.slice(a,e);
return new Float32Array(c)};a.subArrayUint16=function(a,e){var c=this.buffer.slice(a,e);return new Uint16Array(c)};a.subArrayUint8=function(a,e){var c=this.buffer.slice(a,e);return new Uint8Array(c)};a.subArrayUint32=function(a,e){var c=this.buffer.slice(a,e);return new Uint32Array(c)}}var O=new THREE.TextureLoader(this.manager);O.setPath(H).setCrossOrigin(this.crossOrigin);var l={KeyFrame:function(a,b){this.time=a;this.matrix=b.clone();this.position=new THREE.Vector3;this.quaternion=new THREE.Quaternion;
this.scale=new THREE.Vector3(1,1,1);this.matrix.decompose(this.position,this.quaternion,this.scale);this.clone=function(){return new l.KeyFrame(this.time,this.matrix)};this.lerp=function(a,b){b-=this.time;var d=b/(a.time-this.time),g=1-d,f=this.position,h=this.quaternion,k=a.position,m=a.quaternion;l.KeyFrame.tempAniPos.x=f.x*g+k.x*d;l.KeyFrame.tempAniPos.y=f.y*g+k.y*d;l.KeyFrame.tempAniPos.z=f.z*g+k.z*d;l.KeyFrame.tempAniQuat.set(h.x,h.y,h.z,h.w);l.KeyFrame.tempAniQuat.slerp(m,d);return l.KeyFrame.tempAniMatrix.compose(l.KeyFrame.tempAniPos,
l.KeyFrame.tempAniQuat,l.KeyFrame.tempAniScale)}}};l.KeyFrame.tempAniPos=new THREE.Vector3;l.KeyFrame.tempAniQuat=new THREE.Quaternion;l.KeyFrame.tempAniScale=new THREE.Vector3(1,1,1);l.KeyFrame.tempAniMatrix=new THREE.Matrix4;l.KeyFrameTrack=function(){this.keys=[];this.target=null;this.length=this.time=0;this._accelTable={};this.fps=20;this.addKey=function(a){this.keys.push(a)};this.init=function(){this.sortKeys();this.length=0<this.keys.length?this.keys[this.keys.length-1].time:0;if(this.fps)for(var a=
0;a<this.length*this.fps;a++)for(var b=0;b<this.keys.length;b++)if(this.keys[b].time==a){this._accelTable[a]=b;break}else if(this.keys[b].time<a/this.fps&&this.keys[b+1]&&this.keys[b+1].time>=a/this.fps){this._accelTable[a]=b;break}};this.parseFromThree=function(a){var b=a.fps;this.target=a.node;a=a.hierarchy[0].keys;for(var e=0;e<a.length;e++)this.addKey(new l.KeyFrame(e/b||a[e].time,a[e].targets[0].data));this.init()};this.parseFromCollada=function(a){a=a.keys;for(var b=this.fps,e=0;e<a.length;e++)this.addKey(new l.KeyFrame(e/
b||a[e].time,a[e].matrix));this.init()};this.sortKeys=function(){this.keys.sort(this.keySortFunc)};this.keySortFunc=function(a,b){return a.time-b.time};this.clone=function(){var a=new l.KeyFrameTrack;a.target=this.target;a.time=this.time;a.length=this.length;for(var b=0;b<this.keys.length;b++)a.addKey(this.keys[b].clone());a.init();return a};this.reTarget=function(a,b){b||(b=l.TrackTargetNodeNameCompare);this.target=b(a,this.target)};this.keySearchAccel=function(a){a*=this.fps;a=Math.floor(a);return this._accelTable[a]||
0};this.setTime=function(a){a=Math.abs(a);this.length&&(a=a%this.length+.05);for(var b=null,e=null,c=this.keySearchAccel(a);c<this.keys.length;c++)if(this.keys[c].time==a){b=this.keys[c];e=this.keys[c];break}else if(this.keys[c].time<a&&this.keys[c+1]&&this.keys[c+1].time>a){b=this.keys[c];e=this.keys[c+1];break}else if(this.keys[c].time<a&&c==this.keys.length-1){b=this.keys[c];e=this.keys[0].clone();e.time+=this.length+.05;break}b&&e&&b!==e?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(b.lerp(e,
a)),this.target.matrixWorldNeedsUpdate=!0):b&&e&&b==e&&(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(b.matrix),this.target.matrixWorldNeedsUpdate=!0)}};l.TrackTargetNodeNameCompare=function(a,b){function e(a,b){if(a.name==b)return a;for(var g=0;g<a.children.length;g++){var f=e(a.children[g],b);if(f)return f}return null}return e(a,b.name)};l.Animation=function(){this.tracks=[];this.length=0;this.addTrack=function(a){this.tracks.push(a);this.length=Math.max(a.length,this.length)};this.setTime=
function(a){this.time=a;for(var b=0;b<this.tracks.length;b++)this.tracks[b].setTime(a)};this.clone=function(a,b){b||(b=l.TrackTargetNodeNameCompare);var e=new l.Animation;e.target=a;for(var c=0;c<this.tracks.length;c++){var d=this.tracks[c].clone();d.reTarget(a,b);e.addTrack(d)}return e}};var A={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent",
"$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},t={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"},v=0,q,U;return function(a){var b=
new ka,e=new DataView(a);ma(e);e.Seek(44,v);k(e);k(e);k(e);k(e);q=0<F(e);U=0<F(e);if(q)throw"Shortened binaries are not supported!";e.Seek(256,v);e.Seek(128,v);e.Seek(64,v);if(U){a=n(e);var c=e.FileSize()-e.Tell(),d=[];e.Read(d,1,c);e=[];uncompress(e,a,d,c);a=new ArrayBuffer(e);T(a,b)}else return T(e,b),b.toTHREE()}(p)}};