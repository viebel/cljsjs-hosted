THREE.UCSCharacter=function(){function f(a,d){for(var g=new THREE.TextureLoader,c=[],e=0;e<d.length;e++)c[e]=g.load(a+d[e],b.checkLoadComplete),c[e].mapping=THREE.UVMapping,c[e].name=d[e];return c}function h(a){for(var c=[],b=0;b<a.length;b++)c[b]=new THREE.MeshLambertMaterial({color:15658734,specular:10,map:a[b],skinning:!0,morphTargets:!0});return c}var b=this,c;this.scale=1;this.root=new THREE.Object3D;this.numMorphs=this.numSkins=void 0;this.skins=[];this.materials=[];this.morphs=[];this.mixer=
new THREE.AnimationMixer(this.root);this.onLoadComplete=function(){};this.loadCounter=0;this.loadParts=function(a){this.numSkins=a.skins.length;this.numMorphs=a.morphs.length;this.loadCounter=1+a.skins.length;this.skins=f(a.baseUrl+"skins/",a.skins);this.materials=h(this.skins);this.morphs=a.morphs;var d=new THREE.JSONLoader;console.log(a.baseUrl+a.character);d.load(a.baseUrl+a.character,function(d){d.computeBoundingBox();d.computeVertexNormals();c=new THREE.SkinnedMesh(d,[]);c.name=a.character;b.root.add(c);
var f=d.boundingBox;b.root.scale.set(a.s,a.s,a.s);b.root.position.set(a.x,a.y-f.min.y*a.s,a.z);c.castShadow=!0;c.receiveShadow=!0;b.mixer.clipAction(d.animations[0],c).play();b.setSkin(0);b.checkLoadComplete()})};this.setSkin=function(a){c&&b.materials&&(c.material=b.materials[a])};this.updateMorphs=function(a){if(c)for(var d=0;d<b.numMorphs;d++)c.morphTargetInfluences[d]=a[b.morphs[d]]/100};this.checkLoadComplete=function(){--b.loadCounter;if(0===b.loadCounter)b.onLoadComplete()}};