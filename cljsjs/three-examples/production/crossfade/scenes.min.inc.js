function generateGeometry(g,l){function b(a,c){a.faces.forEach(function(a){for(var f=a instanceof THREE.Face3?3:4,b=0;b<f;b++)a.vertexColors[b]=c})}for(var h=new THREE.Geometry,d=0;d<l;d++){var e=new THREE.Vector3;e.x=1E4*Math.random()-5E3;e.y=6E3*Math.random()-3E3;e.z=8E3*Math.random()-4E3;var f=new THREE.Euler;f.x=2*Math.random()*Math.PI;f.y=2*Math.random()*Math.PI;f.z=2*Math.random()*Math.PI;var c=new THREE.Vector3,k,a=new THREE.Color;c.x=200*Math.random()+100;"cube"==g?(k=new THREE.BoxGeometry(1,
1,1),c.y=200*Math.random()+100,c.z=200*Math.random()+100,a.setRGB(0,0,Math.random()+.1)):"sphere"==g&&(k=new THREE.IcosahedronGeometry(1,1),c.y=c.z=c.x,a.setRGB(Math.random()+.1,0,0));b(k,a);a=new THREE.Mesh(k);a.position.copy(e);a.rotation.copy(f);a.scale.copy(c);a.updateMatrix();h.merge(a.geometry,a.matrix)}return h}
function Scene(g,l,b,h,d,e){this.clearColor=e;this.camera=new THREE.PerspectiveCamera(h,window.innerWidth/window.innerHeight,1,1E4);this.camera.position.z=b;this.scene=new THREE.Scene;this.scene.add(new THREE.AmbientLight(5592405));b=new THREE.SpotLight(16777215,1.5);b.position.set(0,500,2E3);this.scene.add(b);this.rotationSpeed=d;d=new THREE.MeshPhongMaterial({color:16777215,flatShading:!0,vertexColors:THREE.VertexColors});this.mesh=new THREE.Mesh(generateGeometry(g,l),d);this.scene.add(this.mesh);
this.fbo=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1});this.render=function(b,c){this.mesh.rotation.x+=b*this.rotationSpeed.x;this.mesh.rotation.y+=b*this.rotationSpeed.y;this.mesh.rotation.z+=b*this.rotationSpeed.z;renderer.setClearColor(this.clearColor);c?renderer.render(this.scene,this.camera,this.fbo,!0):renderer.render(this.scene,this.camera)}};