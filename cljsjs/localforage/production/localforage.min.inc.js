(function(H){"object"===typeof exports&&"undefined"!==typeof module?module.exports=H():"function"===typeof define&&define.amd?define([],H):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).localforage=H()})(function(){return function w(u,r,h){function d(f,z){if(!r[f]){if(!u[f]){var t="function"==typeof require&&require;if(!z&&t)return t(f,!0);if(m)return m(f,!0);t=Error("Cannot find module '"+f+"'");throw t.code="MODULE_NOT_FOUND",t;}t=r[f]=
{exports:{}};u[f][0].call(t.exports,function(h){var q=u[f][1][h];return d(q?q:h)},t,t.exports,w,u,r,h)}return r[f].exports}for(var m="function"==typeof require&&require,f=0;f<h.length;f++)d(h[f]);return d}({1:[function(w,u,r){(function(h){function d(){x=!0;for(var d,f,h=q.length;h;){f=q;q=[];for(d=-1;++d<h;)f[d]();h=q.length}x=!1}var m=h.MutationObserver||h.WebKitMutationObserver,f;if(m){var r=0,m=new m(d),w=h.document.createTextNode("");m.observe(w,{characterData:!0});f=function(){w.data=r=++r%2}}else if(h.setImmediate||
"undefined"===typeof h.MessageChannel)f="document"in h&&"onreadystatechange"in h.document.createElement("script")?function(){var f=h.document.createElement("script");f.onreadystatechange=function(){d();f.onreadystatechange=null;f.parentNode.removeChild(f);f=null};h.document.documentElement.appendChild(f)}:function(){setTimeout(d,0)};else{var t=new h.MessageChannel;t.port1.onmessage=d;f=function(){t.port2.postMessage(0)}}var x,q=[];u.exports=function(d){1!==q.push(d)||x||f()}}).call(this,"undefined"!==
typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],2:[function(w,u,r){function h(){}function d(g){if("function"!==typeof g)throw new TypeError("resolver must be a function");this.state=G;this.queue=[];this.outcome=void 0;g!==h&&z(this,g)}function m(g,d,f){this.promise=g;"function"===typeof d&&(this.onFulfilled=d,this.callFulfilled=this.otherCallFulfilled);"function"===typeof f&&(this.onRejected=f,this.callRejected=this.otherCallRejected)}function f(g,d,
f){x(function(){var h;try{h=d(f)}catch(m){return q.reject(g,m)}h===g?q.reject(g,new TypeError("Cannot resolve promise with itself")):q.resolve(g,h)})}function I(g){var d=g&&g.then;if(g&&"object"===typeof g&&"function"===typeof d)return function(){d.apply(g,arguments)}}function z(g,d){function f(d){m||(m=!0,q.reject(g,d))}function h(d){m||(m=!0,q.resolve(g,d))}var m=!1,r=t(function(){d(h,f)});"error"===r.status&&f(r.value)}function t(g,d){var f={};try{f.value=g(d),f.status="success"}catch(h){f.status=
"error",f.value=h}return f}var x=w(1),q={},B=["REJECTED"],C=["FULFILLED"],G=["PENDING"];u.exports=r=d;d.prototype["catch"]=function(g){return this.then(null,g)};d.prototype.then=function(g,d){if("function"!==typeof g&&this.state===C||"function"!==typeof d&&this.state===B)return this;var q=new this.constructor(h);this.state!==G?f(q,this.state===C?g:d,this.outcome):this.queue.push(new m(q,g,d));return q};m.prototype.callFulfilled=function(g){q.resolve(this.promise,g)};m.prototype.otherCallFulfilled=
function(g){f(this.promise,this.onFulfilled,g)};m.prototype.callRejected=function(g){q.reject(this.promise,g)};m.prototype.otherCallRejected=function(g){f(this.promise,this.onRejected,g)};q.resolve=function(g,d){var f=t(I,d);if("error"===f.status)return q.reject(g,f.value);if(f=f.value)z(g,f);else{g.state=C;g.outcome=d;for(var f=-1,h=g.queue.length;++f<h;)g.queue[f].callFulfilled(d)}return g};q.reject=function(g,d){g.state=B;g.outcome=d;for(var f=-1,h=g.queue.length;++f<h;)g.queue[f].callRejected(d);
return g};r.resolve=function(g){return g instanceof this?g:q.resolve(new this(h),g)};r.reject=function(g){var d=new this(h);return q.reject(d,g)};r.all=function(d){function f(d,g){m.resolve(d).then(function(d){u[g]=d;++w!==r||t||(t=!0,q.resolve(k,u))},function(d){t||(t=!0,q.reject(k,d))})}var m=this;if("[object Array]"!==Object.prototype.toString.call(d))return this.reject(new TypeError("must be an array"));var r=d.length,t=!1;if(!r)return this.resolve([]);for(var u=Array(r),w=0,x=-1,k=new this(h);++x<
r;)f(d[x],x);return k};r.race=function(d){function f(d){m.resolve(d).then(function(d){t||(t=!0,q.resolve(w,d))},function(d){t||(t=!0,q.reject(w,d))})}var m=this;if("[object Array]"!==Object.prototype.toString.call(d))return this.reject(new TypeError("must be an array"));var r=d.length,t=!1;if(!r)return this.resolve([]);for(var u=-1,w=new this(h);++u<r;)f(d[u]);return w}},{1:1}],3:[function(w,u,r){u="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:
{};"function"!==typeof u.Promise&&(u.Promise=w(2))},{2:2}],4:[function(w,u,r){function h(a,b){a=a||[];b=b||{};try{return new Blob(a,b)}catch(p){if("TypeError"!==p.name)throw p;for(var c=new ("undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),e=0;e<a.length;e+=1)c.append(a[e]);return c.getBlob(b.type)}}function d(a,b){b&&a.then(function(a){b(null,a)},function(a){b(a)})}function m(a,b,c){"function"===
typeof b&&a.then(b);if("function"===typeof c)a["catch"](c)}function f(a){"string"!==typeof a&&(console.warn(a+" used as a key, but it is not a string."),a=String(a));return a}function I(a){return(new k(function(b){var c=a.transaction("local-forage-detect-blob-support","readwrite"),e=h([""]);c.objectStore("local-forage-detect-blob-support").put(e,"key");c.onabort=function(a){a.preventDefault();a.stopPropagation();b(!1)};c.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),c=navigator.userAgent.match(/Edge\//);
b(c||!a||43<=parseInt(a[1],10))}}))["catch"](function(){return!1})}function z(a){return"boolean"===typeof L?k.resolve(L):I(a).then(function(b){return L=b})}function t(a){a=y[a.name];var b={};b.promise=new k(function(a){b.resolve=a});a.deferredOperations.push(b);a.dbReady=a.dbReady?a.dbReady.then(function(){return b.promise}):b.promise}function x(a,b){return new k(function(c,e){if(a.db)if(b)t(a),a.db.close();else return c(a.db);var p=[a.name];b&&p.push(a.version);var n=M.open.apply(M,p);b&&(n.onupgradeneeded=
function(b){var c=n.result;try{c.createObjectStore(a.storeName),1>=b.oldVersion&&c.createObjectStore("local-forage-detect-blob-support")}catch(e){if("ConstraintError"===e.name)console.warn('The database "'+a.name+'" has been upgraded from version '+b.oldVersion+" to version "+b.newVersion+', but the storage "'+a.storeName+'" already exists.');else throw e;}});n.onerror=function(b){b.preventDefault();e(n.error)};n.onsuccess=function(){c(n.result);var b=y[a.name].deferredOperations.pop();b&&b.resolve()}})}
function q(a){return new k(function(b,c){var e=new FileReader;e.onerror=c;e.onloadend=function(c){c=btoa(c.target.result||"");b({__local_forage_encoded_blob:!0,data:c,type:a.type})};e.readAsBinaryString(a)})}function B(a){for(var b=atob(a.data),c=b.length,e=new ArrayBuffer(c),p=new Uint8Array(e),n=0;n<c;n++)p[n]=b.charCodeAt(n);return h([e],{type:a.type})}function C(a){var b=this,c=b._initReady().then(function(){var a=y[b._dbInfo.name];if(a&&a.dbReady)return a.dbReady});m(c,a,a);return c}function G(a){t(a);
for(var b=y[a.name].forages,c=0;c<b.length;c++)b[c]._dbInfo.db&&(b[c]._dbInfo.db.close(),b[c]._dbInfo.db=null);return x(a,!1).then(function(a){for(var c=0;c<b.length;c++)b[c]._dbInfo.db=a})["catch"](function(b){var c=y[a.name].deferredOperations.pop();c&&c.reject(b);throw b;})}function g(a,b,c){try{var e=a.db.transaction(a.storeName,b);c(null,e)}catch(p){if(!a.db||"InvalidStateError"===p.name)return G(a).then(function(){var e=a.db.transaction(a.storeName,b);c(null,e)});c(p)}}function P(a){var b=.75*
a.length,c=a.length,e=0,p,n,d,l;"\x3d"===a[a.length-1]&&(b--,"\x3d"===a[a.length-2]&&b--);for(var D=new ArrayBuffer(b),v=new Uint8Array(D),b=0;b<c;b+=4)p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[b]),n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[b+1]),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[b+2]),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a[b+3]),v[e++]=p<<2|
n>>4,v[e++]=(n&15)<<4|d>>2,v[e++]=(d&3)<<6|l&63;return D}function J(a){a=new Uint8Array(a);var b="",c;for(c=0;c<a.length;c+=3)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a[c]>>2],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(a[c]&3)<<4|a[c+1]>>4],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(a[c+1]&15)<<2|a[c+2]>>6],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a[c+2]&63];2===a.length%3?b=b.substring(0,
b.length-1)+"\x3d":1===a.length%3&&(b=b.substring(0,b.length-2)+"\x3d\x3d");return b}function Q(a,b,c,e){var p=this;a=f(a);var n=new k(function(n,d){p.ready().then(function(){void 0===b&&(b=null);var D=b,v=p._dbInfo;v.serializer.serialize(b,function(b,f){f?d(f):v.db.transaction(function(c){c.executeSql("INSERT OR REPLACE INTO "+v.storeName+" (key, value) VALUES (?, ?)",[a,b],function(){n(D)},function(b,a){d(a)})},function(b){b.code===b.QUOTA_ERR&&(0<e?n(Q.apply(p,[a,D,c,e-1])):d(b))})})})["catch"](d)});
d(n,c);return n}function V(a,b){a[b]=function(){var c=arguments;return a.ready().then(function(){return a[b].apply(a,c)})}}function K(){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var c in b)b.hasOwnProperty(c)&&(R(b[c])?arguments[0][c]=b[c].slice():arguments[0][c]=b[c])}return arguments[0]}var W="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?
"symbol":typeof a},M=function(){if("undefined"!==typeof indexedDB)return indexedDB;if("undefined"!==typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!==typeof mozIndexedDB)return mozIndexedDB;if("undefined"!==typeof OIndexedDB)return OIndexedDB;if("undefined"!==typeof msIndexedDB)return msIndexedDB}();"undefined"===typeof Promise&&w(3);var k=Promise,L,y,X=Object.prototype.toString;w={_driver:"asyncStorage",_initStorage:function(a){function b(){return k.resolve()}var c=this,e={db:null};
if(a)for(var p in a)e[p]=a[p];y||(y={});var n=y[e.name];n||(n={forages:[],db:null,dbReady:null,deferredOperations:[]},y[e.name]=n);n.forages.push(c);c._initReady||(c._initReady=c.ready,c.ready=C);a=[];for(p=0;p<n.forages.length;p++){var d=n.forages[p];d!==c&&a.push(d._initReady()["catch"](b))}var l=n.forages.slice(0);return k.all(a).then(function(){e.db=n.db;return x(e,!1)}).then(function(b){e.db=b;var a;a=c._defaultConfig.version;if(e.db){var p=!e.db.objectStoreNames.contains(e.storeName),n=e.version>
e.db.version;e.version<e.db.version&&(e.version!==a&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version);n||p?(p&&(a=e.db.version+1,a>e.version&&(e.version=a)),a=!0):a=!1}else a=!0;return a?x(e,!0):b}).then(function(b){e.db=n.db=b;c._dbInfo=e;for(b=0;b<l.length;b++){var a=l[b];a!==c&&(a._dbInfo.db=e.db,a._dbInfo.version=e.version)}})},_support:function(){try{if(!M)return!1;var a="undefined"!==typeof openDatabase&&
/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b="function"===typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!a||b)&&"undefined"!==typeof indexedDB&&"undefined"!==typeof IDBKeyRange}catch(c){return!1}}(),iterate:function(a,b){var c=this,e=new k(function(b,e){c.ready().then(function(){g(c._dbInfo,"readonly",function(d,l){if(d)return e(d);try{var f=l.objectStore(c._dbInfo.storeName).openCursor(),
v=1;f.onsuccess=function(){var c=f.result;if(c){var e=c.value;e&&e.__local_forage_encoded_blob&&(e=B(e));e=a(e,c.key,v++);if(void 0!==e)b(e);else c["continue"]()}else b()};f.onerror=function(){e(f.error)}}catch(g){e(g)}})})["catch"](e)});d(e,b);return e},getItem:function(a,b){var c=this;a=f(a);var e=new k(function(b,e){c.ready().then(function(){g(c._dbInfo,"readonly",function(d,l){if(d)return e(d);try{var f=l.objectStore(c._dbInfo.storeName).get(a);f.onsuccess=function(){var a=f.result;void 0===a&&
(a=null);a&&a.__local_forage_encoded_blob&&(a=B(a));b(a)};f.onerror=function(){e(f.error)}}catch(v){e(v)}})})["catch"](e)});d(e,b);return e},setItem:function(a,b,c){var e=this;a=f(a);var p=new k(function(c,p){var d;e.ready().then(function(){d=e._dbInfo;return"[object Blob]"===X.call(b)?z(d.db).then(function(a){return a?b:q(b)}):b}).then(function(b){g(e._dbInfo,"readwrite",function(d,f){if(d)return p(d);try{var l=f.objectStore(e._dbInfo.storeName).put(b,a);null===b&&(b=void 0);f.oncomplete=function(){void 0===
b&&(b=null);c(b)};f.onabort=f.onerror=function(){p(l.error?l.error:l.transaction.error)}}catch(g){p(g)}})})["catch"](p)});d(p,c);return p},removeItem:function(a,b){var c=this;a=f(a);var e=new k(function(b,e){c.ready().then(function(){g(c._dbInfo,"readwrite",function(d,f){if(d)return e(d);try{var g=f.objectStore(c._dbInfo.storeName)["delete"](a);f.oncomplete=function(){b()};f.onerror=function(){e(g.error)};f.onabort=function(){e(g.error?g.error:g.transaction.error)}}catch(v){e(v)}})})["catch"](e)});
d(e,b);return e},clear:function(a){var b=this,c=new k(function(a,c){b.ready().then(function(){g(b._dbInfo,"readwrite",function(d,f){if(d)return c(d);try{var l=f.objectStore(b._dbInfo.storeName).clear();f.oncomplete=function(){a()};f.onabort=f.onerror=function(){c(l.error?l.error:l.transaction.error)}}catch(g){c(g)}})})["catch"](c)});d(c,a);return c},length:function(a){var b=this,c=new k(function(a,c){b.ready().then(function(){g(b._dbInfo,"readonly",function(d,f){if(d)return c(d);try{var l=f.objectStore(b._dbInfo.storeName).count();
l.onsuccess=function(){a(l.result)};l.onerror=function(){c(l.error)}}catch(g){c(g)}})})["catch"](c)});d(c,a);return c},key:function(a,b){var c=this,e=new k(function(b,e){if(0>a)b(null);else c.ready().then(function(){g(c._dbInfo,"readonly",function(d,f){if(d)return e(d);try{var g=!1,v=f.objectStore(c._dbInfo.storeName).openCursor();v.onsuccess=function(){var c=v.result;c?0===a?b(c.key):g?b(c.key):(g=!0,c.advance(a)):b(null)};v.onerror=function(){e(v.error)}}catch(h){e(h)}})})["catch"](e)});d(e,b);
return e},keys:function(a){var b=this,c=new k(function(a,c){b.ready().then(function(){g(b._dbInfo,"readonly",function(d,f){if(d)return c(d);try{var g=f.objectStore(b._dbInfo.storeName).openCursor(),h=[];g.onsuccess=function(){var b=g.result;b?(h.push(b.key),b["continue"]()):a(h)};g.onerror=function(){c(g.error)}}catch(v){c(v)}})})["catch"](c)});d(c,a);return c}};var S=/^~~local_forage_type~([^~]+)~/,T=Object.prototype.toString,N={serialize:function(a,b){var c="";a&&(c=T.call(a));if(a&&("[object ArrayBuffer]"===
c||a.buffer&&"[object ArrayBuffer]"===T.call(a.buffer))){var e,d="__lfsc__:";a instanceof ArrayBuffer?(e=a,d+="arbf"):(e=a.buffer,"[object Int8Array]"===c?d+="si08":"[object Uint8Array]"===c?d+="ui08":"[object Uint8ClampedArray]"===c?d+="uic8":"[object Int16Array]"===c?d+="si16":"[object Uint16Array]"===c?d+="ur16":"[object Int32Array]"===c?d+="si32":"[object Uint32Array]"===c?d+="ui32":"[object Float32Array]"===c?d+="fl32":"[object Float64Array]"===c?d+="fl64":b(Error("Failed to get type for BinaryArray")));
b(d+J(e))}else if("[object Blob]"===c)c=new FileReader,c.onload=function(){var c="~~local_forage_type~"+a.type+"~"+J(this.result);b("__lfsc__:blob"+c)},c.readAsArrayBuffer(a);else try{b(JSON.stringify(a))}catch(f){console.error("Couldn't convert value into a JSON string: ",a),b(null,f)}},deserialize:function(a){if("__lfsc__:"!==a.substring(0,9))return JSON.parse(a);var b=a.substring(13);a=a.substring(9,13);var c;if("blob"===a&&S.test(b)){var e=b.match(S);c=e[1];b=b.substring(e[0].length)}b=P(b);switch(a){case "arbf":return b;
case "blob":return h([b],{type:c});case "si08":return new Int8Array(b);case "ui08":return new Uint8Array(b);case "uic8":return new Uint8ClampedArray(b);case "si16":return new Int16Array(b);case "ur16":return new Uint16Array(b);case "si32":return new Int32Array(b);case "ui32":return new Uint32Array(b);case "fl32":return new Float32Array(b);case "fl64":return new Float64Array(b);default:throw Error("Unkown type: "+a);}},stringToBuffer:P,bufferToString:J};r={_driver:"webSQLStorage",_initStorage:function(a){var b=
this,c={db:null};if(a)for(var e in a)c[e]="string"!==typeof a[e]?a[e].toString():a[e];a=new k(function(a,e){try{c.db=openDatabase(c.name,String(c.version),c.description,c.size)}catch(d){return e(d)}c.db.transaction(function(d){d.executeSql("CREATE TABLE IF NOT EXISTS "+c.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){b._dbInfo=c;a()},function(b,a){e(a)})})});c.serializer=N;return a},_support:"function"===typeof openDatabase,iterate:function(a,b){var c=this,e=new k(function(b,
e){c.ready().then(function(){var d=c._dbInfo;d.db.transaction(function(c){c.executeSql("SELECT * FROM "+d.storeName,[],function(c,e){for(var f=e.rows,g=f.length,n=0;n<g;n++){var l=f.item(n),h=l.value;h&&(h=d.serializer.deserialize(h));h=a(h,l.key,n+1);if(void 0!==h){b(h);return}}b()},function(b,a){e(a)})})})["catch"](e)});d(e,b);return e},getItem:function(a,b){var c=this;a=f(a);var e=new k(function(b,e){c.ready().then(function(){var d=c._dbInfo;d.db.transaction(function(c){c.executeSql("SELECT * FROM "+
d.storeName+" WHERE key \x3d ? LIMIT 1",[a],function(a,c){var e=c.rows.length?c.rows.item(0).value:null;e&&(e=d.serializer.deserialize(e));b(e)},function(b,a){e(a)})})})["catch"](e)});d(e,b);return e},setItem:function(a,b,c){return Q.apply(this,[a,b,c,1])},removeItem:function(a,b){var c=this;a=f(a);var e=new k(function(b,e){c.ready().then(function(){var d=c._dbInfo;d.db.transaction(function(c){c.executeSql("DELETE FROM "+d.storeName+" WHERE key \x3d ?",[a],function(){b()},function(b,a){e(a)})})})["catch"](e)});
d(e,b);return e},clear:function(a){var b=this,c=new k(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("DELETE FROM "+d.storeName,[],function(){a()},function(b,a){c(a)})})})["catch"](c)});d(c,a);return c},length:function(a){var b=this,c=new k(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("SELECT COUNT(key) as c FROM "+d.storeName,[],function(b,c){var d=c.rows.item(0).c;a(d)},function(b,a){c(a)})})})["catch"](c)});
d(c,a);return c},key:function(a,b){var c=this,e=new k(function(b,e){c.ready().then(function(){var d=c._dbInfo;d.db.transaction(function(c){c.executeSql("SELECT key FROM "+d.storeName+" WHERE id \x3d ? LIMIT 1",[a+1],function(a,c){var e=c.rows.length?c.rows.item(0).key:null;b(e)},function(b,a){e(a)})})})["catch"](e)});d(e,b);return e},keys:function(a){var b=this,c=new k(function(a,c){b.ready().then(function(){var d=b._dbInfo;d.db.transaction(function(b){b.executeSql("SELECT key FROM "+d.storeName,
[],function(b,c){for(var d=[],f=0;f<c.rows.length;f++)d.push(c.rows.item(f).key);a(d)},function(b,a){c(a)})})})["catch"](c)});d(c,a);return c}};var E;try{E="undefined"!==typeof localStorage&&"setItem"in localStorage&&"function"===typeof localStorage.setItem}catch(a){E=!1}var R=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},F={},U={},A={INDEXEDDB:w,WEBSQL:r,LOCALSTORAGE:{_driver:"localStorageWrapper",_initStorage:function(a){var b={};if(a)for(var c in a)b[c]=
a[c];b.keyPrefix=b.name+"/";b.storeName!==this._defaultConfig.storeName&&(b.keyPrefix+=b.storeName+"/");var e;try{localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),e=!1}catch(d){e=!0}if(e&&!(0<localStorage.length))return k.reject();this._dbInfo=b;b.serializer=N;return k.resolve()},_support:E,iterate:function(a,b){var c=this,e=c.ready().then(function(){for(var b=c._dbInfo,e=b.keyPrefix,d=e.length,f=localStorage.length,g=1,h=0;h<f;h++){var k=localStorage.key(h);
if(0===k.indexOf(e)){var m=localStorage.getItem(k);m&&(m=b.serializer.deserialize(m));m=a(m,k.substring(d),g++);if(void 0!==m)return m}}});d(e,b);return e},getItem:function(a,b){var c=this;a=f(a);var e=c.ready().then(function(){var b=c._dbInfo,e=localStorage.getItem(b.keyPrefix+a);e&&(e=b.serializer.deserialize(e));return e});d(e,b);return e},setItem:function(a,b,c){var e=this;a=f(a);var g=e.ready().then(function(){void 0===b&&(b=null);var c=b;return new k(function(d,f){var g=e._dbInfo;g.serializer.serialize(b,
function(b,e){if(e)f(e);else try{localStorage.setItem(g.keyPrefix+a,b),d(c)}catch(h){"QuotaExceededError"!==h.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==h.name||f(h),f(h)}})})});d(g,c);return g},removeItem:function(a,b){var c=this;a=f(a);var e=c.ready().then(function(){localStorage.removeItem(c._dbInfo.keyPrefix+a)});d(e,b);return e},clear:function(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo.keyPrefix,c=localStorage.length-1;0<=c;c--){var d=localStorage.key(c);0===d.indexOf(a)&&localStorage.removeItem(d)}});
d(c,a);return c},length:function(a){var b=this.keys().then(function(b){return b.length});d(b,a);return b},key:function(a,b){var c=this,e=c.ready().then(function(){var b=c._dbInfo,e;try{e=localStorage.key(a)}catch(d){e=null}e&&(e=e.substring(b.keyPrefix.length));return e});d(e,b);return e},keys:function(a){var b=this,c=b.ready().then(function(){for(var a=b._dbInfo,c=localStorage.length,d=[],f=0;f<c;f++){var g=localStorage.key(f);0===g.indexOf(a.keyPrefix)&&d.push(g.substring(a.keyPrefix.length))}return d});
d(c,a);return c}}},O="clear getItem iterate key keys length removeItem setItem".split(" "),Y={description:"",driver:[A.INDEXEDDB._driver,A.WEBSQL._driver,A.LOCALSTORAGE._driver].slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};E=new (function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");for(var c in A)if(A.hasOwnProperty(c)){var e=A[c],d=e._driver;this[c]=d;F[d]||this.defineDriver(e)}this._defaultConfig=K({},Y);this._config=
K({},this._defaultConfig,b);this._initDriver=this._driverSet=null;this._ready=!1;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver)["catch"](function(){})}a.prototype.config=function(b){if("object"===("undefined"===typeof b?"undefined":W(b))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var a in b){"storeName"===a&&(b[a]=b[a].replace(/\W/g,"_"));if("version"===a&&"number"!==typeof b[a])return Error("Database version must be a number.");
this._config[a]=b[a]}return"driver"in b&&b.driver?this.setDriver(this._config.driver):!0}return"string"===typeof b?this._config[b]:this._config};a.prototype.defineDriver=function(b,a,e){var d=new k(function(a,c){try{var e=b._driver,d=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(b._driver){for(var f=O.concat("_initStorage"),g=0,h=f.length;g<h;g++){var k=f[g];if(!k||!b[k]||"function"!==typeof b[k]){c(d);return}}d=function(c){F[e]&&console.info("Redefining LocalForage driver: "+
e);F[e]=b;U[e]=c;a()};"_support"in b?b._support&&"function"===typeof b._support?b._support().then(d,c):d(!!b._support):d(!0)}else c(d)}catch(p){c(p)}});m(d,a,e);return d};a.prototype.driver=function(){return this._driver||null};a.prototype.getDriver=function(b,a,d){b=F[b]?k.resolve(F[b]):k.reject(Error("Driver not found."));m(b,a,d);return b};a.prototype.getSerializer=function(b){var a=k.resolve(N);m(a,b);return a};a.prototype.ready=function(b){var a=this,d=a._driverSet.then(function(){null===a._ready&&
(a._ready=a._initDriver());return a._ready});m(d,b,b);return d};a.prototype.setDriver=function(a,c,d){function f(){l._config.driver=l.driver()}function g(a){l._extend(a);f();l._ready=l._initStorage(l._config);return l._ready}function h(a){return function(){function b(){for(;c<a.length;){var d=a[c];c++;l._dbInfo=null;l._ready=null;return l.getDriver(d).then(g)["catch"](b)}f();l._driverSet=k.reject(Error("No available storage method found."));return l._driverSet}var c=0;return b()}}var l=this;R(a)||
(a=[a]);var q=this._getSupportedDrivers(a);this._driverSet=(null!==this._driverSet?this._driverSet["catch"](function(){return k.resolve()}):k.resolve()).then(function(){var a=q[0];l._dbInfo=null;l._ready=null;return l.getDriver(a).then(function(a){l._driver=a._driver;f();l._wrapLibraryMethodsWithReady();l._initDriver=h(q)})})["catch"](function(){f();l._driverSet=k.reject(Error("No available storage method found."));return l._driverSet});m(this._driverSet,c,d);return this._driverSet};a.prototype.supports=
function(a){return!!U[a]};a.prototype._extend=function(a){K(this,a)};a.prototype._getSupportedDrivers=function(a){for(var c=[],d=0,f=a.length;d<f;d++){var g=a[d];this.supports(g)&&c.push(g)}return c};a.prototype._wrapLibraryMethodsWithReady=function(){for(var a=0,c=O.length;a<c;a++)V(this,O[a])};a.prototype.createInstance=function(b){return new a(b)};return a}());u.exports=E},{3:3}]},{},[4])(4)});