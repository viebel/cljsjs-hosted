(function(g,b){"object"===typeof exports&&"object"===typeof module?module.exports=b():"function"===typeof define&&define.amd?define("htmlScreenCaptureJs",[],b):"object"===typeof exports?exports.htmlScreenCaptureJs=b():g.htmlScreenCaptureJs=b()})("undefined"!==typeof self?self:this,function(){return function(g){function b(k){if(c[k])return c[k].exports;var d=c[k]={i:k,l:!1,exports:{}};g[k].call(d.exports,d,d.exports,b);d.l=!0;return d.exports}var c={};b.m=g;b.c=c;b.d=function(c,d,a){b.o(c,d)||Object.defineProperty(c,
d,{configurable:!1,enumerable:!0,get:a})};b.n=function(c){var d=c&&c.__esModule?function(){return c["default"]}:function(){return c};b.d(d,"a",d);return d};b.o=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};b.p="";return b(b.s=1)}([function(g,b,c){Object.defineProperty(b,"__esModule",{value:!0});b.default=function d(){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.OBJECT="OBJECT";this.STRING="STRING";this.URI="URI";this.BASE64="BASE64"};g.exports=
b["default"]},function(g,b,c){Object.defineProperty(b,"__esModule",{value:!0});b.OutputType=void 0;b.capture=function(b,a,c){return(new k.default).capture(b,a,c)};g=(g=c(0))&&g.__esModule?g:{default:g};var k=(c=c(2))&&c.__esModule?c:{default:c};b.OutputType=new g.default},function(g,b,c){function k(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(l,f){for(var e=0;e<f.length;e++){var m=f[e];m.enumerable=m.enumerable||!1;m.configurable=
!0;"value"in m&&(m.writable=!0);Object.defineProperty(l,m.key,m)}}return function(l,f,e){f&&a(l.prototype,f);e&&a(l,e);return l}}(),a=c(3),p=k(a),a=c(4),n=k(a);c=c(0);var h=k(c);c=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._logger=new p.default;this._isHead=!0;this._classMap={};this._classCount=0;this._shouldHandleImgDataUrl=!0;this._doc=this._ctx=this._canvas=null;this._options={tagsOfIgnoredDocHeadElements:["script","link","style"],
tagsOfIgnoredDocBodyElements:["script"],classesOfIgnoredDocBodyElements:[],attrKeyValuePairsOfIgnoredElements:{},tagsOfSkippedElementsForChildTreeCssHandling:["svg"],attrKeyForSavingElementOrigClass:"_class",attrKeyForSavingElementOrigStyle:"_style",prefixForNewGeneratedClasses:"c",imageFormatForDataUrl:"image/png",imageQualityForDataUrl:.92,rulesToAddToDocStyle:['*{font-family:"Arial Narrow" !important;}']}}d(a,[{key:"_overrideOptions",value:function(l){if(l)for(var a in l)l.hasOwnProperty(a)&&(this._options[a]=
l[a])}},{key:"_getImgDataUrl",value:function(l){var a="";try{this._canvas||(this._canvas=this._doc.createElement("canvas"),this._ctx=this._canvas.getContext("2d")),this._canvas.width=l.clientWidth,this._canvas.height=l.clientHeight,this._ctx.drawImage(l,0,0),a=this._canvas.toDataURL(this._options.imageFormatForDataUrl,this._options.imageQualityForDataUrl)}catch(e){this._logger.warn("getImgDataUrl() - "+e.message),this._shouldHandleImgDataUrl=!1}return a}},{key:"_getClasses",value:function(a){var f=
[];(a=a.className instanceof SVGAnimatedString?a.className.baseVal:a.className)&&a.split(" ").forEach(function(a){a&&f.push(a)});return f}},{key:"_getClassName",value:function(a){a=a.className;return a instanceof SVGAnimatedString?a.baseVal:a}},{key:"_handleElmCss",value:function(a,f){0<this._getClasses(f).length&&(this._options.attrKeyForSavingElementOrigClass&&f.setAttribute(this._options.attrKeyForSavingElementOrigClass,this._getClassName(f)),f.removeAttribute("class"));f.getAttribute("style")&&
(this._options.attrKeyForSavingElementOrigStyle&&f.setAttribute(this._options.attrKeyForSavingElementOrigStyle,f.getAttribute("style")),f.removeAttribute("style"));for(var e=getComputedStyle(a),m="",b=0;b<e.length;b++){var c=e.item(b),d=e.getPropertyValue(c),c=c+":"+d,d=this._classMap[c];d||(this._classCount++,d=(this._options.prefixForNewGeneratedClasses?this._options.prefixForNewGeneratedClasses:"c")+this._classCount,this._classMap[c]=d);m+=d+" "}m&&f.setAttribute("class",m.trim())}},{key:"_appendNewStyle",
value:function(a){var f=this._doc.createElement("style");f.type="text/css";var e=this._options.rulesToAddToDocStyle?this._options.rulesToAddToDocStyle.join(""):"",b;for(b in this._classMap)this._classMap.hasOwnProperty(b)&&(e+="."+this._classMap[b]+"{"+b+"}");f.styleSheet?f.styleSheet.cssText=e:f.appendChild(this._doc.createTextNode(e));a.children[0].appendChild(f)}},{key:"_shouldIgnoreElm",value:function(a){var b=this,e=!1;if(this._isHead&&this._options.tagsOfIgnoredDocHeadElements&&-1<this._options.tagsOfIgnoredDocHeadElements.indexOf(a.tagName.toLowerCase())||
!this._isHead&&this._options.tagsOfIgnoredDocBodyElements&&-1<this._options.tagsOfIgnoredDocBodyElements.indexOf(a.tagName.toLowerCase()))e=!0;if(!e&&this._options.attrKeyValuePairsOfIgnoredElements)for(var c in this._options.attrKeyValuePairsOfIgnoredElements)if(this._options.attrKeyValuePairsOfIgnoredElements.hasOwnProperty(c))for(var d=0;d<a.attributes.length;d++)a.attributes[d].specified&&a.attributes[d].value===this._options.attrKeyValuePairsOfIgnoredElements[c]&&(e=!0);e||this._isHead||!this._options.classesOfIgnoredDocBodyElements||
this._getClasses(a).forEach(function(a){!e&&-1<b._options.classesOfIgnoredDocBodyElements.indexOf(a)&&(e=!0)});return e}},{key:"_recursiveWalk",value:function(a,b,e){if(this._shouldHandleImgDataUrl&&!this._isHead&&"img"===a.tagName.toLowerCase()){var c=this._getImgDataUrl(a);c&&b.setAttribute("src",c)}e&&(this._handleElmCss(a,b),this._options.tagsOfSkippedElementsForChildTreeCssHandling&&-1<this._options.tagsOfSkippedElementsForChildTreeCssHandling.indexOf(a.tagName.toLowerCase())&&(e=!1));if(a.children)for(c=
a.children.length-1;0<=c;c--)this._shouldIgnoreElm(a.children[c])?b.removeChild(b.children[c]):this._recursiveWalk(a.children[c],b.children[c],e)}},{key:"_createNewHtml",value:function(){var a=this._doc.documentElement.cloneNode(!1);this._handleElmCss(this._doc.documentElement,a);return a}},{key:"_appendNewHead",value:function(a){var b=this._doc.head.cloneNode(!0);this._isHead=!0;this._recursiveWalk(this._doc.head,b,!1);a.appendChild(b)}},{key:"_appendNewBody",value:function(a){var b=this._doc.body.cloneNode(!0);
this._isHead=!1;this._recursiveWalk(this._doc.body,b,!0);a.appendChild(b)}},{key:"_getHtmlObject",value:function(){var a=this._createNewHtml();this._appendNewHead(a);this._appendNewBody(a);this._appendNewStyle(a);return a}},{key:"_prepareOutput",value:function(a,b){var c=null,d=new h.default;if(b&&b!==d.OBJECT){var p=(a?a.outerHTML:"")||"";p&&(b===d.STRING?c=p:b===d.URI?c=n.default.uriEncode(p):b===d.BASE64&&(c=n.default.base64Encode(p)));c=c||""}else c=a;this._logger.isDebug()&&this._logger.debug("output: "+
(c.outerHTML?c.outerHTML:c));return c}},{key:"capture",value:function(a,b,c){var d=null,p=(new Date).getTime();try{this._overrideOptions(c);this._doc=b||document;this._logger.setLogLevel(this._options.logLevel);this._logger.info("capture() outputType: "+a+" - start");var h=this._getHtmlObject(),d=this._prepareOutput(h,a)}catch(n){this._logger.error("capture() - error - "+n.message)}finally{this._logger.info("capture() - end - "+((new Date).getTime()-p)+"ms")}return d}}]);return a}();b.default=c;g.exports=
b["default"]},function(g,b,c){Object.defineProperty(b,"__esModule",{value:!0});var k=function(){function b(a,c){for(var d=0;d<c.length;d++){var h=c[d];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(a,h.key,h)}}return function(a,c,n){c&&b(a.prototype,c);n&&b(a,n);return a}}();c=function(){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this._logLevelNames="debug info warn error fatal off".split(" ");this.init()}
k(b,[{key:"init",value:function(){this._logLevel=this._logLevelNames.indexOf("warn")}},{key:"setLogLevel",value:function(a){a&&-1!==this._logLevelNames.indexOf(a.toLowerCase())&&(this._logLevel=this._logLevelNames.indexOf(a.toLowerCase()))}},{key:"_log",value:function(a,b){this._logLevel<=this._logLevelNames.indexOf(b)&&console.log("|html-screen-capture-js|"+b+"| "+a)}},{key:"isDebug",value:function(){return this._logLevel===this._logLevelNames.indexOf("debug")}},{key:"debug",value:function(a){this._log(a,
"debug")}},{key:"info",value:function(a){this._log(a,"info")}},{key:"warn",value:function(a){this._log(a,"warn")}},{key:"error",value:function(a){this._log(a,"error")}},{key:"fatal",value:function(a){this._log(a,"fatal")}}]);return b}();b.default=c;g.exports=b["default"]},function(g,b,c){Object.defineProperty(b,"__esModule",{value:!0});var k=function(){function b(a,c){for(var d=0;d<c.length;d++){var h=c[d];h.enumerable=h.enumerable||!1;h.configurable=!0;"value"in h&&(h.writable=!0);Object.defineProperty(a,
h.key,h)}}return function(a,c,n){c&&b(a.prototype,c);n&&b(a,n);return a}}();c=function(){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");}k(b,null,[{key:"_utf8_encode",value:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):(127<d&&2048>d?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128))}return b}},
{key:"base64Encode",value:function(a){var c="",g=void 0,h=void 0,k=void 0,l=void 0,f=g=void 0,e=void 0,m=0;for(a=b._utf8_encode(a);m<a.length;)g=a.charCodeAt(m++),h=a.charCodeAt(m++),k=a.charCodeAt(m++),l=g>>2,g=(g&3)<<4|h>>4,f=(h&15)<<2|k>>6,e=k&63,isNaN(h)?f=e=64:isNaN(k)&&(e=64),c=c+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(g)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(f)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(e);return c}},{key:"uriEncode",value:function(a){return(a?encodeURI(a):"")||""}}]);return b}();b.default=c;g.exports=b["default"]}])});