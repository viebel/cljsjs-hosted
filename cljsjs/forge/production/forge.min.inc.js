/*
 almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/almond for details
*/
(function(Q,E){"function"===typeof define&&define.amd?define([],E):Q.forge=E()})(this,function(){var Q,E,l;(function(w){function D(a,p){var b,d,c,g,e,k,m,A,F,q=p&&p.split("/"),u=f.map,h=u&&u["*"]||{};if(a&&"."===a.charAt(0))if(p){q=q.slice(0,q.length-1);a=a.split("/");e=a.length-1;f.nodeIdCompat&&t.test(a[e])&&(a[e]=a[e].replace(t,""));a=q.concat(a);for(e=0;e<a.length;e+=1)if(b=a[e],"."===b)a.splice(e,1),--e;else if(".."===b)if(1!==e||".."!==a[2]&&".."!==a[0])0<e&&(a.splice(e-1,2),e-=2);else break;
a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((q||h)&&u){b=a.split("/");for(e=b.length;0<e;--e){d=b.slice(0,e).join("/");if(q)for(F=q.length;0<F;--F)if(c=u[q.slice(0,F).join("/")])if(c=c[d]){g=c;k=e;break}if(g)break;!m&&h&&h[d]&&(m=h[d],A=e)}!g&&m&&(g=m,k=A);g&&(b.splice(0,k,g),a=b.join("/"))}return a}function v(a,b){return function(){return g.apply(w,p.call(arguments,0).concat([a,b]))}}function C(a){return function(p){return D(p,a)}}function z(a){return function(p){b[a]=p}}function a(a){if(q.call(m,
a)){var p=m[a];delete m[a];u[a]=!0;h.apply(w,p)}if(!q.call(b,a)&&!q.call(u,a))throw Error("No "+a);return b[a]}function e(a){var p,b=a?a.indexOf("!"):-1;-1<b&&(p=a.substring(0,b),a=a.substring(b+1,a.length));return[p,a]}function c(a){return function(){return f&&f.config&&f.config[a]||{}}}var h,g,A,d,b={},m={},f={},u={},q=Object.prototype.hasOwnProperty,p=[].slice,t=/\.js$/;A=function(p,b){var d,f=e(p),t=f[0];p=f[1];t&&(t=D(t,b),d=a(t));t?p=d&&d.normalize?d.normalize(p,C(b)):D(p,b):(p=D(p,b),f=e(p),
t=f[0],p=f[1],t&&(d=a(t)));return{f:t?t+"!"+p:p,n:p,pr:t,p:d}};d={require:function(a){return v(a)},exports:function(a){var p=b[a];return"undefined"!==typeof p?p:b[a]={}},module:function(a){return{id:a,uri:"",exports:b[a],config:c(a)}}};h=function(p,f,n,r){var t,c,g,k,e=[];c=typeof n;var h;r=r||p;if("undefined"===c||"function"===c){f=!f.length&&n.length?["require","exports","module"]:f;for(k=0;k<f.length;k+=1)if(g=A(f[k],r),c=g.f,"require"===c)e[k]=d.require(p);else if("exports"===c)e[k]=d.exports(p),
h=!0;else if("module"===c)t=e[k]=d.module(p);else if(q.call(b,c)||q.call(m,c)||q.call(u,c))e[k]=a(c);else if(g.p)g.p.load(g.n,v(r,!0),z(c),{}),e[k]=b[c];else throw Error(p+" missing "+c);f=n?n.apply(b[p],e):void 0;p&&(t&&t.exports!==w&&t.exports!==b[p]?b[p]=t.exports:f===w&&h||(b[p]=f))}else p&&(b[p]=n)};Q=E=g=function(p,b,n,r,t){if("string"===typeof p)return d[p]?d[p](b):a(A(p,b).f);if(!p.splice){f=p;f.deps&&g(f.deps,f.callback);if(!b)return;b.splice?(p=b,b=n,n=null):p=w}b=b||function(){};"function"===
typeof n&&(n=r,r=t);r?h(w,p,b,n):setTimeout(function(){h(w,p,b,n)},4);return g};g.config=function(a){return g(a)};Q._defined=b;l=function(a,p,d){p.splice||(d=p,p=[]);q.call(b,a)||q.call(m,a)||(m[a]=[a,p,d])};l.amd={jQuery:!0}})();l("node_modules/almond/almond",function(){});(function(){function w(a){function e(a){this.data="";this.read=0;if("string"===typeof a)this.data=a;else if(c.isArrayBuffer(a)||c.isArrayBufferView(a)){a=new Uint8Array(a);try{this.data=String.fromCharCode.apply(null,a)}catch(b){for(var d=
0;d<a.length;++d)this.putByte(a[d])}}else if(a instanceof e||"object"===typeof a&&"string"===typeof a.data&&"number"===typeof a.read)this.data=a.data,this.read=a.read;this._constructedStringLength=0}var c=a.util=a.util||{};(function(){if("undefined"!==typeof process&&process.nextTick)c.nextTick=process.nextTick,c.setImmediate="function"===typeof setImmediate?setImmediate:c.nextTick;else if("function"===typeof setImmediate)c.setImmediate=setImmediate,c.nextTick=function(a){return setImmediate(a)};
else{c.setImmediate=function(a){setTimeout(a,0)};if("undefined"!==typeof window&&"function"===typeof window.postMessage){var a=[];c.setImmediate=function(b){a.push(b);1===a.length&&window.postMessage("forge.setImmediate","*")};window.addEventListener("message",function(b){b.source===window&&"forge.setImmediate"===b.data&&(b.stopPropagation(),b=a.slice(),a.length=0,b.forEach(function(a){a()}))},!0)}if("undefined"!==typeof MutationObserver){var b=Date.now(),d=!0,f=document.createElement("div"),a=[];
(new MutationObserver(function(){var b=a.slice();a.length=0;b.forEach(function(a){a()})})).observe(f,{attributes:!0});var n=c.setImmediate;c.setImmediate=function(r){15<Date.now()-b?(b=Date.now(),n(r)):(a.push(r),1===a.length&&f.setAttribute("a",d=!d))}}c.nextTick=c.setImmediate}})();c.isArray=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};c.isArrayBuffer=function(a){return"undefined"!==typeof ArrayBuffer&&a instanceof ArrayBuffer};c.isArrayBufferView=function(a){return a&&
c.isArrayBuffer(a.buffer)&&void 0!==a.byteLength};c.ByteBuffer=e;c.ByteStringBuffer=e;c.ByteStringBuffer.prototype._optimizeConstructedString=function(a){this._constructedStringLength+=a;4096<this._constructedStringLength&&(this.data.substr(0,1),this._constructedStringLength=0)};c.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};c.ByteStringBuffer.prototype.isEmpty=function(){return 0>=this.length()};c.ByteStringBuffer.prototype.putByte=function(a){return this.putBytes(String.fromCharCode(a))};
c.ByteStringBuffer.prototype.fillWithByte=function(a,b){a=String.fromCharCode(a);for(var d=this.data;0<b;)b&1&&(d+=a),b>>>=1,0<b&&(a+=a);this.data=d;this._optimizeConstructedString(b);return this};c.ByteStringBuffer.prototype.putBytes=function(a){this.data+=a;this._optimizeConstructedString(a.length);return this};c.ByteStringBuffer.prototype.putString=function(a){return this.putBytes(c.encodeUtf8(a))};c.ByteStringBuffer.prototype.putInt16=function(a){return this.putBytes(String.fromCharCode(a>>8&
255)+String.fromCharCode(a&255))};c.ByteStringBuffer.prototype.putInt24=function(a){return this.putBytes(String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255))};c.ByteStringBuffer.prototype.putInt32=function(a){return this.putBytes(String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255))};c.ByteStringBuffer.prototype.putInt16Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>
8&255))};c.ByteStringBuffer.prototype.putInt24Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255))};c.ByteStringBuffer.prototype.putInt32Le=function(a){return this.putBytes(String.fromCharCode(a&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>24&255))};c.ByteStringBuffer.prototype.putInt=function(a,b){var d="";do b-=8,d+=String.fromCharCode(a>>b&255);while(0<b);return this.putBytes(d)};
c.ByteStringBuffer.prototype.putSignedInt=function(a,b){0>a&&(a+=2<<b-1);return this.putInt(a,b)};c.ByteStringBuffer.prototype.putBuffer=function(a){return this.putBytes(a.getBytes())};c.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};c.ByteStringBuffer.prototype.getInt16=function(){var a=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);this.read+=2;return a};c.ByteStringBuffer.prototype.getInt24=function(){var a=this.data.charCodeAt(this.read)<<
16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);this.read+=3;return a};c.ByteStringBuffer.prototype.getInt32=function(){var a=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);this.read+=4;return a};c.ByteStringBuffer.prototype.getInt16Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;this.read+=2;return a};c.ByteStringBuffer.prototype.getInt24Le=
function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;this.read+=3;return a};c.ByteStringBuffer.prototype.getInt32Le=function(){var a=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;this.read+=4;return a};c.ByteStringBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.charCodeAt(this.read++),a-=8;while(0<a);return b};c.ByteStringBuffer.prototype.getSignedInt=
function(a){var b=this.getInt(a);a=2<<a-2;b>=a&&(b-=a<<1);return b};c.ByteStringBuffer.prototype.getBytes=function(a){var b;a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear());return b};c.ByteStringBuffer.prototype.bytes=function(a){return"undefined"===typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)};c.ByteStringBuffer.prototype.at=function(a){return this.data.charCodeAt(this.read+
a)};c.ByteStringBuffer.prototype.setAt=function(a,b){this.data=this.data.substr(0,this.read+a)+String.fromCharCode(b)+this.data.substr(this.read+a+1);return this};c.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};c.ByteStringBuffer.prototype.copy=function(){var a=c.createBuffer(this.data);a.read=this.read;return a};c.ByteStringBuffer.prototype.compact=function(){0<this.read&&(this.data=this.data.slice(this.read),this.read=0);return this};c.ByteStringBuffer.prototype.clear=
function(){this.data="";this.read=0;return this};c.ByteStringBuffer.prototype.truncate=function(a){a=Math.max(0,this.length()-a);this.data=this.data.substr(this.read,a);this.read=0;return this};c.ByteStringBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.length;++b){var d=this.data.charCodeAt(b);16>d&&(a+="0");a+=d.toString(16)}return a};c.ByteStringBuffer.prototype.toString=function(){return c.decodeUtf8(this.bytes())};c.DataBuffer=function(a,b){b=b||{};this.read=b.readOffset||
0;this.growSize=b.growSize||1024;var d=c.isArrayBuffer(a),f=c.isArrayBufferView(a);d||f?(this.data=d?new DataView(a):new DataView(a.buffer,a.byteOffset,a.byteLength),this.write="writeOffset"in b?b.writeOffset:this.data.byteLength):(this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==a&&void 0!==a&&this.putBytes(a),"writeOffset"in b&&(this.write=b.writeOffset))};c.DataBuffer.prototype.length=function(){return this.write-this.read};c.DataBuffer.prototype.isEmpty=function(){return 0>=this.length()};
c.DataBuffer.prototype.accommodate=function(a,b){if(this.length()>=a)return this;b=Math.max(b||this.growSize,a);var d=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),f=new Uint8Array(this.length()+b);f.set(d);this.data=new DataView(f.buffer);return this};c.DataBuffer.prototype.putByte=function(a){this.accommodate(1);this.data.setUint8(this.write++,a);return this};c.DataBuffer.prototype.fillWithByte=function(a,b){this.accommodate(b);for(var d=0;d<b;++d)this.data.setUint8(a);
return this};c.DataBuffer.prototype.putBytes=function(a,b){if(c.isArrayBufferView(a)){var d=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),f=d.byteLength-d.byteOffset;this.accommodate(f);var n=new Uint8Array(this.data.buffer,this.write);n.set(d);this.write+=f;return this}if(c.isArrayBuffer(a))return d=new Uint8Array(a),this.accommodate(d.byteLength),n=new Uint8Array(this.data.buffer),n.set(d,this.write),this.write+=d.byteLength,this;if(a instanceof c.DataBuffer||"object"===typeof a&&"number"===
typeof a.read&&"number"===typeof a.write&&c.isArrayBufferView(a.data))return d=new Uint8Array(a.data.byteLength,a.read,a.length()),this.accommodate(d.byteLength),n=new Uint8Array(a.data.byteLength,this.write),n.set(d),this.write+=d.byteLength,this;a instanceof c.ByteStringBuffer&&(a=a.data,b="binary");b=b||"binary";if("string"===typeof a){if("hex"===b)return this.accommodate(Math.ceil(a.length/2)),d=new Uint8Array(this.data.buffer,this.write),this.write+=c.binary.hex.decode(a,d,this.write),this;if("base64"===
b)return this.accommodate(3*Math.ceil(a.length/4)),d=new Uint8Array(this.data.buffer,this.write),this.write+=c.binary.base64.decode(a,d,this.write),this;"utf8"===b&&(a=c.encodeUtf8(a),b="binary");if("binary"===b||"raw"===b)return this.accommodate(a.length),d=new Uint8Array(this.data.buffer,this.write),this.write+=c.binary.raw.decode(d),this;if("utf16"===b)return this.accommodate(2*a.length),d=new Uint16Array(this.data.buffer,this.write),this.write+=c.text.utf16.encode(d),this;throw Error("Invalid encoding: "+
b);}throw Error("Invalid parameter: "+a);};c.DataBuffer.prototype.putBuffer=function(a){this.putBytes(a);a.clear();return this};c.DataBuffer.prototype.putString=function(a){return this.putBytes(a,"utf16")};c.DataBuffer.prototype.putInt16=function(a){this.accommodate(2);this.data.setInt16(this.write,a);this.write+=2;return this};c.DataBuffer.prototype.putInt24=function(a){this.accommodate(3);this.data.setInt16(this.write,a>>8&65535);this.data.setInt8(this.write,a>>16&255);this.write+=3;return this};
c.DataBuffer.prototype.putInt32=function(a){this.accommodate(4);this.data.setInt32(this.write,a);this.write+=4;return this};c.DataBuffer.prototype.putInt16Le=function(a){this.accommodate(2);this.data.setInt16(this.write,a,!0);this.write+=2;return this};c.DataBuffer.prototype.putInt24Le=function(a){this.accommodate(3);this.data.setInt8(this.write,a>>16&255);this.data.setInt16(this.write,a>>8&65535,!0);this.write+=3;return this};c.DataBuffer.prototype.putInt32Le=function(a){this.accommodate(4);this.data.setInt32(this.write,
a,!0);this.write+=4;return this};c.DataBuffer.prototype.putInt=function(a,b){this.accommodate(b/8);do b-=8,this.data.setInt8(this.write++,a>>b&255);while(0<b);return this};c.DataBuffer.prototype.putSignedInt=function(a,b){this.accommodate(b/8);0>a&&(a+=2<<b-1);return this.putInt(a,b)};c.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};c.DataBuffer.prototype.getInt16=function(){var a=this.data.getInt16(this.read);this.read+=2;return a};c.DataBuffer.prototype.getInt24=
function(){var a=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);this.read+=3;return a};c.DataBuffer.prototype.getInt32=function(){var a=this.data.getInt32(this.read);this.read+=4;return a};c.DataBuffer.prototype.getInt16Le=function(){var a=this.data.getInt16(this.read,!0);this.read+=2;return a};c.DataBuffer.prototype.getInt24Le=function(){var a=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;this.read+=3;return a};c.DataBuffer.prototype.getInt32Le=function(){var a=
this.data.getInt32(this.read,!0);this.read+=4;return a};c.DataBuffer.prototype.getInt=function(a){var b=0;do b=(b<<8)+this.data.getInt8(this.read++),a-=8;while(0<a);return b};c.DataBuffer.prototype.getSignedInt=function(a){var b=this.getInt(a);a=2<<a-2;b>=a&&(b-=a<<1);return b};c.DataBuffer.prototype.getBytes=function(a){var b;a?(a=Math.min(this.length(),a),b=this.data.slice(this.read,this.read+a),this.read+=a):0===a?b="":(b=0===this.read?this.data:this.data.slice(this.read),this.clear());return b};
c.DataBuffer.prototype.bytes=function(a){return"undefined"===typeof a?this.data.slice(this.read):this.data.slice(this.read,this.read+a)};c.DataBuffer.prototype.at=function(a){return this.data.getUint8(this.read+a)};c.DataBuffer.prototype.setAt=function(a,b){this.data.setUint8(a,b);return this};c.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};c.DataBuffer.prototype.copy=function(){return new c.DataBuffer(this)};c.DataBuffer.prototype.compact=function(){if(0<this.read){var a=
new Uint8Array(this.data.buffer,this.read),b=new Uint8Array(a.byteLength);b.set(a);this.data=new DataView(b);this.write-=this.read;this.read=0}return this};c.DataBuffer.prototype.clear=function(){this.data=new DataView(new ArrayBuffer(0));this.read=this.write=0;return this};c.DataBuffer.prototype.truncate=function(a){this.write=Math.max(0,this.length()-a);this.read=Math.min(this.read,this.write);return this};c.DataBuffer.prototype.toHex=function(){for(var a="",b=this.read;b<this.data.byteLength;++b){var d=
this.data.getUint8(b);16>d&&(a+="0");a+=d.toString(16)}return a};c.DataBuffer.prototype.toString=function(a){var b=new Uint8Array(this.data,this.read,this.length());a=a||"utf8";if("binary"===a||"raw"===a)return c.binary.raw.encode(b);if("hex"===a)return c.binary.hex.encode(b);if("base64"===a)return c.binary.base64.encode(b);if("utf8"===a)return c.text.utf8.decode(b);if("utf16"===a)return c.text.utf16.decode(b);throw Error("Invalid encoding: "+a);};c.createBuffer=function(a,b){void 0!==a&&"utf8"===
(b||"raw")&&(a=c.encodeUtf8(a));return new c.ByteBuffer(a)};c.fillString=function(a,b){for(var d="";0<b;)b&1&&(d+=a),b>>>=1,0<b&&(a+=a);return d};c.xorBytes=function(a,b,d){for(var f="",n="",r="",c=0,g=0;0<d;--d,++c)n=a.charCodeAt(c)^b.charCodeAt(c),10<=g&&(f+=r,r="",g=0),r+=String.fromCharCode(n),++g;return f+r};c.hexToBytes=function(a){var b="",d=0;a.length&1&&(d=1,b+=String.fromCharCode(parseInt(a[0],16)));for(;d<a.length;d+=2)b+=String.fromCharCode(parseInt(a.substr(d,2),16));return b};c.bytesToHex=
function(a){return c.createBuffer(a).toHex()};c.int32ToBytes=function(a){return String.fromCharCode(a>>24&255)+String.fromCharCode(a>>16&255)+String.fromCharCode(a>>8&255)+String.fromCharCode(a&255)};var h=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];c.encode64=function(a,b){for(var d="",f="",n,r,c,g=0;g<a.length;)n=
a.charCodeAt(g++),r=a.charCodeAt(g++),c=a.charCodeAt(g++),d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(n>>2),d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt((n&3)<<4|r>>4),isNaN(r)?d+="\x3d\x3d":(d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt((r&15)<<2|c>>6),d+=isNaN(c)?"\x3d":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c&63)),b&&d.length>b&&(f+=d.substr(0,b)+"\r\n",
d=d.substr(b));return f+d};c.decode64=function(a){a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var b="",d,f,n,r,c=0;c<a.length;)d=h[a.charCodeAt(c++)-43],f=h[a.charCodeAt(c++)-43],n=h[a.charCodeAt(c++)-43],r=h[a.charCodeAt(c++)-43],b+=String.fromCharCode(d<<2|f>>4),64!==n&&(b+=String.fromCharCode((f&15)<<4|n>>2),64!==r&&(b+=String.fromCharCode((n&3)<<6|r)));return b};c.encodeUtf8=function(a){return unescape(encodeURIComponent(a))};c.decodeUtf8=function(a){return decodeURIComponent(escape(a))};c.binary=
{raw:{},hex:{},base64:{}};c.binary.raw.encode=function(a){return String.fromCharCode.apply(null,a)};c.binary.raw.decode=function(a,b,d){var f=b;f||(f=new Uint8Array(a.length));for(var n=d=d||0,r=0;r<a.length;++r)f[n++]=a.charCodeAt(r);return b?n-d:f};c.binary.hex.encode=c.bytesToHex;c.binary.hex.decode=function(a,b,d){var f=b;f||(f=new Uint8Array(Math.ceil(a.length/2)));d=d||0;var n=0,r=d;a.length&1&&(n=1,f[r++]=parseInt(a[0],16));for(;n<a.length;n+=2)f[r++]=parseInt(a.substr(n,2),16);return b?r-
d:f};c.binary.base64.encode=function(a,b){for(var d="",f="",n,r,c,g=0;g<a.byteLength;)n=a[g++],r=a[g++],c=a[g++],d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(n>>2),d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt((n&3)<<4|r>>4),isNaN(r)?d+="\x3d\x3d":(d+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt((r&15)<<2|c>>6),d+=isNaN(c)?"\x3d":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d".charAt(c&
63)),b&&d.length>b&&(f+=d.substr(0,b)+"\r\n",d=d.substr(b));return f+d};c.binary.base64.decode=function(a,b,d){var f=b;f||(f=new Uint8Array(3*Math.ceil(a.length/4)));a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");d=d||0;for(var n,r,c,g,e=0,k=d;e<a.length;)n=h[a.charCodeAt(e++)-43],r=h[a.charCodeAt(e++)-43],c=h[a.charCodeAt(e++)-43],g=h[a.charCodeAt(e++)-43],f[k++]=n<<2|r>>4,64!==c&&(f[k++]=(r&15)<<4|c>>2,64!==g&&(f[k++]=(c&3)<<6|g));return b?k-d:f.subarray(0,k)};c.text={utf8:{},utf16:{}};c.text.utf8.encode=
function(a,b,d){a=c.encodeUtf8(a);var f=b;f||(f=new Uint8Array(a.length));for(var n=d=d||0,r=0;r<a.length;++r)f[n++]=a.charCodeAt(r);return b?n-d:f};c.text.utf8.decode=function(a){return c.decodeUtf8(String.fromCharCode.apply(null,a))};c.text.utf16.encode=function(a,b,d){var f=b;f||(f=new Uint8Array(2*a.length));for(var n=new Uint16Array(f.buffer),r=d=d||0,c=d,g=0;g<a.length;++g)n[c++]=a.charCodeAt(g),r+=2;return b?r-d:f};c.text.utf16.decode=function(a){return String.fromCharCode.apply(null,new Uint16Array(a.buffer))};
c.deflate=function(a,b,d){b=c.decode64(a.deflate(c.encode64(b)).rval);d&&(a=2,b.charCodeAt(1)&32&&(a=6),b=b.substring(a,b.length-4));return b};c.inflate=function(a,b,d){a=a.inflate(c.encode64(b)).rval;return null===a?null:c.decode64(a)};var g=function(a,b,d){if(!a)throw Error("WebStorage not available.");null===d?a=a.removeItem(b):(d=c.encode64(JSON.stringify(d)),a=a.setItem(b,d));if("undefined"!==typeof a&&!0!==a.rval)throw b=Error(a.error.message),b.id=a.error.id,b.name=a.error.name,b;},A=function(a,
b){if(!a)throw Error("WebStorage not available.");var d=a.getItem(b);if(a.init)if(null===d.rval){if(d.error){var f=Error(d.error.message);f.id=d.error.id;f.name=d.error.name;throw f;}d=null}else d=d.rval;null!==d&&(d=JSON.parse(c.decode64(d)));return d},d=function(a,b,d,f){var n=A(a,b);null===n&&(n={});n[d]=f;g(a,b,n)},b=function(a,b,d){a=A(a,b);null!==a&&(a=d in a?a[d]:null);return a},m=function(a,b,d){var f=A(a,b);if(null!==f&&d in f){delete f[d];d=!0;for(var n in f){d=!1;break}d&&(f=null);g(a,
b,f)}},f=function(a,b){g(a,b,null)},u=function(a,b,d){var f=null;"undefined"===typeof d&&(d=["web","flash"]);var n,r=!1,c=null,g;for(g in d){n=d[g];try{if("flash"===n||"both"===n){if(null===b[0])throw Error("Flash local storage not available.");f=a.apply(this,b);r="flash"===n}if("web"===n||"both"===n)b[0]=localStorage,f=a.apply(this,b),r=!0}catch(e){c=e}if(r)break}if(!r)throw c;return f};c.setItem=function(a,b,f,c,n){u(d,arguments,n)};c.getItem=function(a,d,f,c){return u(b,arguments,c)};c.removeItem=
function(a,b,d,f){u(m,arguments,f)};c.clearItems=function(a,b,d){u(f,arguments,d)};c.parseUrl=function(a){var b=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;b.lastIndex=0;b=b.exec(a);if(a=null===b?null:{full:a,scheme:b[1],host:b[2],port:b[3],path:b[4]})a.fullHost=a.host,a.port?80!==a.port&&"http"===a.scheme?a.fullHost+=":"+a.port:443!==a.port&&"https"===a.scheme&&(a.fullHost+=":"+a.port):"http"===a.scheme?a.port=80:"https"===a.scheme&&(a.port=443),a.full=a.scheme+"://"+a.fullHost;return a};var q=null;
c.getQueryVariables=function(a){var b=function(a){var b={};a=a.split("\x26");for(var d=0;d<a.length;d++){var f=a[d].indexOf("\x3d"),c;0<f?(c=a[d].substring(0,f),f=a[d].substring(f+1)):(c=a[d],f=null);c in b||(b[c]=[]);c in Object.prototype||null===f||b[c].push(unescape(f))}return b};"undefined"===typeof a?(null===q&&(q="undefined"!==typeof window&&window.location&&window.location.search?b(window.location.search.substring(1)):{}),a=q):a=b(a);return a};c.parseFragment=function(a){var b=a,d="",f=a.indexOf("?");
0<f&&(b=a.substring(0,f),d=a.substring(f+1));a=b.split("/");0<a.length&&""===a[0]&&a.shift();f=""===d?{}:c.getQueryVariables(d);return{pathString:b,queryString:d,path:a,query:f}};c.makeRequest=function(a){var b=c.parseFragment(a),d={path:b.pathString,query:b.queryString,getPath:function(a){return"undefined"===typeof a?b.path:b.path[a]},getQuery:function(a,d){var f;"undefined"===typeof a?f=b.query:(f=b.query[a])&&"undefined"!==typeof d&&(f=f[d]);return f},getQueryLast:function(a,b){var f=d.getQuery(a);
return f?f[f.length-1]:b}};return d};c.makeLink=function(a,b,d){a=jQuery.isArray(a)?a.join("/"):a;b=jQuery.param(b||{});d=d||"";return a+(0<b.length?"?"+b:"")+(0<d.length?"#"+d:"")};c.setPath=function(a,b,d){if("object"===typeof a&&null!==a)for(var f=0,n=b.length;f<n;){var c=b[f++];if(f==n)a[c]=d;else{var g=c in a;if(!g||g&&"object"!==typeof a[c]||g&&null===a[c])a[c]={};a=a[c]}}};c.getPath=function(a,b,d){for(var f=0,n=b.length,c=!0;c&&f<n&&"object"===typeof a&&null!==a;){var g=b[f++];(c=g in a)&&
(a=a[g])}return c?a:d};c.deletePath=function(a,b){if("object"===typeof a&&null!==a)for(var d=0,f=b.length;d<f;){var n=b[d++];if(d==f)delete a[n];else{if(!(n in a)||"object"!==typeof a[n]||null===a[n])break;a=a[n]}}};c.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};c.format=function(a){var b=/%./g,d,f,n=0,c=[];for(f=0;d=b.exec(a);)switch(f=a.substring(f,b.lastIndex-2),0<f.length&&c.push(f),f=b.lastIndex,d=d[0][1],d){case "s":case "o":n<arguments.length?c.push(arguments[n++ +
1]):c.push("\x3c?\x3e");break;case "%":c.push("%");break;default:c.push("\x3c%"+d+"?\x3e")}c.push(a.substring(f));return c.join("")};c.formatNumber=function(a,b,d,f){var n=isNaN(b=Math.abs(b))?2:b;b=void 0===d?",":d;f=void 0===f?".":f;d=0>a?"-":"";var c=parseInt(a=Math.abs(+a||0).toFixed(n),10)+"",g=3<c.length?c.length%3:0;return d+(g?c.substr(0,g)+f:"")+c.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+f)+(n?b+Math.abs(a-c).toFixed(n).slice(2):"")};c.formatSize=function(a){return a=1073741824<=a?c.formatNumber(a/
1073741824,2,".","")+" GiB":1048576<=a?c.formatNumber(a/1048576,2,".","")+" MiB":1024<=a?c.formatNumber(a/1024,0)+" KiB":c.formatNumber(a,0)+" bytes"};c.bytesFromIP=function(a){return-1!==a.indexOf(".")?c.bytesFromIPv4(a):-1!==a.indexOf(":")?c.bytesFromIPv6(a):null};c.bytesFromIPv4=function(a){a=a.split(".");if(4!==a.length)return null;for(var b=c.createBuffer(),d=0;d<a.length;++d){var f=parseInt(a[d],10);if(isNaN(f))return null;b.putByte(f)}return b.getBytes()};c.bytesFromIPv6=function(a){var b=
0;a=a.split(":").filter(function(a){0===a.length&&++b;return!0});for(var d=2*(8-a.length+b),f=c.createBuffer(),n=0;8>n;++n)if(a[n]&&0!==a[n].length){var r=c.hexToBytes(a[n]);2>r.length&&f.putByte(0);f.putBytes(r)}else f.fillWithByte(0,d),d=0;return f.getBytes()};c.bytesToIP=function(a){return 4===a.length?c.bytesToIPv4(a):16===a.length?c.bytesToIPv6(a):null};c.bytesToIPv4=function(a){if(4!==a.length)return null;for(var b=[],d=0;d<a.length;++d)b.push(a.charCodeAt(d));return b.join(".")};c.bytesToIPv6=
function(a){if(16!==a.length)return null;for(var b=[],d=[],f=0,n=0;n<a.length;n+=2){for(var r=c.bytesToHex(a[n]+a[n+1]);"0"===r[0]&&"0"!==r;)r=r.substr(1);if("0"===r){var g=d[d.length-1],e=b.length;g&&e===g.end+1?(g.end=e,g.end-g.start>d[f].end-d[f].start&&(f=d.length-1)):d.push({start:e,end:e})}b.push(r)}0<d.length&&(a=d[f],0<a.end-a.start&&(b.splice(a.start,a.end-a.start+1,""),0===a.start&&b.unshift(""),7===a.end&&b.push("")));return b.join(":")};c.estimateCores=function(a,b){function d(a,g,e){if(0===
g){var k=Math.floor(a.reduce(function(a,b){return a+b},0)/a.length);c.cores=Math.max(1,k);URL.revokeObjectURL(r);return b(null,c.cores)}f(e,function(b,f){a.push(n(e,f));d(a,g-1,e)})}function f(a,b){for(var d=[],n=[],c=0;c<a;++c){var g=new Worker(r);g.addEventListener("message",function(f){n.push(f.data);if(n.length===a){for(f=0;f<a;++f)d[f].terminate();b(null,n)}});d.push(g)}for(c=0;c<a;++c)d[c].postMessage(c)}function n(a,b){for(var d=[],f=0;f<a;++f)for(var n=b[f],c=d[f]=[],r=0;r<a;++r)if(f!==r){var g=
b[r];(n.st>g.st&&n.st<g.et||g.st>n.st&&g.st<n.et)&&c.push(r)}return d.reduce(function(a,b){return Math.max(a,b.length)},0)}"function"===typeof a&&(b=a,a={});a=a||{};if("cores"in c&&!a.update)return b(null,c.cores);if("undefined"!==typeof navigator&&"hardwareConcurrency"in navigator&&0<navigator.hardwareConcurrency)return c.cores=navigator.hardwareConcurrency,b(null,c.cores);if("undefined"===typeof Worker)return c.cores=1,b(null,c.cores);if("undefined"===typeof Blob)return c.cores=2,b(null,c.cores);
var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){a=Date.now();for(var b=a+4;Date.now()<b;);self.postMessage({st:a,et:b})})}.toString(),")()"],{type:"application/javascript"}));d([],5,16)}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};
c.defined=c.defined||{};if(c.defined.util)return c.util;c.defined.util=!0;for(var g=0;g<e.length;++g)e[g](c);return c.util}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/util",["require","module"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){a.cipher=a.cipher||{};a.cipher.algorithms=
a.cipher.algorithms||{};a.cipher.createCipher=function(c,e){var g=c;"string"===typeof g&&(g=a.cipher.getAlgorithm(g))&&(g=g());if(!g)throw Error("Unsupported algorithm: "+c);return new a.cipher.BlockCipher({algorithm:g,key:e,decrypt:!1})};a.cipher.createDecipher=function(c,e){var g=c;"string"===typeof g&&(g=a.cipher.getAlgorithm(g))&&(g=g());if(!g)throw Error("Unsupported algorithm: "+c);return new a.cipher.BlockCipher({algorithm:g,key:e,decrypt:!0})};a.cipher.registerAlgorithm=function(c,e){c=c.toUpperCase();
a.cipher.algorithms[c]=e};a.cipher.getAlgorithm=function(c){c=c.toUpperCase();return c in a.cipher.algorithms?a.cipher.algorithms[c]:null};var e=a.cipher.BlockCipher=function(a){this.algorithm=a.algorithm;this.mode=this.algorithm.mode;this.blockSize=this.mode.blockSize;this._finish=!1;this.output=this._input=null;this._op=a.decrypt?this.mode.decrypt:this.mode.encrypt;this._decrypt=a.decrypt;this.algorithm.initialize(a)};e.prototype.start=function(c){c=c||{};var e={},g;for(g in c)e[g]=c[g];e.decrypt=
this._decrypt;this._finish=!1;this._input=a.util.createBuffer();this.output=c.output||a.util.createBuffer();this.mode.start(e)};e.prototype.update=function(a){for(a&&this._input.putBuffer(a);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};e.prototype.finish=function(a){!a||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(g){return a(this.blockSize,g,!1)},this.mode.unpad=function(g){return a(this.blockSize,g,!0)});var e=
{};e.decrypt=this._decrypt;e.overflow=this._input.length()%this.blockSize;if(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e))return!1;this._finish=!0;this.update();return this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e)||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e)?!1:!0}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,
e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.cipher)return c.cipher;c.defined.cipher=!0;for(var g=0;g<e.length;++g)e[g](c);return c.cipher}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/cipher",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,
0))})})();(function(){function w(a){function e(c){"string"===typeof c&&(c=a.util.createBuffer(c));if(a.util.isArray(c)&&4<c.length){var d=c;c=a.util.createBuffer();for(var b=0;b<d.length;++b)c.putByte(d[b])}a.util.isArray(c)||(c=[c.getInt32(),c.getInt32(),c.getInt32(),c.getInt32()]);return c}function c(a){a[a.length-1]=a[a.length-1]+1&4294967295}function h(a){return[a/4294967296|0,a&4294967295]}a.cipher=a.cipher||{};var g=a.cipher.modes=a.cipher.modes||{};g.ecb=function(a){a=a||{};this.name="ECB";
this.cipher=a.cipher;this.blockSize=a.blockSize||16;this._ints=this.blockSize/4;this._inBlock=Array(this._ints);this._outBlock=Array(this._ints)};g.ecb.prototype.start=function(a){};g.ecb.prototype.encrypt=function(a,d,b){if(a.length()<this.blockSize&&!(b&&0<a.length()))return!0;for(b=0;b<this._ints;++b)this._inBlock[b]=a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(b=0;b<this._ints;++b)d.putInt32(this._outBlock[b])};g.ecb.prototype.decrypt=function(a,d,b){if(a.length()<this.blockSize&&
!(b&&0<a.length()))return!0;for(b=0;b<this._ints;++b)this._inBlock[b]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(b=0;b<this._ints;++b)d.putInt32(this._outBlock[b])};g.ecb.prototype.pad=function(a,d){var b=a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();a.fillWithByte(b,b);return!0};g.ecb.prototype.unpad=function(a,d){if(0<d.overflow)return!1;var b=a.length(),b=a.at(b-1);if(b>this.blockSize<<2)return!1;a.truncate(b);return!0};g.cbc=function(a){a=a||{};this.name=
"CBC";this.cipher=a.cipher;this.blockSize=a.blockSize||16;this._ints=this.blockSize/4;this._inBlock=Array(this._ints);this._outBlock=Array(this._ints)};g.cbc.prototype.start=function(a){if(null===a.iv){if(!this._prev)throw Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in a)this._iv=e(a.iv),this._prev=this._iv.slice(0);else throw Error("Invalid IV parameter.");};g.cbc.prototype.encrypt=function(a,d,b){if(a.length()<this.blockSize&&!(b&&0<a.length()))return!0;for(b=0;b<this._ints;++b)this._inBlock[b]=
this._prev[b]^a.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(b=0;b<this._ints;++b)d.putInt32(this._outBlock[b]);this._prev=this._outBlock};g.cbc.prototype.decrypt=function(a,d,b){if(a.length()<this.blockSize&&!(b&&0<a.length()))return!0;for(b=0;b<this._ints;++b)this._inBlock[b]=a.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(b=0;b<this._ints;++b)d.putInt32(this._prev[b]^this._outBlock[b]);this._prev=this._inBlock.slice(0)};g.cbc.prototype.pad=function(a,d){var b=
a.length()===this.blockSize?this.blockSize:this.blockSize-a.length();a.fillWithByte(b,b);return!0};g.cbc.prototype.unpad=function(a,d){if(0<d.overflow)return!1;var b=a.length(),b=a.at(b-1);if(b>this.blockSize<<2)return!1;a.truncate(b);return!0};g.cfb=function(c){c=c||{};this.name="CFB";this.cipher=c.cipher;this.blockSize=c.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=Array(this._ints);this._partialBlock=Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=
0};g.cfb.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=e(a.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0};g.cfb.prototype.encrypt=function(a,d,b){var c=a.length();if(0===c)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&c>=this.blockSize)for(var f=0;f<this._ints;++f)this._inBlock[f]=a.getInt32()^this._outBlock[f],d.putInt32(this._inBlock[f]);else{var g=(this.blockSize-c)%this.blockSize;0<g&&(g=this.blockSize-
g);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialBlock[f]=a.getInt32()^this._outBlock[f],this._partialOutput.putInt32(this._partialBlock[f]);if(0<g)a.read-=this.blockSize;else for(f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<g&&!b)return d.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;d.putBytes(this._partialOutput.getBytes(c-this._partialBytes));this._partialBytes=
0}};g.cfb.prototype.decrypt=function(a,d,b){var c=a.length();if(0===c)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&c>=this.blockSize)for(var f=0;f<this._ints;++f)this._inBlock[f]=a.getInt32(),d.putInt32(this._inBlock[f]^this._outBlock[f]);else{var g=(this.blockSize-c)%this.blockSize;0<g&&(g=this.blockSize-g);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialBlock[f]=a.getInt32(),this._partialOutput.putInt32(this._partialBlock[f]^this._outBlock[f]);
if(0<g)a.read-=this.blockSize;else for(f=0;f<this._ints;++f)this._inBlock[f]=this._partialBlock[f];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<g&&!b)return d.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;d.putBytes(this._partialOutput.getBytes(c-this._partialBytes));this._partialBytes=0}};g.ofb=function(c){c=c||{};this.name="OFB";this.cipher=c.cipher;this.blockSize=c.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;
this._outBlock=Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0};g.ofb.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=e(a.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0};g.ofb.prototype.encrypt=function(a,d,b){var c=a.length();if(0===a.length())return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&c>=this.blockSize)for(var f=0;f<this._ints;++f)d.putInt32(a.getInt32()^this._outBlock[f]),
this._inBlock[f]=this._outBlock[f];else{var g=(this.blockSize-c)%this.blockSize;0<g&&(g=this.blockSize-g);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(0<g)a.read-=this.blockSize;else for(f=0;f<this._ints;++f)this._inBlock[f]=this._outBlock[f];0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);if(0<g&&!b)return d.putBytes(this._partialOutput.getBytes(g-this._partialBytes)),this._partialBytes=g,!0;d.putBytes(this._partialOutput.getBytes(c-
this._partialBytes));this._partialBytes=0}};g.ofb.prototype.decrypt=g.ofb.prototype.encrypt;g.ctr=function(c){c=c||{};this.name="CTR";this.cipher=c.cipher;this.blockSize=c.blockSize||16;this._ints=this.blockSize/4;this._inBlock=null;this._outBlock=Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=0};g.ctr.prototype.start=function(a){if(!("iv"in a))throw Error("Invalid IV parameter.");this._iv=e(a.iv);this._inBlock=this._iv.slice(0);this._partialBytes=0};g.ctr.prototype.encrypt=
function(a,d,b){var g=a.length();if(0===g)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&g>=this.blockSize)for(var f=0;f<this._ints;++f)d.putInt32(a.getInt32()^this._outBlock[f]);else{var e=(this.blockSize-g)%this.blockSize;0<e&&(e=this.blockSize-e);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);0<e&&(a.read-=this.blockSize);0<this._partialBytes&&this._partialOutput.getBytes(this._partialBytes);
if(0<e&&!b)return d.putBytes(this._partialOutput.getBytes(e-this._partialBytes)),this._partialBytes=e,!0;d.putBytes(this._partialOutput.getBytes(g-this._partialBytes));this._partialBytes=0}c(this._inBlock)};g.ctr.prototype.decrypt=g.ctr.prototype.encrypt;g.gcm=function(c){c=c||{};this.name="GCM";this.cipher=c.cipher;this.blockSize=c.blockSize||16;this._ints=this.blockSize/4;this._inBlock=Array(this._ints);this._outBlock=Array(this._ints);this._partialOutput=a.util.createBuffer();this._partialBytes=
0;this._R=3774873600};g.gcm.prototype.start=function(g){if(!("iv"in g))throw Error("Invalid IV parameter.");var d=a.util.createBuffer(g.iv);this._cipherLength=0;var b;b="additionalData"in g?a.util.createBuffer(g.additionalData):a.util.createBuffer();this._tagLength="tagLength"in g?g.tagLength:128;this._tag=null;if(g.decrypt&&(this._tag=a.util.createBuffer(g.tag).getBytes(),this._tag.length!==this._tagLength/8))throw Error("Authentication tag does not match tag length.");this._hashBlock=Array(this._ints);
this.tag=null;this._hashSubkey=Array(this._ints);this.cipher.encrypt([0,0,0,0],this._hashSubkey);this.componentBits=4;this._m=this.generateHashTable(this._hashSubkey,this.componentBits);g=d.length();if(12===g)this._j0=[d.getInt32(),d.getInt32(),d.getInt32(),1];else{for(this._j0=[0,0,0,0];0<d.length();)this._j0=this.ghash(this._hashSubkey,this._j0,[d.getInt32(),d.getInt32(),d.getInt32(),d.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(h(8*g)))}this._inBlock=this._j0.slice(0);
c(this._inBlock);this._partialBytes=0;b=a.util.createBuffer(b);this._aDataLength=h(8*b.length());(d=b.length()%this.blockSize)&&b.fillWithByte(0,this.blockSize-d);for(this._s=[0,0,0,0];0<b.length();)this._s=this.ghash(this._hashSubkey,this._s,[b.getInt32(),b.getInt32(),b.getInt32(),b.getInt32()])};g.gcm.prototype.encrypt=function(a,d,b){var g=a.length();if(0===g)return!0;this.cipher.encrypt(this._inBlock,this._outBlock);if(0===this._partialBytes&&g>=this.blockSize){for(var f=0;f<this._ints;++f)d.putInt32(this._outBlock[f]^=
a.getInt32());this._cipherLength+=this.blockSize}else{var e=(this.blockSize-g)%this.blockSize;0<e&&(e=this.blockSize-e);this._partialOutput.clear();for(f=0;f<this._ints;++f)this._partialOutput.putInt32(a.getInt32()^this._outBlock[f]);if(0===e||b){b?(f=g%this.blockSize,this._cipherLength+=f,this._partialOutput.truncate(this.blockSize-f)):this._cipherLength+=this.blockSize;for(f=0;f<this._ints;++f)this._outBlock[f]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}0<this._partialBytes&&
this._partialOutput.getBytes(this._partialBytes);if(0<e&&!b)return a.read-=this.blockSize,d.putBytes(this._partialOutput.getBytes(e-this._partialBytes)),this._partialBytes=e,!0;d.putBytes(this._partialOutput.getBytes(g-this._partialBytes));this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock);c(this._inBlock)};g.gcm.prototype.decrypt=function(a,d,b){var g=a.length();if(g<this.blockSize&&!(b&&0<g))return!0;this.cipher.encrypt(this._inBlock,this._outBlock);c(this._inBlock);
this._hashBlock[0]=a.getInt32();this._hashBlock[1]=a.getInt32();this._hashBlock[2]=a.getInt32();this._hashBlock[3]=a.getInt32();this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(a=0;a<this._ints;++a)d.putInt32(this._outBlock[a]^this._hashBlock[a]);this._cipherLength=g<this.blockSize?this._cipherLength+g%this.blockSize:this._cipherLength+this.blockSize};g.gcm.prototype.afterFinish=function(c,d){var b=!0;d.decrypt&&d.overflow&&c.truncate(this.blockSize-d.overflow);this.tag=a.util.createBuffer();
var g=this._aDataLength.concat(h(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,g);g=[];this.cipher.encrypt(this._j0,g);for(var f=0;f<this._ints;++f)this.tag.putInt32(this._s[f]^g[f]);this.tag.truncate(this.tag.length()%(this._tagLength/8));d.decrypt&&this.tag.bytes()!==this._tag&&(b=!1);return b};g.gcm.prototype.multiply=function(a,d){for(var b=[0,0,0,0],c=d.slice(0),f=0;128>f;++f)a[f/32|0]&1<<31-f%32&&(b[0]^=c[0],b[1]^=c[1],b[2]^=c[2],b[3]^=c[3]),this.pow(c,c);return b};g.gcm.prototype.pow=
function(a,d){for(var b=a[3]&1,c=3;0<c;--c)d[c]=a[c]>>>1|(a[c-1]&1)<<31;d[0]=a[0]>>>1;b&&(d[0]^=this._R)};g.gcm.prototype.tableMultiply=function(a){for(var d=[0,0,0,0],b=0;32>b;++b){var c=this._m[b][a[b/8|0]>>>4*(7-b%8)&15];d[0]^=c[0];d[1]^=c[1];d[2]^=c[2];d[3]^=c[3]}return d};g.gcm.prototype.ghash=function(a,d,b){d[0]^=b[0];d[1]^=b[1];d[2]^=b[2];d[3]^=b[3];return this.tableMultiply(d)};g.gcm.prototype.generateHashTable=function(a,d){for(var b=8/d,c=4*b,b=16*b,f=Array(b),g=0;g<b;++g){var e=[0,0,0,
0];e[g/c|0]=1<<d-1<<(c-1-g%c)*d;f[g]=this.generateSubHashTable(this.multiply(e,a),d)}return f};g.gcm.prototype.generateSubHashTable=function(a,d){var b=1<<d,c=b>>>1,f=Array(b);f[c]=a.slice(0);for(var g=c>>>1;0<g;)this.pow(f[2*g],f[g]=[]),g>>=1;for(g=2;g<c;){for(var e=1;e<g;++e){var p=f[g],t=f[e];f[g+e]=[p[0]^t[0],p[1]^t[1],p[2]^t[2],p[3]^t[3]]}g*=2}f[0]=[0,0,0,0];for(g=c+1;g<b;++g)e=f[g^c],f[g]=[a[0]^e[0],a[1]^e[1],a[2]^e[2],a[3]^e[3]];return f}}if("function"!==typeof l)if("object"===typeof module&&
module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.cipherModes)return c.cipherModes;c.defined.cipherModes=!0;for(var g=0;g<e.length;++g)e[g](c);return c.cipherModes}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,
0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/cipherModes",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(b,d){a.cipher.registerAlgorithm(b,function(){return new a.aes.Algorithm(b,d)})}function c(){d=!0;u=[0,1,2,4,8,16,32,64,128,27,54];for(var a=Array(256),b=0;128>b;++b)a[b]=b<<1,a[b+128]=b+128<<1^283;m=Array(256);f=Array(256);q=Array(4);p=Array(4);for(b=0;4>b;++b)q[b]=Array(256),
p[b]=Array(256);for(var c=0,n=0,g,e,B,h,k,b=0;256>b;++b){h=n^n<<1^n<<2^n<<3^n<<4;h=h>>8^h&255^99;m[c]=h;f[h]=c;k=a[h];g=a[c];e=a[g];B=a[e];k^=k<<24^h<<16^h<<8^h;e=(g^e^B)<<24^(c^B)<<16^(c^e^B)<<8^c^g^B;for(var A=0;4>A;++A)q[A][c]=k,p[A][h]=e,k=k<<24|k>>>8,e=e<<24|e>>>8;0===c?c=n=1:(c=g^a[a[a[g^B]]],n^=a[a[n]])}}function h(a,d){for(var f=a.slice(0),n,c=1,g=f.length,e=b*(g+6+1),q=g;q<e;++q)n=f[q-1],0===q%g?(n=m[n>>>16&255]<<24^m[n>>>8&255]<<16^m[n&255]<<8^m[n>>>24]^u[c]<<24,c++):6<g&&4===q%g&&(n=m[n>>>
24]<<24^m[n>>>16&255]<<16^m[n>>>8&255]<<8^m[n&255]),f[q]=f[q-g]^n;if(d){for(var c=p[0],g=p[1],k=p[2],h=p[3],A=f.slice(0),e=f.length,q=0,F=e-b;q<e;q+=b,F-=b)if(0===q||q===e-b)A[q]=f[F],A[q+1]=f[F+3],A[q+2]=f[F+2],A[q+3]=f[F+1];else for(var L=0;L<b;++L)n=f[F+L],A[q+(3&-L)]=c[m[n>>>24]]^g[m[n>>>16&255]]^k[m[n>>>8&255]]^h[m[n&255]];f=A}return f}function g(a,b,d,n){var c=a.length/4-1,g,e,u,k,h;n?(g=p[0],e=p[1],u=p[2],k=p[3],h=f):(g=q[0],e=q[1],u=q[2],k=q[3],h=m);var A,F,L,I,l,K;A=b[0]^a[0];F=b[n?3:1]^
a[1];L=b[2]^a[2];b=b[n?1:3]^a[3];for(var N=3,w=1;w<c;++w)I=g[A>>>24]^e[F>>>16&255]^u[L>>>8&255]^k[b&255]^a[++N],l=g[F>>>24]^e[L>>>16&255]^u[b>>>8&255]^k[A&255]^a[++N],K=g[L>>>24]^e[b>>>16&255]^u[A>>>8&255]^k[F&255]^a[++N],b=g[b>>>24]^e[A>>>16&255]^u[F>>>8&255]^k[L&255]^a[++N],A=I,F=l,L=K;d[0]=h[A>>>24]<<24^h[F>>>16&255]<<16^h[L>>>8&255]<<8^h[b&255]^a[++N];d[n?3:1]=h[F>>>24]<<24^h[L>>>16&255]<<16^h[b>>>8&255]<<8^h[A&255]^a[++N];d[2]=h[L>>>24]<<24^h[b>>>16&255]<<16^h[A>>>8&255]<<8^h[F&255]^a[++N];d[n?
1:3]=h[b>>>24]<<24^h[A>>>16&255]<<16^h[F>>>8&255]<<8^h[L&255]^a[++N]}function A(b){b=b||{};var d="AES-"+(b.mode||"CBC").toUpperCase(),f;f=b.decrypt?a.cipher.createDecipher(d,b.key):a.cipher.createCipher(d,b.key);var n=f.start;f.start=function(b,d){var c=null;d instanceof a.util.ByteBuffer&&(c=d,d={});d=d||{};d.output=c;d.iv=b;n.call(f,d)};return f}a.aes=a.aes||{};a.aes.startEncrypting=function(a,b,d,f){a=A({key:a,output:d,decrypt:!1,mode:f});a.start(b);return a};a.aes.createEncryptionCipher=function(a,
b){return A({key:a,output:null,decrypt:!1,mode:b})};a.aes.startDecrypting=function(a,b,d,f){a=A({key:a,output:d,decrypt:!0,mode:f});a.start(b);return a};a.aes.createDecryptionCipher=function(a,b){return A({key:a,output:null,decrypt:!0,mode:b})};a.aes.Algorithm=function(a,b){d||c();var f=this;f.name=a;f.mode=new b({blockSize:16,cipher:{encrypt:function(a,b){return g(f._w,a,b,!1)},decrypt:function(a,b){return g(f._w,a,b,!0)}}});f._init=!1};a.aes.Algorithm.prototype.initialize=function(b){if(!this._init){var d=
b.key,f;if("string"===typeof d&&(16===d.length||24===d.length||32===d.length))d=a.util.createBuffer(d);else if(a.util.isArray(d)&&(16===d.length||24===d.length||32===d.length)){f=d;for(var d=a.util.createBuffer(),n=0;n<f.length;++n)d.putByte(f[n])}if(!a.util.isArray(d)){f=d;var d=[],c=f.length();if(16===c||24===c||32===c)for(c>>>=2,n=0;n<c;++n)d.push(f.getInt32())}if(!a.util.isArray(d)||4!==d.length&&6!==d.length&&8!==d.length)throw Error("Invalid key parameter.");f=-1!==["CFB","OFB","CTR","GCM"].indexOf(this.mode.name);
this._w=h(d,b.decrypt&&!f);this._init=!0}};a.aes._expandKey=function(a,b){d||c();return h(a,b)};a.aes._updateBlock=g;e("AES-ECB",a.cipher.modes.ecb);e("AES-CBC",a.cipher.modes.cbc);e("AES-CFB",a.cipher.modes.cfb);e("AES-OFB",a.cipher.modes.ofb);e("AES-CTR",a.cipher.modes.ctr);e("AES-GCM",a.cipher.modes.gcm);var d=!1,b=4,m,f,u,q,p}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,
C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.aes)return c.aes;c.defined.aes=!0;for(var g=0;g<e.length;++g)e[g](c);return c.aes}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/aes",["require","module","./cipher","./cipherModes","./util"],function(){C.apply(null,
Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){a.pki=a.pki||{};a=a.pki.oids=a.oids=a.oids||{};a["1.2.840.113549.1.1.1"]="rsaEncryption";a.rsaEncryption="1.2.840.113549.1.1.1";a["1.2.840.113549.1.1.4"]="md5WithRSAEncryption";a.md5WithRSAEncryption="1.2.840.113549.1.1.4";a["1.2.840.113549.1.1.5"]="sha1WithRSAEncryption";a.sha1WithRSAEncryption="1.2.840.113549.1.1.5";a["1.2.840.113549.1.1.7"]="RSAES-OAEP";a["RSAES-OAEP"]="1.2.840.113549.1.1.7";a["1.2.840.113549.1.1.8"]="mgf1";
a.mgf1="1.2.840.113549.1.1.8";a["1.2.840.113549.1.1.9"]="pSpecified";a.pSpecified="1.2.840.113549.1.1.9";a["1.2.840.113549.1.1.10"]="RSASSA-PSS";a["RSASSA-PSS"]="1.2.840.113549.1.1.10";a["1.2.840.113549.1.1.11"]="sha256WithRSAEncryption";a.sha256WithRSAEncryption="1.2.840.113549.1.1.11";a["1.2.840.113549.1.1.12"]="sha384WithRSAEncryption";a.sha384WithRSAEncryption="1.2.840.113549.1.1.12";a["1.2.840.113549.1.1.13"]="sha512WithRSAEncryption";a.sha512WithRSAEncryption="1.2.840.113549.1.1.13";a["1.3.14.3.2.7"]=
"desCBC";a.desCBC="1.3.14.3.2.7";a["1.3.14.3.2.26"]="sha1";a.sha1="1.3.14.3.2.26";a["2.16.840.1.101.3.4.2.1"]="sha256";a.sha256="2.16.840.1.101.3.4.2.1";a["2.16.840.1.101.3.4.2.2"]="sha384";a.sha384="2.16.840.1.101.3.4.2.2";a["2.16.840.1.101.3.4.2.3"]="sha512";a.sha512="2.16.840.1.101.3.4.2.3";a["1.2.840.113549.2.5"]="md5";a.md5="1.2.840.113549.2.5";a["1.2.840.113549.1.7.1"]="data";a.data="1.2.840.113549.1.7.1";a["1.2.840.113549.1.7.2"]="signedData";a.signedData="1.2.840.113549.1.7.2";a["1.2.840.113549.1.7.3"]=
"envelopedData";a.envelopedData="1.2.840.113549.1.7.3";a["1.2.840.113549.1.7.4"]="signedAndEnvelopedData";a.signedAndEnvelopedData="1.2.840.113549.1.7.4";a["1.2.840.113549.1.7.5"]="digestedData";a.digestedData="1.2.840.113549.1.7.5";a["1.2.840.113549.1.7.6"]="encryptedData";a.encryptedData="1.2.840.113549.1.7.6";a["1.2.840.113549.1.9.1"]="emailAddress";a.emailAddress="1.2.840.113549.1.9.1";a["1.2.840.113549.1.9.2"]="unstructuredName";a.unstructuredName="1.2.840.113549.1.9.2";a["1.2.840.113549.1.9.3"]=
"contentType";a.contentType="1.2.840.113549.1.9.3";a["1.2.840.113549.1.9.4"]="messageDigest";a.messageDigest="1.2.840.113549.1.9.4";a["1.2.840.113549.1.9.5"]="signingTime";a.signingTime="1.2.840.113549.1.9.5";a["1.2.840.113549.1.9.6"]="counterSignature";a.counterSignature="1.2.840.113549.1.9.6";a["1.2.840.113549.1.9.7"]="challengePassword";a.challengePassword="1.2.840.113549.1.9.7";a["1.2.840.113549.1.9.8"]="unstructuredAddress";a.unstructuredAddress="1.2.840.113549.1.9.8";a["1.2.840.113549.1.9.14"]=
"extensionRequest";a.extensionRequest="1.2.840.113549.1.9.14";a["1.2.840.113549.1.9.20"]="friendlyName";a.friendlyName="1.2.840.113549.1.9.20";a["1.2.840.113549.1.9.21"]="localKeyId";a.localKeyId="1.2.840.113549.1.9.21";a["1.2.840.113549.1.9.22.1"]="x509Certificate";a.x509Certificate="1.2.840.113549.1.9.22.1";a["1.2.840.113549.1.12.10.1.1"]="keyBag";a.keyBag="1.2.840.113549.1.12.10.1.1";a["1.2.840.113549.1.12.10.1.2"]="pkcs8ShroudedKeyBag";a.pkcs8ShroudedKeyBag="1.2.840.113549.1.12.10.1.2";a["1.2.840.113549.1.12.10.1.3"]=
"certBag";a.certBag="1.2.840.113549.1.12.10.1.3";a["1.2.840.113549.1.12.10.1.4"]="crlBag";a.crlBag="1.2.840.113549.1.12.10.1.4";a["1.2.840.113549.1.12.10.1.5"]="secretBag";a.secretBag="1.2.840.113549.1.12.10.1.5";a["1.2.840.113549.1.12.10.1.6"]="safeContentsBag";a.safeContentsBag="1.2.840.113549.1.12.10.1.6";a["1.2.840.113549.1.5.13"]="pkcs5PBES2";a.pkcs5PBES2="1.2.840.113549.1.5.13";a["1.2.840.113549.1.5.12"]="pkcs5PBKDF2";a.pkcs5PBKDF2="1.2.840.113549.1.5.12";a["1.2.840.113549.1.12.1.1"]="pbeWithSHAAnd128BitRC4";
a.pbeWithSHAAnd128BitRC4="1.2.840.113549.1.12.1.1";a["1.2.840.113549.1.12.1.2"]="pbeWithSHAAnd40BitRC4";a.pbeWithSHAAnd40BitRC4="1.2.840.113549.1.12.1.2";a["1.2.840.113549.1.12.1.3"]="pbeWithSHAAnd3-KeyTripleDES-CBC";a["pbeWithSHAAnd3-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.3";a["1.2.840.113549.1.12.1.4"]="pbeWithSHAAnd2-KeyTripleDES-CBC";a["pbeWithSHAAnd2-KeyTripleDES-CBC"]="1.2.840.113549.1.12.1.4";a["1.2.840.113549.1.12.1.5"]="pbeWithSHAAnd128BitRC2-CBC";a["pbeWithSHAAnd128BitRC2-CBC"]="1.2.840.113549.1.12.1.5";
a["1.2.840.113549.1.12.1.6"]="pbewithSHAAnd40BitRC2-CBC";a["pbewithSHAAnd40BitRC2-CBC"]="1.2.840.113549.1.12.1.6";a["1.2.840.113549.3.7"]="des-EDE3-CBC";a["des-EDE3-CBC"]="1.2.840.113549.3.7";a["2.16.840.1.101.3.4.1.2"]="aes128-CBC";a["aes128-CBC"]="2.16.840.1.101.3.4.1.2";a["2.16.840.1.101.3.4.1.22"]="aes192-CBC";a["aes192-CBC"]="2.16.840.1.101.3.4.1.22";a["2.16.840.1.101.3.4.1.42"]="aes256-CBC";a["aes256-CBC"]="2.16.840.1.101.3.4.1.42";a["2.5.4.3"]="commonName";a.commonName="2.5.4.3";a["2.5.4.5"]=
"serialName";a.serialName="2.5.4.5";a["2.5.4.6"]="countryName";a.countryName="2.5.4.6";a["2.5.4.7"]="localityName";a.localityName="2.5.4.7";a["2.5.4.8"]="stateOrProvinceName";a.stateOrProvinceName="2.5.4.8";a["2.5.4.10"]="organizationName";a.organizationName="2.5.4.10";a["2.5.4.11"]="organizationalUnitName";a.organizationalUnitName="2.5.4.11";a["2.16.840.1.113730.1.1"]="nsCertType";a.nsCertType="2.16.840.1.113730.1.1";a["2.5.29.1"]="authorityKeyIdentifier";a["2.5.29.2"]="keyAttributes";a["2.5.29.3"]=
"certificatePolicies";a["2.5.29.4"]="keyUsageRestriction";a["2.5.29.5"]="policyMapping";a["2.5.29.6"]="subtreesConstraint";a["2.5.29.7"]="subjectAltName";a["2.5.29.8"]="issuerAltName";a["2.5.29.9"]="subjectDirectoryAttributes";a["2.5.29.10"]="basicConstraints";a["2.5.29.11"]="nameConstraints";a["2.5.29.12"]="policyConstraints";a["2.5.29.13"]="basicConstraints";a["2.5.29.14"]="subjectKeyIdentifier";a.subjectKeyIdentifier="2.5.29.14";a["2.5.29.15"]="keyUsage";a.keyUsage="2.5.29.15";a["2.5.29.16"]="privateKeyUsagePeriod";
a["2.5.29.17"]="subjectAltName";a.subjectAltName="2.5.29.17";a["2.5.29.18"]="issuerAltName";a.issuerAltName="2.5.29.18";a["2.5.29.19"]="basicConstraints";a.basicConstraints="2.5.29.19";a["2.5.29.20"]="cRLNumber";a["2.5.29.21"]="cRLReason";a["2.5.29.22"]="expirationDate";a["2.5.29.23"]="instructionCode";a["2.5.29.24"]="invalidityDate";a["2.5.29.25"]="cRLDistributionPoints";a["2.5.29.26"]="issuingDistributionPoint";a["2.5.29.27"]="deltaCRLIndicator";a["2.5.29.28"]="issuingDistributionPoint";a["2.5.29.29"]=
"certificateIssuer";a["2.5.29.30"]="nameConstraints";a["2.5.29.31"]="cRLDistributionPoints";a["2.5.29.32"]="certificatePolicies";a["2.5.29.33"]="policyMappings";a["2.5.29.34"]="policyConstraints";a["2.5.29.35"]="authorityKeyIdentifier";a["2.5.29.36"]="policyConstraints";a["2.5.29.37"]="extKeyUsage";a.extKeyUsage="2.5.29.37";a["2.5.29.46"]="freshestCRL";a["2.5.29.54"]="inhibitAnyPolicy";a["1.3.6.1.5.5.7.3.1"]="serverAuth";a.serverAuth="1.3.6.1.5.5.7.3.1";a["1.3.6.1.5.5.7.3.2"]="clientAuth";a.clientAuth=
"1.3.6.1.5.5.7.3.2";a["1.3.6.1.5.5.7.3.3"]="codeSigning";a.codeSigning="1.3.6.1.5.5.7.3.3";a["1.3.6.1.5.5.7.3.4"]="emailProtection";a.emailProtection="1.3.6.1.5.5.7.3.4";a["1.3.6.1.5.5.7.3.8"]="timeStamping";a.timeStamping="1.3.6.1.5.5.7.3.8"}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);
c=c||{};c.defined=c.defined||{};if(c.defined.oids)return c.oids;c.defined.oids=!0;for(var g=0;g<e.length;++g)e[g](c);return c.oids}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/oids",["require","module"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){var e=a.asn1=a.asn1||{};e.Class={UNIVERSAL:0,
APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};e.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};e.create=function(c,e,d,b){if(a.util.isArray(b)){for(var m=[],f=0;f<b.length;++f)void 0!==b[f]&&m.push(b[f]);b=m}return{tagClass:c,type:e,constructed:d,composed:d||a.util.isArray(b),value:b}};var c=e.getBerValueLength=
function(a){var c=a.getByte();if(128!==c)return c&128?a.getInt((c&127)<<3):c};e.fromDer=function(g,h){void 0===h&&(h=!0);"string"===typeof g&&(g=a.util.createBuffer(g));if(2>g.length()){var d=Error("Too few bytes to parse DER.");d.bytes=g.length();throw d;}var b=g.getByte(),d=b&192,m=b&31,f=c(g);if(g.length()<f){if(h)throw d=Error("Too few bytes to read ASN.1 value."),d.detail=g.length()+" \x3c "+f,d;f=g.length()}var u,q=32===(b&32);u=q;if(!u&&d===e.Class.UNIVERSAL&&m===e.Type.BITSTRING&&1<f){var p=
g.read;if(0===g.getByte()&&(b=g.getByte(),b&=192,b===e.Class.UNIVERSAL||b===e.Class.CONTEXT_SPECIFIC))try{if(u=c(g)===f-(g.read-p))++p,--f}catch(t){}g.read=p}if(u)if(u=[],void 0===f)for(;;){if(g.bytes(2)===String.fromCharCode(0,0)){g.getBytes(2);break}u.push(e.fromDer(g,h))}else for(p=g.length();0<f;)u.push(e.fromDer(g,h)),f-=p-g.length(),p=g.length();else{if(void 0===f){if(h)throw Error("Non-constructed ASN.1 object of indefinite length.");f=g.length()}if(m===e.Type.BMPSTRING)for(u="",p=0;p<f;p+=
2)u+=String.fromCharCode(g.getInt16());else u=g.getBytes(f)}return e.create(d,m,q,u)};e.toDer=function(c){var h=a.util.createBuffer(),d=c.tagClass|c.type,b=a.util.createBuffer();if(c.composed){c.constructed?d|=32:b.putByte(0);for(var m=0;m<c.value.length;++m)void 0!==c.value[m]&&b.putBuffer(e.toDer(c.value[m]))}else if(c.type===e.Type.BMPSTRING)for(m=0;m<c.value.length;++m)b.putInt16(c.value.charCodeAt(m));else b.putBytes(c.value);h.putByte(d);if(127>=b.length())h.putByte(b.length()&127);else{m=b.length();
c="";do c+=String.fromCharCode(m&255),m>>>=8;while(0<m);h.putByte(c.length|128);for(m=c.length-1;0<=m;--m)h.putByte(c.charCodeAt(m))}h.putBuffer(b);return h};e.oidToDer=function(c){c=c.split(".");var e=a.util.createBuffer();e.putByte(40*parseInt(c[0],10)+parseInt(c[1],10));for(var d,b,m,f,h=2;h<c.length;++h){d=!0;b=[];m=parseInt(c[h],10);do f=m&127,m>>>=7,d||(f|=128),b.push(f),d=!1;while(0<m);for(d=b.length-1;0<=d;--d)e.putByte(b[d])}return e};e.derToOid=function(c){var e;"string"===typeof c&&(c=
a.util.createBuffer(c));var d=c.getByte();e=Math.floor(d/40)+"."+d%40;for(var b=0;0<c.length();)d=c.getByte(),b<<=7,d&128?b+=d&127:(e+="."+(b+d),b=0);return e};e.utcTimeToDate=function(a){var c=new Date,d=parseInt(a.substr(0,2),10),d=50<=d?1900+d:2E3+d,b=parseInt(a.substr(2,2),10)-1,e=parseInt(a.substr(4,2),10),f=parseInt(a.substr(6,2),10),h=parseInt(a.substr(8,2),10),q=0;if(11<a.length){var p=a.charAt(10),t=10;"+"!==p&&"-"!==p&&(q=parseInt(a.substr(10,2),10),t+=2)}c.setUTCFullYear(d,b,e);c.setUTCHours(f,
h,q,0);t&&(p=a.charAt(t),"+"===p||"-"===p)&&(d=parseInt(a.substr(t+1,2),10),a=parseInt(a.substr(t+4,2),10),a=6E4*(60*d+a),"+"===p?c.setTime(+c-a):c.setTime(+c+a));return c};e.generalizedTimeToDate=function(a){var c=new Date,d=parseInt(a.substr(0,4),10),b=parseInt(a.substr(4,2),10)-1,e=parseInt(a.substr(6,2),10),f=parseInt(a.substr(8,2),10),h=parseInt(a.substr(10,2),10),q=parseInt(a.substr(12,2),10),p=0,t=0,x=!1;"Z"===a.charAt(a.length-1)&&(x=!0);var s=a.length-5,n=a.charAt(s);if("+"===n||"-"===n)t=
parseInt(a.substr(s+1,2),10),s=parseInt(a.substr(s+4,2),10),t=6E4*(60*t+s),"+"===n&&(t*=-1),x=!0;"."===a.charAt(14)&&(p=1E3*parseFloat(a.substr(14),10));x?(c.setUTCFullYear(d,b,e),c.setUTCHours(f,h,q,p),c.setTime(+c+t)):(c.setFullYear(d,b,e),c.setHours(f,h,q,p));return c};e.dateToUtcTime=function(a){if("string"===typeof a)return a;var c="",d=[];d.push((""+a.getUTCFullYear()).substr(2));d.push(""+(a.getUTCMonth()+1));d.push(""+a.getUTCDate());d.push(""+a.getUTCHours());d.push(""+a.getUTCMinutes());
d.push(""+a.getUTCSeconds());for(a=0;a<d.length;++a)2>d[a].length&&(c+="0"),c+=d[a];return c+"Z"};e.dateToGeneralizedTime=function(a){if("string"===typeof a)return a;var c="",d=[];d.push(""+a.getUTCFullYear());d.push(""+(a.getUTCMonth()+1));d.push(""+a.getUTCDate());d.push(""+a.getUTCHours());d.push(""+a.getUTCMinutes());d.push(""+a.getUTCSeconds());for(a=0;a<d.length;++a)2>d[a].length&&(c+="0"),c+=d[a];return c+"Z"};e.integerToDer=function(c){var e=a.util.createBuffer();if(-128<=c&&128>c)return e.putSignedInt(c,
8);if(-32768<=c&&32768>c)return e.putSignedInt(c,16);if(-8388608<=c&&8388608>c)return e.putSignedInt(c,24);if(-2147483648<=c&&2147483648>c)return e.putSignedInt(c,32);e=Error("Integer too large; max is 32-bits.");e.integer=c;throw e;};e.derToInteger=function(c){"string"===typeof c&&(c=a.util.createBuffer(c));var e=8*c.length();if(32<e)throw Error("Integer too large; max is 32-bits.");return c.getSignedInt(e)};e.validate=function(c,h,d,b){var m=!1;if(c.tagClass!==h.tagClass&&"undefined"!==typeof h.tagClass||
c.type!==h.type&&"undefined"!==typeof h.type)b&&(c.tagClass!==h.tagClass&&b.push("["+h.name+'] Expected tag class "'+h.tagClass+'", got "'+c.tagClass+'"'),c.type!==h.type&&b.push("["+h.name+'] Expected type "'+h.type+'", got "'+c.type+'"'));else if(c.constructed===h.constructed||"undefined"===typeof h.constructed){m=!0;if(h.value&&a.util.isArray(h.value))for(var f=0,u=0;m&&u<h.value.length;++u)m=h.value[u].optional||!1,c.value[f]&&((m=e.validate(c.value[f],h.value[u],d,b))?++f:h.value[u].optional&&
(m=!0)),!m&&b&&b.push("["+h.name+'] Tag class "'+h.tagClass+'", type "'+h.type+'" expected value length "'+h.value.length+'", got "'+c.value.length+'"');m&&d&&(h.capture&&(d[h.capture]=c.value),h.captureAsn1&&(d[h.captureAsn1]=c))}else b&&b.push("["+h.name+'] Expected constructed "'+h.constructed+'", got "'+c.constructed+'"');return m};var h=/[^\\u0000-\\u00ff]/;e.prettyPrint=function(c,A,d){var b="";A=A||0;d=d||2;0<A&&(b+="\n");for(var m="",f=0;f<A*d;++f)m+=" ";b+=m+"Tag: ";switch(c.tagClass){case e.Class.UNIVERSAL:b+=
"Universal:";break;case e.Class.APPLICATION:b+="Application:";break;case e.Class.CONTEXT_SPECIFIC:b+="Context-Specific:";break;case e.Class.PRIVATE:b+="Private:"}if(c.tagClass===e.Class.UNIVERSAL)switch(b+=c.type,c.type){case e.Type.NONE:b+=" (None)";break;case e.Type.BOOLEAN:b+=" (Boolean)";break;case e.Type.BITSTRING:b+=" (Bit string)";break;case e.Type.INTEGER:b+=" (Integer)";break;case e.Type.OCTETSTRING:b+=" (Octet string)";break;case e.Type.NULL:b+=" (Null)";break;case e.Type.OID:b+=" (Object Identifier)";
break;case e.Type.ODESC:b+=" (Object Descriptor)";break;case e.Type.EXTERNAL:b+=" (External or Instance of)";break;case e.Type.REAL:b+=" (Real)";break;case e.Type.ENUMERATED:b+=" (Enumerated)";break;case e.Type.EMBEDDED:b+=" (Embedded PDV)";break;case e.Type.UTF8:b+=" (UTF8)";break;case e.Type.ROID:b+=" (Relative Object Identifier)";break;case e.Type.SEQUENCE:b+=" (Sequence)";break;case e.Type.SET:b+=" (Set)";break;case e.Type.PRINTABLESTRING:b+=" (Printable String)";break;case e.Type.IA5String:b+=
" (IA5String (ASCII))";break;case e.Type.UTCTIME:b+=" (UTC time)";break;case e.Type.GENERALIZEDTIME:b+=" (Generalized time)";break;case e.Type.BMPSTRING:b+=" (BMP String)"}else b+=c.type;b=b+"\n"+(m+"Constructed: "+c.constructed+"\n");if(c.composed){for(var u=0,q="",f=0;f<c.value.length;++f)void 0!==c.value[f]&&(u+=1,q+=e.prettyPrint(c.value[f],A+1,d),f+1<c.value.length&&(q+=","));b+=m+"Sub values: "+u+q}else if(b+=m+"Value: ",c.type===e.Type.OID&&(A=e.derToOid(c.value),b+=A,a.pki&&a.pki.oids&&A in
a.pki.oids&&(b+=" ("+a.pki.oids[A]+") ")),c.type===e.Type.INTEGER)try{b+=e.derToInteger(c.value)}catch(p){b+="0x"+a.util.bytesToHex(c.value)}else c.type===e.Type.OCTETSTRING?(h.test(c.value)||(b+="("+c.value+") "),b+="0x"+a.util.bytesToHex(c.value)):b=c.type===e.Type.UTF8?b+a.util.decodeUtf8(c.value):c.type===e.Type.PRINTABLESTRING||c.type===e.Type.IA5String?b+c.value:h.test(c.value)?b+("0x"+a.util.bytesToHex(c.value)):0===c.value.length?b+"[null]":b+c.value;return b}}if("function"!==typeof l)if("object"===
typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.asn1)return c.asn1;c.defined.asn1=!0;for(var g=0;g<e.length;++g)e[g](c);return c.asn1}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,
Array.prototype.slice.call(arguments,0))};l("js/asn1",["require","module","./util","./oids"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(){g=String.fromCharCode(128);g+=a.util.fillString(String.fromCharCode(0),64);A=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9];d=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,
5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21];b=Array(64);for(var c=0;64>c;++c)b[c]=Math.floor(4294967296*Math.abs(Math.sin(c+1)));m=!0}function c(a,c,e){for(var g,m,h,s,n,r,y,B=e.length();64<=B;){m=a.h0;h=a.h1;s=a.h2;n=a.h3;for(y=0;16>y;++y)c[y]=e.getInt32Le(),g=n^h&(s^n),g=m+g+b[y]+c[y],r=d[y],m=n,n=s,s=h,h+=g<<r|g>>>32-r;for(;32>y;++y)g=s^n&(h^s),g=m+g+b[y]+c[A[y]],r=d[y],m=n,n=s,s=h,h+=g<<r|g>>>32-r;for(;48>y;++y)g=h^s^n,g=m+g+b[y]+
c[A[y]],r=d[y],m=n,n=s,s=h,h+=g<<r|g>>>32-r;for(;64>y;++y)g=s^(h|~n),g=m+g+b[y]+c[A[y]],r=d[y],m=n,n=s,s=h,h+=g<<r|g>>>32-r;a.h0=a.h0+m|0;a.h1=a.h1+h|0;a.h2=a.h2+s|0;a.h3=a.h3+n|0;B-=64}}var h=a.md5=a.md5||{};a.md=a.md||{};a.md.algorithms=a.md.algorithms||{};a.md.md5=a.md.algorithms.md5=h;h.create=function(){m||e();var b=null,d=a.util.createBuffer(),q=Array(16),p={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){p.messageLength=
0;p.fullMessageLength=p.messageLength64=[];for(var c=p.messageLengthSize/4,e=0;e<c;++e)p.fullMessageLength.push(0);d=a.util.createBuffer();b={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878};return p}};p.start();p.update=function(e,g){"utf8"===g&&(e=a.util.encodeUtf8(e));var m=e.length;p.messageLength+=m;for(var m=[m/4294967296>>>0,m>>>0],n=p.fullMessageLength.length-1;0<=n;--n)p.fullMessageLength[n]+=m[1],m[1]=m[0]+(p.fullMessageLength[n]/4294967296>>>0),p.fullMessageLength[n]>>>=0,m[0]=m[1]/
4294967296>>>0;d.putBytes(e);c(b,q,d);(2048<d.read||0===d.length())&&d.compact();return p};p.digest=function(){var e=a.util.createBuffer();e.putBytes(d.bytes());e.putBytes(g.substr(0,p.blockLength-(p.fullMessageLength[p.fullMessageLength.length-1]+p.messageLengthSize&p.blockLength-1)));for(var m,h=0,n=p.fullMessageLength.length-1;0<=n;--n)m=8*p.fullMessageLength[n]+h,h=m/4294967296>>>0,e.putInt32Le(m>>>0);m={h0:b.h0,h1:b.h1,h2:b.h2,h3:b.h3};c(m,q,e);e=a.util.createBuffer();e.putInt32Le(m.h0);e.putInt32Le(m.h1);
e.putInt32Le(m.h2);e.putInt32Le(m.h3);return e};return p};var g=null,A=null,d=null,b=null,m=!1}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.md5)return c.md5;c.defined.md5=!0;for(var g=0;g<e.length;++g)e[g](c);return c.md5}},z=l;l=function(a,e){v=
"string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/md5",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a,d,b){for(var c,f,e,g,p,h,x,s,n=b.length();64<=n;){f=a.h0;e=a.h1;g=a.h2;p=a.h3;h=a.h4;for(s=0;16>s;++s)c=b.getInt32(),d[s]=c,x=p^e&(g^p),c=(f<<5|f>>>27)+x+h+1518500249+
c,h=p,p=g,g=e<<30|e>>>2,e=f,f=c;for(;20>s;++s)c=d[s-3]^d[s-8]^d[s-14]^d[s-16],c=c<<1|c>>>31,d[s]=c,x=p^e&(g^p),c=(f<<5|f>>>27)+x+h+1518500249+c,h=p,p=g,g=e<<30|e>>>2,e=f,f=c;for(;32>s;++s)c=d[s-3]^d[s-8]^d[s-14]^d[s-16],c=c<<1|c>>>31,d[s]=c,x=e^g^p,c=(f<<5|f>>>27)+x+h+1859775393+c,h=p,p=g,g=e<<30|e>>>2,e=f,f=c;for(;40>s;++s)c=d[s-6]^d[s-16]^d[s-28]^d[s-32],c=c<<2|c>>>30,d[s]=c,x=e^g^p,c=(f<<5|f>>>27)+x+h+1859775393+c,h=p,p=g,g=e<<30|e>>>2,e=f,f=c;for(;60>s;++s)c=d[s-6]^d[s-16]^d[s-28]^d[s-32],c=c<<
2|c>>>30,d[s]=c,x=e&g|p&(e^g),c=(f<<5|f>>>27)+x+h+2400959708+c,h=p,p=g,g=e<<30|e>>>2,e=f,f=c;for(;80>s;++s)c=d[s-6]^d[s-16]^d[s-28]^d[s-32],c=c<<2|c>>>30,d[s]=c,x=e^g^p,c=(f<<5|f>>>27)+x+h+3395469782+c,h=p,p=g,g=e<<30|e>>>2,e=f,f=c;a.h0=a.h0+f|0;a.h1=a.h1+e|0;a.h2=a.h2+g|0;a.h3=a.h3+p|0;a.h4=a.h4+h|0;n-=64}}var c=a.sha1=a.sha1||{};a.md=a.md||{};a.md.algorithms=a.md.algorithms||{};a.md.sha1=a.md.algorithms.sha1=c;c.create=function(){g||(h=String.fromCharCode(128),h+=a.util.fillString(String.fromCharCode(0),
64),g=!0);var c=null,d=a.util.createBuffer(),b=Array(80),m={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){m.messageLength=0;m.fullMessageLength=m.messageLength64=[];for(var b=m.messageLengthSize/4,e=0;e<b;++e)m.fullMessageLength.push(0);d=a.util.createBuffer();c={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520};return m}};m.start();m.update=function(f,g){"utf8"===g&&(f=a.util.encodeUtf8(f));var h=f.length;
m.messageLength+=h;for(var h=[h/4294967296>>>0,h>>>0],p=m.fullMessageLength.length-1;0<=p;--p)m.fullMessageLength[p]+=h[1],h[1]=h[0]+(m.fullMessageLength[p]/4294967296>>>0),m.fullMessageLength[p]>>>=0,h[0]=h[1]/4294967296>>>0;d.putBytes(f);e(c,b,d);(2048<d.read||0===d.length())&&d.compact();return m};m.digest=function(){var f=a.util.createBuffer();f.putBytes(d.bytes());f.putBytes(h.substr(0,m.blockLength-(m.fullMessageLength[m.fullMessageLength.length-1]+m.messageLengthSize&m.blockLength-1)));a.util.createBuffer();
for(var g,q,p=8*m.fullMessageLength[0],t=0;t<m.fullMessageLength.length;++t)g=8*m.fullMessageLength[t+1],q=g/4294967296>>>0,p+=q,f.putInt32(p>>>0),p=g;g={h0:c.h0,h1:c.h1,h2:c.h2,h3:c.h3,h4:c.h4};e(g,b,f);f=a.util.createBuffer();f.putInt32(g.h0);f.putInt32(g.h1);f.putInt32(g.h2);f.putInt32(g.h3);f.putInt32(g.h4);return f};return m};var h=null,g=!1}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge=
{}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.sha1)return c.sha1;c.defined.sha1=!0;for(var g=0;g<e.length;++g)e[g](c);return c.sha1}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/sha1",["require","module","./util"],function(){C.apply(null,
Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a,b,c){for(var f,e,g,p,h,x,s,n,r,y,B,l,k,M=c.length();64<=M;){for(h=0;16>h;++h)b[h]=c.getInt32();for(;64>h;++h)f=b[h-2],f=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10,e=b[h-15],e=(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3,b[h]=f+b[h-7]+e+b[h-16]|0;x=a.h0;s=a.h1;n=a.h2;r=a.h3;y=a.h4;B=a.h5;l=a.h6;k=a.h7;for(h=0;64>h;++h)f=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),g=l^y&(B^l),e=(x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10),p=x&s|n&(x^
s),f=k+f+g+A[h]+b[h],e+=p,k=l,l=B,B=y,y=r+f|0,r=n,n=s,s=x,x=f+e|0;a.h0=a.h0+x|0;a.h1=a.h1+s|0;a.h2=a.h2+n|0;a.h3=a.h3+r|0;a.h4=a.h4+y|0;a.h5=a.h5+B|0;a.h6=a.h6+l|0;a.h7=a.h7+k|0;M-=64}}var c=a.sha256=a.sha256||{};a.md=a.md||{};a.md.algorithms=a.md.algorithms||{};a.md.sha256=a.md.algorithms.sha256=c;c.create=function(){g||(h=String.fromCharCode(128),h+=a.util.fillString(String.fromCharCode(0),64),A=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,
607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,
2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=!0);var d=null,b=a.util.createBuffer(),c=Array(64),f={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){f.messageLength=0;f.fullMessageLength=f.messageLength64=[];for(var c=f.messageLengthSize/4,e=0;e<c;++e)f.fullMessageLength.push(0);b=a.util.createBuffer();d={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,
h6:528734635,h7:1541459225};return f}};f.start();f.update=function(g,h){"utf8"===h&&(g=a.util.encodeUtf8(g));var p=g.length;f.messageLength+=p;for(var p=[p/4294967296>>>0,p>>>0],t=f.fullMessageLength.length-1;0<=t;--t)f.fullMessageLength[t]+=p[1],p[1]=p[0]+(f.fullMessageLength[t]/4294967296>>>0),f.fullMessageLength[t]>>>=0,p[0]=p[1]/4294967296>>>0;b.putBytes(g);e(d,c,b);(2048<b.read||0===b.length())&&b.compact();return f};f.digest=function(){var g=a.util.createBuffer();g.putBytes(b.bytes());g.putBytes(h.substr(0,
f.blockLength-(f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize&f.blockLength-1)));a.util.createBuffer();for(var q,p,t=8*f.fullMessageLength[0],x=0;x<f.fullMessageLength.length;++x)q=8*f.fullMessageLength[x+1],p=q/4294967296>>>0,t+=p,g.putInt32(t>>>0),t=q;q={h0:d.h0,h1:d.h1,h2:d.h2,h3:d.h3,h4:d.h4,h5:d.h5,h6:d.h6,h7:d.h7};e(q,c,g);g=a.util.createBuffer();g.putInt32(q.h0);g.putInt32(q.h1);g.putInt32(q.h2);g.putInt32(q.h3);g.putInt32(q.h4);g.putInt32(q.h5);g.putInt32(q.h6);g.putInt32(q.h7);
return g};return f};var h=null,g=!1,A=null}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.sha256)return c.sha256;c.defined.sha256=!0;for(var g=0;g<e.length;++g)e[g](c);return c.sha256}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);
if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/sha256",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a,b,c){for(var e,g,h,x,s,n,r,y,B,A,k,l,S,F,L,I,O,K,N,w,z,v,H,G,J,R=c.length();128<=R;){for(J=0;16>J;++J)b[J][0]=c.getInt32()>>>0,b[J][1]=c.getInt32()>>>0;for(;80>J;++J)s=b[J-2],B=s[0],s=s[1],e=((B>>>19|s<<13)^
(s>>>29|B<<3)^B>>>6)>>>0,g=((B<<13|s>>>19)^(s<<3|B>>>29)^(B<<26|s>>>6))>>>0,s=b[J-15],B=s[0],s=s[1],h=((B>>>1|s<<31)^(B>>>8|s<<24)^B>>>7)>>>0,x=((B<<31|s>>>1)^(B<<24|s>>>8)^(B<<25|s>>>7))>>>0,B=b[J-7],A=b[J-16],s=g+B[1]+x+A[1],b[J][0]=e+B[0]+h+A[0]+(s/4294967296>>>0)>>>0,b[J][1]=s>>>0;B=a[0][0];A=a[0][1];k=a[1][0];l=a[1][1];S=a[2][0];F=a[2][1];L=a[3][0];I=a[3][1];O=a[4][0];K=a[4][1];N=a[5][0];w=a[5][1];z=a[6][0];v=a[6][1];H=a[7][0];G=a[7][1];for(J=0;80>J;++J)e=((O>>>14|K<<18)^(O>>>18|K<<14)^(K>>>
9|O<<23))>>>0,s=((O<<18|K>>>14)^(O<<14|K>>>18)^(K<<23|O>>>9))>>>0,g=(z^O&(N^z))>>>0,n=(v^K&(w^v))>>>0,h=((B>>>28|A<<4)^(A>>>2|B<<30)^(A>>>7|B<<25))>>>0,x=((B<<4|A>>>28)^(A<<30|B>>>2)^(A<<25|B>>>7))>>>0,r=(B&k|S&(B^k))>>>0,y=(A&l|F&(A^l))>>>0,s=G+s+n+d[J][1]+b[J][1],e=H+e+g+d[J][0]+b[J][0]+(s/4294967296>>>0)>>>0,g=s>>>0,s=x+y,h=h+r+(s/4294967296>>>0)>>>0,x=s>>>0,H=z,G=v,z=N,v=w,N=O,w=K,s=I+g,O=L+e+(s/4294967296>>>0)>>>0,K=s>>>0,L=S,I=F,S=k,F=l,k=B,l=A,s=g+x,B=e+h+(s/4294967296>>>0)>>>0,A=s>>>0;s=a[0][1]+
A;a[0][0]=a[0][0]+B+(s/4294967296>>>0)>>>0;a[0][1]=s>>>0;s=a[1][1]+l;a[1][0]=a[1][0]+k+(s/4294967296>>>0)>>>0;a[1][1]=s>>>0;s=a[2][1]+F;a[2][0]=a[2][0]+S+(s/4294967296>>>0)>>>0;a[2][1]=s>>>0;s=a[3][1]+I;a[3][0]=a[3][0]+L+(s/4294967296>>>0)>>>0;a[3][1]=s>>>0;s=a[4][1]+K;a[4][0]=a[4][0]+O+(s/4294967296>>>0)>>>0;a[4][1]=s>>>0;s=a[5][1]+w;a[5][0]=a[5][0]+N+(s/4294967296>>>0)>>>0;a[5][1]=s>>>0;s=a[6][1]+v;a[6][0]=a[6][0]+z+(s/4294967296>>>0)>>>0;a[6][1]=s>>>0;s=a[7][1]+G;a[7][0]=a[7][0]+H+(s/4294967296>>>
0)>>>0;a[7][1]=s>>>0;R-=128}}var c=a.sha512=a.sha512||{};a.md=a.md||{};a.md.algorithms=a.md.algorithms||{};a.md.sha512=a.md.algorithms.sha512=c;var h=a.sha384=a.sha512.sha384=a.sha512.sha384||{};h.create=function(){return c.create("SHA-384")};a.md.sha384=a.md.algorithms.sha384=h;a.sha512.sha256=a.sha512.sha256||{create:function(){return c.create("SHA-512/256")}};a.md["sha512/256"]=a.md.algorithms["sha512/256"]=a.sha512.sha256;a.sha512.sha224=a.sha512.sha224||{create:function(){return c.create("SHA-512/224")}};
a.md["sha512/224"]=a.md.algorithms["sha512/224"]=a.sha512.sha224;c.create=function(c){A||(g=String.fromCharCode(128),g+=a.util.fillString(String.fromCharCode(0),128),d=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,
633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],
[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,
1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],
[1816402316,1246189591]],b={"SHA-512":[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],"SHA-384":[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],"SHA-512/256":[[573645204,4230739756],[2673172387,3360449730],[596883563,
1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],"SHA-512/224":[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]]},A=!0);"undefined"===typeof c&&(c="SHA-512");if(!(c in b))throw Error("Invalid SHA-512 algorithm: "+c);for(var f=b[c],h=null,q=a.util.createBuffer(),p=Array(80),t=0;80>t;++t)p[t]=
Array(2);var x={algorithm:c.replace("-","").toLowerCase(),blockLength:128,digestLength:64,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){x.messageLength=0;x.fullMessageLength=x.messageLength128=[];for(var b=x.messageLengthSize/4,d=0;d<b;++d)x.fullMessageLength.push(0);q=a.util.createBuffer();h=Array(f.length);for(d=0;d<f.length;++d)h[d]=f[d].slice(0);return x}};x.start();x.update=function(b,d){"utf8"===d&&(b=a.util.encodeUtf8(b));var c=b.length;x.messageLength+=c;for(var c=
[c/4294967296>>>0,c>>>0],f=x.fullMessageLength.length-1;0<=f;--f)x.fullMessageLength[f]+=c[1],c[1]=c[0]+(x.fullMessageLength[f]/4294967296>>>0),x.fullMessageLength[f]>>>=0,c[0]=c[1]/4294967296>>>0;q.putBytes(b);e(h,p,q);(2048<q.read||0===q.length())&&q.compact();return x};x.digest=function(){var b=a.util.createBuffer();b.putBytes(q.bytes());b.putBytes(g.substr(0,x.blockLength-(x.fullMessageLength[x.fullMessageLength.length-1]+x.messageLengthSize&x.blockLength-1)));a.util.createBuffer();for(var d,
f,y=8*x.fullMessageLength[0],B=0;B<x.fullMessageLength.length;++B)d=8*x.fullMessageLength[B+1],f=d/4294967296>>>0,y+=f,b.putInt32(y>>>0),y=d;d=Array(h.length);for(B=0;B<h.length;++B)d[B]=h[B].slice(0);e(d,p,b);b=a.util.createBuffer();f="SHA-512"===c?d.length:"SHA-384"===c?d.length-2:d.length-4;for(B=0;B<f;++B)b.putInt32(d[B][0]),B===f-1&&"SHA-512/224"===c||b.putInt32(d[B][1]);return b};return x};var g=null,A=!1,d=null,b=null}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=
!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.sha512)return c.sha512;c.defined.sha512=!0;for(var g=0;g<e.length;++g)e[g](c);return c.sha512}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,
0))};l("js/sha512",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){a.md=a.md||{};a.md.algorithms={md5:a.md5,sha1:a.sha1,sha256:a.sha256};a.md.md5=a.md5;a.md.sha1=a.sha1;a.md.sha256=a.sha256}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);
c=c||{};c.defined=c.defined||{};if(c.defined.md)return c.md;c.defined.md=!0;for(var g=0;g<e.length;++g)e[g](c);return c.md}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/md","require module ./md5 ./sha1 ./sha256 ./sha512".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){(a.hmac=
a.hmac||{}).create=function(){var e=null,c=null,h=null,g={start:function(g,d){if(null!==g)if("string"===typeof g)if(g=g.toLowerCase(),g in a.md.algorithms)e=a.md.algorithms[g].create();else throw Error('Unknown hash algorithm "'+g+'"');else e=g;if(null!==d){if("string"===typeof d)d=a.util.createBuffer(d);else if(a.util.isArray(d)){var b=d;d=a.util.createBuffer();for(var m=0;m<b.length;++m)d.putByte(b[m])}var f=d.length();f>e.blockLength&&(e.start(),e.update(d.bytes()),d=e.digest());c=a.util.createBuffer();
h=a.util.createBuffer();f=d.length();for(m=0;m<f;++m)b=d.at(m),c.putByte(54^b),h.putByte(92^b);if(f<e.blockLength)for(b=e.blockLength-f,m=0;m<b;++m)c.putByte(54),h.putByte(92);c=c.bytes();h=h.bytes()}e.start();e.update(c)},update:function(a){e.update(a)},getMac:function(){var a=e.digest().bytes();e.start();e.update(h);e.update(a);return e.digest()}};g.digest=g.getMac;return g}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===
typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.hmac)return c.hmac;c.defined.hmac=!0;for(var g=0;g<e.length;++g)e[g](c);return c.hmac}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/hmac",["require","module","./md",
"./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a){for(var c=a.name+": ",e=[],d=function(a,b){return" "+b},b=0;b<a.values.length;++b)e.push(a.values[b].replace(/^(\S+\r\n)/,d));c+=e.join(",")+"\r\n";e=0;a=-1;for(b=0;b<c.length;++b,++e)if(65<e&&-1!==a)e=c[a],","===e?(++a,c=c.substr(0,a)+"\r\n "+c.substr(a)):c=c.substr(0,a)+"\r\n"+e+c.substr(a+1),e=b-a-1,a=-1,++b;else if(" "===c[b]||"\t"===c[b]||","===c[b])a=b;return c}var c=a.pem=
a.pem||{};c.encode=function(c,g){g=g||{};var A="-----BEGIN "+c.type+"-----\r\n",d;c.procType&&(d={name:"Proc-Type",values:[String(c.procType.version),c.procType.type]},A+=e(d));c.contentDomain&&(d={name:"Content-Domain",values:[c.contentDomain]},A+=e(d));c.dekInfo&&(d={name:"DEK-Info",values:[c.dekInfo.algorithm]},c.dekInfo.parameters&&d.values.push(c.dekInfo.parameters),A+=e(d));if(c.headers)for(d=0;d<c.headers.length;++d)A+=e(c.headers[d]);c.procType&&(A+="\r\n");A+=a.util.encode64(c.body,g.maxline||
64)+"\r\n";return A+="-----END "+c.type+"-----\r\n"};c.decode=function(c){for(var e=[],A=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,d=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,b=/\r?\n/,m;;){m=A.exec(c);if(!m)break;var f={type:m[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:a.util.decode64(m[3])};e.push(f);if(m[2]){for(var u=m[2].split(b),q=0;m&&q<u.length;){m=u[q].replace(/\s+$/,"");for(var p=q+1;p<u.length;++p){var t=
u[p];if(!/\s/.test(t[0]))break;m+=t;q=p}if(m=m.match(d)){for(var p={name:m[1],values:[]},t=m[2].split(","),x=0;x<t.length;++x)p.values.push(t[x].replace(/^\s+/,""));if(f.procType)if(f.contentDomain||"Content-Domain"!==p.name)if(f.dekInfo||"DEK-Info"!==p.name)f.headers.push(p);else{if(0===p.values.length)throw Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');f.dekInfo={algorithm:t[0],parameters:t[1]||null}}else f.contentDomain=t[0]||"";else{if("Proc-Type"!==
p.name)throw Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==p.values.length)throw Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');f.procType={version:t[0],type:t[1]}}}++q}if("ENCRYPTED"===f.procType&&!f.dekInfo)throw Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".');}}if(0===e.length)throw Error("Invalid PEM formatted message.");return e}}if("function"!==
typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.pem)return c.pem;c.defined.pem=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pem}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,
0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/pem",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(b,d){a.cipher.registerAlgorithm(b,function(){return new a.des.Algorithm(b,d)})}function c(a,c,e,h){var n=32===a.length?3:9;h=3===n?h?[30,-2,-2]:[0,32,2]:h?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var r=c[0],y=c[1];c=(r>>>4^y)&252645135;y^=c;r^=c<<4;c=(r>>>16^y)&65535;y^=
c;r^=c<<16;c=(y>>>2^r)&858993459;r^=c;y^=c<<2;c=(y>>>8^r)&16711935;r^=c;y^=c<<8;c=(r>>>1^y)&1431655765;for(var y=y^c,r=r^c<<1,r=r<<1|r>>>31,y=y<<1|y>>>31,B=0;B<n;B+=3){for(var l=h[B+1],k=h[B+2],M=h[B];M!=l;M+=k){var w=y^a[M],F=(y>>>4|y<<28)^a[M+1];c=r;r=y;y=c^(A[w>>>24&63]|b[w>>>16&63]|f[w>>>8&63]|q[w&63]|g[F>>>24&63]|d[F>>>16&63]|m[F>>>8&63]|u[F&63])}c=r;r=y;y=c}r=r>>>1|r<<31;y=y>>>1|y<<31;c=(r>>>1^y)&1431655765;y^=c;r^=c<<1;c=(y>>>8^r)&16711935;r^=c;y^=c<<8;c=(y>>>2^r)&858993459;r^=c;y^=c<<2;c=
(r>>>16^y)&65535;y^=c;r^=c<<16;c=(r>>>4^y)&252645135;e[0]=r^c<<4;e[1]=y^c}function h(b){b=b||{};var d="DES-"+(b.mode||"CBC").toUpperCase(),c;c=b.decrypt?a.cipher.createDecipher(d,b.key):a.cipher.createCipher(d,b.key);var f=c.start;c.start=function(b,d){var e=null;d instanceof a.util.ByteBuffer&&(e=d,d={});d=d||{};d.output=e;d.iv=b;f.call(c,d)};return c}a.des=a.des||{};a.des.startEncrypting=function(a,b,d,c){a=h({key:a,output:d,decrypt:!1,mode:c||(null===b?"ECB":"CBC")});a.start(b);return a};a.des.createEncryptionCipher=
function(a,b){return h({key:a,output:null,decrypt:!1,mode:b})};a.des.startDecrypting=function(a,b,d,c){a=h({key:a,output:d,decrypt:!0,mode:c||(null===b?"ECB":"CBC")});a.start(b);return a};a.des.createDecryptionCipher=function(a,b){return h({key:a,output:null,decrypt:!0,mode:b})};a.des.Algorithm=function(a,b){var d=this;d.name=a;d.mode=new b({blockSize:8,cipher:{encrypt:function(a,b){return c(d._keys,a,b,!1)},decrypt:function(a,b){return c(d._keys,a,b,!0)}}});d._init=!1};a.des.Algorithm.prototype.initialize=
function(b){if(!this._init){b=a.util.createBuffer(b.key);if(0===this.name.indexOf("3DES")&&24!==b.length())throw Error("Invalid Triple-DES key size: "+8*b.length());for(var d=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],c=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],f=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,
16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],e=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],g=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],h=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],q=[0,65536,2048,67584,536870912,536936448,
536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],k=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],m=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],u=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],F=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,
69206016,85983232,69206528,85983744],L=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],I=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],l=8<b.length()?3:1,A=[],w=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],z=0,v,D=0;D<l;D++){var H=b.getInt32(),G=b.getInt32();v=(H>>>4^G)&252645135;G^=v;H^=v<<4;v=(G>>>-16^H)&65535;H^=v;G^=v<<-16;v=(H>>>2^G)&858993459;G^=v;H^=v<<2;v=(G>>>-16^H)&65535;H^=v;G^=v<<-16;v=(H>>>1^G)&1431655765;G^=v;H^=v<<
1;v=(G>>>8^H)&16711935;H^=v;G^=v<<8;v=(H>>>1^G)&1431655765;G^=v;H^=v<<1;v=H<<8|G>>>20&240;for(var H=G<<24|G<<8&16711680|G>>>8&65280|G>>>24&240,G=v,J=0;J<w.length;++J){w[J]?(H=H<<2|H>>>26,G=G<<2|G>>>26):(H=H<<1|H>>>27,G=G<<1|G>>>27);var H=H&-15,G=G&-15,R=d[H>>>28]|c[H>>>24&15]|f[H>>>20&15]|n[H>>>16&15]|e[H>>>12&15]|g[H>>>8&15]|h[H>>>4&15],U=q[G>>>28]|k[G>>>24&15]|m[G>>>20&15]|u[G>>>16&15]|F[G>>>12&15]|L[G>>>8&15]|I[G>>>4&15];v=(U>>>16^R)&65535;A[z++]=R^v;A[z++]=U^v<<16}}this._keys=A;this._init=!0}};
e("DES-ECB",a.cipher.modes.ecb);e("DES-CBC",a.cipher.modes.cbc);e("DES-CFB",a.cipher.modes.cfb);e("DES-OFB",a.cipher.modes.ofb);e("DES-CTR",a.cipher.modes.ctr);e("3DES-ECB",a.cipher.modes.ecb);e("3DES-CBC",a.cipher.modes.cbc);e("3DES-CFB",a.cipher.modes.cfb);e("3DES-OFB",a.cipher.modes.ofb);e("3DES-CTR",a.cipher.modes.ctr);var g=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,
16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],A=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,
-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],d=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,
134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],b=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,
8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],m=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,
524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,
541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],u=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,
2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],q=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,
268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696]}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);
c=c||{};c.defined=c.defined||{};if(c.defined.des)return c.des;c.defined.des=!0;for(var g=0;g<e.length;++g)e[g](c);return c.des}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/des",["require","module","./cipher","./cipherModes","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){var e=
a.pkcs5=a.pkcs5||{},c="undefined"!==typeof process&&process.versions&&process.versions.node,h;c&&!a.disableNativeCode&&(h=E("crypto"));a.pbkdf2=e.pbkdf2=function(e,l,d,b,m,f){function u(){if(P>t)return f(null,n);s.start(null,null);s.update(l);s.update(a.util.int32ToBytes(P));r=B=s.digest().getBytes();k=2;q()}function q(){if(k<=d)return s.start(null,null),s.update(B),y=s.digest().getBytes(),r=a.util.xorBytes(r,y,p),B=y,++k,a.util.setImmediate(q);n+=P<t?r:r.substr(0,x);++P;u()}"function"===typeof m&&
(f=m,m=null);if(c&&!a.disableNativeCode&&h.pbkdf2&&(null===m||"object"!==typeof m)&&(4<h.pbkdf2Sync.length||!m||"sha1"===m))return"string"!==typeof m&&(m="sha1"),l=new Buffer(l,"binary"),f?4===h.pbkdf2Sync.length?h.pbkdf2(e,l,d,b,function(a,b){if(a)return f(a);f(null,b.toString("binary"))}):h.pbkdf2(e,l,d,b,m,function(a,b){if(a)return f(a);f(null,b.toString("binary"))}):4===h.pbkdf2Sync.length?h.pbkdf2Sync(e,l,d,b).toString("binary"):h.pbkdf2Sync(e,l,d,b,m).toString("binary");if("undefined"===typeof m||
null===m)m=a.md.sha1.create();if("string"===typeof m){if(!(m in a.md.algorithms))throw Error("Unknown hash algorithm: "+m);m=a.md[m].create()}var p=m.digestLength;if(b>4294967295*p){e=Error("Derived key is too long.");if(f)return f(e);throw e;}var t=Math.ceil(b/p),x=b-(t-1)*p,s=a.hmac.create();s.start(m,e);var n="",r,y,B;if(!f){for(var P=1;P<=t;++P){s.start(null,null);s.update(l);s.update(a.util.int32ToBytes(P));r=B=s.digest().getBytes();for(var k=2;k<=d;++k)s.start(null,null),s.update(B),y=s.digest().getBytes(),
r=a.util.xorBytes(r,y,p),B=y;n+=P<t?r:r.substr(0,x)}return n}P=1;u()}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.pbkdf2)return c.pbkdf2;c.defined.pbkdf2=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pbkdf2}},z=l;l=function(a,e){v="string"===
typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/pbkdf2",["require","module","./hmac","./md","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){var e="undefined"!==typeof process&&process.versions&&process.versions.node,c=null;a.disableNativeCode||!e||process.versions["node-webkit"]||(c=E("crypto"));(a.prng=a.prng||
{}).create=function(e){function g(a){if(32<=b.pools[0].messageLength)return l(),a();b.seedFile(32-b.pools[0].messageLength<<5,function(d,c){if(d)return a(d);b.collect(c);l();a()})}function l(){var a=b.plugin.md.create();a.update(b.pools[0].digest().getBytes());b.pools[0].start();for(var d=1,c=1;32>c;++c)d=31===d?2147483648:d<<2,0===d%b.reseeds&&(a.update(b.pools[c].digest().getBytes()),b.pools[c].start());d=a.digest().getBytes();a.start();a.update(d);a=a.digest().getBytes();b.key=b.plugin.formatKey(d);
b.seed=b.plugin.formatSeed(a);b.reseeds=4294967295===b.reseeds?0:b.reseeds+1;b.generated=0}function d(b){var d=null;if("undefined"!==typeof window){var c=window.crypto||window.msCrypto;c&&c.getRandomValues&&(d=function(a){return c.getRandomValues(a)})}var f=a.util.createBuffer();if(d)for(;f.length()<b;){var e=Math.max(1,Math.min(b-f.length(),65536)/4),g=new Uint32Array(Math.floor(e));try{for(d(g),e=0;e<g.length;++e)f.putInt32(g[e])}catch(n){if(!("undefined"!==typeof QuotaExceededError&&n instanceof
QuotaExceededError))throw n;}}if(f.length()<b)for(d=Math.floor(65536*Math.random());f.length()<b;)for(e=16807*(d&65535),d=16807*(d>>16),e+=(d&32767)<<16,e+=d>>15,e=(e&2147483647)+(e>>31),d=e&4294967295,e=0;3>e;++e)g=d>>>(e<<3),g^=Math.floor(256*Math.random()),f.putByte(String.fromCharCode(g&255));return f.getBytes(b)}var b={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0};e=e.md;for(var m=Array(32),f=0;32>f;++f)m[f]=e.create();b.pools=m;b.pool=0;b.generate=function(d,c){function f(y){if(y)return c(y);
if(r.length()>=d)return c(null,r.getBytes(d));1048575<b.generated&&(b.key=null);if(null===b.key)return a.util.nextTick(function(){g(f)});y=e(b.key,b.seed);b.generated+=y.length;r.putBytes(y);b.key=m(e(b.key,h(b.seed)));b.seed=n(e(b.key,b.seed));a.util.setImmediate(f)}if(!c)return b.generateSync(d);var e=b.plugin.cipher,h=b.plugin.increment,m=b.plugin.formatKey,n=b.plugin.formatSeed,r=a.util.createBuffer();b.key=null;f()};b.generateSync=function(d){var c=b.plugin.cipher,f=b.plugin.increment,e=b.plugin.formatKey,
g=b.plugin.formatSeed;b.key=null;for(var h=a.util.createBuffer();h.length()<d;){1048575<b.generated&&(b.key=null);null===b.key&&(32<=b.pools[0].messageLength||b.collect(b.seedFileSync(32-b.pools[0].messageLength<<5)),l());var n=c(b.key,b.seed);b.generated+=n.length;h.putBytes(n);b.key=e(c(b.key,f(b.seed)));b.seed=g(c(b.key,b.seed))}return h.getBytes(d)};c?(b.seedFile=function(a,b){c.randomBytes(a,function(a,d){if(a)return b(a);b(null,d.toString())})},b.seedFileSync=function(a){return c.randomBytes(a).toString()}):
(b.seedFile=function(a,b){try{b(null,d(a))}catch(c){b(c)}},b.seedFileSync=d);b.collect=function(a){for(var d=a.length,c=0;c<d;++c)b.pools[b.pool].update(a.substr(c,1)),b.pool=31===b.pool?0:b.pool+1};b.collectInt=function(a,d){for(var c="",f=0;f<d;f+=8)c+=String.fromCharCode(a>>f&255);b.collect(c)};b.registerWorker=function(a){a===self?b.seedFile=function(a,b){function d(a){a=a.data;a.forge&&a.forge.prng&&(self.removeEventListener("message",d),b(a.forge.prng.err,a.forge.prng.bytes))}self.addEventListener("message",
d);self.postMessage({forge:{prng:{needed:a}}})}:a.addEventListener("message",function(d){d=d.data;d.forge&&d.forge.prng&&b.seedFile(d.forge.prng.needed,function(b,d){a.postMessage({forge:{prng:{err:b,bytes:d}}})})})};return b}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=
c.defined||{};if(c.defined.prng)return c.prng;c.defined.prng=!0;for(var g=0;g<e.length;++g)e[g](c);return c.prng}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/prng",["require","module","./md","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){a.random&&a.random.getBytes||function(e){function c(){var b=
a.prng.create(h);b.getBytes=function(a,d){return b.generate(a,d)};b.getBytesSync=function(a){return b.generate(a)};return b}var h={},g=Array(4),l=a.util.createBuffer();h.formatKey=function(b){var d=a.util.createBuffer(b);b=Array(4);b[0]=d.getInt32();b[1]=d.getInt32();b[2]=d.getInt32();b[3]=d.getInt32();return a.aes._expandKey(b,!1)};h.formatSeed=function(b){var d=a.util.createBuffer(b);b=Array(4);b[0]=d.getInt32();b[1]=d.getInt32();b[2]=d.getInt32();b[3]=d.getInt32();return b};h.cipher=function(b,
d){a.aes._updateBlock(b,d,g,!1);l.putInt32(g[0]);l.putInt32(g[1]);l.putInt32(g[2]);l.putInt32(g[3]);return l.getBytes()};h.increment=function(a){++a[3];return a};h.md=a.md.sha256;var d=c(),b="undefined"!==typeof process&&process.versions&&process.versions.node,m=null;if("undefined"!==typeof window){var f=window.crypto||window.msCrypto;f&&f.getRandomValues&&(m=function(a){return f.getRandomValues(a)})}if(a.disableNativeCode||!b&&!m){d.collectInt(+new Date,32);if("undefined"!==typeof navigator){var b=
"",u;for(u in navigator)try{"string"==typeof navigator[u]&&(b+=navigator[u])}catch(q){}d.collect(b);b=null}e&&(e().mousemove(function(a){d.collectInt(a.clientX,16);d.collectInt(a.clientY,16)}),e().keypress(function(a){d.collectInt(a.charCode,8)}))}if(a.random)for(u in d)a.random[u]=d[u];else a.random=d;a.random.createInstance=c}("undefined"!==typeof jQuery?jQuery:null)}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===
typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.random)return c.random;c.defined.random=!0;for(var g=0;g<e.length;++g)e[g](c);return c.random}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/random","require module ./aes ./md ./prng ./util".split(" "),
function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){var e=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,
3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,
127,193,173],c=[1,2,3,5];a.rc2=a.rc2||{};a.rc2.expandKey=function(c,h){"string"===typeof c&&(c=a.util.createBuffer(c));h=h||128;var d=c,b=c.length(),m=h,f=Math.ceil(m/8),m=255>>(m&7),l;for(l=b;128>l;l++)d.putByte(e[d.at(l-1)+d.at(l-b)&255]);d.setAt(128-f,e[d.at(128-f)&m]);for(l=127-f;0<=l;l--)d.setAt(l,e[d.at(l+1)^d.at(l+f)]);return d};var h=function(e,h,d){var b=!1,m=null,f=null,l=null,q,p,t,x,s=[];e=a.rc2.expandKey(e,h);for(t=0;64>t;t++)s.push(e.getInt16Le());d?(q=function(a){for(t=0;4>t;t++){a[t]+=
s[x]+(a[(t+3)%4]&a[(t+2)%4])+(~a[(t+3)%4]&a[(t+1)%4]);var b=a[t],d=c[t];a[t]=b<<d&65535|(b&65535)>>16-d;x++}},p=function(a){for(t=0;4>t;t++)a[t]+=s[a[(t+3)%4]&63]}):(q=function(a){for(t=3;0<=t;t--){var b=a[t],d=c[t];a[t]=(b&65535)>>d|b<<16-d&65535;a[t]-=s[x]+(a[(t+3)%4]&a[(t+2)%4])+(~a[(t+3)%4]&a[(t+1)%4]);x--}},p=function(a){for(t=3;0<=t;t--)a[t]-=s[a[(t+3)%4]&63]});var n=null;return n={start:function(d,c){d&&"string"===typeof d&&(d=a.util.createBuffer(d));b=!1;m=a.util.createBuffer();f=c||new a.util.createBuffer;
l=d;n.output=f},update:function(a){for(b||m.putBuffer(a);8<=m.length();){a=[[5,q],[1,p],[6,q],[1,p],[5,q]];var c=[];for(t=0;4>t;t++){var e=m.getInt16Le();null!==l&&(d?e^=l.getInt16Le():l.putInt16Le(e));c.push(e&65535)}x=d?0:63;for(e=0;e<a.length;e++)for(var n=0;n<a[e][0];n++)a[e][1](c);for(t=0;4>t;t++)null!==l&&(d?l.putInt16Le(c[t]):c[t]^=l.getInt16Le()),f.putInt16Le(c[t])}},finish:function(a){var c=!0;if(d)if(a)c=a(8,m,!d);else{var e=8===m.length()?8:8-m.length();m.fillWithByte(e,e)}c&&(b=!0,n.update());
!d&&(c=0===m.length())&&(a?c=a(8,f,!d):(a=f.length(),e=f.at(a-1),e>a?c=!1:f.truncate(e)));return c}}};a.rc2.startEncrypting=function(c,e,d){c=a.rc2.createEncryptionCipher(c,128);c.start(e,d);return c};a.rc2.createEncryptionCipher=function(a,c){return h(a,c,!0)};a.rc2.startDecrypting=function(c,e,d){c=a.rc2.createDecryptionCipher(c,128);c.start(e,d);return c};a.rc2.createDecryptionCipher=function(a,c){return h(a,c,!1)}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;
l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.rc2)return c.rc2;c.defined.rc2=!0;for(var g=0;g<e.length;++g)e[g](c);return c.rc2}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,
0))};l("js/rc2",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a,b,d){this.data=[];null!=a&&("number"==typeof a?this.fromNumber(a,b,d):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function c(){return new e(null)}function h(a,b,d,c,f,e){for(;0<=--e;){var n=b*this.data[a++]+d.data[c]+f;f=Math.floor(n/67108864);d.data[c++]=n&67108863}return f}function g(a,b,d,c,f,e){var n=b&32767;for(b>>=
15;0<=--e;){var g=this.data[a]&32767,k=this.data[a++]>>15,r=b*g+k*n,g=n*g+((r&32767)<<15)+d.data[c]+(f&1073741823);f=(g>>>30)+(r>>>15)+b*k+(f>>>30);d.data[c++]=g&1073741823}return f}function l(a,b,d,c,f,e){var n=b&16383;for(b>>=14;0<=--e;){var g=this.data[a]&16383,k=this.data[a++]>>14,r=b*g+k*n,g=n*g+((r&16383)<<14)+d.data[c]+f;f=(g>>28)+(r>>14)+b*k;d.data[c++]=g&268435455}return f}function d(a,b){var d=P[a.charCodeAt(b)];return null==d?-1:d}function b(a){var b=c();b.fromInt(a);return b}function m(a){var b=
1,d;0!=(d=a>>>16)&&(a=d,b+=16);0!=(d=a>>8)&&(a=d,b+=8);0!=(d=a>>4)&&(a=d,b+=4);0!=(d=a>>2)&&(a=d,b+=2);0!=a>>1&&(b+=1);return b}function f(a){this.m=a}function u(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}function q(a,b){return a&b}function p(a,b){return a|b}function t(a,b){return a^b}function x(a,b){return a&~b}function s(){}function n(a){return a}function r(a){this.r2=c();this.q3=c();e.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);
this.m=a}function y(){return{nextBytes:function(a){for(var b=0;b<a.length;++b)a[b]=Math.floor(256*Math.random())}}}var B;"undefined"===typeof navigator?(e.prototype.am=l,B=28):"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=g,B=30):"Netscape"!=navigator.appName?(e.prototype.am=h,B=26):(e.prototype.am=l,B=28);e.prototype.DB=B;e.prototype.DM=(1<<B)-1;e.prototype.DV=1<<B;e.prototype.FV=Math.pow(2,52);e.prototype.F1=52-B;e.prototype.F2=2*B-52;var P=[],k;B=48;for(k=0;9>=k;++k)P[B++]=k;
B=97;for(k=10;36>k;++k)P[B++]=k;B=65;for(k=10;36>k;++k)P[B++]=k;f.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a};f.prototype.revert=function(a){return a};f.prototype.reduce=function(a){a.divRemTo(this.m,null,a)};f.prototype.mulTo=function(a,b,d){a.multiplyTo(b,d);this.reduce(d)};f.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};u.prototype.convert=function(a){var b=c();a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);0>a.s&&0<b.compareTo(e.ZERO)&&
this.m.subTo(b,b);return b};u.prototype.revert=function(a){var b=c();a.copyTo(b);this.reduce(b);return b};u.prototype.reduce=function(a){for(;a.t<=this.mt2;)a.data[a.t++]=0;for(var b=0;b<this.m.t;++b){var d=a.data[b]&32767,c=d*this.mpl+((d*this.mph+(a.data[b]>>15)*this.mpl&this.um)<<15)&a.DM,d=b+this.m.t;for(a.data[d]+=this.m.am(0,c,a,b,0,this.m.t);a.data[d]>=a.DV;)a.data[d]-=a.DV,a.data[++d]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)};u.prototype.mulTo=function(a,
b,d){a.multiplyTo(b,d);this.reduce(d)};u.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};e.prototype.copyTo=function(a){for(var b=this.t-1;0<=b;--b)a.data[b]=this.data[b];a.t=this.t;a.s=this.s};e.prototype.fromInt=function(a){this.t=1;this.s=0>a?-1:0;0<a?this.data[0]=a:-1>a?this.data[0]=a+this.DV:this.t=0};e.prototype.fromString=function(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else if(4==b)c=2;else{this.fromRadix(a,b);return}this.s=
this.t=0;for(var f=a.length,n=!1,g=0;0<=--f;){var k=8==c?a[f]&255:d(a,f);0>k?"-"==a.charAt(f)&&(n=!0):(n=!1,0==g?this.data[this.t++]=k:g+c>this.DB?(this.data[this.t-1]|=(k&(1<<this.DB-g)-1)<<g,this.data[this.t++]=k>>this.DB-g):this.data[this.t-1]|=k<<g,g+=c,g>=this.DB&&(g-=this.DB))}8==c&&0!=(a[0]&128)&&(this.s=-1,0<g&&(this.data[this.t-1]|=(1<<this.DB-g)-1<<g));this.clamp();n&&e.ZERO.subTo(this,this)};e.prototype.clamp=function(){for(var a=this.s&this.DM;0<this.t&&this.data[this.t-1]==a;)--this.t};
e.prototype.dlShiftTo=function(a,b){var d;for(d=this.t-1;0<=d;--d)b.data[d+a]=this.data[d];for(d=a-1;0<=d;--d)b.data[d]=0;b.t=this.t+a;b.s=this.s};e.prototype.drShiftTo=function(a,b){for(var d=a;d<this.t;++d)b.data[d-a]=this.data[d];b.t=Math.max(this.t-a,0);b.s=this.s};e.prototype.lShiftTo=function(a,b){var d=a%this.DB,c=this.DB-d,f=(1<<c)-1,e=Math.floor(a/this.DB),n=this.s<<d&this.DM,g;for(g=this.t-1;0<=g;--g)b.data[g+e+1]=this.data[g]>>c|n,n=(this.data[g]&f)<<d;for(g=e-1;0<=g;--g)b.data[g]=0;b.data[e]=
n;b.t=this.t+e+1;b.s=this.s;b.clamp()};e.prototype.rShiftTo=function(a,b){b.s=this.s;var d=Math.floor(a/this.DB);if(d>=this.t)b.t=0;else{var c=a%this.DB,f=this.DB-c,e=(1<<c)-1;b.data[0]=this.data[d]>>c;for(var n=d+1;n<this.t;++n)b.data[n-d-1]|=(this.data[n]&e)<<f,b.data[n-d]=this.data[n]>>c;0<c&&(b.data[this.t-d-1]|=(this.s&e)<<f);b.t=this.t-d;b.clamp()}};e.prototype.subTo=function(a,b){for(var d=0,c=0,f=Math.min(a.t,this.t);d<f;)c+=this.data[d]-a.data[d],b.data[d++]=c&this.DM,c>>=this.DB;if(a.t<
this.t){for(c-=a.s;d<this.t;)c+=this.data[d],b.data[d++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;d<a.t;)c-=a.data[d],b.data[d++]=c&this.DM,c>>=this.DB;c-=a.s}b.s=0>c?-1:0;-1>c?b.data[d++]=this.DV+c:0<c&&(b.data[d++]=c);b.t=d;b.clamp()};e.prototype.multiplyTo=function(a,b){var d=this.abs(),c=a.abs(),f=d.t;for(b.t=f+c.t;0<=--f;)b.data[f]=0;for(f=0;f<c.t;++f)b.data[f+d.t]=d.am(0,c.data[f],b,f,0,d.t);b.s=0;b.clamp();this.s!=a.s&&e.ZERO.subTo(b,b)};e.prototype.squareTo=function(a){for(var b=
this.abs(),d=a.t=2*b.t;0<=--d;)a.data[d]=0;for(d=0;d<b.t-1;++d){var c=b.am(d,b.data[d],a,2*d,0,1);(a.data[d+b.t]+=b.am(d+1,2*b.data[d],a,2*d+1,c,b.t-d-1))>=b.DV&&(a.data[d+b.t]-=b.DV,a.data[d+b.t+1]=1)}0<a.t&&(a.data[a.t-1]+=b.am(d,b.data[d],a,2*d,0,1));a.s=0;a.clamp()};e.prototype.divRemTo=function(a,b,d){var f=a.abs();if(!(0>=f.t)){var n=this.abs();if(n.t<f.t)null!=b&&b.fromInt(0),null!=d&&this.copyTo(d);else{null==d&&(d=c());var g=c(),k=this.s;a=a.s;var r=this.DB-m(f.data[f.t-1]);0<r?(f.lShiftTo(r,
g),n.lShiftTo(r,d)):(f.copyTo(g),n.copyTo(d));f=g.t;n=g.data[f-1];if(0!=n){var y=n*(1<<this.F1)+(1<f?g.data[f-2]>>this.F2:0),h=this.FV/y,y=(1<<this.F1)/y,p=1<<this.F2,q=d.t,B=q-f,l=null==b?c():b;g.dlShiftTo(B,l);0<=d.compareTo(l)&&(d.data[d.t++]=1,d.subTo(l,d));e.ONE.dlShiftTo(f,l);for(l.subTo(g,g);g.t<f;)g.data[g.t++]=0;for(;0<=--B;){var x=d.data[--q]==n?this.DM:Math.floor(d.data[q]*h+(d.data[q-1]+p)*y);if((d.data[q]+=g.am(0,x,d,B,0,f))<x)for(g.dlShiftTo(B,l),d.subTo(l,d);d.data[q]<--x;)d.subTo(l,
d)}null!=b&&(d.drShiftTo(f,b),k!=a&&e.ZERO.subTo(b,b));d.t=f;d.clamp();0<r&&d.rShiftTo(r,d);0>k&&e.ZERO.subTo(d,d)}}}};e.prototype.invDigit=function(){if(1>this.t)return 0;var a=this.data[0];if(0==(a&1))return 0;var b=a&3,b=b*(2-(a&15)*b)&15,b=b*(2-(a&255)*b)&255,b=b*(2-((a&65535)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV;return 0<b?this.DV-b:-b};e.prototype.isEven=function(){return 0==(0<this.t?this.data[0]&1:this.s)};e.prototype.exp=function(a,b){if(4294967295<a||1>a)return e.ONE;var d=c(),f=
c(),n=b.convert(this),g=m(a)-1;for(n.copyTo(d);0<=--g;)if(b.sqrTo(d,f),0<(a&1<<g))b.mulTo(f,n,d);else var k=d,d=f,f=k;return b.revert(d)};e.prototype.toString=function(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var b=(1<<a)-1,d,c=!1,f="",e=this.t,n=this.DB-e*this.DB%a;if(0<e--)for(n<this.DB&&0<(d=this.data[e]>>n)&&(c=!0,f="0123456789abcdefghijklmnopqrstuvwxyz".charAt(d));0<=e;)n<a?
(d=(this.data[e]&(1<<n)-1)<<a-n,d|=this.data[--e]>>(n+=this.DB-a)):(d=this.data[e]>>(n-=a)&b,0>=n&&(n+=this.DB,--e)),0<d&&(c=!0),c&&(f+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(d));return c?f:"0"};e.prototype.negate=function(){var a=c();e.ZERO.subTo(this,a);return a};e.prototype.abs=function(){return 0>this.s?this.negate():this};e.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var d=this.t,b=d-a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--d;)if(0!=(b=this.data[d]-a.data[d]))return b;
return 0};e.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+m(this.data[this.t-1]^this.s&this.DM)};e.prototype.mod=function(a){var b=c();this.abs().divRemTo(a,null,b);0>this.s&&0<b.compareTo(e.ZERO)&&a.subTo(b,b);return b};e.prototype.modPowInt=function(a,b){var d;d=256>a||b.isEven()?new f(b):new u(b);return this.exp(a,d)};e.ZERO=b(0);e.ONE=b(1);s.prototype.convert=n;s.prototype.revert=n;s.prototype.mulTo=function(a,b,d){a.multiplyTo(b,d)};s.prototype.sqrTo=function(a,b){a.squareTo(b)};
r.prototype.convert=function(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=c();a.copyTo(b);this.reduce(b);return b};r.prototype.revert=function(a){return a};r.prototype.reduce=function(a){a.drShiftTo(this.m.t-1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,
a)};r.prototype.mulTo=function(a,b,d){a.multiplyTo(b,d);this.reduce(d)};r.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};var M=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],
v=67108864/M[M.length-1];e.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))};e.prototype.toRadix=function(a){null==a&&(a=10);if(0==this.signum()||2>a||36<a)return"0";var d=this.chunkSize(a),d=Math.pow(a,d),f=b(d),e=c(),n=c(),g="";for(this.divRemTo(f,e,n);0<e.signum();)g=(d+n.intValue()).toString(a).substr(1)+g,e.divRemTo(f,e,n);return n.intValue().toString(a)+g};e.prototype.fromRadix=function(a,b){this.fromInt(0);null==b&&(b=10);for(var c=this.chunkSize(b),f=Math.pow(b,
c),n=!1,g=0,k=0,r=0;r<a.length;++r){var y=d(a,r);0>y?"-"==a.charAt(r)&&0==this.signum()&&(n=!0):(k=b*k+y,++g>=c&&(this.dMultiply(f),this.dAddOffset(k,0),k=g=0))}0<g&&(this.dMultiply(Math.pow(b,g)),this.dAddOffset(k,0));n&&e.ZERO.subTo(this,this)};e.prototype.fromNumber=function(a,b,d){if("number"==typeof b)if(2>a)this.fromInt(1);else for(this.fromNumber(a,d),this.testBit(a-1)||this.bitwiseTo(e.ONE.shiftLeft(a-1),p,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,
0),this.bitLength()>a&&this.subTo(e.ONE.shiftLeft(a-1),this);else{d=[];var c=a&7;d.length=(a>>3)+1;b.nextBytes(d);d[0]=0<c?d[0]&(1<<c)-1:0;this.fromString(d,256)}};e.prototype.bitwiseTo=function(a,b,d){var c,f,e=Math.min(a.t,this.t);for(c=0;c<e;++c)d.data[c]=b(this.data[c],a.data[c]);if(a.t<this.t){f=a.s&this.DM;for(c=e;c<this.t;++c)d.data[c]=b(this.data[c],f);d.t=this.t}else{f=this.s&this.DM;for(c=e;c<a.t;++c)d.data[c]=b(f,a.data[c]);d.t=a.t}d.s=b(this.s,a.s);d.clamp()};e.prototype.changeBit=function(a,
b){var d=e.ONE.shiftLeft(a);this.bitwiseTo(d,b,d);return d};e.prototype.addTo=function(a,b){for(var d=0,c=0,f=Math.min(a.t,this.t);d<f;)c+=this.data[d]+a.data[d],b.data[d++]=c&this.DM,c>>=this.DB;if(a.t<this.t){for(c+=a.s;d<this.t;)c+=this.data[d],b.data[d++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;d<a.t;)c+=a.data[d],b.data[d++]=c&this.DM,c>>=this.DB;c+=a.s}b.s=0>c?-1:0;0<c?b.data[d++]=c:-1>c&&(b.data[d++]=this.DV+c);b.t=d;b.clamp()};e.prototype.dMultiply=function(a){this.data[this.t]=
this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()};e.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this.data[this.t++]=0;for(this.data[b]+=a;this.data[b]>=this.DV;)this.data[b]-=this.DV,++b>=this.t&&(this.data[this.t++]=0),++this.data[b]}};e.prototype.multiplyLowerTo=function(a,b,d){var c=Math.min(this.t+a.t,b);d.s=0;for(d.t=c;0<c;)d.data[--c]=0;var f;for(f=d.t-this.t;c<f;++c)d.data[c+this.t]=this.am(0,a.data[c],d,c,0,this.t);for(f=Math.min(a.t,b);c<f;++c)this.am(0,a.data[c],d,c,
0,b-c);d.clamp()};e.prototype.multiplyUpperTo=function(a,b,d){--b;var c=d.t=this.t+a.t-b;for(d.s=0;0<=--c;)d.data[c]=0;for(c=Math.max(b-this.t,0);c<a.t;++c)d.data[this.t+c-b]=this.am(b-c,a.data[c],d,0,0,this.t+c-b);d.clamp();d.drShiftTo(1,d)};e.prototype.modInt=function(a){if(0>=a)return 0;var b=this.DV%a,d=0>this.s?a-1:0;if(0<this.t)if(0==b)d=this.data[0]%a;else for(var c=this.t-1;0<=c;--c)d=(b*d+this.data[c])%a;return d};e.prototype.millerRabin=function(a){var b=this.subtract(e.ONE),d=b.getLowestSetBit();
if(0>=d)return!1;for(var c=b.shiftRight(d),f=y(),n,g=0;g<a;++g){do n=new e(this.bitLength(),f);while(0>=n.compareTo(e.ONE)||0<=n.compareTo(b));n=n.modPow(c,this);if(0!=n.compareTo(e.ONE)&&0!=n.compareTo(b)){for(var k=1;k++<d&&0!=n.compareTo(b);)if(n=n.modPowInt(2,this),0==n.compareTo(e.ONE))return!1;if(0!=n.compareTo(b))return!1}}return!0};e.prototype.clone=function(){var a=c();this.copyTo(a);return a};e.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==
this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]};e.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24};e.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16};e.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this.data[0]?0:1};e.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var d=this.DB-a*this.DB%8,c,f=0;if(0<a--)for(d<this.DB&&(c=this.data[a]>>d)!=
(this.s&this.DM)>>d&&(b[f++]=c|this.s<<this.DB-d);0<=a;)if(8>d?(c=(this.data[a]&(1<<d)-1)<<8-d,c|=this.data[--a]>>(d+=this.DB-8)):(c=this.data[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(c&128)&&(c|=-256),0==f&&(this.s&128)!=(c&128)&&++f,0<f||c!=this.s)b[f++]=c;return b};e.prototype.equals=function(a){return 0==this.compareTo(a)};e.prototype.min=function(a){return 0>this.compareTo(a)?this:a};e.prototype.max=function(a){return 0<this.compareTo(a)?this:a};e.prototype.and=function(a){var b=c();this.bitwiseTo(a,
q,b);return b};e.prototype.or=function(a){var b=c();this.bitwiseTo(a,p,b);return b};e.prototype.xor=function(a){var b=c();this.bitwiseTo(a,t,b);return b};e.prototype.andNot=function(a){var b=c();this.bitwiseTo(a,x,b);return b};e.prototype.not=function(){for(var a=c(),b=0;b<this.t;++b)a.data[b]=this.DM&~this.data[b];a.t=this.t;a.s=~this.s;return a};e.prototype.shiftLeft=function(a){var b=c();0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b);return b};e.prototype.shiftRight=function(a){var b=c();0>a?this.lShiftTo(-a,
b):this.rShiftTo(a,b);return b};e.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this.data[a]){var b=a*this.DB;a=this.data[a];if(0==a)a=-1;else{var d=0;0==(a&65535)&&(a>>=16,d+=16);0==(a&255)&&(a>>=8,d+=8);0==(a&15)&&(a>>=4,d+=4);0==(a&3)&&(a>>=2,d+=2);0==(a&1)&&++d;a=d}return b+a}return 0>this.s?this.t*this.DB:-1};e.prototype.bitCount=function(){for(var a=0,b=this.s&this.DM,d=0;d<this.t;++d){for(var c=this.data[d]^b,f=0;0!=c;)c&=c-1,++f;a+=f}return a};e.prototype.testBit=function(a){var b=
Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this.data[b]&1<<a%this.DB)};e.prototype.setBit=function(a){return this.changeBit(a,p)};e.prototype.clearBit=function(a){return this.changeBit(a,x)};e.prototype.flipBit=function(a){return this.changeBit(a,t)};e.prototype.add=function(a){var b=c();this.addTo(a,b);return b};e.prototype.subtract=function(a){var b=c();this.subTo(a,b);return b};e.prototype.multiply=function(a){var b=c();this.multiplyTo(a,b);return b};e.prototype.divide=function(a){var b=
c();this.divRemTo(a,b,null);return b};e.prototype.remainder=function(a){var b=c();this.divRemTo(a,null,b);return b};e.prototype.divideAndRemainder=function(a){var b=c(),d=c();this.divRemTo(a,b,d);return[b,d]};e.prototype.modPow=function(a,d){var e=a.bitLength(),n,g=b(1),k;if(0>=e)return g;n=18>e?1:48>e?3:144>e?4:768>e?5:6;k=8>e?new f(d):d.isEven()?new r(d):new u(d);var y=[],h=3,p=n-1,H=(1<<n)-1;y[1]=k.convert(this);if(1<n)for(e=c(),k.sqrTo(y[1],e);h<=H;)y[h]=c(),k.mulTo(e,y[h-2],y[h]),h+=2;for(var q=
a.t-1,B,l=!0,x=c(),e=m(a.data[q])-1;0<=q;){e>=p?B=a.data[q]>>e-p&H:(B=(a.data[q]&(1<<e+1)-1)<<p-e,0<q&&(B|=a.data[q-1]>>this.DB+e-p));for(h=n;0==(B&1);)B>>=1,--h;0>(e-=h)&&(e+=this.DB,--q);if(l)y[B].copyTo(g),l=!1;else{for(;1<h;)k.sqrTo(g,x),k.sqrTo(x,g),h-=2;0<h?k.sqrTo(g,x):(h=g,g=x,x=h);k.mulTo(x,y[B],g)}for(;0<=q&&0==(a.data[q]&1<<e);)k.sqrTo(g,x),h=g,g=x,x=h,0>--e&&(e=this.DB-1,--q)}return k.revert(g)};e.prototype.modInverse=function(a){var d=a.isEven();if(this.isEven()&&d||0==a.signum())return e.ZERO;
for(var c=a.clone(),f=this.clone(),n=b(1),g=b(0),k=b(0),r=b(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),d?(n.isEven()&&g.isEven()||(n.addTo(this,n),g.subTo(a,g)),n.rShiftTo(1,n)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;f.isEven();)f.rShiftTo(1,f),d?(k.isEven()&&r.isEven()||(k.addTo(this,k),r.subTo(a,r)),k.rShiftTo(1,k)):r.isEven()||r.subTo(a,r),r.rShiftTo(1,r);0<=c.compareTo(f)?(c.subTo(f,c),d&&n.subTo(k,n),g.subTo(r,g)):(f.subTo(c,f),d&&k.subTo(n,k),r.subTo(g,r))}if(0!=f.compareTo(e.ONE))return e.ZERO;
if(0<=r.compareTo(a))return r.subtract(a);if(0>r.signum())r.addTo(a,r);else return r;return 0>r.signum()?r.add(a):r};e.prototype.pow=function(a){return this.exp(a,new s)};e.prototype.gcd=function(a){var b=0>this.s?this.negate():this.clone();a=0>a.s?a.negate():a.clone();if(0>b.compareTo(a)){var d=b,b=a;a=d}var d=b.getLowestSetBit(),c=a.getLowestSetBit();if(0>c)return b;d<c&&(c=d);0<c&&(b.rShiftTo(c,b),a.rShiftTo(c,a));for(;0<b.signum();)0<(d=b.getLowestSetBit())&&b.rShiftTo(d,b),0<(d=a.getLowestSetBit())&&
a.rShiftTo(d,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));0<c&&a.lShiftTo(c,a);return a};e.prototype.isProbablePrime=function(a){var b,d=this.abs();if(1==d.t&&d.data[0]<=M[M.length-1]){for(b=0;b<M.length;++b)if(d.data[0]==M[b])return!0;return!1}if(d.isEven())return!1;for(b=1;b<M.length;){for(var c=M[b],f=b+1;f<M.length&&c<v;)c*=M[f++];for(c=d.modInt(c);b<f;)if(0==c%M[b++])return!1}return d.millerRabin(a)};a.jsbn=a.jsbn||{};a.jsbn.BigInteger=e}if("function"!==
typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.jsbn)return c.jsbn;c.defined.jsbn=!0;for(var g=0;g<e.length;++g)e[g](c);return c.jsbn}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,
0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/jsbn",["require","module"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(c,e,l){l||(l=a.md.sha1.create());for(var d="",b=Math.ceil(e/l.digestLength),m=0;m<b;++m){var f=String.fromCharCode(m>>24&255,m>>16&255,m>>8&255,m&255);l.start();l.update(c+f);d+=l.digest().getBytes()}return d.substring(0,e)}var c=a.pkcs1=a.pkcs1||{};c.encode_rsa_oaep=function(c,g,l,d,b){var m,
f,u,q;"string"===typeof l?(m=l,f=d||void 0,u=b||void 0):l&&(m=l.label||void 0,f=l.seed||void 0,u=l.md||void 0,l.mgf1&&l.mgf1.md&&(q=l.mgf1.md));u?u.start():u=a.md.sha1.create();q||(q=u);c=Math.ceil(c.n.bitLength()/8);l=c-2*u.digestLength-2;if(g.length>l)throw q=Error("RSAES-OAEP input message length is too long."),q.length=g.length,q.maxLength=l,q;m||(m="");u.update(m,"raw");m=u.digest();d="";l-=g.length;for(b=0;b<l;b++)d+="\x00";g=m.getBytes()+d+""+g;if(!f)f=a.random.getBytes(u.digestLength);else if(f.length!==
u.digestLength)throw q=Error("Invalid RSAES-OAEP seed. The seed length must match the digest length."),q.seedLength=f.length,q.digestLength=u.digestLength,q;c=e(f,c-u.digestLength-1,q);g=a.util.xorBytes(g,c,g.length);u=e(g,u.digestLength,q);return"\x00"+a.util.xorBytes(f,u,f.length)+g};c.decode_rsa_oaep=function(c,g,l,d){var b,m,f;"string"===typeof l?(b=l,m=d||void 0):l&&(b=l.label||void 0,m=l.md||void 0,l.mgf1&&l.mgf1.md&&(f=l.mgf1.md));l=Math.ceil(c.n.bitLength()/8);if(g.length!==l)throw f=Error("RSAES-OAEP encoded message length is invalid."),
f.length=g.length,f.expectedLength=l,f;void 0===m?m=a.md.sha1.create():m.start();f||(f=m);if(l<2*m.digestLength+2)throw Error("RSAES-OAEP key is too short for the hash function.");b||(b="");m.update(b,"raw");b=m.digest().getBytes();c=g.charAt(0);d=g.substring(1,m.digestLength+1);g=g.substring(1+m.digestLength);var u=e(g,m.digestLength,f);d=a.util.xorBytes(d,u,d.length);f=e(d,l-m.digestLength-1,f);g=a.util.xorBytes(g,f,g.length);l=g.substring(0,m.digestLength);f="\x00"!==c;for(c=0;c<m.digestLength;++c)f|=
b.charAt(c)!==l.charAt(c);b=1;for(m=c=m.digestLength;m<g.length;m++)l=g.charCodeAt(m),d=l&1^1,f|=l&(b?65534:0),b&=d,c+=b;if(f||1!==g.charCodeAt(c))throw Error("Invalid RSAES-OAEP padding.");return g.substring(c+1)}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||
{};if(c.defined.pkcs1)return c.pkcs1;c.defined.pkcs1=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pkcs1}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/pkcs1",["require","module","./util","./random","./sha1"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a,b,d,f){return"workers"in
d?h(a,b,d,f):c(a,b,d,f)}function c(b,d,f,e){var h=g(b,d),n=0,r=l(h.bitLength());"millerRabinTests"in f&&(r=f.millerRabinTests);var y=10;"maxBlockTime"in f&&(y=f.maxBlockTime);var B=+new Date;do{h.bitLength()>b&&(h=g(b,d));if(h.isProbablePrime(r))return e(null,h);h.dAddOffset(m[n++%8],0)}while(0>y||+new Date-B<y);a.util.setImmediate(function(){c(b,d,f,e)})}function h(d,f,e,h){function m(){function a(e){if(!u){--t;var k=e.data;if(k.found){for(e=0;e<c.length;++e)c[e].terminate();u=!0;return h(null,new b(k.prime,
16))}n.bitLength()>d&&(n=g(d,f));k=n.toString(16);e.target.postMessage({hex:k,workLoad:y});n.dAddOffset(B,0)}}r=Math.max(1,r);for(var c=[],e=0;e<r;++e)c[e]=new Worker(l);for(var t=r,e=0;e<r;++e)c[e].addEventListener("message",a);var u=!1}if("undefined"===typeof Worker)return c(d,f,e,h);var n=g(d,f),r=e.workers,y=e.workLoad||100,B=30*y/8,l=e.workerScript||"forge/prime.worker.js";if(-1===r)return a.util.estimateCores(function(a,b){a&&(b=2);r=b-1;m()});m()}function g(a,d){var c=new b(a,d),e=a-1;c.testBit(e)||
c.bitwiseTo(b.ONE.shiftLeft(e),u,c);c.dAddOffset(31-c.mod(f).byteValue(),0);return c}function l(a){return 100>=a?27:150>=a?18:200>=a?15:250>=a?12:300>=a?9:350>=a?8:400>=a?7:500>=a?6:600>=a?5:800>=a?4:1250>=a?3:2}if(!a.prime){var d=a.prime=a.prime||{},b=a.jsbn.BigInteger,m=[6,4,2,4,2,4,6,2],f=new b(null);f.fromInt(30);var u=function(a,b){return a|b};d.generateProbablePrime=function(b,d,c){"function"===typeof d&&(c=d,d={});d=d||{};var f=d.algorithm||"PRIMEINC";"string"===typeof f&&(f={name:f});f.options=
f.options||{};var g=d.prng||a.random;d={nextBytes:function(a){for(var b=g.getBytesSync(a.length),d=0;d<a.length;++d)a[d]=b.charCodeAt(d)}};if("PRIMEINC"===f.name)return e(b,d,f.options,c);throw Error("Invalid prime generation algorithm: "+f.name);}}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);
c=c||{};c.defined=c.defined||{};if(c.defined.prime)return c.prime;c.defined.prime=!0;for(var g=0;g<e.length;++g)e[g](c);return c.prime}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/prime",["require","module","./util","./jsbn","./random"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(b,
d,c){var f=a.util.createBuffer();d=Math.ceil(d.n.bitLength()/8);if(b.length>d-11)throw f=Error("Message is too long for PKCS#1 v1.5 padding."),f.length=b.length,f.max=d-11,f;f.putByte(0);f.putByte(c);d=d-3-b.length;if(0===c||1===c){c=0===c?0:255;for(var e=0;e<d;++e)f.putByte(c)}else for(;0<d;){for(var g=0,h=a.random.getBytes(d),e=0;e<d;++e)c=h.charCodeAt(e),0===c?++g:f.putByte(c);d=g}f.putByte(0);f.putBytes(b);return f}function c(b,d,c,f){d=Math.ceil(d.n.bitLength()/8);b=a.util.createBuffer(b);var e=
b.getByte(),g=b.getByte();if(0!==e||c&&0!==g&&1!==g||!c&&2!=g||c&&0===g&&"undefined"===typeof f)throw Error("Encryption block is invalid.");c=0;if(0===g)for(c=d-3-f,f=0;f<c;++f){if(0!==b.getByte())throw Error("Encryption block is invalid.");}else if(1===g)for(c=0;1<b.length();){if(255!==b.getByte()){--b.read;break}++c}else if(2===g)for(c=0;1<b.length();){if(0===b.getByte()){--b.read;break}++c}if(0!==b.getByte()||c!==d-3-b.length())throw Error("Encryption block is invalid.");return b.getBytes()}function h(b,
c,f){function e(){g(b.pBits,function(a,d){if(a)return f(a);b.p=d;if(null!==b.q)return k(a,b.q);g(b.qBits,k)})}function g(b,d){a.prime.generateProbablePrime(b,h,d)}function k(a,c){if(a)return f(a);b.q=c;if(0>b.p.compareTo(b.q)){var r=b.p;b.p=b.q;b.q=r}0!==b.p.subtract(d.ONE).gcd(b.e).compareTo(d.ONE)?(b.p=null,e()):0!==b.q.subtract(d.ONE).gcd(b.e).compareTo(d.ONE)?(b.q=null,g(b.qBits,k)):(b.p1=b.p.subtract(d.ONE),b.q1=b.q.subtract(d.ONE),b.phi=b.p1.multiply(b.q1),0!==b.phi.gcd(b.e).compareTo(d.ONE)?
(b.p=b.q=null,e()):(b.n=b.p.multiply(b.q),b.n.bitLength()!==b.bits?(b.q=null,g(b.qBits,k)):(r=b.e.modInverse(b.phi),b.keys={privateKey:m.rsa.setPrivateKey(b.n,b.e,r,b.p,b.q,r.mod(b.p1),r.mod(b.q1),b.q.modInverse(b.p)),publicKey:m.rsa.setPublicKey(b.n,b.e)},f(null,b.keys))))}"function"===typeof c&&(f=c,c={});c=c||{};var h={algorithm:{name:c.algorithm||"PRIMEINC",options:{workers:c.workers||2,workLoad:c.workLoad||100,workerScript:c.workerScript}}};"prng"in c&&(h.prng=c.prng);e()}function g(b){b=b.toString(16);
"8"<=b[0]&&(b="00"+b);return a.util.hexToBytes(b)}function l(a){return 100>=a?27:150>=a?18:200>=a?15:250>=a?12:300>=a?9:350>=a?8:400>=a?7:500>=a?6:600>=a?5:800>=a?4:1250>=a?3:2}if("undefined"===typeof d)var d=a.jsbn.BigInteger;var b=a.asn1;a.pki=a.pki||{};a.pki.rsa=a.rsa=a.rsa||{};var m=a.pki,f=[6,4,2,4,2,4,6,2],u={name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,
capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},q={name:"RSAPrivateKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",
tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",
tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:b.Class.UNIVERSAL,
type:b.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},p={name:"RSAPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},t=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,
constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:b.Class.UNIVERSAL,
type:b.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},x=function(a){var d;if(a.algorithm in m.oids)d=m.oids[a.algorithm];else throw d=Error("Unknown message digest algorithm."),d.algorithm=a.algorithm,d;var c=b.oidToDer(d).getBytes();d=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);var f=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);f.value.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,c));f.value.push(b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,""));a=b.create(b.Class.UNIVERSAL,
b.Type.OCTETSTRING,!1,a.digest().getBytes());d.value.push(f);d.value.push(a);return b.toDer(d).getBytes()},s=function(b,c,f){if(f)return b.modPow(c.e,c.n);if(!c.p||!c.q)return b.modPow(c.d,c.n);c.dP||(c.dP=c.d.mod(c.p.subtract(d.ONE)));c.dQ||(c.dQ=c.d.mod(c.q.subtract(d.ONE)));c.qInv||(c.qInv=c.q.modInverse(c.p));do f=new d(a.util.bytesToHex(a.random.getBytes(c.n.bitLength()/8)),16);while(0<=f.compareTo(c.n)||!f.gcd(c.n).equals(d.ONE));b=b.multiply(f.modPow(c.e,c.n)).mod(c.n);var e=b.mod(c.p).modPow(c.dP,
c.p);for(b=b.mod(c.q).modPow(c.dQ,c.q);0>e.compareTo(b);)e=e.add(c.p);b=e.subtract(b).multiply(c.qInv).mod(c.p).multiply(c.q).add(b);return b=b.multiply(f.modInverse(c.n)).mod(c.n)};m.rsa.encrypt=function(b,c,f){var g=f,h=Math.ceil(c.n.bitLength()/8);!1!==f&&!0!==f?(g=2===f,f=e(b,c,f)):(f=a.util.createBuffer(),f.putBytes(b));b=new d(f.toHex(),16);c=s(b,c,g).toString(16);g=a.util.createBuffer();for(h-=Math.ceil(c.length/2);0<h;)g.putByte(0),--h;g.putBytes(a.util.hexToBytes(c));return g.getBytes()};
m.rsa.decrypt=function(b,f,e,g){var h=Math.ceil(f.n.bitLength()/8);if(b.length!==h)throw f=Error("Encrypted message length is invalid."),f.length=b.length,f.expected=h,f;b=new d(a.util.createBuffer(b).toHex(),16);if(0<=b.compareTo(f.n))throw Error("Encrypted message is invalid.");b=s(b,f,e).toString(16);for(var k=a.util.createBuffer(),h=h-Math.ceil(b.length/2);0<h;)k.putByte(0),--h;k.putBytes(a.util.hexToBytes(b));return!1!==g?c(k.getBytes(),f,e):k.getBytes()};m.rsa.createKeyPairGenerationState=function(b,
c,f){"string"===typeof b&&(b=parseInt(b,10));b=b||2048;f=f||{};var e=f.prng||a.random,g={nextBytes:function(a){for(var b=e.getBytesSync(a.length),d=0;d<a.length;++d)a[d]=b.charCodeAt(d)}};f=f.algorithm||"PRIMEINC";if("PRIMEINC"===f)b={algorithm:f,state:0,bits:b,rng:g,eInt:c||65537,e:new d(null),p:null,q:null,qBits:b>>1,pBits:b-(b>>1),pqState:0,num:null,keys:null},b.e.fromInt(b.eInt);else throw Error("Invalid key generation algorithm: "+f);return b};m.rsa.stepKeyPairGenerationState=function(a,b){"algorithm"in
a||(a.algorithm="PRIMEINC");var c=new d(null);c.fromInt(30);for(var e=0,g=function(a,b){return a|b},k=+new Date,h,p=0;null===a.keys&&(0>=b||p<b);){if(0===a.state){h=null===a.p?a.pBits:a.qBits;var q=h-1;0===a.pqState?(a.num=new d(h,a.rng),a.num.testBit(q)||a.num.bitwiseTo(d.ONE.shiftLeft(q),g,a.num),a.num.dAddOffset(31-a.num.mod(c).byteValue(),0),e=0,++a.pqState):1===a.pqState?a.num.bitLength()>h?a.pqState=0:a.num.isProbablePrime(l(a.num.bitLength()))?++a.pqState:a.num.dAddOffset(f[e++%8],0):2===a.pqState?
a.pqState=0===a.num.subtract(d.ONE).gcd(a.e).compareTo(d.ONE)?3:0:3===a.pqState&&(a.pqState=0,null===a.p?a.p=a.num:a.q=a.num,null!==a.p&&null!==a.q&&++a.state,a.num=null)}else 1===a.state?(0>a.p.compareTo(a.q)&&(a.num=a.p,a.p=a.q,a.q=a.num),++a.state):2===a.state?(a.p1=a.p.subtract(d.ONE),a.q1=a.q.subtract(d.ONE),a.phi=a.p1.multiply(a.q1),++a.state):3===a.state?0===a.phi.gcd(a.e).compareTo(d.ONE)?++a.state:(a.p=null,a.q=null,a.state=0):4===a.state?(a.n=a.p.multiply(a.q),a.n.bitLength()===a.bits?++a.state:
(a.q=null,a.state=0)):5===a.state&&(h=a.e.modInverse(a.phi),a.keys={privateKey:m.rsa.setPrivateKey(a.n,a.e,h,a.p,a.q,h.mod(a.p1),h.mod(a.q1),a.q.modInverse(a.p)),publicKey:m.rsa.setPublicKey(a.n,a.e)});h=+new Date;p+=h-k;k=h}return null!==a.keys};m.rsa.generateKeyPair=function(a,b,d,c){1===arguments.length?"object"===typeof a?(d=a,a=void 0):"function"===typeof a&&(c=a,a=void 0):2===arguments.length?"number"===typeof a?"function"===typeof b?(c=b,b=void 0):"number"!==typeof b&&(d=b,b=void 0):(d=a,c=
b,b=a=void 0):3===arguments.length&&("number"===typeof b?"function"===typeof d&&(c=d,d=void 0):(c=d,d=b,b=void 0));d=d||{};void 0===a&&(a=d.bits||2048);void 0===b&&(b=d.e||65537);var f=m.rsa.createKeyPairGenerationState(a,b,d);if(!c)return m.rsa.stepKeyPairGenerationState(f,0),f.keys;h(f,d,c)};m.setRsaPublicKey=m.rsa.setPublicKey=function(d,f){var g={n:d,e:f,encrypt:function(b,d,c){"string"===typeof d?d=d.toUpperCase():void 0===d&&(d="RSAES-PKCS1-V1_5");if("RSAES-PKCS1-V1_5"===d)d={encode:function(a,
b,d){return e(a,b,2).getBytes()}};else if("RSA-OAEP"===d||"RSAES-OAEP"===d)d={encode:function(b,d){return a.pkcs1.encode_rsa_oaep(d,b,c)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(d))d={encode:function(a){return a}};else if("string"===typeof d)throw Error('Unsupported encryption scheme: "'+d+'".');b=d.encode(b,g,!0);return m.rsa.encrypt(b,g,!0)},verify:function(a,d,f){"string"===typeof f?f=f.toUpperCase():void 0===f&&(f="RSASSA-PKCS1-V1_5");if("RSASSA-PKCS1-V1_5"===f)f={verify:function(a,d){d=
c(d,g,!0);var f=b.fromDer(d);return a===f.value[1].value}};else if("NONE"===f||"NULL"===f||null===f)f={verify:function(a,b){b=c(b,g,!0);return a===b}};d=m.rsa.decrypt(d,g,!0,!1);return f.verify(a,d,g.n.bitLength())}};return g};m.setRsaPrivateKey=m.rsa.setPrivateKey=function(b,d,f,e,g,k,h,p){var q={n:b,e:d,d:f,p:e,q:g,dP:k,dQ:h,qInv:p,decrypt:function(b,d,f){"string"===typeof d?d=d.toUpperCase():void 0===d&&(d="RSAES-PKCS1-V1_5");b=m.rsa.decrypt(b,q,!1,!1);if("RSAES-PKCS1-V1_5"===d)d={decode:c};else if("RSA-OAEP"===
d||"RSAES-OAEP"===d)d={decode:function(b,d){return a.pkcs1.decode_rsa_oaep(d,b,f)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(d))d={decode:function(a){return a}};else throw Error('Unsupported encryption scheme: "'+d+'".');return d.decode(b,q,!1)},sign:function(a,b){var d=!1;"string"===typeof b&&(b=b.toUpperCase());if(void 0===b||"RSASSA-PKCS1-V1_5"===b)b={encode:x},d=1;else if("NONE"===b||"NULL"===b||null===b)b={encode:function(){return a}},d=1;var c=b.encode(a,q.n.bitLength());return m.rsa.encrypt(c,
q,d)}};return q};m.wrapRsaPrivateKey=function(a){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(m.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,b.toDer(a).getBytes())])};m.privateKeyFromAsn1=function(c){var f={},e=[];b.validate(c,u,f,e)&&
(c=b.fromDer(a.util.createBuffer(f.privateKey)));f={};e=[];if(!b.validate(c,q,f,e))throw f=Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey."),f.errors=e,f;var g,h,k,p,l,e=a.util.createBuffer(f.privateKeyModulus).toHex();c=a.util.createBuffer(f.privateKeyPublicExponent).toHex();g=a.util.createBuffer(f.privateKeyPrivateExponent).toHex();h=a.util.createBuffer(f.privateKeyPrime1).toHex();k=a.util.createBuffer(f.privateKeyPrime2).toHex();p=a.util.createBuffer(f.privateKeyExponent1).toHex();
l=a.util.createBuffer(f.privateKeyExponent2).toHex();f=a.util.createBuffer(f.privateKeyCoefficient).toHex();return m.setRsaPrivateKey(new d(e,16),new d(c,16),new d(g,16),new d(h,16),new d(k,16),new d(p,16),new d(l,16),new d(f,16))};m.privateKeyToAsn1=m.privateKeyToRSAPrivateKey=function(a){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(0).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,
!1,g(a.e)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.d)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.p)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.q)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.dP)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.dQ)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.qInv))])};m.publicKeyFromAsn1=function(c){var f={},e=[];if(b.validate(c,t,f,e)){e=b.derToOid(f.publicKeyOid);if(e!==m.oids.rsaEncryption)throw f=Error("Cannot read public key. Unknown OID."),
f.oid=e,f;c=f.rsaPublicKey}e=[];if(!b.validate(c,p,f,e))throw f=Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey."),f.errors=e,f;e=a.util.createBuffer(f.publicKeyModulus).toHex();f=a.util.createBuffer(f.publicKeyExponent).toHex();return m.setRsaPublicKey(new d(e,16),new d(f,16))};m.publicKeyToAsn1=m.publicKeyToSubjectPublicKeyInfo=function(a){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,
b.Type.OID,!1,b.oidToDer(m.oids.rsaEncryption).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,[m.publicKeyToRSAPublicKey(a)])])};m.publicKeyToRSAPublicKey=function(a){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.n)),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,g(a.e))])}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===
typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.rsa)return c.rsa;c.defined.rsa=!0;for(var g=0;g<e.length;++g)e[g](c);return c.rsa}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/rsa","require module ./asn1 ./jsbn ./oids ./pkcs1 ./prime ./random ./util".split(" "),
function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a,b){return a.start().update(b).digest().getBytes()}if("undefined"===typeof c)var c=a.jsbn.BigInteger;var h=a.asn1,g=a.pki=a.pki||{};g.pbe=a.pbe=a.pbe||{};var l=g.oids,d={name:"EncryptedPrivateKeyInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",
tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},b={name:"PBES2Algorithms",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:h.Class.UNIVERSAL,
type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,onstructed:!0,capture:"kdfIterationCount"}]}]},
{name:"PBES2Algorithms.encryptionScheme",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},m={name:"pkcs-12PbeParams",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:h.Class.UNIVERSAL,
type:h.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"iterations"}]};g.encryptPrivateKeyInfo=function(b,d,c){c=c||{};c.saltSize=c.saltSize||8;c.count=c.count||2048;c.algorithm=c.algorithm||"aes128";var e=a.random.getBytesSync(c.saltSize),m=c.count,x=h.integerToDer(m),s;if(0===c.algorithm.indexOf("aes")||"des"===c.algorithm){var n,r;switch(c.algorithm){case "aes128":n=s=16;c=l["aes128-CBC"];
r=a.aes.createEncryptionCipher;break;case "aes192":s=24;n=16;c=l["aes192-CBC"];r=a.aes.createEncryptionCipher;break;case "aes256":s=32;n=16;c=l["aes256-CBC"];r=a.aes.createEncryptionCipher;break;case "des":n=s=8;c=l.desCBC;r=a.des.createEncryptionCipher;break;default:throw e=Error("Cannot encrypt private key. Unknown encryption algorithm."),e.algorithm=c.algorithm,e;}var y=a.pkcs5.pbkdf2(d,e,m,s);d=a.random.getBytesSync(n);m=r(y);m.start(d);m.update(h.toDer(b));m.finish();b=m.output.getBytes();e=
h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(l.pkcs5PBES2).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(l.pkcs5PBKDF2).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,e),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,x.getBytes())])]),h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,
!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(c).getBytes()),h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,d)])])])}else if("3des"===c.algorithm)s=24,c=new a.util.ByteBuffer(e),y=g.pbe.generatePkcs12Key(d,c,1,m,s),d=g.pbe.generatePkcs12Key(d,c,2,m,s),m=a.des.createEncryptionCipher(y),m.start(d),m.update(h.toDer(b)),m.finish(),b=m.output.getBytes(),e=h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OID,!1,h.oidToDer(l["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),
h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,e),h.create(h.Class.UNIVERSAL,h.Type.INTEGER,!1,x.getBytes())])]);else throw e=Error("Cannot encrypt private key. Unknown encryption algorithm."),e.algorithm=c.algorithm,e;return h.create(h.Class.UNIVERSAL,h.Type.SEQUENCE,!0,[e,h.create(h.Class.UNIVERSAL,h.Type.OCTETSTRING,!1,b)])};g.decryptPrivateKeyInfo=function(b,c){var e=null,m={},l=[];if(!h.validate(b,d,m,l))throw e=Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo."),
e.errors=l,e;l=h.derToOid(m.encryptionOid);l=g.pbe.getCipher(l,m.encryptionParams,c);m=a.util.createBuffer(m.encryptedData);l.update(m);l.finish()&&(e=h.fromDer(l.output));return e};g.encryptedPrivateKeyToPem=function(b,d){var c={type:"ENCRYPTED PRIVATE KEY",body:h.toDer(b).getBytes()};return a.pem.encode(c,{maxline:d})};g.encryptedPrivateKeyFromPem=function(b){b=a.pem.decode(b)[0];if("ENCRYPTED PRIVATE KEY"!==b.type){var d=Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');
d.headerType=b.type;throw d;}if(b.procType&&"ENCRYPTED"===b.procType.type)throw Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return h.fromDer(b.body)};g.encryptRsaPrivateKey=function(b,d,c){c=c||{};if(!c.legacy)return b=g.wrapRsaPrivateKey(g.privateKeyToAsn1(b)),b=g.encryptPrivateKeyInfo(b,d,c),g.encryptedPrivateKeyToPem(b);var e,m,l;switch(c.algorithm){case "aes128":c="AES-128-CBC";m=16;e=a.random.getBytesSync(16);l=a.aes.createEncryptionCipher;break;case "aes192":c=
"AES-192-CBC";m=24;e=a.random.getBytesSync(16);l=a.aes.createEncryptionCipher;break;case "aes256":c="AES-256-CBC";m=32;e=a.random.getBytesSync(16);l=a.aes.createEncryptionCipher;break;case "3des":c="DES-EDE3-CBC";m=24;e=a.random.getBytesSync(8);l=a.des.createEncryptionCipher;break;case "des":c="DES-CBC";m=8;e=a.random.getBytesSync(8);l=a.des.createEncryptionCipher;break;default:throw b=Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+c.algorithm+'".'),b.algorithm=c.algorithm,
b;}d=a.pbe.opensslDeriveBytes(d,e.substr(0,8),m);d=l(d);d.start(e);d.update(h.toDer(g.privateKeyToAsn1(b)));d.finish();b={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:c,parameters:a.util.bytesToHex(e).toUpperCase()},body:d.output.getBytes()};return a.pem.encode(b)};g.decryptRsaPrivateKey=function(b,d){var c=null,e=a.pem.decode(b)[0];if("ENCRYPTED PRIVATE KEY"!==e.type&&"PRIVATE KEY"!==e.type&&"RSA PRIVATE KEY"!==e.type)throw c=Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".'),
c.headerType=c,c;if(e.procType&&"ENCRYPTED"===e.procType.type){var m,l;switch(e.dekInfo.algorithm){case "DES-CBC":m=8;l=a.des.createDecryptionCipher;break;case "DES-EDE3-CBC":m=24;l=a.des.createDecryptionCipher;break;case "AES-128-CBC":m=16;l=a.aes.createDecryptionCipher;break;case "AES-192-CBC":m=24;l=a.aes.createDecryptionCipher;break;case "AES-256-CBC":m=32;l=a.aes.createDecryptionCipher;break;case "RC2-40-CBC":m=5;l=function(b){return a.rc2.createDecryptionCipher(b,40)};break;case "RC2-64-CBC":m=
8;l=function(b){return a.rc2.createDecryptionCipher(b,64)};break;case "RC2-128-CBC":m=16;l=function(b){return a.rc2.createDecryptionCipher(b,128)};break;default:throw c=Error('Could not decrypt private key; unsupported encryption algorithm "'+e.dekInfo.algorithm+'".'),c.algorithm=e.dekInfo.algorithm,c;}var s=a.util.hexToBytes(e.dekInfo.parameters);m=a.pbe.opensslDeriveBytes(d,s.substr(0,8),m);l=l(m);l.start(s);l.update(a.util.createBuffer(e.body));if(l.finish())c=l.output.getBytes();else return c}else c=
e.body;c="ENCRYPTED PRIVATE KEY"===e.type?g.decryptPrivateKeyInfo(h.fromDer(c),d):h.fromDer(c);null!==c&&(c=g.privateKeyFromAsn1(c));return c};g.pbe.generatePkcs12Key=function(b,d,c,e,g,h){var m,n;if("undefined"===typeof h||null===h)h=a.md.sha1.create();var r=h.digestLength,y=h.blockLength,l=new a.util.ByteBuffer,A=new a.util.ByteBuffer;if(null!==b&&void 0!==b){for(n=0;n<b.length;n++)A.putInt16(b.charCodeAt(n));A.putInt16(0)}b=A.length();var k=d.length(),v=new a.util.ByteBuffer;v.fillWithByte(c,y);
var w=y*Math.ceil(k/y);c=new a.util.ByteBuffer;for(n=0;n<w;n++)c.putByte(d.at(n%k));w=y*Math.ceil(b/y);d=new a.util.ByteBuffer;for(n=0;n<w;n++)d.putByte(A.at(n%b));A=c;A.putBuffer(d);d=Math.ceil(g/r);for(c=1;c<=d;c++){w=new a.util.ByteBuffer;w.putBytes(v.bytes());w.putBytes(A.bytes());for(n=0;n<e;n++)h.start(),h.update(w.getBytes()),w=h.digest();var z=new a.util.ByteBuffer;for(n=0;n<y;n++)z.putByte(w.at(n%r));var D=Math.ceil(k/y)+Math.ceil(b/y),C=new a.util.ByteBuffer;for(m=0;m<D;m++){var E=new a.util.ByteBuffer(A.getBytes(y)),
K=511;for(n=z.length()-1;0<=n;n--)K>>=8,K+=z.at(n)+E.at(n),E.setAt(n,K&255);C.putBuffer(E)}A=C;l.putBuffer(w)}l.truncate(l.length()-g);return l};g.pbe.getCipher=function(a,b,d){switch(a){case g.oids.pkcs5PBES2:return g.pbe.getCipherForPBES2(a,b,d);case g.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case g.oids["pbewithSHAAnd40BitRC2-CBC"]:return g.pbe.getCipherForPKCS12PBE(a,b,d);default:throw b=Error("Cannot read encrypted PBE data block. Unsupported OID."),b.oid=a,b.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC",
"pbewithSHAAnd40BitRC2-CBC"],b;}};g.pbe.getCipherForPBES2=function(d,c,e){var m={};d=[];if(!h.validate(c,b,m,d)){var l=Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");l.errors=d;throw l;}d=h.derToOid(m.kdfOid);if(d!==g.oids.pkcs5PBKDF2)throw l=Error("Cannot read encrypted private key. Unsupported key derivation function OID."),l.oid=d,l.supportedOids=["pkcs5PBKDF2"],l;d=h.derToOid(m.encOid);if(d!==g.oids["aes128-CBC"]&&
d!==g.oids["aes192-CBC"]&&d!==g.oids["aes256-CBC"]&&d!==g.oids["des-EDE3-CBC"]&&d!==g.oids.desCBC)throw l=Error("Cannot read encrypted private key. Unsupported encryption scheme OID."),l.oid=d,l.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],l;c=m.kdfSalt;var x=a.util.createBuffer(m.kdfIterationCount),x=x.getInt(x.length()<<3),s;switch(g.oids[d]){case "aes128-CBC":s=16;l=a.aes.createDecryptionCipher;break;case "aes192-CBC":s=24;l=a.aes.createDecryptionCipher;break;
case "aes256-CBC":s=32;l=a.aes.createDecryptionCipher;break;case "des-EDE3-CBC":s=24;l=a.des.createDecryptionCipher;break;case "desCBC":s=8,l=a.des.createDecryptionCipher}d=a.pkcs5.pbkdf2(e,c,x,s);m=m.encIv;l=l(d);l.start(m);return l};g.pbe.getCipherForPKCS12PBE=function(b,d,c){var e={},l=[];if(!h.validate(d,m,e,l))throw c=Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo."),c.errors=l,c;var l=a.util.createBuffer(e.salt),e=a.util.createBuffer(e.iterations),
e=e.getInt(e.length()<<3),x;switch(b){case g.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:x=24;d=8;b=a.des.startDecrypting;break;case g.oids["pbewithSHAAnd40BitRC2-CBC"]:x=5;d=8;b=function(b,d){var c=a.rc2.createDecryptionCipher(b,40);c.start(d,null);return c};break;default:throw c=Error("Cannot read PKCS #12 PBE data block. Unsupported OID."),c.oid=b,c;}x=g.pbe.generatePkcs12Key(c,l,1,e,x);c=g.pbe.generatePkcs12Key(c,l,2,e,d);return b(x,c)};g.pbe.opensslDeriveBytes=function(b,d,c,g){if("undefined"===
typeof g||null===g)g=a.md.md5.create();null===d&&(d="");for(var h=[e(g,b+d)],m=16,l=1;m<c;++l,m+=16)h.push(e(g,h[l-1]+b+d));return h.join("").substr(0,c)}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.pbe)return c.pbe;c.defined.pbe=!0;for(var g=
0;g<e.length;++g)e[g](c);return c.pbe}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/pbe","require module ./aes ./asn1 ./des ./md ./oids ./pem ./pbkdf2 ./random ./rc2 ./rsa ./util".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){var e=a.asn1,c=a.pkcs7asn1=a.pkcs7asn1||{};a.pkcs7=
a.pkcs7||{};a.pkcs7.asn1=c;a={name:"ContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};c.contentInfoValidator=a;var h={name:"EncryptedContentInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",
tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",
tagClass:e.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};c.envelopedDataValidator={name:"EnvelopedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(h)};c.encryptedDataValidator={name:"EncryptedData",
tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"}].concat(h)};c.signedDataValidator={name:"SignedData",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,constructed:!0,
captureAsn1:"digestAlgorithms"},a,{name:"SignedData.Certificates",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:e.Class.UNIVERSAL,type:e.Type.SET,capture:"signerInfos",optional:!0,value:[{name:"SignerInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:e.Class.UNIVERSAL,
type:e.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,
value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,
constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:e.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]}]}]};c.recipientInfoValidator={name:"RecipientInfo",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,
constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:e.Class.UNIVERSAL,type:e.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.SEQUENCE,constructed:!0,
value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:e.Class.UNIVERSAL,type:e.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:e.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:e.Class.UNIVERSAL,type:e.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===
typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.pkcs7asn1)return c.pkcs7asn1;c.defined.pkcs7asn1=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pkcs7asn1}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/pkcs7asn1",
["require","module","./asn1","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){a.mgf=a.mgf||{};(a.mgf.mgf1=a.mgf1=a.mgf1||{}).create=function(e){return{generate:function(c,h){for(var g=new a.util.ByteBuffer,l=Math.ceil(h/e.digestLength),d=0;d<l;d++){var b=new a.util.ByteBuffer;b.putInt32(d);e.start();e.update(c+b.getBytes());g.putBuffer(e.digest())}g.truncate(g.length()-h);return g.getBytes()}}}}if("function"!==typeof l)if("object"===typeof module&&
module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.mgf1)return c.mgf1;c.defined.mgf1=!0;for(var g=0;g<e.length;++g)e[g](c);return c.mgf1}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,
Array.prototype.slice.call(arguments,0))};l("js/mgf1",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){a.mgf=a.mgf||{};a.mgf.mgf1=a.mgf1}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||
{};if(c.defined.mgf)return c.mgf;c.defined.mgf=!0;for(var g=0;g<e.length;++g)e[g](c);return c.mgf}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/mgf",["require","module","./mgf1"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){(a.pss=a.pss||{}).create=function(e){3===arguments.length&&
(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var c=e.md,h=e.mgf,g=c.digestLength,l=e.salt||null;"string"===typeof l&&(l=a.util.createBuffer(l));var d;if("saltLength"in e)d=e.saltLength;else if(null!==l)d=l.length();else throw Error("Salt length not specified or specific salt not given.");if(null!==l&&l.length()!==d)throw Error("Given salt length does not match length of given salt.");var b=e.prng||a.random;return{encode:function(e,f){var u,q=f-1,p=Math.ceil(q/8),t=e.digest().getBytes();
if(p<g+d+2)throw Error("Message is too long to encrypt.");var x;x=null===l?b.getBytesSync(d):l.bytes();u=new a.util.ByteBuffer;u.fillWithByte(0,8);u.putBytes(t);u.putBytes(x);c.start();c.update(u.getBytes());t=c.digest().getBytes();u=new a.util.ByteBuffer;u.fillWithByte(0,p-d-g-2);u.putByte(1);u.putBytes(x);var s=u.getBytes(),n=p-g-1,r=h.generate(t,n);x="";for(u=0;u<n;u++)x+=String.fromCharCode(s.charCodeAt(u)^r.charCodeAt(u));q=65280>>8*p-q&255;x=String.fromCharCode(x.charCodeAt(0)&~q)+x.substr(1);
return x+t+String.fromCharCode(188)},verify:function(b,f,e){var l;l=e-1;e=Math.ceil(l/8);f=f.substr(-e);if(e<g+d+2)throw Error("Inconsistent parameters to PSS signature verification.");if(188!==f.charCodeAt(e-1))throw Error("Encoded message does not end in 0xBC.");var p=e-g-1,t=f.substr(0,p);f=f.substr(p,g);var x=65280>>8*e-l&255;if(0!==(t.charCodeAt(0)&x))throw Error("Bits beyond keysize not zero as expected.");var s=h.generate(f,p),n="";for(l=0;l<p;l++)n+=String.fromCharCode(t.charCodeAt(l)^s.charCodeAt(l));
n=String.fromCharCode(n.charCodeAt(0)&~x)+n.substr(1);e=e-g-d-2;for(l=0;l<e;l++)if(0!==n.charCodeAt(l))throw Error("Leftmost octets not zero as expected");if(1!==n.charCodeAt(e))throw Error("Inconsistent PSS signature, 0x01 marker not found");e=n.substr(-d);p=new a.util.ByteBuffer;p.fillWithByte(0,8);p.putBytes(b);p.putBytes(e);c.start();c.update(p.getBytes());b=c.digest().getBytes();return f===b}}}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,
module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.pss)return c.pss;c.defined.pss=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pss}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/pss",
["require","module","./random","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a,b){"string"===typeof b&&(b={shortName:b});for(var d=null,c,f=0;null===d&&f<a.attributes.length;++f)c=a.attributes[f],b.type&&b.type===c.type?d=c:b.name&&b.name===c.name?d=c:b.shortName&&b.shortName===c.shortName&&(d=c);return d}function c(d){var c=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),f;d=d.attributes;for(var e=0;e<d.length;++e){f=d[e];
var g=f.value,k=b.Type.PRINTABLESTRING;"valueTagClass"in f&&(k=f.valueTagClass,k===b.Type.UTF8&&(g=a.util.encodeUtf8(g)));f=b.create(b.Class.UNIVERSAL,b.Type.SET,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(f.type).getBytes()),b.create(b.Class.UNIVERSAL,k,!1,g)])]);c.value.push(f)}return c}function h(a){for(var d,c=0;c<a.length;++c){d=a[c];"undefined"===typeof d.name&&(d.type&&d.type in m.oids?d.name=m.oids[d.type]:d.shortName&&d.shortName in
u&&(d.name=m.oids[u[d.shortName]]));if("undefined"===typeof d.type)if(d.name&&d.name in m.oids)d.type=m.oids[d.name];else throw a=Error("Attribute type not specified."),a.attribute=d,a;"undefined"===typeof d.shortName&&d.name&&d.name in u&&(d.shortName=u[d.name]);if(d.type===f.extensionRequest&&(d.valueConstructed=!0,d.valueTagClass=b.Type.SEQUENCE,!d.value&&d.extensions)){d.value=[];for(var e=0;e<d.extensions.length;++e)d.value.push(m.certificateExtensionToAsn1(g(d.extensions[e])))}if("undefined"===
typeof d.value)throw a=Error("Attribute value not specified."),a.attribute=d,a;}}function g(d,c){c=c||{};"undefined"===typeof d.name&&d.id&&d.id in m.oids&&(d.name=m.oids[d.id]);if("undefined"===typeof d.id)if(d.name&&d.name in m.oids)d.id=m.oids[d.name];else{var e=Error("Extension ID not specified.");e.extension=d;throw e;}if("undefined"!==typeof d.value)return d;if("keyUsage"===d.name){var g=e=0,h=0;d.digitalSignature&&(g|=128,e=7);d.nonRepudiation&&(g|=64,e=6);d.keyEncipherment&&(g|=32,e=5);d.dataEncipherment&&
(g|=16,e=4);d.keyAgreement&&(g|=8,e=3);d.keyCertSign&&(g|=4,e=2);d.cRLSign&&(g|=2,e=1);d.encipherOnly&&(g|=1,e=0);d.decipherOnly&&(h|=128,e=7);e=String.fromCharCode(e);0!==h?e+=String.fromCharCode(g)+String.fromCharCode(h):0!==g&&(e+=String.fromCharCode(g));d.value=b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,e)}else if("basicConstraints"===d.name)d.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),d.cA&&d.value.value.push(b.create(b.Class.UNIVERSAL,b.Type.BOOLEAN,!1,String.fromCharCode(255))),
"pathLenConstraint"in d&&d.value.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(d.pathLenConstraint).getBytes()));else if("extKeyUsage"===d.name)for(g in d.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),e=d.value.value,d)!0===d[g]&&(g in f?e.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(f[g]).getBytes())):-1!==g.indexOf(".")&&e.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(g).getBytes())));else if("nsCertType"===d.name)g=e=0,d.client&&(g|=128,
e=7),d.server&&(g|=64,e=6),d.email&&(g|=32,e=5),d.objsign&&(g|=16,e=4),d.reserved&&(g|=8,e=3),d.sslCA&&(g|=4,e=2),d.emailCA&&(g|=2,e=1),d.objCA&&(g|=1,e=0),e=String.fromCharCode(e),0!==g&&(e+=String.fromCharCode(g)),d.value=b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,e);else if("subjectAltName"===d.name||"issuerAltName"===d.name)for(d.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),h=0;h<d.altNames.length;++h){g=d.altNames[h];e=g.value;if(7===g.type&&g.ip){if(e=a.util.bytesFromIP(g.ip),
null===e)throw e=Error('Extension "ip" value is not a valid IPv4 or IPv6 address.'),e.extension=d,e;}else 8===g.type&&(e=g.oid?b.oidToDer(b.oidToDer(g.oid)):b.oidToDer(e));d.value.value.push(b.create(b.Class.CONTEXT_SPECIFIC,g.type,!1,e))}else"subjectKeyIdentifier"===d.name&&c.cert&&(e=c.cert.generateSubjectKeyIdentifier(),d.subjectKeyIdentifier=e.toHex(),d.value=b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,e.getBytes()));if("undefined"===typeof d.value)throw e=Error("Extension value not specified."),
e.extension=d,e;return d}function l(a,d){switch(a){case f["RSASSA-PSS"]:var c=[];void 0!==d.hash.algorithmOid&&c.push(b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(d.hash.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])]));void 0!==d.mgf.algorithmOid&&c.push(b.create(b.Class.CONTEXT_SPECIFIC,1,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,
!1,b.oidToDer(d.mgf.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(d.mgf.hash.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])])]));void 0!==d.saltLength&&c.push(b.create(b.Class.CONTEXT_SPECIFIC,2,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(d.saltLength).getBytes())]));return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,c);default:return b.create(b.Class.UNIVERSAL,b.Type.NULL,
!1,"")}}function d(d){var c=b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===d.attributes.length)return c;d=d.attributes;for(var e=0;e<d.length;++e){var f=d[e],g=f.value,k=b.Type.UTF8;"valueTagClass"in f&&(k=f.valueTagClass);k===b.Type.UTF8&&(g=a.util.encodeUtf8(g));var h=!1;"valueConstructed"in f&&(h=f.valueConstructed);f=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(f.type).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,[b.create(b.Class.UNIVERSAL,
k,h,g)])]);c.value.push(f)}return c}var b=a.asn1,m=a.pki=a.pki||{},f=m.oids,u={};u.CN=f.commonName;u.commonName="CN";u.C=f.countryName;u.countryName="C";u.L=f.localityName;u.localityName="L";u.ST=f.stateOrProvinceName;u.stateOrProvinceName="ST";u.O=f.organizationName;u.organizationName="O";u.OU=f.organizationalUnitName;u.organizationalUnitName="OU";u.E=f.emailAddress;u.emailAddress="E";var q=a.pki.rsa.publicKeyValidator,p={name:"Certificate",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,
value:[{name:"Certificate.TBSCertificate",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,
capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,
constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:b.Class.UNIVERSAL,type:b.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:b.Class.UNIVERSAL,type:b.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},
{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:b.Class.UNIVERSAL,type:b.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:b.Class.UNIVERSAL,type:b.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},q,{name:"Certificate.TBSCertificate.issuerUniqueID",
tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:b.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,capture:"certSubjectUniqueId"}]},
{name:"Certificate.TBSCertificate.extensions",tagClass:b.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},
{name:"Certificate.signatureValue",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,capture:"certSignature"}]},t={name:"rsapss",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,
type:b.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:b.Class.UNIVERSAL,
type:b.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:b.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:b.Class.UNIVERSAL,type:b.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:b.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",
tagClass:b.Class.UNIVERSAL,type:b.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},x={name:"CertificationRequest",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[{name:"CertificationRequestInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",
tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},q,{name:"CertificationRequestInfo.attributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",
tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0}]}]}]},{name:"CertificationRequest.signatureAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:b.Class.UNIVERSAL,
type:b.Type.BITSTRING,constructed:!1,capture:"csrSignature"}]};m.RDNAttributesAsArray=function(a,d){for(var c=[],e,g,k,h=0;h<a.value.length;++h){e=a.value[h];for(var m=0;m<e.value.length;++m)k={},g=e.value[m],k.type=b.derToOid(g.value[0].value),k.value=g.value[1].value,k.valueTagClass=g.value[1].type,k.type in f&&(k.name=f[k.type],k.name in u&&(k.shortName=u[k.name])),d&&(d.update(k.type),d.update(k.value)),c.push(k)}return c};m.CRIAttributesAsArray=function(a){for(var d=[],c=0;c<a.length;++c)for(var e=
a[c],g=b.derToOid(e.value[0].value),e=e.value[1].value,k=0;k<e.length;++k){var h={};h.type=g;h.value=e[k].value;h.valueTagClass=e[k].type;h.type in f&&(h.name=f[h.type],h.name in u&&(h.shortName=u[h.name]));if(h.type===f.extensionRequest){h.extensions=[];for(var l=0;l<h.value.length;++l)h.extensions.push(m.certificateExtensionFromAsn1(h.value[l]))}d.push(h)}return d};var s=function(a,d,c){var e={};if(a!==f["RSASSA-PSS"])return e;c&&(e={hash:{algorithmOid:f.sha1},mgf:{algorithmOid:f.mgf1,hash:{algorithmOid:f.sha1}},
saltLength:20});c={};a=[];if(!b.validate(d,t,c,a))throw d=Error("Cannot read RSASSA-PSS parameter block."),d.errors=a,d;void 0!==c.hashOid&&(e.hash=e.hash||{},e.hash.algorithmOid=b.derToOid(c.hashOid));void 0!==c.maskGenOid&&(e.mgf=e.mgf||{},e.mgf.algorithmOid=b.derToOid(c.maskGenOid),e.mgf.hash=e.mgf.hash||{},e.mgf.hash.algorithmOid=b.derToOid(c.maskGenHashOid));void 0!==c.saltLength&&(e.saltLength=c.saltLength.charCodeAt(0));return e};m.certificateFromPem=function(d,c,e){d=a.pem.decode(d)[0];if("CERTIFICATE"!==
d.type&&"X509 CERTIFICATE"!==d.type&&"TRUSTED CERTIFICATE"!==d.type)throw c=Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".'),c.headerType=d.type,c;if(d.procType&&"ENCRYPTED"===d.procType.type)throw Error("Could not convert certificate from PEM; PEM is encrypted.");e=b.fromDer(d.body,e);return m.certificateFromAsn1(e,c)};m.certificateToPem=function(d,c){var e={type:"CERTIFICATE",body:b.toDer(m.certificateToAsn1(d)).getBytes()};
return a.pem.encode(e,{maxline:c})};m.publicKeyFromPem=function(d){d=a.pem.decode(d)[0];if("PUBLIC KEY"!==d.type&&"RSA PUBLIC KEY"!==d.type){var c=Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');c.headerType=d.type;throw c;}if(d.procType&&"ENCRYPTED"===d.procType.type)throw Error("Could not convert public key from PEM; PEM is encrypted.");d=b.fromDer(d.body);return m.publicKeyFromAsn1(d)};m.publicKeyToPem=function(d,c){var e={type:"PUBLIC KEY",
body:b.toDer(m.publicKeyToAsn1(d)).getBytes()};return a.pem.encode(e,{maxline:c})};m.publicKeyToRSAPublicKeyPem=function(d,c){var e={type:"RSA PUBLIC KEY",body:b.toDer(m.publicKeyToRSAPublicKey(d)).getBytes()};return a.pem.encode(e,{maxline:c})};m.getPublicKeyFingerprint=function(d,c){c=c||{};var e=c.md||a.md.sha1.create(),f;switch(c.type||"RSAPublicKey"){case "RSAPublicKey":f=b.toDer(m.publicKeyToRSAPublicKey(d)).getBytes();break;case "SubjectPublicKeyInfo":f=b.toDer(m.publicKeyToAsn1(d)).getBytes();
break;default:throw Error('Unknown fingerprint type "'+c.type+'".');}e.start();e.update(f);e=e.digest();if("hex"===c.encoding)return e=e.toHex(),c.delimiter?e.match(/.{2}/g).join(c.delimiter):e;if("binary"===c.encoding)return e.getBytes();if(c.encoding)throw Error('Unknown encoding "'+c.encoding+'".');return e};m.certificationRequestFromPem=function(d,c,e){d=a.pem.decode(d)[0];if("CERTIFICATE REQUEST"!==d.type)throw c=Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".'),
c.headerType=d.type,c;if(d.procType&&"ENCRYPTED"===d.procType.type)throw Error("Could not convert certification request from PEM; PEM is encrypted.");e=b.fromDer(d.body,e);return m.certificationRequestFromAsn1(e,c)};m.certificationRequestToPem=function(d,c){var e={type:"CERTIFICATE REQUEST",body:b.toDer(m.certificationRequestToAsn1(d)).getBytes()};return a.pem.encode(e,{maxline:c})};m.createCertificate=function(){var d={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};d.siginfo.algorithmOid=
null;d.validity={};d.validity.notBefore=new Date;d.validity.notAfter=new Date;d.issuer={};d.issuer.getField=function(a){return e(d.issuer,a)};d.issuer.addField=function(a){h([a]);d.issuer.attributes.push(a)};d.issuer.attributes=[];d.issuer.hash=null;d.subject={};d.subject.getField=function(a){return e(d.subject,a)};d.subject.addField=function(a){h([a]);d.subject.attributes.push(a)};d.subject.attributes=[];d.subject.hash=null;d.extensions=[];d.publicKey=null;d.md=null;d.setSubject=function(a,b){h(a);
d.subject.attributes=a;delete d.subject.uniqueId;b&&(d.subject.uniqueId=b);d.subject.hash=null};d.setIssuer=function(a,b){h(a);d.issuer.attributes=a;delete d.issuer.uniqueId;b&&(d.issuer.uniqueId=b);d.issuer.hash=null};d.setExtensions=function(a){for(var b=0;b<a.length;++b)g(a[b],{cert:d});d.extensions=a};d.getExtension=function(a){"string"===typeof a&&(a={name:a});for(var b=null,c,e=0;null===b&&e<d.extensions.length;++e)c=d.extensions[e],a.id&&c.id===a.id?b=c:a.name&&c.name===a.name&&(b=c);return b};
d.sign=function(c,e){d.md=e||a.md.sha1.create();var g=f[d.md.algorithm+"WithRSAEncryption"];if(!g)throw g=Error("Could not compute certificate digest. Unknown message digest algorithm OID."),g.algorithm=d.md.algorithm,g;d.signatureOid=d.siginfo.algorithmOid=g;d.tbsCertificate=m.getTBSCertificate(d);g=b.toDer(d.tbsCertificate);d.md.update(g.getBytes());d.signature=c.sign(d.md)};d.verify=function(c){var e=!1;if(!d.issued(c)){var e=d.subject,g=Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");
g.expectedIssuer=c.issuer.attributes;g.actualIssuer=e.attributes;throw g;}g=c.md;if(null===g){if(c.signatureOid in f)switch(f[c.signatureOid]){case "sha1WithRSAEncryption":g=a.md.sha1.create();break;case "md5WithRSAEncryption":g=a.md.md5.create();break;case "sha256WithRSAEncryption":g=a.md.sha256.create();break;case "sha512WithRSAEncryption":g=a.md.sha512.create();break;case "RSASSA-PSS":g=a.md.sha256.create()}if(null===g)throw g=Error("Could not compute certificate digest. Unknown signature OID."),
g.signatureOid=c.signatureOid,g;var h=c.tbsCertificate||m.getTBSCertificate(c),h=b.toDer(h);g.update(h.getBytes())}if(null!==g){var k;switch(c.signatureOid){case f.sha1WithRSAEncryption:k=void 0;break;case f["RSASSA-PSS"]:e=f[c.signatureParameters.mgf.hash.algorithmOid];if(void 0===e||void 0===a.md[e])throw g=Error("Unsupported MGF hash function."),g.oid=c.signatureParameters.mgf.hash.algorithmOid,g.name=e,g;k=f[c.signatureParameters.mgf.algorithmOid];if(void 0===k||void 0===a.mgf[k])throw g=Error("Unsupported MGF function."),
g.oid=c.signatureParameters.mgf.algorithmOid,g.name=k,g;k=a.mgf[k].create(a.md[e].create());e=f[c.signatureParameters.hash.algorithmOid];if(void 0===e||void 0===a.md[e])throw{message:"Unsupported RSASSA-PSS hash function.",oid:c.signatureParameters.hash.algorithmOid,name:e};k=a.pss.create(a.md[e].create(),k,c.signatureParameters.saltLength)}e=d.publicKey.verify(g.digest().getBytes(),c.signature,k)}return e};d.isIssuer=function(a){var b=!1,c=d.issuer;a=a.subject;if(c.hash&&a.hash)b=c.hash===a.hash;
else if(c.attributes.length===a.attributes.length)for(var b=!0,e,f,g=0;b&&g<c.attributes.length;++g)if(e=c.attributes[g],f=a.attributes[g],e.type!==f.type||e.value!==f.value)b=!1;return b};d.issued=function(a){return a.isIssuer(d)};d.generateSubjectKeyIdentifier=function(){return m.getPublicKeyFingerprint(d.publicKey,{type:"RSAPublicKey"})};d.verifySubjectKeyIdentifier=function(){for(var b=f.subjectKeyIdentifier,c=0;c<d.extensions.length;++c){var e=d.extensions[c];if(e.id===b)return b=d.generateSubjectKeyIdentifier().getBytes(),
a.util.hexToBytes(e.subjectKeyIdentifier)===b}return!1};return d};m.certificateFromAsn1=function(d,c){var g={},l=[];if(!b.validate(d,p,g,l))throw g=Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate."),g.errors=l,g;if("string"!==typeof g.certSignature){for(var l="\x00",q=0;q<g.certSignature.length;++q)l+=b.toDer(g.certSignature[q]).getBytes();g.certSignature=l}l=b.derToOid(g.publicKeyOid);if(l!==m.oids.rsaEncryption)throw Error("Cannot read public key. OID is not RSA.");
var k=m.createCertificate();k.version=g.certVersion?g.certVersion.charCodeAt(0):0;l=a.util.createBuffer(g.certSerialNumber);k.serialNumber=l.toHex();k.signatureOid=a.asn1.derToOid(g.certSignatureOid);k.signatureParameters=s(k.signatureOid,g.certSignatureParams,!0);k.siginfo.algorithmOid=a.asn1.derToOid(g.certinfoSignatureOid);k.siginfo.parameters=s(k.siginfo.algorithmOid,g.certinfoSignatureParams,!1);l=a.util.createBuffer(g.certSignature);++l.read;k.signature=l.getBytes();l=[];void 0!==g.certValidity1UTCTime&&
l.push(b.utcTimeToDate(g.certValidity1UTCTime));void 0!==g.certValidity2GeneralizedTime&&l.push(b.generalizedTimeToDate(g.certValidity2GeneralizedTime));void 0!==g.certValidity3UTCTime&&l.push(b.utcTimeToDate(g.certValidity3UTCTime));void 0!==g.certValidity4GeneralizedTime&&l.push(b.generalizedTimeToDate(g.certValidity4GeneralizedTime));if(2<l.length)throw Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(2>l.length)throw Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");
k.validity.notBefore=l[0];k.validity.notAfter=l[1];k.tbsCertificate=g.tbsCertificate;if(c){k.md=null;if(k.signatureOid in f)switch(l=f[k.signatureOid],l){case "sha1WithRSAEncryption":k.md=a.md.sha1.create();break;case "md5WithRSAEncryption":k.md=a.md.md5.create();break;case "sha256WithRSAEncryption":k.md=a.md.sha256.create();break;case "sha512WithRSAEncryption":k.md=a.md.sha512.create();break;case "RSASSA-PSS":k.md=a.md.sha256.create()}if(null===k.md)throw g=Error("Could not compute certificate digest. Unknown signature OID."),
g.signatureOid=k.signatureOid,g;l=b.toDer(k.tbsCertificate);k.md.update(l.getBytes())}l=a.md.sha1.create();k.issuer.getField=function(a){return e(k.issuer,a)};k.issuer.addField=function(a){h([a]);k.issuer.attributes.push(a)};k.issuer.attributes=m.RDNAttributesAsArray(g.certIssuer,l);g.certIssuerUniqueId&&(k.issuer.uniqueId=g.certIssuerUniqueId);k.issuer.hash=l.digest().toHex();l=a.md.sha1.create();k.subject.getField=function(a){return e(k.subject,a)};k.subject.addField=function(a){h([a]);k.subject.attributes.push(a)};
k.subject.attributes=m.RDNAttributesAsArray(g.certSubject,l);g.certSubjectUniqueId&&(k.subject.uniqueId=g.certSubjectUniqueId);k.subject.hash=l.digest().toHex();k.extensions=g.certExtensions?m.certificateExtensionsFromAsn1(g.certExtensions):[];k.publicKey=m.publicKeyFromAsn1(g.subjectPublicKeyInfo);return k};m.certificateExtensionsFromAsn1=function(a){for(var b=[],d=0;d<a.value.length;++d)for(var c=a.value[d],e=0;e<c.value.length;++e)b.push(m.certificateExtensionFromAsn1(c.value[e]));return b};m.certificateExtensionFromAsn1=
function(d){var c={};c.id=b.derToOid(d.value[0].value);c.critical=!1;d.value[1].type===b.Type.BOOLEAN?(c.critical=0!==d.value[1].value.charCodeAt(0),c.value=d.value[2].value):c.value=d.value[1].value;if(c.id in f)if(c.name=f[c.id],"keyUsage"===c.name){d=b.fromDer(c.value);var e=0,g=0;1<d.value.length&&(e=d.value.charCodeAt(1),g=2<d.value.length?d.value.charCodeAt(2):0);c.digitalSignature=128===(e&128);c.nonRepudiation=64===(e&64);c.keyEncipherment=32===(e&32);c.dataEncipherment=16===(e&16);c.keyAgreement=
8===(e&8);c.keyCertSign=4===(e&4);c.cRLSign=2===(e&2);c.encipherOnly=1===(e&1);c.decipherOnly=128===(g&128)}else if("basicConstraints"===c.name)d=b.fromDer(c.value),c.cA=0<d.value.length&&d.value[0].type===b.Type.BOOLEAN?0!==d.value[0].value.charCodeAt(0):!1,e=null,0<d.value.length&&d.value[0].type===b.Type.INTEGER?e=d.value[0].value:1<d.value.length&&(e=d.value[1].value),null!==e&&(c.pathLenConstraint=b.derToInteger(e));else if("extKeyUsage"===c.name)for(d=b.fromDer(c.value),e=0;e<d.value.length;++e)g=
b.derToOid(d.value[e].value),g in f?c[f[g]]=!0:c[g]=!0;else if("nsCertType"===c.name)d=b.fromDer(c.value),e=0,1<d.value.length&&(e=d.value.charCodeAt(1)),c.client=128===(e&128),c.server=64===(e&64),c.email=32===(e&32),c.objsign=16===(e&16),c.reserved=8===(e&8),c.sslCA=4===(e&4),c.emailCA=2===(e&2),c.objCA=1===(e&1);else if("subjectAltName"===c.name||"issuerAltName"===c.name)for(c.altNames=[],d=b.fromDer(c.value),g=0;g<d.value.length;++g){var e=d.value[g],h={type:e.type,value:e.value};c.altNames.push(h);
switch(e.type){case 7:h.ip=a.util.bytesToIP(e.value);break;case 8:h.oid=b.derToOid(e.value)}}else"subjectKeyIdentifier"===c.name&&(d=b.fromDer(c.value),c.subjectKeyIdentifier=a.util.bytesToHex(d.value));return c};m.certificationRequestFromAsn1=function(d,c){var g={},l=[];if(!b.validate(d,x,g,l))throw g=Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest."),g.errors=l,g;if("string"!==typeof g.csrSignature){for(var l="\x00",p=0;p<g.csrSignature.length;++p)l+=
b.toDer(g.csrSignature[p]).getBytes();g.csrSignature=l}l=b.derToOid(g.publicKeyOid);if(l!==m.oids.rsaEncryption)throw Error("Cannot read public key. OID is not RSA.");var k=m.createCertificationRequest();k.version=g.csrVersion?g.csrVersion.charCodeAt(0):0;k.signatureOid=a.asn1.derToOid(g.csrSignatureOid);k.signatureParameters=s(k.signatureOid,g.csrSignatureParams,!0);k.siginfo.algorithmOid=a.asn1.derToOid(g.csrSignatureOid);k.siginfo.parameters=s(k.siginfo.algorithmOid,g.csrSignatureParams,!1);l=
a.util.createBuffer(g.csrSignature);++l.read;k.signature=l.getBytes();k.certificationRequestInfo=g.certificationRequestInfo;if(c){k.md=null;if(k.signatureOid in f)switch(l=f[k.signatureOid],l){case "sha1WithRSAEncryption":k.md=a.md.sha1.create();break;case "md5WithRSAEncryption":k.md=a.md.md5.create();break;case "sha256WithRSAEncryption":k.md=a.md.sha256.create();break;case "sha512WithRSAEncryption":k.md=a.md.sha512.create();break;case "RSASSA-PSS":k.md=a.md.sha256.create()}if(null===k.md)throw g=
Error("Could not compute certification request digest. Unknown signature OID."),g.signatureOid=k.signatureOid,g;l=b.toDer(k.certificationRequestInfo);k.md.update(l.getBytes())}l=a.md.sha1.create();k.subject.getField=function(a){return e(k.subject,a)};k.subject.addField=function(a){h([a]);k.subject.attributes.push(a)};k.subject.attributes=m.RDNAttributesAsArray(g.certificationRequestInfoSubject,l);k.subject.hash=l.digest().toHex();k.publicKey=m.publicKeyFromAsn1(g.subjectPublicKeyInfo);k.getAttribute=
function(a){return e(k,a)};k.addAttribute=function(a){h([a]);k.attributes.push(a)};k.attributes=m.CRIAttributesAsArray(g.certificationRequestInfoAttributes||[]);return k};m.createCertificationRequest=function(){var d={version:0,signatureOid:null,signature:null,siginfo:{}};d.siginfo.algorithmOid=null;d.subject={};d.subject.getField=function(a){return e(d.subject,a)};d.subject.addField=function(a){h([a]);d.subject.attributes.push(a)};d.subject.attributes=[];d.subject.hash=null;d.publicKey=null;d.attributes=
[];d.getAttribute=function(a){return e(d,a)};d.addAttribute=function(a){h([a]);d.attributes.push(a)};d.md=null;d.setSubject=function(a){h(a);d.subject.attributes=a;d.subject.hash=null};d.setAttributes=function(a){h(a);d.attributes=a};d.sign=function(c,e){d.md=e||a.md.sha1.create();var g=f[d.md.algorithm+"WithRSAEncryption"];if(!g)throw g=Error("Could not compute certification request digest. Unknown message digest algorithm OID."),g.algorithm=d.md.algorithm,g;d.signatureOid=d.siginfo.algorithmOid=
g;d.certificationRequestInfo=m.getCertificationRequestInfo(d);g=b.toDer(d.certificationRequestInfo);d.md.update(g.getBytes());d.signature=c.sign(d.md)};d.verify=function(){var c=!1,e=d.md;if(null===e){if(d.signatureOid in f)switch(f[d.signatureOid]){case "sha1WithRSAEncryption":e=a.md.sha1.create();break;case "md5WithRSAEncryption":e=a.md.md5.create();break;case "sha256WithRSAEncryption":e=a.md.sha256.create();break;case "sha512WithRSAEncryption":e=a.md.sha512.create();break;case "RSASSA-PSS":e=a.md.sha256.create()}if(null===
e)throw e=Error("Could not compute certification request digest. Unknown signature OID."),e.signatureOid=d.signatureOid,e;var g=d.certificationRequestInfo||m.getCertificationRequestInfo(d),g=b.toDer(g);e.update(g.getBytes())}if(null!==e){var h;switch(d.signatureOid){case f["RSASSA-PSS"]:c=f[d.signatureParameters.mgf.hash.algorithmOid];if(void 0===c||void 0===a.md[c])throw e=Error("Unsupported MGF hash function."),e.oid=d.signatureParameters.mgf.hash.algorithmOid,e.name=c,e;h=f[d.signatureParameters.mgf.algorithmOid];
if(void 0===h||void 0===a.mgf[h])throw e=Error("Unsupported MGF function."),e.oid=d.signatureParameters.mgf.algorithmOid,e.name=h,e;h=a.mgf[h].create(a.md[c].create());c=f[d.signatureParameters.hash.algorithmOid];if(void 0===c||void 0===a.md[c])throw e=Error("Unsupported RSASSA-PSS hash function."),e.oid=d.signatureParameters.hash.algorithmOid,e.name=c,e;h=a.pss.create(a.md[c].create(),h,d.signatureParameters.saltLength)}c=d.publicKey.verify(e.digest().getBytes(),d.signature,h)}return c};return d};
m.getTBSCertificate=function(d){var e=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(d.version).getBytes())]),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.util.hexToBytes(d.serialNumber)),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(d.siginfo.algorithmOid).getBytes()),l(d.siginfo.algorithmOid,d.siginfo.parameters)]),c(d.issuer),b.create(b.Class.UNIVERSAL,
b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.UTCTIME,!1,b.dateToUtcTime(d.validity.notBefore)),b.create(b.Class.UNIVERSAL,b.Type.UTCTIME,!1,b.dateToUtcTime(d.validity.notAfter))]),c(d.subject),m.publicKeyToAsn1(d.publicKey)]);d.issuer.uniqueId&&e.value.push(b.create(b.Class.CONTEXT_SPECIFIC,1,!0,[b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+d.issuer.uniqueId)]));d.subject.uniqueId&&e.value.push(b.create(b.Class.CONTEXT_SPECIFIC,2,!0,[b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,
!1,String.fromCharCode(0)+d.subject.uniqueId)]));0<d.extensions.length&&e.value.push(m.certificateExtensionsToAsn1(d.extensions));return e};m.getCertificationRequestInfo=function(a){return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(a.version).getBytes()),c(a.subject),m.publicKeyToAsn1(a.publicKey),d(a)])};m.distinguishedNameToAsn1=function(a){return c(a)};m.certificateToAsn1=function(a){var d=a.tbsCertificate||m.getTBSCertificate(a);
return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[d,b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.signatureOid).getBytes()),l(a.signatureOid,a.signatureParameters)]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])};m.certificateExtensionsToAsn1=function(a){var d=b.create(b.Class.CONTEXT_SPECIFIC,3,!0,[]),c=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);d.value.push(c);for(var e=0;e<a.length;++e)c.value.push(m.certificateExtensionToAsn1(a[e]));
return d};m.certificateExtensionToAsn1=function(a){var d=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);d.value.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.id).getBytes()));a.critical&&d.value.push(b.create(b.Class.UNIVERSAL,b.Type.BOOLEAN,!1,String.fromCharCode(255)));var c=a.value;"string"!==typeof a.value&&(c=b.toDer(c).getBytes());d.value.push(b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,c));return d};m.certificationRequestToAsn1=function(a){var d=a.certificationRequestInfo||
m.getCertificationRequestInfo(a);return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[d,b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(a.signatureOid).getBytes()),l(a.signatureOid,a.signatureParameters)]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+a.signature)])};m.createCaStore=function(d){function e(d){if(!d.hash){var b=a.md.sha1.create();d.attributes=m.RDNAttributesAsArray(c(d),b);d.hash=b.digest().toHex()}return f.certs[d.hash]||
null}var f={certs:{},getIssuer:function(a){return e(a.issuer)},addCertificate:function(d){"string"===typeof d&&(d=a.pki.certificateFromPem(d));if(!d.subject.hash){var b=a.md.sha1.create();d.subject.attributes=m.RDNAttributesAsArray(c(d.subject),b);d.subject.hash=b.digest().toHex()}d.subject.hash in f.certs?(b=f.certs[d.subject.hash],a.util.isArray(b)||(b=[b]),b.push(d)):f.certs[d.subject.hash]=d},hasCertificate:function(d){var c=e(d.subject);if(!c)return!1;a.util.isArray(c)||(c=[c]);d=b.toDer(m.certificateToAsn1(d)).getBytes();
for(var f=0;f<c.length;++f){var g=b.toDer(m.certificateToAsn1(c[f])).getBytes();if(d===g)return!0}return!1}};if(d)for(var g=0;g<d.length;++g)f.addCertificate(d[g]);return f};m.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};
m.verifyCertificateChain=function(d,b,c){b=b.slice(0);var e=b.slice(0),f=new Date,g=!0,h=null,l=0;do{var p=b.shift(),q=null,x=!1;if(f<p.validity.notBefore||f>p.validity.notAfter)h={message:"Certificate is not valid yet or has expired.",error:m.certificateError.certificate_expired,notBefore:p.validity.notBefore,notAfter:p.validity.notAfter,now:f};if(null===h){q=b[0]||d.getIssuer(p);null===q&&p.isIssuer(p)&&(x=!0,q=p);if(q){var s=q;a.util.isArray(s)||(s=[s]);for(var t=!1;!t&&0<s.length;){q=s.shift();
try{t=q.verify(p)}catch(u){}}t||(h={message:"Certificate signature is invalid.",error:m.certificateError.bad_certificate})}null!==h||q&&!x||d.hasCertificate(p)||(h={message:"Certificate is not trusted.",error:m.certificateError.unknown_ca})}null===h&&q&&!p.isIssuer(q)&&(h={message:"Certificate issuer is invalid.",error:m.certificateError.bad_certificate});if(null===h)for(s={keyUsage:!0,basicConstraints:!0},t=0;null===h&&t<p.extensions.length;++t){var A=p.extensions[t];!A.critical||A.name in s||(h=
{message:"Certificate has an unsupported critical extension.",error:m.certificateError.unsupported_certificate})}null!==h||g&&(0!==b.length||q&&!x)||(g=p.getExtension("basicConstraints"),p=p.getExtension("keyUsage"),null!==p&&(p.keyCertSign&&null!==g||(h={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:m.certificateError.bad_certificate})),
null!==h||null===g||g.cA||(h={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:m.certificateError.bad_certificate}),null===h&&null!==p&&"pathLenConstraint"in g&&l-1>g.pathLenConstraint&&(h={message:"Certificate basicConstraints pathLenConstraint violated.",error:m.certificateError.bad_certificate}));p=null===h?!0:h.error;g=c?c(p,l,e):p;if(!0===g)h=null;else{!0===p&&(h={message:"The application rejected the certificate.",error:m.certificateError.bad_certificate});
if(g||0===g)"object"!==typeof g||a.util.isArray(g)?"string"===typeof g&&(h.error=g):(g.message&&(h.message=g.message),g.error&&(h.error=g.error));throw h;}g=!1;++l}while(0<b.length);return!0}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.x509)return c.x509;
c.defined.x509=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pki}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/x509","require module ./aes ./asn1 ./des ./md ./mgf ./oids ./pem ./pss ./rsa ./util".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(a,d,b,c){for(var e=
[],f=0;f<a.length;f++)for(var g=0;g<a[f].safeBags.length;g++){var k=a[f].safeBags[g];if(void 0===c||k.type===c)null===d?e.push(k):void 0!==k.attributes[d]&&0<=k.attributes[d].indexOf(b)&&e.push(k)}return e}function c(d){if(d.composed||d.constructed){for(var b=a.util.createBuffer(),c=0;c<d.value.length;++c)b.putBytes(d.value[c].value);d.composed=d.constructed=!1;d.value=b.getBytes()}return d}function h(e,h,l,m){h=d.fromDer(h,l);if(h.tagClass!==d.Class.UNIVERSAL||h.type!==d.Type.SEQUENCE||!0!==h.constructed)throw Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");
for(var p=0;p<h.value.length;p++){var q={},t=[];if(!d.validate(h.value[p],f,q,t))throw e=Error("Cannot read ContentInfo."),e.errors=t,e;var t={encrypted:!1},k=null,k=q.content.value[0];switch(d.derToOid(q.contentType)){case b.oids.data:if(k.tagClass!==d.Class.UNIVERSAL||k.type!==d.Type.OCTETSTRING)throw Error("PKCS#12 SafeContents Data is not an OCTET STRING.");k=c(k).value;break;case b.oids.encryptedData:var u=m,q={},A=[];if(!d.validate(k,a.pkcs7.asn1.encryptedDataValidator,q,A))throw e=Error("Cannot read EncryptedContentInfo."),
e.errors=A,e;k=d.derToOid(q.contentType);if(k!==b.oids.data)throw e=Error("PKCS#12 EncryptedContentInfo ContentType is not Data."),e.oid=k,e;k=d.derToOid(q.encAlgorithm);k=b.pbe.getCipher(k,q.encParameter,u);q=c(q.encryptedContentAsn1);q=a.util.createBuffer(q.value);k.update(q);if(!k.finish())throw Error("Failed to decrypt PKCS#12 SafeContents.");k=k.output.getBytes();t.encrypted=!0;break;default:throw e=Error("Unsupported PKCS#12 contentType."),e.contentType=d.derToOid(q.contentType),e;}t.safeBags=
g(k,l,m);e.safeContents.push(t)}}function g(a,c,e){if(!c&&0===a.length)return[];a=d.fromDer(a,c);if(a.tagClass!==d.Class.UNIVERSAL||a.type!==d.Type.SEQUENCE||!0!==a.constructed)throw Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var f=[],g=0;g<a.value.length;g++){var h={},m=[];if(!d.validate(a.value[g],q,h,m))throw a=Error("Cannot read SafeBag."),a.errors=m,a;var k={type:d.derToOid(h.bagId),attributes:l(h.bagAttributes)};f.push(k);var p,u,v=h.bagValue.value[0];switch(k.type){case b.oids.pkcs8ShroudedKeyBag:if(v=
b.decryptPrivateKeyInfo(v,e),null===v)throw Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case b.oids.keyBag:try{k.key=b.privateKeyFromAsn1(v)}catch(w){k.key=null,k.asn1=v}continue;case b.oids.certBag:p=t;u=function(){if(d.derToOid(h.certId)!==b.oids.x509Certificate){var a=Error("Unsupported certificate type, only X.509 supported.");a.oid=d.derToOid(h.certId);throw a;}a=d.fromDer(h.cert,c);try{k.cert=b.certificateFromAsn1(a,!0)}catch(e){k.cert=null,k.asn1=a}};break;default:throw a=
Error("Unsupported PKCS#12 SafeBag type."),a.oid=k.type,a;}if(void 0!==p&&!d.validate(v,p,h,m))throw a=Error("Cannot read PKCS#12 "+p.name),a.errors=m,a;u()}return f}function l(a){var c={};if(void 0!==a)for(var e=0;e<a.length;++e){var f={},g=[];if(!d.validate(a[e],p,f,g))throw a=Error("Cannot read PKCS#12 BagAttribute."),a.errors=g,a;g=d.derToOid(f.oid);if(void 0!==b.oids[g]){c[b.oids[g]]=[];for(var h=0;h<f.values.length;++h)c[b.oids[g]].push(f.values[h].value)}}return c}var d=a.asn1,b=a.pki,m=a.pkcs12=
a.pkcs12||{},f={name:"ContentInfo",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:d.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},u={name:"PFX",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,capture:"version"},
f,{name:"PFX.macData",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",
tagClass:d.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:d.Class.UNIVERSAL,type:d.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:d.Class.UNIVERSAL,type:d.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},q={name:"SafeBag",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,
value:[{name:"SafeBag.bagId",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:d.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:d.Class.UNIVERSAL,type:d.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},p={name:"Attribute",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,
capture:"oid"},{name:"Attribute.attrValues",tagClass:d.Class.UNIVERSAL,type:d.Type.SET,constructed:!0,capture:"values"}]},t={name:"CertBag",tagClass:d.Class.UNIVERSAL,type:d.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:d.Class.UNIVERSAL,type:d.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:d.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:d.Class.UNIVERSAL,type:d.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};
m.pkcs12FromAsn1=function(f,g,l){"string"===typeof g?(l=g,g=!0):void 0===g&&(g=!0);var p={};if(!d.validate(f,u,p,[]))throw g=Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX."),g.errors=g,g;var q={version:p.version.charCodeAt(0),safeContents:[],getBags:function(d){var b={},c;"localKeyId"in d?c=d.localKeyId:"localKeyIdHex"in d&&(c=a.util.hexToBytes(d.localKeyIdHex));void 0===c&&!("friendlyName"in d)&&"bagType"in d&&(b[d.bagType]=e(q.safeContents,null,null,d.bagType));void 0!==c&&
(b.localKeyId=e(q.safeContents,"localKeyId",c,d.bagType));"friendlyName"in d&&(b.friendlyName=e(q.safeContents,"friendlyName",d.friendlyName,d.bagType));return b},getBagsByFriendlyName:function(a,d){return e(q.safeContents,"friendlyName",a,d)},getBagsByLocalKeyId:function(a,d){return e(q.safeContents,"localKeyId",a,d)}};if(3!==p.version.charCodeAt(0))throw g=Error("PKCS#12 PFX of version other than 3 not supported."),g.version=p.version.charCodeAt(0),g;if(d.derToOid(p.contentType)!==b.oids.data)throw g=
Error("Only PKCS#12 PFX in password integrity mode supported."),g.oid=d.derToOid(p.contentType),g;f=p.content.value[0];if(f.tagClass!==d.Class.UNIVERSAL||f.type!==d.Type.OCTETSTRING)throw Error("PKCS#12 authSafe content data is not an OCTET STRING.");f=c(f);if(p.mac){var t=null,A=0,k=d.derToOid(p.macAlgorithm);switch(k){case b.oids.sha1:t=a.md.sha1.create();A=20;break;case b.oids.sha256:t=a.md.sha256.create();A=32;break;case b.oids.sha384:t=a.md.sha384.create();A=48;break;case b.oids.sha512:t=a.md.sha512.create();
A=64;break;case b.oids.md5:t=a.md.md5.create(),A=16}if(null===t)throw Error("PKCS#12 uses unsupported MAC algorithm: "+k);var k=new a.util.ByteBuffer(p.macSalt),v="macIterations"in p?parseInt(a.util.bytesToHex(p.macIterations),16):1,A=m.generateKey(l,k,3,v,A,t),k=a.hmac.create();k.start(t,A);k.update(f.value);if(k.getMac().getBytes()!==p.macDigest)throw Error("PKCS#12 MAC could not be verified. Invalid password?");}h(q,f.value,g,l);return q};m.toPkcs12Asn1=function(c,e,f,g){g=g||{};g.saltSize=g.saltSize||
8;g.count=g.count||2048;g.algorithm=g.algorithm||g.encAlgorithm||"aes128";"useMac"in g||(g.useMac=!0);"localKeyId"in g||(g.localKeyId=null);"generateLocalKeyId"in g||(g.generateLocalKeyId=!0);var h=g.localKeyId,l;if(null!==h)h=a.util.hexToBytes(h);else if(g.generateLocalKeyId)if(e){var p=a.util.isArray(e)?e[0]:e;"string"===typeof p&&(p=b.certificateFromPem(p));h=a.md.sha1.create();h.update(d.toDer(b.certificateToAsn1(p)).getBytes());h=h.digest().getBytes()}else h=a.random.getBytes(20);p=[];null!==
h&&p.push(d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.localKeyId).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SET,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,h)])]));"friendlyName"in g&&p.push(d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.friendlyName).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SET,!0,[d.create(d.Class.UNIVERSAL,d.Type.BMPSTRING,!1,g.friendlyName)])]));
0<p.length&&(l=d.create(d.Class.UNIVERSAL,d.Type.SET,!0,p));h=[];p=[];null!==e&&(p=a.util.isArray(e)?e:[e]);for(var k=[],q=0;q<p.length;++q){e=p[q];"string"===typeof e&&(e=b.certificateFromPem(e));var t=0===q?l:void 0;e=b.certificateToAsn1(e);e=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.certBag).getBytes()),d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.x509Certificate).getBytes()),
d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,d.toDer(e).getBytes())])])]),t]);k.push(e)}0<k.length&&(e=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,k),e=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.data).getBytes()),d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,d.toDer(e).getBytes())])]),h.push(e));e=null;null!==c&&(c=b.wrapRsaPrivateKey(b.privateKeyToAsn1(c)),
e=null===f?d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.keyBag).getBytes()),d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[c]),l]):d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.pkcs8ShroudedKeyBag).getBytes()),d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[b.encryptPrivateKeyInfo(c,f,g)]),l]),c=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[e]),c=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,
[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.data).getBytes()),d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,d.toDer(c).getBytes())])]),h.push(c));l=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,h);var u;g.useMac&&(h=a.md.sha1.create(),u=new a.util.ByteBuffer(a.random.getBytes(g.saltSize)),g=g.count,c=m.generateKey(f,u,3,g,20),f=a.hmac.create(),f.start(h,c),f.update(d.toDer(l).getBytes()),f=f.getMac(),u=d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,
!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.sha1).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.NULL,!1,"")]),d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,f.getBytes())]),d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,u.getBytes()),d.create(d.Class.UNIVERSAL,d.Type.INTEGER,!1,d.integerToDer(g).getBytes())]));return d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,
d.Type.INTEGER,!1,d.integerToDer(3).getBytes()),d.create(d.Class.UNIVERSAL,d.Type.SEQUENCE,!0,[d.create(d.Class.UNIVERSAL,d.Type.OID,!1,d.oidToDer(b.oids.data).getBytes()),d.create(d.Class.CONTEXT_SPECIFIC,0,!0,[d.create(d.Class.UNIVERSAL,d.Type.OCTETSTRING,!1,d.toDer(l).getBytes())])]),u])};m.generateKey=a.pbe.generatePkcs12Key}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,
C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.pkcs12)return c.pkcs12;c.defined.pkcs12=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pkcs12}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/pkcs12","require module ./asn1 ./hmac ./oids ./pkcs7asn1 ./pbe ./random ./rsa ./sha1 ./util ./x509".split(" "),
function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){var e=a.asn1,c=a.pki=a.pki||{};c.pemToDer=function(c){c=a.pem.decode(c)[0];if(c.procType&&"ENCRYPTED"===c.procType.type)throw Error("Could not convert PEM to DER; PEM is encrypted.");return a.util.createBuffer(c.body)};c.privateKeyFromPem=function(h){h=a.pem.decode(h)[0];if("PRIVATE KEY"!==h.type&&"RSA PRIVATE KEY"!==h.type){var g=Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');
g.headerType=h.type;throw g;}if(h.procType&&"ENCRYPTED"===h.procType.type)throw Error("Could not convert private key from PEM; PEM is encrypted.");h=e.fromDer(h.body);return c.privateKeyFromAsn1(h)};c.privateKeyToPem=function(h,g){var l={type:"RSA PRIVATE KEY",body:e.toDer(c.privateKeyToAsn1(h)).getBytes()};return a.pem.encode(l,{maxline:g})};c.privateKeyInfoToPem=function(c,g){var l={type:"PRIVATE KEY",body:e.toDer(c).getBytes()};return a.pem.encode(l,{maxline:g})}}if("function"!==typeof l)if("object"===
typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.pki)return c.pki;c.defined.pki=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pki}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,
Array.prototype.slice.call(arguments,0))};l("js/pki","require module ./asn1 ./oids ./pbe ./pem ./pbkdf2 ./pkcs12 ./pss ./rsa ./util ./x509".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){var e=function(d,b,c,e){var f=a.util.createBuffer(),g=d.length>>1,h=g+(d.length&1),k=d.substr(0,h),h=d.substr(g,h);d=a.util.createBuffer();g=a.hmac.create();c=b+c;var l=Math.ceil(e/16);b=Math.ceil(e/20);g.start("MD5",k);k=a.util.createBuffer();d.putBytes(c);
for(var m=0;m<l;++m)g.start(null,null),g.update(d.getBytes()),d.putBuffer(g.digest()),g.start(null,null),g.update(d.bytes()+c),k.putBuffer(g.digest());g.start("SHA1",h);h=a.util.createBuffer();d.clear();d.putBytes(c);for(m=0;m<b;++m)g.start(null,null),g.update(d.getBytes()),d.putBuffer(g.digest()),g.start(null,null),g.update(d.bytes()+c),h.putBuffer(g.digest());f.putBytes(a.util.xorBytes(k.getBytes(),h.getBytes(),e));return f},c=function(d,b,c){c=!1;try{var e=d.deflate(b.fragment.getBytes());b.fragment=
a.util.createBuffer(e);b.length=e.length;c=!0}catch(f){}return c},h=function(d,b,c){c=!1;try{var e=d.inflate(b.fragment.getBytes());b.fragment=a.util.createBuffer(e);b.length=e.length;c=!0}catch(f){}return c},g=function(d,b){var c=0;switch(b){case 1:c=d.getByte();break;case 2:c=d.getInt16();break;case 3:c=d.getInt24();break;case 4:c=d.getInt32()}return a.util.createBuffer(d.getBytes(c))},l=function(a,d,b){a.putInt(b.length(),d<<3);a.putBuffer(b)},d={Versions:{TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,
minor:2},TLS_1_2:{major:3,minor:3}}};d.SupportedVersions=[d.Versions.TLS_1_1,d.Versions.TLS_1_0];d.Version=d.SupportedVersions[0];d.MaxFragment=15360;d.ConnectionEnd={server:0,client:1};d.PRFAlgorithm={tls_prf_sha256:0};d.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};d.CipherType={stream:0,block:1,aead:2};d.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};d.CompressionMethod={none:0,deflate:1};d.ContentType={change_cipher_spec:20,alert:21,handshake:22,
application_data:23,heartbeat:24};d.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};d.Alert={};d.Alert.Level={warning:1,fatal:2};d.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,
certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};d.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};d.CipherSuites={};d.getCipherSuite=function(a){var b=null,c;for(c in d.CipherSuites){var e=d.CipherSuites[c];if(e.id[0]===a.charCodeAt(0)&&e.id[1]===a.charCodeAt(1)){b=e;break}}return b};
d.handleUnexpected=function(a,b){(a.open||a.entity!==d.ConnectionEnd.client)&&a.error(a,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.unexpected_message}})};d.handleHelloRequest=function(a,b,c){!a.handshaking&&0<a.handshakes&&(d.queue(a,d.createAlert(a,{level:d.Alert.Level.warning,description:d.Alert.Description.no_renegotiation})),d.flush(a));a.process()};d.parseHelloMessage=function(b,c,e){var f=null,h=b.entity===
d.ConnectionEnd.client;if(38>e)b.error(b,{message:h?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});else{c=c.fragment;var k=c.length(),f={version:{major:c.getByte(),minor:c.getByte()},random:a.util.createBuffer(c.getBytes(32)),session_id:g(c,1),extensions:[]};h?(f.cipher_suite=c.getBytes(2),f.compression_method=c.getByte()):(f.cipher_suites=g(c,2),f.compression_methods=
g(c,1));k=e-(k-c.length());if(0<k){for(e=g(c,2);0<e.length();)f.extensions.push({type:[e.getByte(),e.getByte()],data:g(e,2)});if(!h)for(e=0;e<f.extensions.length;++e)if(c=f.extensions[e],0===c.type[0]&&0===c.type[1])for(c=g(c.data,2);0<c.length()&&0===c.getByte();)b.session.extensions.server_name.serverNameList.push(g(c,2).getBytes())}if(b.session.version&&(f.version.major!==b.session.version.major||f.version.minor!==b.session.version.minor))return b.error(b,{message:"TLS version change is disallowed during renegotiation.",
send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.protocol_version}});if(h)b.session.cipherSuite=d.getCipherSuite(f.cipher_suite);else for(e=a.util.createBuffer(f.cipher_suites.bytes());0<e.length()&&(b.session.cipherSuite=d.getCipherSuite(e.getBytes(2)),null===b.session.cipherSuite););if(null===b.session.cipherSuite)return b.error(b,{message:"No cipher suites in common.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(f.cipher_suite)});
b.session.compressionMethod=h?f.compression_method:d.CompressionMethod.none}return f};d.createSecurityParameters=function(a,b){var c=a.entity===d.ConnectionEnd.client,e=b.random.bytes(),f=c?a.session.sp.client_random:e,c=c?e:d.createRandom().getBytes();a.session.sp={entity:a.entity,prf_algorithm:d.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,
compression_algorithm:a.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:f,server_random:c}};d.handleServerHello=function(a,c,e){c=d.parseHelloMessage(a,c,e);if(!a.fail){if(c.version.minor<=a.version.minor)a.version.minor=c.version.minor;else return a.error(a,{message:"Incompatible TLS version.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.protocol_version}});a.session.version=a.version;e=c.session_id.bytes();0<e.length&&e===a.session.id?
(a.expect=q,a.session.resuming=!0,a.session.sp.server_random=c.random.bytes()):(a.expect=b,a.session.resuming=!1,d.createSecurityParameters(a,c));a.session.id=e;a.process()}};d.handleClientHello=function(b,c,e){c=d.parseHelloMessage(b,c,e);if(!b.fail){var f=c.session_id.bytes();e=null;if(b.sessionCache)if(e=b.sessionCache.getSession(f),null===e)f="";else if(e.version.major!==c.version.major||e.version.minor>c.version.minor)e=null,f="";0===f.length&&(f=a.random.getBytes(32));b.session.id=f;b.session.clientHelloVersion=
c.version;b.session.sp={};if(e)b.version=b.session.version=e.version,b.session.sp=e.sp;else{for(var g,f=1;f<d.SupportedVersions.length&&!(g=d.SupportedVersions[f],g.minor<=c.version.minor);++f);b.version={major:g.major,minor:g.minor};b.session.version=b.version}null!==e?(b.expect=v,b.session.resuming=!0,b.session.sp.client_random=c.random.bytes()):(b.expect=!1!==b.verifyClient?s:n,b.session.resuming=!1,d.createSecurityParameters(b,c));b.open=!0;d.queue(b,d.createRecord(b,{type:d.ContentType.handshake,
data:d.createServerHello(b)}));b.session.resuming?(d.queue(b,d.createRecord(b,{type:d.ContentType.change_cipher_spec,data:d.createChangeCipherSpec()})),b.state.pending=d.createConnectionState(b),b.state.current.write=b.state.pending.write,d.queue(b,d.createRecord(b,{type:d.ContentType.handshake,data:d.createFinished(b)}))):(d.queue(b,d.createRecord(b,{type:d.ContentType.handshake,data:d.createCertificate(b)})),b.fail||(d.queue(b,d.createRecord(b,{type:d.ContentType.handshake,data:d.createServerKeyExchange(b)})),
!1!==b.verifyClient&&d.queue(b,d.createRecord(b,{type:d.ContentType.handshake,data:d.createCertificateRequest(b)})),d.queue(b,d.createRecord(b,{type:d.ContentType.handshake,data:d.createServerHelloDone(b)}))));d.flush(b);b.process()}};d.handleCertificate=function(b,c,e){if(3>e)return b.error(b,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});e=g(c.fragment,3);var f,h;c=[];try{for(;0<e.length();)f=
g(e,3),h=a.asn1.fromDer(f),f=a.pki.certificateFromAsn1(h,!0),c.push(f)}catch(k){return b.error(b,{message:"Could not parse certificate list.",cause:k,send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.bad_certificate}})}f=b.entity===d.ConnectionEnd.client;!f&&!0!==b.verifyClient||0!==c.length?0===c.length?b.expect=f?m:n:(f?b.session.serverCertificate=c[0]:b.session.clientCertificate=c[0],d.verifyCertificateChain(b,c)&&(b.expect=f?m:n)):b.error(b,{message:f?"No server certificate provided.":
"No client certificate provided.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});b.process()};d.handleServerKeyExchange=function(a,b,c){if(0<c)return a.error(a,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.unsupported_certificate}});a.expect=f;a.process()};d.handleClientKeyExchange=function(b,c,e){if(48>e)return b.error(b,{message:"Invalid key parameters. Only RSA is supported.",
send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.unsupported_certificate}});c=g(c.fragment,2).getBytes();e=null;if(b.getPrivateKey)try{e=b.getPrivateKey(b,b.session.serverCertificate),e=a.pki.privateKeyFromPem(e)}catch(f){b.error(b,{message:"Could not get private key.",cause:f,send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}})}if(null===e)return b.error(b,{message:"No private key set.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}});
try{var h=b.session.sp;h.pre_master_secret=e.decrypt(c);var k=b.session.clientHelloVersion;if(k.major!==h.pre_master_secret.charCodeAt(0)||k.minor!==h.pre_master_secret.charCodeAt(1))throw Error("TLS version rollback attack detected.");}catch(l){h.pre_master_secret=a.random.getBytes(48)}b.expect=v;null!==b.session.clientCertificate&&(b.expect=r);b.process()};d.handleCertificateRequest=function(a,b,c){if(3>c)return a.error(a,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:d.Alert.Level.fatal,
description:d.Alert.Description.illegal_parameter}});b=b.fragment;b={certificate_types:g(b,1),certificate_authorities:g(b,2)};a.session.certificateRequest=b;a.expect=u;a.process()};d.handleCertificateVerify=function(b,c,e){if(2>e)return b.error(b,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});e=c.fragment;e.read-=4;c=e.bytes();e.read+=4;e=g(e,2).getBytes();var f=a.util.createBuffer();f.putBuffer(b.session.md5.digest());
f.putBuffer(b.session.sha1.digest());f=f.getBytes();try{if(!b.session.clientCertificate.publicKey.verify(f,e,"NONE"))throw Error("CertificateVerify signature does not match.");b.session.md5.update(c);b.session.sha1.update(c)}catch(h){return b.error(b,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.handshake_failure}})}b.expect=v;b.process()};d.handleServerHelloDone=function(b,c,e){if(0<e)return b.error(b,{message:"Invalid ServerHelloDone message. Invalid length.",
send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.record_overflow}});if(null===b.serverCertificate&&(c={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.insufficient_security}},e=b.verify(b,c.alert.description,0,[]),!0!==e)){if(e||0===e)"object"!==typeof e||a.util.isArray(e)?"number"===typeof e&&(c.alert.description=e):(e.message&&(c.message=e.message),e.alert&&(c.alert.description=e.alert));
return b.error(b,c)}null!==b.session.certificateRequest&&(c=d.createRecord(b,{type:d.ContentType.handshake,data:d.createCertificate(b)}),d.queue(b,c));c=d.createRecord(b,{type:d.ContentType.handshake,data:d.createClientKeyExchange(b)});d.queue(b,c);b.expect=x;c=function(a,b){null!==a.session.certificateRequest&&null!==a.session.clientCertificate&&d.queue(a,d.createRecord(a,{type:d.ContentType.handshake,data:d.createCertificateVerify(a,b)}));d.queue(a,d.createRecord(a,{type:d.ContentType.change_cipher_spec,
data:d.createChangeCipherSpec()}));a.state.pending=d.createConnectionState(a);a.state.current.write=a.state.pending.write;d.queue(a,d.createRecord(a,{type:d.ContentType.handshake,data:d.createFinished(a)}));a.expect=q;d.flush(a);a.process()};if(null===b.session.certificateRequest||null===b.session.clientCertificate)return c(b,null);d.getClientSignature(b,c)};d.handleChangeCipherSpec=function(a,b){if(1!==b.fragment.getByte())return a.error(a,{message:"Invalid ChangeCipherSpec message received.",send:!0,
alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.illegal_parameter}});var c=a.entity===d.ConnectionEnd.client;if(a.session.resuming&&c||!a.session.resuming&&!c)a.state.pending=d.createConnectionState(a);a.state.current.read=a.state.pending.read;if(!a.session.resuming&&c||a.session.resuming&&!c)a.state.pending=null;a.expect=c?p:w;a.process()};d.handleFinished=function(b,c,f){f=c.fragment;f.read-=4;var g=f.bytes();f.read+=4;c=c.fragment.getBytes();f=a.util.createBuffer();f.putBuffer(b.session.md5.digest());
f.putBuffer(b.session.sha1.digest());var h=b.entity===d.ConnectionEnd.client;f=e(b.session.sp.master_secret,h?"server finished":"client finished",f.getBytes(),12);if(f.getBytes()!==c)return b.error(b,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.decrypt_error}});b.session.md5.update(g);b.session.sha1.update(g);if(b.session.resuming&&h||!b.session.resuming&&!h)d.queue(b,d.createRecord(b,{type:d.ContentType.change_cipher_spec,
data:d.createChangeCipherSpec()})),b.state.current.write=b.state.pending.write,b.state.pending=null,d.queue(b,d.createRecord(b,{type:d.ContentType.handshake,data:d.createFinished(b)}));b.expect=h?t:z;b.handshaking=!1;++b.handshakes;b.peerCertificate=h?b.session.serverCertificate:b.session.clientCertificate;d.flush(b);b.isConnected=!0;b.connected(b);b.process()};d.handleAlert=function(a,b){var c=b.fragment,c={level:c.getByte(),description:c.getByte()},e;switch(c.description){case d.Alert.Description.close_notify:e=
"Connection closed.";break;case d.Alert.Description.unexpected_message:e="Unexpected message.";break;case d.Alert.Description.bad_record_mac:e="Bad record MAC.";break;case d.Alert.Description.decryption_failed:e="Decryption failed.";break;case d.Alert.Description.record_overflow:e="Record overflow.";break;case d.Alert.Description.decompression_failure:e="Decompression failed.";break;case d.Alert.Description.handshake_failure:e="Handshake failure.";break;case d.Alert.Description.bad_certificate:e=
"Bad certificate.";break;case d.Alert.Description.unsupported_certificate:e="Unsupported certificate.";break;case d.Alert.Description.certificate_revoked:e="Certificate revoked.";break;case d.Alert.Description.certificate_expired:e="Certificate expired.";break;case d.Alert.Description.certificate_unknown:e="Certificate unknown.";break;case d.Alert.Description.illegal_parameter:e="Illegal parameter.";break;case d.Alert.Description.unknown_ca:e="Unknown certificate authority.";break;case d.Alert.Description.access_denied:e=
"Access denied.";break;case d.Alert.Description.decode_error:e="Decode error.";break;case d.Alert.Description.decrypt_error:e="Decrypt error.";break;case d.Alert.Description.export_restriction:e="Export restriction.";break;case d.Alert.Description.protocol_version:e="Unsupported protocol version.";break;case d.Alert.Description.insufficient_security:e="Insufficient security.";break;case d.Alert.Description.internal_error:e="Internal error.";break;case d.Alert.Description.user_canceled:e="User canceled.";
break;case d.Alert.Description.no_renegotiation:e="Renegotiation not supported.";break;default:e="Unknown error."}if(c.description===d.Alert.Description.close_notify)return a.close();a.error(a,{message:e,send:!1,origin:a.entity===d.ConnectionEnd.client?"server":"client",alert:c});a.process()};d.handleHandshake=function(b,c){var e=c.fragment,f=e.getByte(),g=e.getInt24();if(g>e.length())return b.fragmented=c,c.fragment=a.util.createBuffer(),e.read-=4,b.process();b.fragmented=null;e.read-=4;var h=e.bytes(g+
4);e.read+=4;f in N[b.entity][b.expect]?(b.entity!==d.ConnectionEnd.server||b.open||b.fail||(b.handshaking=!0,b.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}),f!==d.HandshakeType.hello_request&&f!==d.HandshakeType.certificate_verify&&f!==d.HandshakeType.finished&&(b.session.md5.update(h),b.session.sha1.update(h)),N[b.entity][b.expect][f](b,c,g)):
d.handleUnexpected(b,c)};d.handleApplicationData=function(a,b){a.data.putBuffer(b.fragment);a.dataReady(a);a.process()};d.handleHeartbeat=function(b,c){var e=c.fragment,f=e.getByte(),g=e.getInt16(),e=e.getBytes(g);if(f===d.HeartbeatMessageType.heartbeat_request){if(b.handshaking||g>e.length)return b.process();d.queue(b,d.createRecord(b,{type:d.ContentType.heartbeat,data:d.createHeartbeat(d.HeartbeatMessageType.heartbeat_response,e)}));d.flush(b)}else if(f===d.HeartbeatMessageType.heartbeat_response){if(e!==
b.expectedHeartbeatPayload)return b.process();b.heartbeatReceived&&b.heartbeatReceived(b,a.util.createBuffer(e))}b.process()};var b=1,m=2,f=3,u=4,q=5,p=6,t=7,x=8,s=1,n=2,r=3,v=4,w=5,z=6,k=d.handleUnexpected,D=d.handleChangeCipherSpec,C=d.handleAlert,F=d.handleHandshake,E=d.handleApplicationData,I=d.handleHeartbeat,O=[];O[d.ConnectionEnd.client]=[[k,C,F,k,I],[k,C,F,k,I],[k,C,F,k,I],[k,C,F,k,I],[k,C,F,k,I],[D,C,k,k,I],[k,C,F,k,I],[k,C,F,E,I],[k,C,F,k,I]];O[d.ConnectionEnd.server]=[[k,C,F,k,I],[k,C,
F,k,I],[k,C,F,k,I],[k,C,F,k,I],[D,C,k,k,I],[k,C,F,k,I],[k,C,F,E,I],[k,C,F,k,I]];var D=d.handleHelloRequest,C=d.handleCertificate,F=d.handleServerKeyExchange,E=d.handleCertificateRequest,I=d.handleServerHelloDone,K=d.handleFinished,N=[];N[d.ConnectionEnd.client]=[[k,k,d.handleServerHello,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[D,k,k,k,k,k,k,k,k,k,k,C,F,E,I,k,k,k,k,k,k],[D,k,k,k,k,k,k,k,k,k,k,k,F,E,I,k,k,k,k,k,k],[D,k,k,k,k,k,k,k,k,k,k,k,k,E,I,k,k,k,k,k,k],[D,k,k,k,k,k,k,k,k,k,k,k,k,k,I,k,k,k,k,k,k],
[D,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[D,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,K],[D,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[D,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k]];N[d.ConnectionEnd.server]=[[k,d.handleClientHello,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,C,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,d.handleClientKeyExchange,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,d.handleCertificateVerify,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,
k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,K],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k],[k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k,k]];d.generateKeys=function(a,b){var c=b.client_random+b.server_random;a.session.resuming||(b.master_secret=e(b.pre_master_secret,"master secret",c,48).bytes(),b.pre_master_secret=null);var c=b.server_random+b.client_random,f=2*b.mac_key_length+2*b.enc_key_length,g=a.version.major===d.Versions.TLS_1_0.major&&a.version.minor===d.Versions.TLS_1_0.minor;g&&(f+=2*b.fixed_iv_length);c=
e(b.master_secret,"key expansion",c,f);f={client_write_MAC_key:c.getBytes(b.mac_key_length),server_write_MAC_key:c.getBytes(b.mac_key_length),client_write_key:c.getBytes(b.enc_key_length),server_write_key:c.getBytes(b.enc_key_length)};g&&(f.client_write_IV=c.getBytes(b.fixed_iv_length),f.server_write_IV=c.getBytes(b.fixed_iv_length));return f};d.createConnectionState=function(a){var b=a.entity===d.ConnectionEnd.client,e=function(){var a={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,
cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){4294967295===a.sequenceNumber[1]?(a.sequenceNumber[1]=0,++a.sequenceNumber[0]):++a.sequenceNumber[1]}};return a},f={read:e(),write:e()};f.read.update=function(a,b){f.read.cipherFunction(b,f.read)?f.read.compressFunction(a,b,f.read)||a.error(a,{message:"Could not decompress record.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.decompression_failure}}):
a.error(a,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.bad_record_mac}});return!a.fail};f.write.update=function(a,b){f.write.compressFunction(a,b,f.write)?f.write.cipherFunction(b,f.write)||a.error(a,{message:"Could not encrypt record.",send:!1,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}}):a.error(a,{message:"Could not compress record.",send:!1,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}});
return!a.fail};if(a.session)switch(e=a.session.sp,a.session.cipherSuite.initSecurityParameters(e),e.keys=d.generateKeys(a,e),f.read.macKey=b?e.keys.server_write_MAC_key:e.keys.client_write_MAC_key,f.write.macKey=b?e.keys.client_write_MAC_key:e.keys.server_write_MAC_key,a.session.cipherSuite.initConnectionState(f,a,e),e.compression_algorithm){case d.CompressionMethod.none:break;case d.CompressionMethod.deflate:f.read.compressFunction=h;f.write.compressFunction=c;break;default:throw Error("Unsupported compression algorithm.");
}return f};d.createRandom=function(){var b=new Date,b=+b+6E4*b.getTimezoneOffset(),d=a.util.createBuffer();d.putInt32(b);d.putBytes(a.random.getBytes(28));return d};d.createRecord=function(a,b){return b.data?{type:b.type,version:{major:a.version.major,minor:a.version.minor},length:b.data.length(),fragment:b.data}:null};d.createAlert=function(b,c){var e=a.util.createBuffer();e.putByte(c.level);e.putByte(c.description);return d.createRecord(b,{type:d.ContentType.alert,data:e})};d.createClientHello=
function(b){b.session.clientHelloVersion={major:b.version.major,minor:b.version.minor};for(var c=a.util.createBuffer(),e=0;e<b.cipherSuites.length;++e){var f=b.cipherSuites[e];c.putByte(f.id[0]);c.putByte(f.id[1])}var g=c.length(),e=a.util.createBuffer();e.putByte(d.CompressionMethod.none);var h=e.length(),f=a.util.createBuffer();if(b.virtualHost){var k=a.util.createBuffer();k.putByte(0);k.putByte(0);var m=a.util.createBuffer();m.putByte(0);l(m,2,a.util.createBuffer(b.virtualHost));var p=a.util.createBuffer();
l(p,2,m);l(k,2,p);f.putBuffer(k)}k=f.length();0<k&&(k+=2);m=b.session.id;g=m.length+1+2+4+28+2+g+1+h+k;h=a.util.createBuffer();h.putByte(d.HandshakeType.client_hello);h.putInt24(g);h.putByte(b.version.major);h.putByte(b.version.minor);h.putBytes(b.session.sp.client_random);l(h,1,a.util.createBuffer(m));l(h,2,c);l(h,1,e);0<k&&l(h,2,f);return h};d.createServerHello=function(b){var c=b.session.id,e=c.length+1+2+4+28+2+1,f=a.util.createBuffer();f.putByte(d.HandshakeType.server_hello);f.putInt24(e);f.putByte(b.version.major);
f.putByte(b.version.minor);f.putBytes(b.session.sp.server_random);l(f,1,a.util.createBuffer(c));f.putByte(b.session.cipherSuite.id[0]);f.putByte(b.session.cipherSuite.id[1]);f.putByte(b.session.compressionMethod);return f};d.createCertificate=function(b){var c=b.entity===d.ConnectionEnd.client,e=null;b.getCertificate&&(e=b.getCertificate(b,c?b.session.certificateRequest:b.session.extensions.server_name.serverNameList));var f=a.util.createBuffer();if(null!==e)try{a.util.isArray(e)||(e=[e]);for(var g=
null,h=0;h<e.length;++h){var k=a.pem.decode(e[h])[0];if("CERTIFICATE"!==k.type&&"X509 CERTIFICATE"!==k.type&&"TRUSTED CERTIFICATE"!==k.type){var m=Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');m.headerType=k.type;throw m;}if(k.procType&&"ENCRYPTED"===k.procType.type)throw Error("Could not convert certificate from PEM; PEM is encrypted.");var p=a.util.createBuffer(k.body);null===g&&(g=a.asn1.fromDer(p.bytes(),!1));
var q=a.util.createBuffer();l(q,3,p);f.putBuffer(q)}e=a.pki.certificateFromAsn1(g);c?b.session.clientCertificate=e:b.session.serverCertificate=e}catch(n){return b.error(b,{message:"Could not send certificate list.",cause:n,send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.bad_certificate}})}b=3+f.length();c=a.util.createBuffer();c.putByte(d.HandshakeType.certificate);c.putInt24(b);l(c,3,f);return c};d.createClientKeyExchange=function(b){var c=a.util.createBuffer();c.putByte(b.session.clientHelloVersion.major);
c.putByte(b.session.clientHelloVersion.minor);c.putBytes(a.random.getBytes(46));var e=b.session.sp;e.pre_master_secret=c.getBytes();c=b.session.serverCertificate.publicKey.encrypt(e.pre_master_secret);b=c.length+2;e=a.util.createBuffer();e.putByte(d.HandshakeType.client_key_exchange);e.putInt24(b);e.putInt16(c.length);e.putBytes(c);return e};d.createServerKeyExchange=function(b){return a.util.createBuffer()};d.getClientSignature=function(b,c){var e=a.util.createBuffer();e.putBuffer(b.session.md5.digest());
e.putBuffer(b.session.sha1.digest());e=e.getBytes();b.getSignature=b.getSignature||function(b,c,e){var f=null;if(b.getPrivateKey)try{f=b.getPrivateKey(b,b.session.clientCertificate),f=a.pki.privateKeyFromPem(f)}catch(g){b.error(b,{message:"Could not get private key.",cause:g,send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}})}null===f?b.error(b,{message:"No private key set.",send:!0,alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.internal_error}}):
c=f.sign(c,null);e(b,c)};b.getSignature(b,e,c)};d.createCertificateVerify=function(b,c){var e=c.length+2,f=a.util.createBuffer();f.putByte(d.HandshakeType.certificate_verify);f.putInt24(e);f.putInt16(c.length);f.putBytes(c);return f};d.createCertificateRequest=function(b){var c=a.util.createBuffer();c.putByte(1);var e=a.util.createBuffer(),f;for(f in b.caStore.certs){var g=a.pki.distinguishedNameToAsn1(b.caStore.certs[f].subject);e.putBuffer(a.asn1.toDer(g))}b=1+c.length()+2+e.length();f=a.util.createBuffer();
f.putByte(d.HandshakeType.certificate_request);f.putInt24(b);l(f,1,c);l(f,2,e);return f};d.createServerHelloDone=function(b){b=a.util.createBuffer();b.putByte(d.HandshakeType.server_hello_done);b.putInt24(0);return b};d.createChangeCipherSpec=function(){var b=a.util.createBuffer();b.putByte(1);return b};d.createFinished=function(b){var c=a.util.createBuffer();c.putBuffer(b.session.md5.digest());c.putBuffer(b.session.sha1.digest());c=e(b.session.sp.master_secret,b.entity===d.ConnectionEnd.client?"client finished":
"server finished",c.getBytes(),12);b=a.util.createBuffer();b.putByte(d.HandshakeType.finished);b.putInt24(c.length());b.putBuffer(c);return b};d.createHeartbeat=function(b,d,c){"undefined"===typeof c&&(c=d.length);var e=a.util.createBuffer();e.putByte(b);e.putInt16(c);e.putBytes(d);b=e.length();c=Math.max(16,b-c-3);e.putBytes(a.random.getBytes(c));return e};d.queue=function(b,c){if(c){if(c.type===d.ContentType.handshake){var e=c.fragment.bytes();b.session.md5.update(e);b.session.sha1.update(e)}if(c.fragment.length()<=
d.MaxFragment)e=[c];else{for(var e=[],f=c.fragment.bytes();f.length>d.MaxFragment;)e.push(d.createRecord(b,{type:c.type,data:a.util.createBuffer(f.slice(0,d.MaxFragment))})),f=f.slice(d.MaxFragment);0<f.length&&e.push(d.createRecord(b,{type:c.type,data:a.util.createBuffer(f)}))}for(f=0;f<e.length&&!b.fail;++f){var g=e[f];b.state.current.write.update(b,g)&&b.records.push(g)}}};d.flush=function(a){for(var b=0;b<a.records.length;++b){var d=a.records[b];a.tlsData.putByte(d.type);a.tlsData.putByte(d.version.major);
a.tlsData.putByte(d.version.minor);a.tlsData.putInt16(d.fragment.length());a.tlsData.putBuffer(a.records[b].fragment)}a.records=[];return a.tlsDataReady(a)};var Q=function(b){switch(b){case !0:return!0;case a.pki.certificateError.bad_certificate:return d.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return d.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return d.Alert.Description.certificate_revoked;case a.pki.certificateError.certificate_expired:return d.Alert.Description.certificate_expired;
case a.pki.certificateError.certificate_unknown:return d.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return d.Alert.Description.unknown_ca;default:return d.Alert.Description.bad_certificate}},V=function(b){switch(b){case !0:return!0;case d.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case d.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;case d.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;
case d.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case d.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case d.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}};d.verifyCertificateChain=function(b,c){try{a.pki.verifyCertificateChain(b.caStore,c,function(c,e,f){Q(c);e=b.verify(b,c,e,f);if(!0!==e){if("object"===typeof e&&!a.util.isArray(e))throw c=
Error("The application rejected the certificate."),c.send=!0,c.alert={level:d.Alert.Level.fatal,description:d.Alert.Description.bad_certificate},e.message&&(c.message=e.message),e.alert&&(c.alert.description=e.alert),c;e!==c&&(e=V(e))}return e})}catch(e){var f=e;if("object"!==typeof f||a.util.isArray(f))f={send:!0,alert:{level:d.Alert.Level.fatal,description:Q(e)}};"send"in f||(f.send=!0);"alert"in f||(f.alert={level:d.Alert.Level.fatal,description:Q(f.error)});b.error(b,f)}return!b.fail};d.createSessionCache=
function(b,d){var c=null;if(b&&b.getSession&&b.setSession&&b.order)c=b;else{c={};c.cache=b||{};c.capacity=Math.max(d||100,1);c.order=[];for(var e in b)c.order.length<=d?c.order.push(e):delete b[e];c.getSession=function(b){var d=null,e=null;b?e=a.util.bytesToHex(b):0<c.order.length&&(e=c.order[0]);if(null!==e&&e in c.cache){d=c.cache[e];delete c.cache[e];for(var f in c.order)if(c.order[f]===e){c.order.splice(f,1);break}}return d};c.setSession=function(b,d){if(c.order.length===c.capacity){var e=c.order.shift();
delete c.cache[e]}e=a.util.bytesToHex(b);c.order.push(e);c.cache[e]=d}}return c};d.createConnection=function(b){var c=null,c=b.caStore?a.util.isArray(b.caStore)?a.pki.createCaStore(b.caStore):b.caStore:a.pki.createCaStore(),e=b.cipherSuites||null;if(null===e){var e=[],f;for(f in d.CipherSuites)e.push(d.CipherSuites[f])}f=b.server?d.ConnectionEnd.server:d.ConnectionEnd.client;var g=b.sessionCache?d.createSessionCache(b.sessionCache):null,h={version:{major:d.Version.major,minor:d.Version.minor},entity:f,
sessionId:b.sessionId,caStore:c,sessionCache:g,cipherSuites:e,connected:b.connected,virtualHost:b.virtualHost||null,verifyClient:b.verifyClient||!1,verify:b.verify||function(a,b,d,c){return b},getCertificate:b.getCertificate||null,getPrivateKey:b.getPrivateKey||null,getSignature:b.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),tlsDataReady:b.tlsDataReady,dataReady:b.dataReady,heartbeatReceived:b.heartbeatReceived,closed:b.closed,error:function(a,
c){c.origin=c.origin||(a.entity===d.ConnectionEnd.client?"client":"server");c.send&&(d.queue(a,d.createAlert(a,c.alert)),d.flush(a));var e=!1!==c.fatal;e&&(a.fail=!0);b.error(a,c);e&&a.close(!1)},deflate:b.deflate||null,inflate:b.inflate||null,reset:function(a){h.version={major:d.Version.major,minor:d.Version.minor};h.record=null;h.session=null;h.peerCertificate=null;h.state={pending:null,current:null};h.expect=0;h.fragmented=null;h.records=[];h.open=!1;h.handshakes=0;h.handshaking=!1;h.isConnected=
!1;h.fail=!(a||"undefined"===typeof a);h.input.clear();h.tlsData.clear();h.data.clear();h.state.current=d.createConnectionState(h)}};h.reset();h.handshake=function(b){if(h.entity!==d.ConnectionEnd.client)h.error(h,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(h.handshaking)h.error(h,{message:"Handshake already in progress.",fatal:!1});else{h.fail&&!h.open&&0===h.handshakes&&(h.fail=!1);h.handshaking=!0;b=b||"";var c=null;0<b.length&&(h.sessionCache&&(c=h.sessionCache.getSession(b)),
null===c&&(b=""));0===b.length&&h.sessionCache&&(c=h.sessionCache.getSession(),null!==c&&(b=c.id));h.session={id:b,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()};c&&(h.version=c.version,h.session.sp=c.sp);h.session.sp.client_random=d.createRandom().getBytes();h.open=!0;d.queue(h,d.createRecord(h,{type:d.ContentType.handshake,data:d.createClientHello(h)}));d.flush(h)}};h.process=
function(b){var c=0;b&&h.input.putBytes(b);if(!h.fail){null!==h.record&&h.record.ready&&h.record.fragment.isEmpty()&&(h.record=null);if(null===h.record){c=0;b=h.input;var e=b.length();5>e?c=5-e:(h.record={type:b.getByte(),version:{major:b.getByte(),minor:b.getByte()},length:b.getInt16(),fragment:a.util.createBuffer(),ready:!1},(b=h.record.version.major===h.version.major)&&h.session&&h.session.version&&(b=h.record.version.minor===h.version.minor),b||h.error(h,{message:"Incompatible TLS version.",send:!0,
alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.protocol_version}}))}if(!h.fail&&null!==h.record&&!h.record.ready){c=h;b=0;var e=c.input,f=e.length();f<c.record.length?b=c.record.length-f:(c.record.fragment.putBytes(e.getBytes(c.record.length)),e.compact(),c.state.current.read.update(c,c.record)&&(null!==c.fragmented&&(c.fragmented.type===c.record.type?(c.fragmented.fragment.putBuffer(c.record.fragment),c.record=c.fragmented):c.error(c,{message:"Invalid fragmented record.",send:!0,
alert:{level:d.Alert.Level.fatal,description:d.Alert.Description.unexpected_message}})),c.record.ready=!0));c=b}if(!h.fail&&null!==h.record&&h.record.ready)if(b=h.record,e=b.type-d.ContentType.change_cipher_spec,f=O[h.entity][h.expect],e in f)f[e](h,b);else d.handleUnexpected(h,b)}return c};h.prepare=function(b){d.queue(h,d.createRecord(h,{type:d.ContentType.application_data,data:a.util.createBuffer(b)}));return d.flush(h)};h.prepareHeartbeatRequest=function(b,c){b instanceof a.util.ByteBuffer&&(b=
b.bytes());"undefined"===typeof c&&(c=b.length);h.expectedHeartbeatPayload=b;d.queue(h,d.createRecord(h,{type:d.ContentType.heartbeat,data:d.createHeartbeat(d.HeartbeatMessageType.heartbeat_request,b,c)}));return d.flush(h)};h.close=function(a){if(!h.fail&&h.sessionCache&&h.session){var b={id:h.session.id,version:h.session.version,sp:h.session.sp};b.sp.keys=null;h.sessionCache.setSession(b.id,b)}if(h.open){h.open=!1;h.input.clear();if(h.isConnected||h.handshaking)h.isConnected=h.handshaking=!1,d.queue(h,
d.createAlert(h,{level:d.Alert.Level.warning,description:d.Alert.Description.close_notify})),d.flush(h);h.closed(h)}h.reset(a)};return h};a.tls=a.tls||{};for(var T in d)"function"!==typeof d[T]&&(a.tls[T]=d[T]);a.tls.prf_tls1=e;a.tls.hmac_sha1=function(b,d,c){var e=a.hmac.create();e.start("SHA1",b);b=a.util.createBuffer();b.putInt32(d[0]);b.putInt32(d[1]);b.putByte(c.type);b.putByte(c.version.major);b.putByte(c.version.minor);b.putInt16(c.length);b.putBytes(c.fragment.bytes());e.update(b.getBytes());
return e.digest().getBytes()};a.tls.createSessionCache=d.createSessionCache;a.tls.createConnection=d.createConnection}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.tls)return c.tls;c.defined.tls=!0;for(var g=0;g<e.length;++g)e[g](c);return c.tls}},
z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/tls","require module ./asn1 ./hmac ./md ./pem ./pki ./random ./util".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(b,e,g){e=e.entity===a.tls.ConnectionEnd.client;b.read.cipherState={init:!1,cipher:a.cipher.createDecipher("AES-CBC",
e?g.keys.server_write_key:g.keys.client_write_key),iv:e?g.keys.server_write_IV:g.keys.client_write_IV};b.write.cipherState={init:!1,cipher:a.cipher.createCipher("AES-CBC",e?g.keys.client_write_key:g.keys.server_write_key),iv:e?g.keys.client_write_IV:g.keys.server_write_IV};b.read.cipherFunction=l;b.write.cipherFunction=c;b.read.macLength=b.write.macLength=g.mac_length;b.read.macFunction=b.write.macFunction=d.hmac_sha1}function c(b,c){var e=!1,g=c.macFunction(c.macKey,c.sequenceNumber,b);b.fragment.putBytes(g);
c.updateSequenceNumber();g=b.version.minor===d.Versions.TLS_1_0.minor?c.cipherState.init?null:c.cipherState.iv:a.random.getBytesSync(16);c.cipherState.init=!0;var l=c.cipherState.cipher;l.start({iv:g});b.version.minor>=d.Versions.TLS_1_1.minor&&l.output.putBytes(g);l.update(b.fragment);l.finish(h)&&(b.fragment=l.output,b.length=b.fragment.length(),e=!0);return e}function h(a,b,d){d||(a-=b.length()%a,b.fillWithByte(a-1,a));return!0}function g(a,b,d){a=!0;if(d){d=b.length();for(var c=b.last(),e=d-1-
c;e<d-1;++e)a=a&&b.at(e)==c;a&&b.truncate(c+1)}return a}function l(c,e){var h=!1;++b;h=c.version.minor===d.Versions.TLS_1_0.minor?e.cipherState.init?null:e.cipherState.iv:c.fragment.getBytes(16);e.cipherState.init=!0;var q=e.cipherState.cipher;q.start({iv:h});q.update(c.fragment);var h=q.finish(g),p=e.macLength,t=a.random.getBytesSync(p),x=q.output.length();x>=p?(c.fragment=q.output.getBytes(x-p),t=q.output.getBytes(p)):c.fragment=q.output.getBytes();c.fragment=a.util.createBuffer(c.fragment);c.length=
c.fragment.length();p=e.macFunction(e.macKey,e.sequenceNumber,c);e.updateSequenceNumber();q=e.macKey;x=a.hmac.create();x.start("SHA1",q);x.update(t);t=x.digest().getBytes();x.start(null,null);x.update(p);p=x.digest().getBytes();return t===p&&h}var d=a.tls;d.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=d.BulkCipherAlgorithm.aes;a.cipher_type=d.CipherType.block;a.enc_key_length=16;a.block_length=16;
a.fixed_iv_length=16;a.record_iv_length=16;a.mac_algorithm=d.MACAlgorithm.hmac_sha1;a.mac_length=20;a.mac_key_length=20},initConnectionState:e};d.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(a){a.bulk_cipher_algorithm=d.BulkCipherAlgorithm.aes;a.cipher_type=d.CipherType.block;a.enc_key_length=32;a.block_length=16;a.fixed_iv_length=16;a.record_iv_length=16;a.mac_algorithm=d.MACAlgorithm.hmac_sha1;a.mac_length=20;a.mac_key_length=
20},initConnectionState:e};var b=0}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.aesCipherSuites)return c.aesCipherSuites;c.defined.aesCipherSuites=!0;for(var g=0;g<e.length;++g)e[g](c);return c.aesCipherSuites}},z=l;l=function(a,e){v="string"===
typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/aesCipherSuites",["require","module","./aes","./tls"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){a.debug=a.debug||{};a.debug.storage={};a.debug.get=function(e,c){var h;"undefined"===typeof e?h=a.debug.storage:e in a.debug.storage&&(h="undefined"===typeof c?a.debug.storage[e]:
a.debug.storage[e][c]);return h};a.debug.set=function(e,c,h){e in a.debug.storage||(a.debug.storage[e]={});a.debug.storage[e][c]=h};a.debug.clear=function(e,c){"undefined"===typeof e?a.debug.storage={}:e in a.debug.storage&&("undefined"===typeof c?delete a.debug.storage[e]:delete a.debug.storage[e][c])}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=
function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.debug)return c.debug;c.defined.debug=!0;for(var g=0;g<e.length;++g)e[g](c);return c.debug}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/debug",["require","module"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();
(function(){function w(a){function e(c,e,l,d){c.generate=function(b,c){for(var f=new a.util.ByteBuffer,h=Math.ceil(c/d)+l,q=new a.util.ByteBuffer,p=l;p<h;++p){q.putInt32(p);e.start();e.update(b+q.getBytes());var t=e.digest();f.putBytes(t.getBytes(d))}f.truncate(f.length()-c);return f.getBytes()}}a.kem=a.kem||{};var c=a.jsbn.BigInteger;a.kem.rsa={};a.kem.rsa.create=function(e,g){g=g||{};var l=g.prng||a.random;return{encrypt:function(d,b){var g=Math.ceil(d.n.bitLength()/8),f;do f=(new c(a.util.bytesToHex(l.getBytesSync(g)),
16)).mod(d.n);while(f.equals(c.ZERO));f=a.util.hexToBytes(f.toString(16));g-=f.length;0<g&&(f=a.util.fillString(String.fromCharCode(0),g)+f);g=d.encrypt(f,"NONE");f=e.generate(f,b);return{encapsulation:g,key:f}},decrypt:function(a,b,c){a=a.decrypt(b,"NONE");return e.generate(a,c)}}};a.kem.kdf1=function(a,c){e(this,a,0,c||a.digestLength)};a.kem.kdf2=function(a,c){e(this,a,1,c||a.digestLength)}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===
typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.kem)return c.kem;c.defined.kem=!0;for(var g=0;g<e.length;++g)e[g](c);return c.kem}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/kem",["require","module","./util","./random",
"./jsbn"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){a.log=a.log||{};a.log.levels="none error warning info debug verbose max".split(" ");var e={},c=[],h=null;a.log.LEVEL_LOCKED=2;a.log.NO_LEVEL_CHECK=4;a.log.INTERPOLATE=8;for(var g=0;g<a.log.levels.length;++g){var l=a.log.levels[g];e[l]={index:g,name:l.toUpperCase()}}a.log.logMessage=function(b){for(var d=e[b.level].index,f=0;f<c.length;++f){var g=c[f];g.flags&a.log.NO_LEVEL_CHECK?g.f(b):d<=e[g.level].index&&
g.f(g,b)}};a.log.prepareStandard=function(a){"standard"in a||(a.standard=e[a.level].name+" ["+a.category+"] "+a.message)};a.log.prepareFull=function(b){if(!("full"in b)){var c=[b.message],c=c.concat([]);b.full=a.util.format.apply(this,c)}};a.log.prepareStandardFull=function(b){"standardFull"in b||(a.log.prepareStandard(b),b.standardFull=b.standard)};l=["error","warning","info","debug","verbose"];for(g=0;g<l.length;++g)(function(b){a.log[b]=function(c,d){var e=Array.prototype.slice.call(arguments).slice(2);
a.log.logMessage({timestamp:new Date,level:b,category:c,message:d,arguments:e})}})(l[g]);a.log.makeLogger=function(b){b={flags:0,f:b};a.log.setLevel(b,"none");return b};a.log.setLevel=function(b,c){var d=!1;if(b&&!(b.flags&a.log.LEVEL_LOCKED))for(var e=0;e<a.log.levels.length;++e)if(c==a.log.levels[e]){b.level=c;d=!0;break}return d};a.log.lock=function(b,c){b.flags="undefined"===typeof c||c?b.flags|a.log.LEVEL_LOCKED:b.flags&~a.log.LEVEL_LOCKED};a.log.addLogger=function(a){c.push(a)};if("undefined"!==
typeof console&&"log"in console){if(console.error&&console.warn&&console.info&&console.debug)var d={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},h=function(b,c){a.log.prepareStandard(c);var e=d[c.level],g=[c.standard],g=g.concat(c.arguments.slice());e.apply(console,g)};else h=function(b,c){a.log.prepareStandardFull(c);console.log(c.standardFull)};h=a.log.makeLogger(h);a.log.setLevel(h,"debug");a.log.addLogger(h)}else console={log:function(){}};
null!==h&&(g=a.util.getQueryVariables(),"console.level"in g&&a.log.setLevel(h,g["console.level"].slice(-1)[0]),"console.lock"in g&&"true"==g["console.lock"].slice(-1)[0]&&a.log.lock(h));a.log.consoleLogger=h}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.log)return c.log;
c.defined.log=!0;for(var g=0;g<e.length;++g)e[g](c);return c.log}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/log",["require","module","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(b){var c={},d=[];if(!f.validate(b,u.asn1.recipientInfoValidator,c,d))throw b=Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo."),
b.errors=d,b;return{version:c.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(c.issuer),serialNumber:a.util.createBuffer(c.serial).toHex(),encryptedContent:{algorithm:f.derToOid(c.encAlgorithm),parameter:c.encParameter.value,content:c.encKey}}}function c(b){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(b.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:b.issuer}),
f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.encryptedContent.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]),f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b.encryptedContent.content)])}function h(a){for(var b=[],d=0;d<a.length;++d)b.push(c(a[d]));return b}function g(b){var c=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,
f.Type.INTEGER,!1,f.integerToDer(b.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:b.issuer}),f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,a.util.hexToBytes(b.serialNumber))]),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.digestAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")])]);b.authenticatedAttributesAsn1&&c.value.push(b.authenticatedAttributesAsn1);c.value.push(f.create(f.Class.UNIVERSAL,
f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.signatureAlgorithm).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.NULL,!1,"")]));c.value.push(f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b.signature));if(0<b.unauthenticatedAttributes.length){for(var d=f.create(f.Class.CONTEXT_SPECIFIC,1,!0,[]),e=0;e<b.unauthenticatedAttributes.length;++e)d.values.push(l(b.unauthenticatedAttributes[e]));c.value.push(d)}return c}function l(b){var c;if(b.type===a.pki.oids.contentType)c=
f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.value).getBytes());else if(b.type===a.pki.oids.messageDigest)c=f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b.value.bytes());else if(b.type===a.pki.oids.signingTime){c=new Date("Jan 1, 1950 00:00:00Z");var d=new Date("Jan 1, 2050 00:00:00Z"),e=b.value;if("string"===typeof e)var g=Date.parse(e),e=isNaN(g)?13===e.length?f.utcTimeToDate(e):f.generalizedTimeToDate(e):new Date(g);c=e>=c&&e<d?f.create(f.Class.UNIVERSAL,f.Type.UTCTIME,!1,f.dateToUtcTime(e)):
f.create(f.Class.UNIVERSAL,f.Type.GENERALIZEDTIME,!1,f.dateToGeneralizedTime(e))}return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.type).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[c])])}function d(b){return[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(a.pki.oids.data).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(b.algorithm).getBytes()),f.create(f.Class.UNIVERSAL,
f.Type.OCTETSTRING,!1,b.parameter.getBytes())]),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b.content.getBytes())])]}function b(b,c,d){var e={};if(!f.validate(c,d,e,[]))throw b=Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message."),b.errors=b,b;if(f.derToOid(e.contentType)!==a.pki.oids.data)throw Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(e.encryptedContent){c="";if(a.util.isArray(e.encryptedContent))for(d=
0;d<e.encryptedContent.length;++d){if(e.encryptedContent[d].type!==f.Type.OCTETSTRING)throw Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");c+=e.encryptedContent[d].value}else c=e.encryptedContent;b.encryptedContent={algorithm:f.derToOid(e.encAlgorithm),parameter:a.util.createBuffer(e.encParameter.value),content:a.util.createBuffer(c)}}if(e.content){c="";if(a.util.isArray(e.content))for(d=0;d<e.content.length;++d){if(e.content[d].type!==f.Type.OCTETSTRING)throw Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");
c+=e.content[d].value}else c=e.content;b.content=a.util.createBuffer(c)}b.version=e.version.charCodeAt(0);return b.rawCapture=e}function m(b){if(void 0===b.encryptedContent.key)throw Error("Symmetric key not available.");if(void 0===b.content){var c;switch(b.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:c=a.aes.createDecryptionCipher(b.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:c=a.des.createDecryptionCipher(b.encryptedContent.key);
break;default:throw Error("Unsupported symmetric cipher, OID "+b.encryptedContent.algorithm);}c.start(b.encryptedContent.parameter);c.update(b.encryptedContent.content);if(!c.finish())throw Error("Symmetric decryption failed.");b.content=c.output}}var f=a.asn1,u=a.pkcs7=a.pkcs7||{};u.messageFromPem=function(b){b=a.pem.decode(b)[0];if("PKCS7"!==b.type){var c=Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');c.headerType=b.type;throw c;}if(b.procType&&"ENCRYPTED"===
b.procType.type)throw Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");b=f.fromDer(b.body);return u.messageFromAsn1(b)};u.messageToPem=function(b,c){var d={type:"PKCS7",body:f.toDer(b.toAsn1()).getBytes()};return a.pem.encode(d,{maxline:c})};u.messageFromAsn1=function(b){var c={},d=[];if(!f.validate(b,u.asn1.contentInfoValidator,c,d))throw c=Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo."),c.errors=d,c;d=f.derToOid(c.contentType);switch(d){case a.pki.oids.envelopedData:d=
u.createEnvelopedData();break;case a.pki.oids.encryptedData:d=u.createEncryptedData();break;case a.pki.oids.signedData:d=u.createSignedData();break;default:throw Error("Cannot read PKCS#7 message. ContentType with OID "+d+" is not (yet) supported.");}d.fromAsn1(c.content.value[0]);return d};u.createSignedData=function(){var c=null;return c={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(d){b(c,
d,u.asn1.signedDataValidator);c.certificates=[];c.crls=[];c.digestAlgorithmIdentifiers=[];c.contentInfo=null;c.signerInfos=[];d=c.rawCapture.certificates.value;for(var e=0;e<d.length;++e)c.certificates.push(a.pki.certificateFromAsn1(d[e]))},toAsn1:function(){c.contentInfo||c.sign();for(var b=[],d=0;d<c.certificates.length;++d)b.push(a.pki.certificateToAsn1(c.certificates[d]));var d=[],e=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,
f.Type.INTEGER,!1,f.integerToDer(c.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,c.digestAlgorithmIdentifiers),c.contentInfo])]);0<b.length&&e.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,0,!0,b));0<d.length&&e.value[0].value.push(f.create(f.Class.CONTEXT_SPECIFIC,1,!0,d));e.value[0].value.push(f.create(f.Class.UNIVERSAL,f.Type.SET,!0,c.signerInfos));return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(c.type).getBytes()),
e])},addSigner:function(b){var d=b.issuer,e=b.serialNumber;b.certificate&&(e=b.certificate,"string"===typeof e&&(e=a.pki.certificateFromPem(e)),d=e.issuer.attributes,e=e.serialNumber);var f=b.key;if(!f)throw Error("Could not add PKCS#7 signer; no private key specified.");"string"===typeof f&&(f=a.pki.privateKeyFromPem(f));var g=b.digestAlgorithm||a.pki.oids.sha1;switch(g){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+
g);}b=b.authenticatedAttributes||[];if(0<b.length){for(var h=!1,l=!1,m=0;m<b.length;++m){var u=b[m];if(!h&&u.type===a.pki.oids.contentType){if(h=!0,l)break}else if(!l&&u.type===a.pki.oids.messageDigest&&(l=!0,h))break}if(!h||!l)throw Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.");}c.signers.push({key:f,version:1,issuer:d,serialNumber:e,digestAlgorithm:g,
signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:b,unauthenticatedAttributes:[]})},sign:function(){if("object"!==typeof c.content||null===c.contentInfo)if(c.contentInfo=f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(a.pki.oids.data).getBytes())]),"content"in c){var b;c.content instanceof a.util.ByteBuffer?b=c.content.bytes():"string"===typeof c.content&&(b=a.util.encodeUtf8(c.content));c.contentInfo.value.push(f.create(f.Class.CONTEXT_SPECIFIC,
0,!0,[f.create(f.Class.UNIVERSAL,f.Type.OCTETSTRING,!1,b)]))}if(0!==c.signers.length){b={};for(var d=0;d<c.signers.length;++d){var e=c.signers[d],h=e.digestAlgorithm;h in b||(b[h]=a.md[a.pki.oids[h]].create());e.md=0===e.authenticatedAttributes.length?b[h]:a.md[a.pki.oids[h]].create()}c.digestAlgorithmIdentifiers=[];for(h in b)c.digestAlgorithmIdentifiers.push(f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(h).getBytes()),f.create(f.Class.UNIVERSAL,
f.Type.NULL,!1,"")]));if(2>c.contentInfo.value.length)throw Error("Could not sign PKCS#7 message; there is no content to sign.");var h=f.derToOid(c.contentInfo.value[0].value),d=c.contentInfo.value[1],d=d.value[0],m=f.toDer(d);m.getByte();f.getBerValueLength(m);var m=m.getBytes(),r;for(r in b)b[r].start().update(m);r=new Date;for(d=0;d<c.signers.length;++d){e=c.signers[d];if(0===e.authenticatedAttributes.length){if(h!==a.pki.oids.data)throw Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.");
}else{e.authenticatedAttributesAsn1=f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var m=f.create(f.Class.UNIVERSAL,f.Type.SET,!0,[]),u=0;u<e.authenticatedAttributes.length;++u){var v=e.authenticatedAttributes[u];v.type===a.pki.oids.messageDigest?v.value=b[e.digestAlgorithm].digest():v.type!==a.pki.oids.signingTime||v.value||(v.value=r);m.value.push(l(v));e.authenticatedAttributesAsn1.value.push(l(v))}m=f.toDer(m).getBytes();e.md.start().update(m)}e.signature=e.key.sign(e.md,"RSASSA-PKCS1-V1_5")}b=
c;h=c.signers;r=[];for(d=0;d<h.length;++d)r.push(g(h[d]));b.signerInfos=r}},verify:function(){throw Error("PKCS#7 signature verification not yet implemented.");},addCertificate:function(b){"string"===typeof b&&(b=a.pki.certificateFromPem(b));c.certificates.push(b)},addCertificateRevokationList:function(a){throw Error("PKCS#7 CRL support not yet implemented.");}}};u.createEncryptedData=function(){var c=null;return c={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},
fromAsn1:function(a){b(c,a,u.asn1.encryptedDataValidator)},decrypt:function(a){void 0!==a&&(c.encryptedContent.key=a);m(c)}}};u.createEnvelopedData=function(){var c=null;return c={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(a){var d=b(c,a,u.asn1.envelopedDataValidator);a=c;for(var d=d.recipientInfos.value,f=[],g=0;g<d.length;++g)f.push(e(d[g]));a.recipients=f},toAsn1:function(){return f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,
!0,[f.create(f.Class.UNIVERSAL,f.Type.OID,!1,f.oidToDer(c.type).getBytes()),f.create(f.Class.CONTEXT_SPECIFIC,0,!0,[f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,[f.create(f.Class.UNIVERSAL,f.Type.INTEGER,!1,f.integerToDer(c.version).getBytes()),f.create(f.Class.UNIVERSAL,f.Type.SET,!0,h(c.recipients)),f.create(f.Class.UNIVERSAL,f.Type.SEQUENCE,!0,d(c.encryptedContent))])])])},findRecipient:function(a){for(var b=a.issuer.attributes,d=0;d<c.recipients.length;++d){var e=c.recipients[d],f=e.issuer;if(e.serialNumber===
a.serialNumber&&f.length===b.length){for(var g=!0,h=0;h<b.length;++h)if(f[h].type!==b[h].type||f[h].value!==b[h].value){g=!1;break}if(g)return e}}return null},decrypt:function(b,d){if(void 0===c.encryptedContent.key&&void 0!==b&&void 0!==d)switch(b.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var e=d.decrypt(b.encryptedContent.content);c.encryptedContent.key=a.util.createBuffer(e);break;default:throw Error("Unsupported asymmetric cipher, OID "+b.encryptedContent.algorithm);
}m(c)},addRecipient:function(b){c.recipients.push({version:0,issuer:b.issuer.attributes,serialNumber:b.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:b.publicKey}})},encrypt:function(b,d){if(void 0===c.encryptedContent.content){d=d||c.encryptedContent.algorithm;b=b||c.encryptedContent.key;var e,f,g;switch(d){case a.pki.oids["aes128-CBC"]:f=e=16;g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:e=24;f=16;g=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:e=
32;f=16;g=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:e=24;f=8;g=a.des.createEncryptionCipher;break;default:throw Error("Unsupported symmetric cipher, OID "+d);}if(void 0===b)b=a.util.createBuffer(a.random.getBytes(e));else if(b.length()!=e)throw Error("Symmetric key has wrong length; got "+b.length()+" bytes, expected "+e+".");c.encryptedContent.algorithm=d;c.encryptedContent.key=b;c.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(f));e=g(b);e.start(c.encryptedContent.parameter.copy());
e.update(c.content);if(!e.finish())throw Error("Symmetric encryption failed.");c.encryptedContent.content=e.output}for(e=0;e<c.recipients.length;++e)if(f=c.recipients[e],void 0===f.encryptedContent.content)switch(f.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:f.encryptedContent.content=f.encryptedContent.key.encrypt(c.encryptedContent.key.data);break;default:throw Error("Unsupported asymmetric cipher, OID "+f.encryptedContent.algorithm);}}}}}if("function"!==typeof l)if("object"===typeof module&&
module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.pkcs7)return c.pkcs7;c.defined.pkcs7=!0;for(var g=0;g<e.length;++g)e[g](c);return c.pkcs7}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,
Array.prototype.slice.call(arguments,0))};l("js/pkcs7","require module ./aes ./asn1 ./des ./oids ./pem ./pkcs7asn1 ./random ./util ./x509".split(" "),function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){function e(c,d){var b=d.toString(16);"8"<=b[0]&&(b="00"+b);b=a.util.hexToBytes(b);c.putInt32(b.length);c.putBytes(b)}function c(a,c){a.putInt32(c.length);a.putString(c)}function h(){for(var c=a.md.sha1.create(),d=arguments.length,b=0;b<d;++b)c.update(arguments[b]);
return c.digest()}var g=a.ssh=a.ssh||{};g.privateKeyToPutty=function(g,d,b){b=b||"";d=d||"";var l=""===d?"none":"aes256-cbc",f;f="PuTTY-User-Key-File-2: ssh-rsa\r\n"+("Encryption: "+l+"\r\n")+("Comment: "+b+"\r\n");var u=a.util.createBuffer();c(u,"ssh-rsa");e(u,g.e);e(u,g.n);var q=a.util.encode64(u.bytes(),64),p=Math.floor(q.length/66)+1;f+="Public-Lines: "+p+"\r\n";f+=q;q=a.util.createBuffer();e(q,g.d);e(q,g.p);e(q,g.q);e(q,g.qInv);d?(p=q.length()+16-1,p-=p%16,g=h(q.bytes()),g.truncate(g.length()-
p+q.length()),q.putBuffer(g),p=a.util.createBuffer(),p.putBuffer(h("\x00\x00\x00\x00",d)),p.putBuffer(h("\x00\x00\x00",d)),p=a.aes.createEncryptionCipher(p.truncate(8),"CBC"),p.start(a.util.createBuffer().fillWithByte(0,16)),p.update(q.copy()),p.finish(),p=p.output,p.truncate(16),g=a.util.encode64(p.bytes(),64)):g=a.util.encode64(q.bytes(),64);p=Math.floor(g.length/66)+1;f+="\r\nPrivate-Lines: "+p+"\r\n";f+=g;d=h("putty-private-key-file-mac-key",d);p=a.util.createBuffer();c(p,"ssh-rsa");c(p,l);c(p,
b);p.putInt32(u.length());p.putBuffer(u);p.putInt32(q.length());p.putBuffer(q);b=a.hmac.create();b.start("sha1",d);b.update(p.bytes());return f+="\r\nPrivate-MAC: "+b.digest().toHex()+"\r\n"};g.publicKeyToOpenSSH=function(g,d){d=d||"";var b=a.util.createBuffer();c(b,"ssh-rsa");e(b,g.e);e(b,g.n);return"ssh-rsa "+a.util.encode64(b.bytes())+" "+d};g.privateKeyToOpenSSH=function(c,d){return d?a.pki.encryptRsaPrivateKey(c,d,{legacy:!0,algorithm:"aes128"}):a.pki.privateKeyToPem(c)};g.getPublicKeyFingerprint=
function(g,d){d=d||{};var b=d.md||a.md.md5.create(),h=a.util.createBuffer();c(h,"ssh-rsa");e(h,g.e);e(h,g.n);b.start();b.update(h.getBytes());b=b.digest();if("hex"===d.encoding)return b=b.toHex(),d.delimiter?b.match(/.{2}/g).join(d.delimiter):b;if("binary"===d.encoding)return b.getBytes();if(d.encoding)throw Error('Unknown encoding "'+d.encoding+'".');return b}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&
(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.ssh)return c.ssh;c.defined.ssh=!0;for(var g=0;g<e.length;++g)e[g](c);return c.ssh}},z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/ssh","require module ./aes ./hmac ./md5 ./sha1 ./util".split(" "),
function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){function w(a){var e={},c=0;a.debug.set("forge.task","tasks",e);var h={};a.debug.set("forge.task","queues",h);var g={ready:{}};g.ready.stop="ready";g.ready.start="running";g.ready.cancel="done";g.ready.fail="error";g.running={};g.running.stop="ready";g.running.start="running";g.running.block="blocked";g.running.unblock="running";g.running.sleep="sleeping";g.running.wakeup="running";g.running.cancel="done";g.running.fail=
"error";g.blocked={};g.blocked.stop="blocked";g.blocked.start="blocked";g.blocked.block="blocked";g.blocked.unblock="blocked";g.blocked.sleep="blocked";g.blocked.wakeup="blocked";g.blocked.cancel="done";g.blocked.fail="error";g.sleeping={};g.sleeping.stop="sleeping";g.sleeping.start="sleeping";g.sleeping.block="sleeping";g.sleeping.unblock="sleeping";g.sleeping.sleep="sleeping";g.sleeping.wakeup="sleeping";g.sleeping.cancel="done";g.sleeping.fail="error";g.done={};g.done.stop="done";g.done.start=
"done";g.done.block="done";g.done.unblock="done";g.done.sleep="done";g.done.wakeup="done";g.done.cancel="done";g.done.fail="error";g.error={};g.error.stop="error";g.error.start="error";g.error.block="error";g.error.unblock="error";g.error.sleep="error";g.error.wakeup="error";g.error.cancel="error";g.error.fail="error";var l=function(a){this.id=-1;this.name=a.name||"?";this.parent=a.parent||null;this.run=a.run;this.subtasks=[];this.error=!1;this.state="ready";this.blocks=0;this.userData=this.swapTime=
this.timeoutId=null;this.id=c++;e[this.id]=this};l.prototype.debug=function(b){a.log.debug("forge.task",b||"","[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",h)};l.prototype.next=function(a,b){"function"===typeof a&&(b=a,a=this.name);var c=new l({run:b,name:a,parent:this});c.state="running";c.type=this.type;c.successCallback=this.successCallback||null;c.failureCallback=this.failureCallback||null;this.subtasks.push(c);return this};l.prototype.parallel=function(b,c){a.util.isArray(b)&&
(c=b,b=this.name);return this.next(b,function(d){d.block(c.length);for(var e=function(b,e){a.task.start({type:b,run:function(a){c[e](a)},success:function(a){d.unblock()},failure:function(a){d.unblock()}})},g=0;g<c.length;g++)e(b+"__parallel-"+d.id+"-"+g,g)})};l.prototype.stop=function(){this.state=g[this.state].stop};l.prototype.start=function(){this.error=!1;this.state=g[this.state].start;"running"===this.state&&(this.start=new Date,this.run(this),b(this,0))};l.prototype.block=function(a){this.blocks+=
"undefined"===typeof a?1:a;0<this.blocks&&(this.state=g[this.state].block)};l.prototype.unblock=function(a){this.blocks-="undefined"===typeof a?1:a;0===this.blocks&&"done"!==this.state&&(this.state="running",b(this,0));return this.blocks};l.prototype.sleep=function(a){this.state=g[this.state].sleep;var c=this;this.timeoutId=setTimeout(function(){c.timeoutId=null;c.state="running";b(c,0)},"undefined"===typeof a?0:a)};l.prototype.wait=function(a){a.wait(this)};l.prototype.wakeup=function(){"sleeping"===
this.state&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state="running",b(this,0))};l.prototype.cancel=function(){this.state=g[this.state].cancel;this.permitsNeeded=0;null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null);this.subtasks=[]};l.prototype.fail=function(a){this.error=!0;m(this,!0);if(a)a.error=this.error,a.swapTime=this.swapTime,a.userData=this.userData,b(a,0);else{if(null!==this.parent){for(a=this.parent;null!==a.parent;)a.error=this.error,a.swapTime=this.swapTime,
a.userData=this.userData,a=a.parent;m(a,!0)}this.failureCallback&&this.failureCallback(this)}};var d=function(a){a.error=!1;a.state=g[a.state].start;setTimeout(function(){"running"===a.state&&(a.swapTime=+new Date,a.run(a),b(a,0))},0)},b=function(a,c){var d=30<c||20<+new Date-a.swapTime,e=function(c){c++;if("running"===a.state)if(d&&(a.swapTime=+new Date),0<a.subtasks.length){var e=a.subtasks.shift();e.error=a.error;e.swapTime=a.swapTime;e.userData=a.userData;e.run(e);e.error||b(e,c)}else m(a),a.error||
null===a.parent||(a.parent.error=a.error,a.parent.swapTime=a.swapTime,a.parent.userData=a.userData,b(a.parent,c))};d?setTimeout(e,0):e(c)},m=function(b,c){b.state="done";delete e[b.id];null===b.parent&&(b.type in h?0===h[b.type].length?a.log.error("forge.task","[%s][%s] task queue empty [%s]",b.id,b.name,b.type):h[b.type][0]!==b?a.log.error("forge.task","[%s][%s] task not first in queue [%s]",b.id,b.name,b.type):(h[b.type].shift(),0===h[b.type].length?delete h[b.type]:h[b.type][0].start()):a.log.error("forge.task",
"[%s][%s] task queue missing [%s]",b.id,b.name,b.type),c||(b.error&&b.failureCallback?b.failureCallback(b):!b.error&&b.successCallback&&b.successCallback(b)))};a.task=a.task||{};a.task.start=function(a){var b=new l({run:a.run,name:a.name||"?"});b.type=a.type;b.successCallback=a.success||null;b.failureCallback=a.failure||null;b.type in h?h[a.type].push(b):(h[b.type]=[b],d(b))};a.task.cancel=function(a){a in h&&(h[a]=[h[a][0]])};a.task.createCondition=function(){var a={tasks:{},wait:function(b){b.id in
a.tasks||(b.block(),a.tasks[b.id]=b)},notify:function(){var b=a.tasks;a.tasks={};for(var c in b)b[c].unblock()}};return a}}if("function"!==typeof l)if("object"===typeof module&&module.exports){var D=!0;l=function(a,e){e(E,module)}}else return"undefined"===typeof forge&&(forge={}),w(forge);var v,C=function(a,e){e.exports=function(c){var e=v.map(function(c){return a(c)}).concat(w);c=c||{};c.defined=c.defined||{};if(c.defined.task)return c.task;c.defined.task=!0;for(var g=0;g<e.length;++g)e[g](c);return c.task}},
z=l;l=function(a,e){v="string"===typeof a?e.slice(2):a.slice(2);if(D)return delete l,z.apply(null,Array.prototype.slice.call(arguments,0));l=z;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/task",["require","module","./debug","./log","./util"],function(){C.apply(null,Array.prototype.slice.call(arguments,0))})})();(function(){if("function"!==typeof l)if("object"===typeof module&&module.exports){var w=!0;l=function(l,a){a(E,module)}}else{"undefined"===typeof forge&&(forge={disableNativeCode:!1});
return}var D,v=function(l,a){a.exports=function(a){var c=D.map(function(a){return l(a)});a=a||{};a.defined=a.defined||{};if(a.defined.forge)return a.forge;a.defined.forge=!0;for(var h=0;h<c.length;++h)c[h](a);return a};a.exports.disableNativeCode=!1;a.exports(a.exports)},C=l;l=function(v,a){D="string"===typeof v?a.slice(2):v.slice(2);if(w)return delete l,C.apply(null,Array.prototype.slice.call(arguments,0));l=C;return l.apply(null,Array.prototype.slice.call(arguments,0))};l("js/forge","require module ./aes ./aesCipherSuites ./asn1 ./cipher ./cipherModes ./debug ./des ./hmac ./kem ./log ./md ./mgf1 ./pbkdf2 ./pem ./pkcs7 ./pkcs1 ./pkcs12 ./pki ./prime ./prng ./pss ./random ./rc2 ./ssh ./task ./tls ./util".split(" "),
function(){v.apply(null,Array.prototype.slice.call(arguments,0))})})();return E("js/forge")});