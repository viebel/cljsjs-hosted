(function(m,d){if("function"===typeof define&&define.amd)define([],d);else if("object"===typeof module&&module.exports)module.exports=d();else{var e=d();e._onReady(e.init);m.Duo=e}})(this,function(){function m(){n="duo_iframe";f="";g="sig_response";p=c=k=l=h=void 0}function d(a,b){throw Error("Duo Web SDK error: "+a+(b?"\nSee "+b+" for more information":""));}function e(a,b){return"dataset"in a?a.dataset[b]:a.getAttribute("data-"+b.replace(/([a-z])([A-Z])/,"$1-$2").toLowerCase())}function u(a){"addEventListener"in
window?document.addEventListener("DOMContentLoaded",a,!1):document.attachEvent("onreadystatechange",a)}function v(a){"removeEventListener"in window?document.removeEventListener("DOMContentLoaded",a,!1):document.detachEvent("onreadystatechange",a)}function q(a){if(a){0===a.indexOf("ERR|")&&d(a.split("|")[1]);-1!==a.indexOf(":")&&2===a.split(":").length||d("Duo was given a bad token.  This might indicate a configuration problem with one of Duo's client libraries.","https://www.duosecurity.com/docs/duoweb#first-steps");
var b=a.split(":");l=b[0];k=b[1];return{sigRequest:a,duoSig:b[0],appSig:b[1]}}}function w(){c=document.getElementById(n);if(!c)throw Error('This page does not contain an iframe for Duo to use.Add an element like \x3ciframe id\x3d"duo_iframe"\x3e\x3c/iframe\x3e to this page.  See https://www.duosecurity.com/docs/duoweb#3.-show-the-iframe for more information.');r();v(w)}function x(a){return!(a.origin!=="https://"+h||"string"!==typeof a.data||!(a.data.match(C)||a.data.match(D)||a.data.match(y)))}function z(a){m();
a&&(a.host&&(h=a.host),a.sig_request&&q(a.sig_request),a.post_action&&(f=a.post_action),a.post_argument&&(g=a.post_argument),a.iframe&&(a.iframe.tagName?c=a.iframe:"string"===typeof a.iframe&&(n=a.iframe)),"function"===typeof a.submit_callback&&(p=a.submit_callback));c?r():(c=document.getElementById(n))?r():u(w);v(z)}function A(a){if(x(a))if(a.data.match(y))a=a.data.substring(16),E(a)&&window.open(a,"_self");else{B(a.data);a=window;var b=A;"removeEventListener"in window?a.removeEventListener("message",
b,!1):a.detachEvent("onmessage",b)}}function E(a){if(!a)return!1;var b=document.createElement("a");b.href=a;if("duotrustedendpoints:"===b.protocol)return!0;if("https:"!==b.protocol)return!1;for(a=0;a<t.length;a++)if(b.hostname.endsWith("."+t[a])||b.hostname===t[a])return!0;return!1}function r(){h||(h=e(c,"host"))||d("No API hostname is given for Duo to use.  Be sure to pass a `host` parameter to Duo.init, or through the `data-host` attribute on the iframe element.","https://www.duosecurity.com/docs/duoweb#3.-show-the-iframe");
l&&k||(q(e(c,"sigRequest")),l&&k||d("No valid signed request is given.  Be sure to give the `sig_request` parameter to Duo.init, or use the `data-sig-request` attribute on the iframe element.","https://www.duosecurity.com/docs/duoweb#3.-show-the-iframe"));""===f&&(f=e(c,"postAction")||f);"sig_response"===g&&(g=e(c,"postArgument")||g);c.src=["https://",h,"/frame/web/v1/auth?tx\x3d",l,"\x26parent\x3d",encodeURIComponent(document.location.href),"\x26v\x3d2.7"].join("");var a=window,b=A;"addEventListener"in
window?a.addEventListener("message",b,!1):a.attachEvent("onmessage",b)}function B(a){var b=document.createElement("input");b.type="hidden";b.name=g;b.value=a+":"+k;a=document.getElementById("duo_form");a||(a=document.createElement("form"),c.parentElement.insertBefore(a,c.nextSibling));a.method="POST";a.action=f;a.appendChild(b);"function"===typeof p?p.call(null,a):a.submit()}var C=/^(?:AUTH|ENROLL)+\|[A-Za-z0-9\+\/=]+\|[A-Za-z0-9\+\/=]+$/,D=/^ERR\|[\w\s\.\(\)]+$/,y=/^DUO_OPEN_WINDOW\|/,t=["duo.com",
"duosecurity.com","duomobile.s3-us-west-1.amazonaws.com"],n,f,g,h,l,k,c,p;m();return{init:z,_onReady:u,_parseSigRequest:q,_isDuoMessage:x,_doPostBack:B}});