(function(d,k){"function"===typeof define&&define.amd?define(["react"],k):"object"===typeof exports?module.exports=k(require("react")):d.ReactSlider=k(d.React)})(this,function(d){function k(a){a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();a.cancelBubble=!0;return a.returnValue=!1}function m(a){return null==a?[]:Array.isArray(a)?a:[a]}function n(a){return null!=a&&1===a.length?a[0]:a}return d.createClass({displayName:"ReactSlider",propTypes:{min:d.PropTypes.number,max:d.PropTypes.number,
step:d.PropTypes.number,minDistance:d.PropTypes.number,defaultValue:d.PropTypes.oneOfType([d.PropTypes.number,d.PropTypes.arrayOf(d.PropTypes.number)]),value:d.PropTypes.oneOfType([d.PropTypes.number,d.PropTypes.arrayOf(d.PropTypes.number)]),orientation:d.PropTypes.oneOf(["horizontal","vertical"]),className:d.PropTypes.string,handleClassName:d.PropTypes.string,handleActiveClassName:d.PropTypes.string,withBars:d.PropTypes.bool,barClassName:d.PropTypes.string,pearling:d.PropTypes.bool,disabled:d.PropTypes.bool,
snapDragDisabled:d.PropTypes.bool,invert:d.PropTypes.bool,onBeforeChange:d.PropTypes.func,onChange:d.PropTypes.func,onAfterChange:d.PropTypes.func,onSliderClick:d.PropTypes.func},getDefaultProps:function(){return{min:0,max:100,step:1,minDistance:0,defaultValue:0,orientation:"horizontal",className:"slider",handleClassName:"handle",handleActiveClassName:"active",barClassName:"bar",withBars:!1,pearling:!1,disabled:!1,snapDragDisabled:!1,invert:!1}},getInitialState:function(){var a=this._or(m(this.props.value),
m(this.props.defaultValue));this.tempArray=a.slice();this.pendingResizeTimeouts=[];for(var c=[],b=0;b<a.length;b++)a[b]=this._trimAlignValue(a[b],this.props),c.push(b);return{index:-1,upperBound:0,sliderLength:0,value:a,zIndices:c}},componentWillReceiveProps:function(a){var c=this._or(m(a.value),this.state.value);this.tempArray=c.slice();for(var b=0;b<c.length;b++)this.state.value[b]=this._trimAlignValue(c[b],a);this.state.value.length>c.length&&(this.state.value.length=c.length);0===this.state.upperBound&&
this._handleResize()},_or:function(a,c){var b=d.Children.count(this.props.children);switch(b){case 0:return 0<a.length?a:c;case a.length:return a;case c.length:return c;default:a.length===b&&c.length===b||console.warn(this.constructor.displayName+": Number of values does not match number of children.");for(var e=this.props.min,f=(this.props.max-e)/(b-1),h=[],g=0;g<b;g++)h.push(e+f*g);return h}},componentDidMount:function(){window.addEventListener("resize",this._handleResize);this._handleResize()},
componentWillUnmount:function(){this._clearPendingResizeTimeouts();window.removeEventListener("resize",this._handleResize)},getValue:function(){return n(this.state.value)},_handleResize:function(){var a=window.setTimeout(function(){this.pendingResizeTimeouts.shift();var a=this.refs.slider,b=this.refs.handle0,e=a.getBoundingClientRect(),f=this._sizeKey(),d=e[this._posMaxKey()],e=e[this._posMinKey()];this.setState({upperBound:a[f]-b[f],sliderLength:Math.abs(d-e),handleSize:b[f],sliderStart:this.props.invert?
d:e})}.bind(this),0);this.pendingResizeTimeouts.push(a)},_clearPendingResizeTimeouts:function(){do{var a=this.pendingResizeTimeouts.shift();clearTimeout(a)}while(this.pendingResizeTimeouts.length)},_calcOffset:function(a){return(a-this.props.min)/(this.props.max-this.props.min)*this.state.upperBound},_calcValue:function(a){return a/this.state.upperBound*(this.props.max-this.props.min)+this.props.min},_buildHandleStyle:function(a,c){var b={position:"absolute",willChange:0<=this.state.index?this._posMinKey():
"",zIndex:this.state.zIndices.indexOf(c)+1};b[this._posMinKey()]=a+"px";return b},_buildBarStyle:function(a,c){var b={position:"absolute",willChange:0<=this.state.index?this._posMinKey()+","+this._posMaxKey():""};b[this._posMinKey()]=a;b[this._posMaxKey()]=c;return b},_getClosestIndex:function(a){for(var c=Number.MAX_VALUE,b=-1,e=this.state.value,f=e.length,d=0;d<f;d++){var g=this._calcOffset(e[d]),g=Math.abs(a-g);g<c&&(c=g,b=d)}return b},_calcOffsetFromPosition:function(a){a-=this.state.sliderStart;
this.props.invert&&(a=this.state.sliderLength-a);return a-=this.state.handleSize/2},_forceValueFromPosition:function(a,c){var b=this._calcOffsetFromPosition(a),e=this._getClosestIndex(b),f=this._trimAlignValue(this._calcValue(b)),b=this.state.value.slice();b[e]=f;for(f=0;f<b.length-1;f+=1)if(b[f+1]-b[f]<this.props.minDistance)return;this.setState({value:b},c.bind(this,e))},_getMousePosition:function(a){return[a["page"+this._axisKey()],a["page"+this._orthogonalAxisKey()]]},_getTouchPosition:function(a){a=
a.touches[0];return[a["page"+this._axisKey()],a["page"+this._orthogonalAxisKey()]]},_getMouseEventMap:function(){return{mousemove:this._onMouseMove,mouseup:this._onMouseUp}},_getTouchEventMap:function(){return{touchmove:this._onTouchMove,touchend:this._onTouchEnd}},_createOnMouseDown:function(a){return function(c){if(!this.props.disabled){var b=this._getMousePosition(c);this._start(a,b[0]);this._addHandlers(this._getMouseEventMap());k(c)}}.bind(this)},_createOnTouchStart:function(a){return function(c){if(!(this.props.disabled||
1<c.touches.length)){var b=this._getTouchPosition(c);this.startPosition=b;this.isScrolling=void 0;this._start(a,b[0]);this._addHandlers(this._getTouchEventMap());c.stopPropagation&&c.stopPropagation();c.cancelBubble=!0}}.bind(this)},_addHandlers:function(a){for(var c in a)document.addEventListener(c,a[c],!1)},_removeHandlers:function(a){for(var c in a)document.removeEventListener(c,a[c],!1)},_start:function(a,c){document.activeElement&&document.activeElement!=document.body&&document.activeElement.blur();
this.hasMoved=!1;this._fireChangeEvent("onBeforeChange");var b=this.state.zIndices;b.splice(b.indexOf(a),1);b.push(a);this.setState({startValue:this.state.value[a],startPosition:c,index:a,zIndices:b})},_onMouseUp:function(){this._onEnd(this._getMouseEventMap())},_onTouchEnd:function(){this._onEnd(this._getTouchEventMap())},_onEnd:function(a){this._removeHandlers(a);this.setState({index:-1},this._fireChangeEvent.bind(this,"onAfterChange"))},_onMouseMove:function(a){a=this._getMousePosition(a);this._move(a[0])},
_onTouchMove:function(a){if(!(1<a.touches.length)){var c=this._getTouchPosition(a);if("undefined"===typeof this.isScrolling){var b=c[0]-this.startPosition[0];this.isScrolling=Math.abs(c[1]-this.startPosition[1])>Math.abs(b)}this.isScrolling?this.setState({index:-1}):(k(a),this._move(c[0]))}},_move:function(a){this.hasMoved=!0;var c=this.props,b=this.state,e=b.index,f=b.value,d=f.length,g=f[e];a-=b.startPosition;c.invert&&(a*=-1);b=this._trimAlignValue(b.startValue+a/(b.sliderLength-b.handleSize)*
(c.max-c.min));a=c.minDistance;if(!c.pearling){if(0<e){var l=f[e-1];b<l+a&&(b=l+a)}e<d-1&&(l=f[e+1],b>l-a&&(b=l-a))}f[e]=b;c.pearling&&1<d&&(b>g?(this._pushSucceeding(f,a,e),this._trimSucceeding(d,f,a,c.max)):b<g&&(this._pushPreceding(f,a,e),this._trimPreceding(d,f,a,c.min)));b!==g&&this.setState({value:f},this._fireChangeEvent.bind(this,"onChange"))},_pushSucceeding:function(a,c,b){var e;for(e=a[b]+c;null!=a[b+1]&&e>a[b+1];b++,e=a[b]+c)a[b+1]=this._alignValue(e)},_trimSucceeding:function(a,c,b,e){for(var d=
0;d<a;d++){var h=e-d*b;c[a-1-d]>h&&(c[a-1-d]=h)}},_pushPreceding:function(a,c,b){var e;for(e=a[b]-c;null!=a[b-1]&&e<a[b-1];b--,e=a[b]-c)a[b-1]=this._alignValue(e)},_trimPreceding:function(a,c,b,e){for(var d=0;d<a;d++){var h=e+d*b;c[d]<h&&(c[d]=h)}},_axisKey:function(){var a=this.props.orientation;if("horizontal"===a)return"X";if("vertical"===a)return"Y"},_orthogonalAxisKey:function(){var a=this.props.orientation;if("horizontal"===a)return"Y";if("vertical"===a)return"X"},_posMinKey:function(){var a=
this.props.orientation;if("horizontal"===a)return this.props.invert?"right":"left";if("vertical"===a)return this.props.invert?"bottom":"top"},_posMaxKey:function(){var a=this.props.orientation;if("horizontal"===a)return this.props.invert?"left":"right";if("vertical"===a)return this.props.invert?"top":"bottom"},_sizeKey:function(){var a=this.props.orientation;if("horizontal"===a)return"clientWidth";if("vertical"===a)return"clientHeight"},_trimAlignValue:function(a,c){return this._alignValue(this._trimValue(a,
c),c)},_trimValue:function(a,c){c=c||this.props;a<=c.min&&(a=c.min);a>=c.max&&(a=c.max);return a},_alignValue:function(a,c){c=c||this.props;var b=(a-c.min)%c.step,d=a-b;2*Math.abs(b)>=c.step&&(d+=0<b?c.step:-c.step);return parseFloat(d.toFixed(5))},_renderHandle:function(a,c,b){return d.createElement("div",{ref:"handle"+b,key:"handle"+b,className:this.props.handleClassName+" "+(this.props.handleClassName+"-"+b)+" "+(this.state.index===b?this.props.handleActiveClassName:""),style:a,onMouseDown:this._createOnMouseDown(b),
onTouchStart:this._createOnTouchStart(b)},c)},_renderHandles:function(a){for(var c=a.length,b=this.tempArray,e=0;e<c;e++)b[e]=this._buildHandleStyle(a[e],e);var f=this.tempArray,h=this._renderHandle;if(0<d.Children.count(this.props.children))d.Children.forEach(this.props.children,function(a,c){f[c]=h(b[c],a,c)});else for(e=0;e<c;e++)f[e]=h(b[e],null,e);return f},_renderBar:function(a,c,b){return d.createElement("div",{key:"bar"+a,ref:"bar"+a,className:this.props.barClassName+" "+this.props.barClassName+
"-"+a,style:this._buildBarStyle(c,this.state.upperBound-b)})},_renderBars:function(a){var c=[],b=a.length-1;c.push(this._renderBar(0,0,a[0]));for(var d=0;d<b;d++)c.push(this._renderBar(d+1,a[d],a[d+1]));c.push(this._renderBar(b+1,a[b],this.state.upperBound));return c},_onSliderMouseDown:function(a){if(!this.props.disabled){this.hasMoved=!1;if(!this.props.snapDragDisabled){var c=this._getMousePosition(a);this._forceValueFromPosition(c[0],function(a){this._fireChangeEvent("onChange");this._start(a,
c[0]);this._addHandlers(this._getMouseEventMap())}.bind(this))}k(a)}},_onSliderClick:function(a){this.props.disabled||!this.props.onSliderClick||this.hasMoved||(a=this._getMousePosition(a),a=this._trimAlignValue(this._calcValue(this._calcOffsetFromPosition(a[0]))),this.props.onSliderClick(a))},_fireChangeEvent:function(a){if(this.props[a])this.props[a](n(this.state.value))},render:function(){for(var a=this.props,c=this.tempArray,b=this.state.value,e=b.length,f=0;f<e;f++)c[f]=this._calcOffset(b[f],
f);b=a.withBars?this._renderBars(c):null;c=this._renderHandles(c);return d.createElement("div",{ref:"slider",style:{position:"relative"},className:a.className+(a.disabled?" disabled":""),onMouseDown:this._onSliderMouseDown,onClick:this._onSliderClick},b,c)}})});