'use strict';("function"===typeof define?function(g){define("msgpack-js",g)}:"object"===typeof exports?function(g){module.exports=g()}:function(g){this.msgpack=g()})(function(){function g(a,b,c){for(var e=0,d=c.length;e<d;e++){var f=c.charCodeAt(e);if(128>f)a.setUint8(b++,f>>>0&127|0);else if(2048>f)a.setUint8(b++,f>>>6&31|192),a.setUint8(b++,f>>>0&63|128);else if(65536>f)a.setUint8(b++,f>>>12&15|224),a.setUint8(b++,f>>>6&63|128),a.setUint8(b++,f>>>0&63|128);else if(1114112>f)a.setUint8(b++,f>>>18&
7|240),a.setUint8(b++,f>>>12&63|128),a.setUint8(b++,f>>>6&63|128),a.setUint8(b++,f>>>0&63|128);else throw Error("bad codepoint "+f);}}function p(a,b,c){var e="",d=b;for(b+=c;d<b;d++)if(c=a.getUint8(d),0===(c&128))e+=String.fromCharCode(c);else if(192===(c&224))e+=String.fromCharCode((c&15)<<6|a.getUint8(++d)&63);else if(224===(c&240))e+=String.fromCharCode((c&15)<<12|(a.getUint8(++d)&63)<<6|(a.getUint8(++d)&63)<<0);else if(240===(c&248))e+=String.fromCharCode((c&7)<<18|(a.getUint8(++d)&63)<<12|(a.getUint8(++d)&
63)<<6|(a.getUint8(++d)&63)<<0);else throw Error("Invalid byte "+c.toString(16));return e}function n(a){for(var b=0,c=0,e=a.length;c<e;c++){var d=a.charCodeAt(c);if(128>d)b+=1;else if(2048>d)b+=2;else if(65536>d)b+=3;else if(1114112>d)b+=4;else throw Error("bad codepoint "+d);}return b}function h(a,b){this.offset=b||0;this.view=a}function l(a,b,c){var e=typeof a;if("string"===e){var d=n(a);if(32>d)return b.setUint8(c,d|160),g(b,c+1,a),1+d;if(65536>d)return b.setUint8(c,218),b.setUint16(c+1,d),g(b,
c+3,a),3+d;if(4294967296>d)return b.setUint8(c,219),b.setUint32(c+1,d),g(b,c+5,a),5+d}if(a instanceof ArrayBuffer){d=a.byteLength;if(65536>d)return b.setUint8(c,216),b.setUint16(c+1,d),(new Uint8Array(b.buffer)).set(new Uint8Array(a),c+3),3+d;if(4294967296>d)return b.setUint8(c,217),b.setUint32(c+1,d),(new Uint8Array(b.buffer)).set(new Uint8Array(a),c+5),5+d}if("number"===e){if(a<<0!==a)return b.setUint8(c,203),b.setFloat64(c+1,a),9;if(0<=a){if(128>a)return b.setUint8(c,a),1;if(256>a)return b.setUint8(c,
204),b.setUint8(c+1,a),2;if(65536>a)return b.setUint8(c,205),b.setUint16(c+1,a),3;if(4294967296>a)return b.setUint8(c,206),b.setUint32(c+1,a),5;throw Error("Number too big 0x"+a.toString(16));}if(-32<=a)return b.setInt8(c,a),1;if(-128<=a)return b.setUint8(c,208),b.setInt8(c+1,a),2;if(-32768<=a)return b.setUint8(c,209),b.setInt16(c+1,a),3;if(-2147483648<=a)return b.setUint8(c,210),b.setInt32(c+1,a),5;throw Error("Number too small -0x"+(-a).toString(16).substr(1));}if("undefined"===e)return b.setUint8(c,
196),1;if(null===a)return b.setUint8(c,192),1;if("boolean"===e)return b.setUint8(c,a?195:194),1;if("object"===e){var e=0,f=Array.isArray(a);if(f)d=a.length;else var h=Object.keys(a),d=h.length;16>d?(b.setUint8(c,d|(f?144:128)),e=1):65536>d?(b.setUint8(c,f?220:222),b.setUint16(c+1,d),e=3):4294967296>d&&(b.setUint8(c,f?221:223),b.setUint32(c+1,d),e=5);if(f)for(f=0;f<d;f++)e+=l(a[f],b,c+e);else for(f=0;f<d;f++)var k=h[f],e=e+l(k,b,c+e),e=e+l(a[k],b,c+e);return e}throw Error("Unknown type "+e);}function m(a){var b=
typeof a;if("string"===b){var c=n(a);if(32>c)return 1+c;if(65536>c)return 3+c;if(4294967296>c)return 5+c}if(a instanceof ArrayBuffer){c=a.byteLength;if(65536>c)return 3+c;if(4294967296>c)return 5+c}if("number"===b){if(a<<0!==a)return 9;if(0<=a){if(128>a)return 1;if(256>a)return 2;if(65536>a)return 3;if(4294967296>a)return 5;if(1.8446744073709552E19>a)return 9;throw Error("Number too big 0x"+a.toString(16));}if(-32<=a)return 1;if(-128<=a)return 2;if(-32768<=a)return 3;if(-2147483648<=a)return 5;if(-9223372036854775808<=
a)return 9;throw Error("Number too small -0x"+a.toString(16).substr(1));}if("boolean"===b||"undefined"===b||null===a)return 1;if("object"===b){b=0;if(Array.isArray(a))for(var c=a.length,e=0;e<c;e++)b+=m(a[e]);else for(var d=Object.keys(a),c=d.length,e=0;e<c;e++)var f=d[e],b=b+(m(f)+m(a[f]));if(16>c)return 1+b;if(65536>c)return 3+b;if(4294967296>c)return 5+b;throw Error("Array or object too long 0x"+c.toString(16));}throw Error("Unknown type "+b);}var k={inspect:function(a){if(void 0===a)return"undefined";
var b,c;a instanceof ArrayBuffer?(c="ArrayBuffer",b=new DataView(a)):a instanceof DataView&&(c="DataView",b=a);if(!b)return JSON.stringify(a);for(var e=[],d=0;d<a.byteLength;d++){if(20<d){e.push("...");break}var f=b.getUint8(d).toString(16);1===f.length&&(f="0"+f);e.push(f)}return"\x3c"+c+" "+e.join(" ")+"\x3e"}};k.utf8Write=g;k.utf8Read=p;k.utf8ByteCount=n;k.encode=function(a){var b=new ArrayBuffer(m(a)),c=new DataView(b);l(a,c,0);return b};k.decode=function(a){var b=new DataView(a),b=new h(b),c=
b.parse();if(b.offset!==a.byteLength)throw Error(a.byteLength-b.offset+" trailing bytes");return c};h.prototype.map=function(a){for(var b={},c=0;c<a;c++){var e=this.parse();b[e]=this.parse()}return b};h.prototype.buf=function(a){var b=new ArrayBuffer(a);(new Uint8Array(b)).set(new Uint8Array(this.view.buffer,this.offset,a),0);this.offset+=a;return b};h.prototype.raw=function(a){var b=p(this.view,this.offset,a);this.offset+=a;return b};h.prototype.array=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=
this.parse();return b};h.prototype.parse=function(){var a=this.view.getUint8(this.offset);if(160===(a&224))return this.offset++,this.raw(a&31);if(128===(a&240))return this.offset++,this.map(a&15);if(144===(a&240))return this.offset++,this.array(a&15);if(0===(a&128))return this.offset++,a;if(224===(a&224))return a=this.view.getInt8(this.offset),this.offset++,a;switch(a){case 218:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.raw(a);case 219:return a=this.view.getUint32(this.offset+
1),this.offset+=5,this.raw(a);case 192:return this.offset++,null;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:this.offset++;return;case 204:return a=this.view.getUint8(this.offset+1),this.offset+=2,a;case 205:return a=this.view.getUint16(this.offset+1),this.offset+=3,a;case 206:return a=this.view.getUint32(this.offset+1),this.offset+=5,a;case 208:return a=this.view.getInt8(this.offset+1),this.offset+=2,a;case 209:return a=this.view.getInt16(this.offset+1),this.offset+=
3,a;case 210:return a=this.view.getInt32(this.offset+1),this.offset+=5,a;case 222:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.map(a);case 223:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.map(a);case 220:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.array(a);case 221:return a=this.view.getUint32(this.offset+1),this.offset+=5,this.array(a);case 216:return a=this.view.getUint16(this.offset+1),this.offset+=3,this.buf(a);case 217:return a=this.view.getUint32(this.offset+
1),this.offset+=5,this.buf(a);case 202:return a=this.view.getFloat32(this.offset+1),this.offset+=5,a;case 203:return a=this.view.getFloat64(this.offset+1),this.offset+=9,a}throw Error("Unknown type 0x"+a.toString(16));};return k});