(function(d,a){"object"===typeof exports?module.exports=a():"function"===typeof define&&define.amd?define([],a):d.urltemplate=a()})(this,function(){function d(){}d.prototype.encodeReserved=function(a){return a.split(/(%[0-9A-Fa-f]{2})/g).map(function(c){/%[0-9A-Fa-f]/.test(c)||(c=encodeURI(c).replace(/%5B/g,"[").replace(/%5D/g,"]"));return c}).join("")};d.prototype.encodeUnreserved=function(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(c){return"%"+c.charCodeAt(0).toString(16).toUpperCase()})};
d.prototype.encodeValue=function(a,c,e){c="+"===a||"#"===a?this.encodeReserved(c):this.encodeUnreserved(c);return e?this.encodeUnreserved(e)+"\x3d"+c:c};d.prototype.isDefined=function(a){return void 0!==a&&null!==a};d.prototype.isKeyOperator=function(a){return";"===a||"\x26"===a||"?"===a};d.prototype.getValues=function(a,c,e,d){var b=a[e],f=[];if(this.isDefined(b)&&""!==b)if("string"===typeof b||"number"===typeof b||"boolean"===typeof b)b=b.toString(),d&&"*"!==d&&(b=b.substring(0,parseInt(d,10))),
f.push(this.encodeValue(c,b,this.isKeyOperator(c)?e:null));else if("*"===d)Array.isArray(b)?b.filter(this.isDefined).forEach(function(b){f.push(this.encodeValue(c,b,this.isKeyOperator(c)?e:null))},this):Object.keys(b).forEach(function(a){this.isDefined(b[a])&&f.push(this.encodeValue(c,b[a],a))},this);else{var h=[];Array.isArray(b)?b.filter(this.isDefined).forEach(function(b){h.push(this.encodeValue(c,b))},this):Object.keys(b).forEach(function(a){this.isDefined(b[a])&&(h.push(this.encodeUnreserved(a)),
h.push(this.encodeValue(c,b[a].toString())))},this);this.isKeyOperator(c)?f.push(this.encodeUnreserved(e)+"\x3d"+h.join(",")):0!==h.length&&f.push(h.join(","))}else";"===c?this.isDefined(b)&&f.push(this.encodeUnreserved(e)):""!==b||"\x26"!==c&&"?"!==c?""===b&&f.push(""):f.push(this.encodeUnreserved(e)+"\x3d");return f};d.prototype.parse=function(a){var c=this,d="+#./;?\x26".split("");return{expand:function(l){return a.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(b,a,h){if(a){var g=null,k=[];-1!==
d.indexOf(a.charAt(0))&&(g=a.charAt(0),a=a.substr(1));a.split(/,/g).forEach(function(a){a=/([^:\*]*)(?::(\d+)|(\*))?/.exec(a);k.push.apply(k,c.getValues(l,g,a[1],a[2]||a[3]))});return g&&"+"!==g?(b=",","?"===g?b="\x26":"#"!==g&&(b=g),(0!==k.length?g:"")+k.join(b)):k.join(",")}return c.encodeReserved(h)})}}};return new d});